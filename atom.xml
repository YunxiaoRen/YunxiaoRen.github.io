<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>生信拾光</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-08-24T16:46:40.393Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>六六</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>摘要-scRNA-seq揭示胰腺导管癌的肿瘤内部抑制性和恶性发展过程</title>
    <link href="http://yoursite.com/2019/08/24/%E6%91%98%E8%A6%81-scRNA-seq%E6%8F%AD%E7%A4%BA%E8%83%B0%E8%85%BA%E5%AF%BC%E7%AE%A1%E7%99%8C%E7%9A%84%E8%82%BF%E7%98%A4%E5%86%85%E9%83%A8%E6%8A%91%E5%88%B6%E6%80%A7%E5%92%8C%E6%81%B6%E6%80%A7%E5%8F%91%E5%B1%95%E8%BF%87%E7%A8%8B/"/>
    <id>http://yoursite.com/2019/08/24/摘要-scRNA-seq揭示胰腺导管癌的肿瘤内部抑制性和恶性发展过程/</id>
    <published>2019-08-24T15:26:26.000Z</published>
    <updated>2019-08-24T16:46:40.393Z</updated>
    
    <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>胰腺导管癌(PDAC)异质性和恶性发展的单细胞研究</p><p><strong>文章信息</strong></p><p>题目：Single-cell RNA-seq highlights intra-tumoral heterogeneity and malignant progression in pancreatic ductal adenocarcinoma</p><p>杂志：Cell Research</p><p>时间：04 July 2019</p><p>链接: <a href="https://www.nature.com/articles/s41422-019-0195-y" target="_blank" rel="noopener">https://www.nature.com/articles/s41422-019-0195-y</a></p><p><strong>figure</strong></p><p><img src="/2019/08/24/摘要-scRNA-seq揭示胰腺导管癌的肿瘤内部抑制性和恶性发展过程/fig1-abstract.png" alt></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>利用单细胞RNA-seq技术对胰腺导管癌的肿瘤内部异质性和恶性发展进行探究。样本量包括24个肿瘤样本和11个对照样本，利用droplet建库的方法，得到57,530个细胞。主要分析包括：首先对细胞进行<strong>1）分群</strong>，鉴定到10个群，其中有2个导管细胞型群分别具有异常和恶性基因表达特征，然后又对两个导管细胞群进行亚群分析。<strong>2）细胞轨迹分析（拟时间分析）</strong>揭示了PDAC恶性发展过程中的相关的通路和转录因子。<strong>3）免疫浸润分析</strong>：结合TCGA胰腺癌相关的公共数据发现了肿瘤浸润T细胞失活状态相关的基因，为肿瘤免疫治疗提供了参考靶点。</p><p><strong>碎碎念</strong></p><ul><li>细胞分群是单细胞数据分析的常规步骤</li><li>拟时间分析这里用于探究肿瘤恶性程度的发展值得借鉴</li><li>另外如何从拟时间分析得到了相关的转录因子呢？（细看原文）</li><li>最后与肿瘤免疫扯上关系，升华了研究的价值和意义</li></ul><blockquote><p>每日文献摘要：第1篇  2019年08月24日 周六 </p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;一句话评价&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;胰腺导管癌(PDAC)异质性和恶性发展的单细胞研究&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;文章信息&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;题目：Single-cell RNA-seq highlights intra-tumoral heterogeneity and malignant progression in pancreatic ductal adenocarcinoma&lt;/p&gt;
&lt;p&gt;杂志：Cell Research&lt;/p&gt;
&lt;p&gt;时间：04 July 2019&lt;/p&gt;
&lt;p&gt;链接: &lt;a href=&quot;https://www.nature.com/articles/s41422-019-0195-y&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.nature.com/articles/s41422-019-0195-y&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;figure&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2019/08/24/摘要-scRNA-seq揭示胰腺导管癌的肿瘤内部抑制性和恶性发展过程/fig1-abstract.png&quot; alt&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="文献摘要" scheme="http://yoursite.com/tags/%E6%96%87%E7%8C%AE%E6%91%98%E8%A6%81/"/>
    
      <category term="single cell" scheme="http://yoursite.com/tags/single-cell/"/>
    
      <category term="scRNA-seq" scheme="http://yoursite.com/tags/scRNA-seq/"/>
    
  </entry>
  
  <entry>
    <title>scRNA-seq基础知识扫盲篇</title>
    <link href="http://yoursite.com/2019/08/24/scRNA-seq%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%89%AB%E7%9B%B2%E7%AF%87/"/>
    <id>http://yoursite.com/2019/08/24/scRNA-seq基础知识扫盲篇/</id>
    <published>2019-08-23T16:29:27.000Z</published>
    <updated>2019-08-24T12:22:10.278Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Bulk-RNA-seq与scRNA-seq的优势和局限性"><a href="#Bulk-RNA-seq与scRNA-seq的优势和局限性" class="headerlink" title="Bulk RNA-seq与scRNA-seq的优势和局限性"></a>Bulk RNA-seq与scRNA-seq的优势和局限性</h2><h4 id="Bulk-RNA-seq"><a href="#Bulk-RNA-seq" class="headerlink" title="Bulk RNA-seq"></a>Bulk RNA-seq</h4><ul><li>20世纪末即芯片技术后的又一个突破性技术，之后被广泛应用，逐渐替代芯片</li><li>评估测量<strong>一个大群体内所有细胞的平均表达量水平</strong></li><li>适用于比较转录组学，如不同物种相同组织的不同样本间的转录表达差异比较；或者用于评估疾病等表达量特征</li><li>不适用于研究系统的异质性，如早期胚胎发育、复杂组织（脑）</li><li>不能提供基因表达量的随机特征</li></ul><h4 id="scRNA-seq"><a href="#scRNA-seq" class="headerlink" title="scRNA-seq"></a>scRNA-seq</h4><ul><li>2009年出现 (Tang et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Tang2009-bu" target="_blank" rel="noopener">2009</a>)</li><li>伴随着新的protocols和测序成本的降低，2014年左右被广泛推广</li><li>适用于检测一群细胞的表达量分布水平；细胞特异性变化等（如鉴定细胞类型、细胞应激的异质性，基因表达的随机性、推测细胞间的基因调控网络</li><li>数据集从10<em>2～  10 </em>8细胞，且逐年增长</li><li>目前的使用的protocols：SMART-seq2 (Picelli et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Picelli2013-sb" target="_blank" rel="noopener">2013</a>), CELL-seq (Hashimshony et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Hashimshony2012-kd" target="_blank" rel="noopener">2012</a>) and Drop-seq (Macosko et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Macosko2015-ix" target="_blank" rel="noopener">2015</a>)</li><li>商业平台：<a href="https://www.fluidigm.com/products/c1-system" target="_blank" rel="noopener">Fluidigm C1</a>, <a href="https://www.wafergen.com/products/icell8-single-cell-system" target="_blank" rel="noopener">Wafergen ICELL8</a> and the <a href="https://www.10xgenomics.com/single-cell/" target="_blank" rel="noopener">10X Genomics Chromium</a></li><li>Bulk RNA-seq的一些方法也适合于scRNA-seq，大多情况需要新的方法</li></ul><a id="more"></a><h2 id="单细胞RNA测序流程"><a href="#单细胞RNA测序流程" class="headerlink" title="单细胞RNA测序流程"></a>单细胞RNA测序流程</h2><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig1-workflow.png" style="zoom:50%"></p><h2 id="分析方法"><a href="#分析方法" class="headerlink" title="分析方法"></a>分析方法</h2><p>scRNA-seq上游分析方法与bulk 相同，对测序数据进行<strong>质控、比对、比对结果的质控（黄色部分）</strong>，接着是细胞质控、标准化，这一部分与bulk有相同的也有不同的地方，下游分析就是解释实际生物学问题，包括差异分析、聚类、网络分析等，所用的方法一般都是scRNA特有的算法。</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig2-analysis.png" style="zoom:50%"></p><blockquote><p>scRNA-seq 分析的综述：(Stegle, Teichmann, and Marioni <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Stegle2015-uv" target="_blank" rel="noopener">2015</a>)</p></blockquote><ul><li><a href="https://github.com/VCCRI/Falco/" target="_blank" rel="noopener">Falco</a> ：云端处理scRNA-seq分析.</li><li><a href="https://github.com/YosefLab/scone" target="_blank" rel="noopener">SCONE</a> (Single-Cell Overview of Normalized Expression), scRNA-seq质控和标准化的R包</li><li><a href="http://satijalab.org/seurat/" target="_blank" rel="noopener">Seurat</a> ：scRNA-seq分析的常用的四大R包之一，包括对数据的质控、分析等</li><li><a href="https://asap.epfl.ch/" target="_blank" rel="noopener">ASAP</a> (Automated Single-cell Analysis Pipeline) ：scRNA-seq交互分析的网络平台</li></ul><h2 id="挑战"><a href="#挑战" class="headerlink" title="挑战"></a>挑战</h2><p>bulk RNA-seq与scRNA-seq最主要的不同是scRNA-seq的每个测序文库代表一个细胞而不是一群细胞。文库的不同来源于：</p><ul><li>扩增 (达到1 million倍)</li><li>Gene ‘dropouts’：指一个细胞在一个细胞中是中等表达水平，但是在另一个细胞中没有被检测到</li></ul><p>上面的差异主要来自于RNA的起始量很低，因此提高转录本的捕获率、降低扩增偏差是一个热门的研究方向。</p><h2 id="实验方法"><a href="#实验方法" class="headerlink" title="实验方法"></a>实验方法</h2><p>发展新的scRNA-seq protocol也是一个热门领域，目前已有的方法包括：</p><ul><li>CEL-seq (Hashimshony et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Hashimshony2012-kd" target="_blank" rel="noopener">2012</a>)</li><li>CEL-seq2 (Hashimshony et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Hashimshony2016-lx" target="_blank" rel="noopener">2016</a>)</li><li>Drop-seq (Macosko et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Macosko2015-ix" target="_blank" rel="noopener">2015</a>)</li><li>InDrop-seq (Klein et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Klein2015-kz" target="_blank" rel="noopener">2015</a>)</li><li>MARS-seq (Jaitin et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Jaitin2014-ko" target="_blank" rel="noopener">2014</a>)</li><li>SCRB-seq (Soumillon et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Soumillon2014-eu" target="_blank" rel="noopener">2014</a>)</li><li>Seq-well (Gierahn et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Gierahn2017-es" target="_blank" rel="noopener">2017</a>)</li><li>Smart-seq (Picelli et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Picelli2014-ic" target="_blank" rel="noopener">2014</a>)</li><li>Smart-seq2 (Picelli et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Picelli2014-ic" target="_blank" rel="noopener">2014</a>)</li><li><a href="http://www.clontech.com/US/Products/cDNA_Synthesis_and_Library_Construction/Next_Gen_Sequencing_Kits/Total_RNA-Seq/Universal_RNA_Seq_Random_Primed" target="_blank" rel="noopener">SMARTer</a></li><li>STRT-seq (Islam et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Islam2014-cn" target="_blank" rel="noopener">2013</a>)</li></ul><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig3-expre-method.png" style="zoom:50%"></p><p>不同的方法实现方式不同，其中<strong>定量</strong>和<strong>捕获</strong>是最重要的两个方面</p><p><strong>定量有两种类型：</strong></p><ul><li>全长（full length): <ul><li>致力于实现每个转录本一致的read coverage</li><li>理论上的一致的coverage很难实现，经常会存在偏差</li></ul></li><li>基于标签(tag-based):<ul><li>只捕获RNA的5‘ 端或3’端，</li><li>可以和UMI(unique molecular identifiers )结合提高定量准确性</li><li>由于只捕获单端RNA可能会降低比对率</li><li>很难鉴定isoforms</li></ul></li></ul><p><strong>捕获</strong>：</p><p>捕获策略决定了测序通量，以及得到细胞的方式和其他信息。常用的捕获策略有：</p><ul><li><p><strong>microwell-based</strong></p><p>使用吸液管或激光捕获等方法分离细胞，并将其放置在微流体管中。该方法的优缺点是：</p><ul><li><p>优点是：可以与FACS分选结合使用，从而可以根据细胞表面marker筛选感兴趣的特定类型的细胞，同时在分选时可以拍摄细胞。图像可以用于识别受损细胞或dublets。</p></li><li><p>缺点是：通量低、耗时费工</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig4-microwell.png" style="zoom:30%"></p></li></ul></li></ul><ul><li><p><strong>microfluidic-based</strong></p><ul><li><p>如Fluidigm’s C1，提供了一个更为集成的系统，用于捕捉细胞和进行建库准备所需的反应。</p></li><li><p>优点是：通量比microwell-based 高</p></li><li><p>缺点是：捕获效率低，只有10%的细胞可以被捕获，因此不适用于细胞类型罕见或者输入细胞量少的研究；另外芯片价格相对贵</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig5-fluidigm.png" style="zoom:30%"></p></li></ul></li><li><p><strong>droplet- based</strong></p><ul><li><p>将每一个细胞封装在一个毫微升的液滴中，并加上一个珠子（bead), bead中含有建库所需的酶和唯一的条形码（barcode)，条形码可以将reads来自于哪个细胞关联。因此，所有的液滴都可以汇集起来，排序在一起，然后根据条形码将reads分配给原始细胞。</p></li><li><p>优点是：通量最高</p></li><li><p>缺点是：测序成本、低覆盖率 (Ziegenhain et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Ziegenhain2017-cu" target="_blank" rel="noopener">2017</a>)</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig6-drop-seq.png" alt></p></li></ul></li></ul><h2 id="如何选择合适的平台"><a href="#如何选择合适的平台" class="headerlink" title="如何选择合适的平台"></a>如何选择合适的平台</h2><p>如何选择合适的protocols，只有根据研究的生物学问题。如果感兴趣一个组织的组成，那么droplet-based的方法可以得到大量的细胞，或许是最适合的；如果研究的是罕见细胞，并且知道细胞marker,那么结合FACS富集，测少量的细胞也可以实现目的。</p><p>全长转录本适合于对不同亚型感兴趣的研究，tagged的protocols可以和UMI结合，适用于基因水平的定量。</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig7-comparison-methods.png" style="zoom:40%"></p><blockquote><p>内容来自<em>Hemberg</em> lab’s 单细胞课程学习笔记 ： </p><p>Introduction to single-cell RNA-seq：</p><p><a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html" target="_blank" rel="noopener">https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html</a></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Bulk-RNA-seq与scRNA-seq的优势和局限性&quot;&gt;&lt;a href=&quot;#Bulk-RNA-seq与scRNA-seq的优势和局限性&quot; class=&quot;headerlink&quot; title=&quot;Bulk RNA-seq与scRNA-seq的优势和局限性&quot;&gt;&lt;/a&gt;Bulk RNA-seq与scRNA-seq的优势和局限性&lt;/h2&gt;&lt;h4 id=&quot;Bulk-RNA-seq&quot;&gt;&lt;a href=&quot;#Bulk-RNA-seq&quot; class=&quot;headerlink&quot; title=&quot;Bulk RNA-seq&quot;&gt;&lt;/a&gt;Bulk RNA-seq&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;20世纪末即芯片技术后的又一个突破性技术，之后被广泛应用，逐渐替代芯片&lt;/li&gt;
&lt;li&gt;评估测量&lt;strong&gt;一个大群体内所有细胞的平均表达量水平&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;适用于比较转录组学，如不同物种相同组织的不同样本间的转录表达差异比较；或者用于评估疾病等表达量特征&lt;/li&gt;
&lt;li&gt;不适用于研究系统的异质性，如早期胚胎发育、复杂组织（脑）&lt;/li&gt;
&lt;li&gt;不能提供基因表达量的随机特征&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;scRNA-seq&quot;&gt;&lt;a href=&quot;#scRNA-seq&quot; class=&quot;headerlink&quot; title=&quot;scRNA-seq&quot;&gt;&lt;/a&gt;scRNA-seq&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;2009年出现 (Tang et al. &lt;a href=&quot;https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Tang2009-bu&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;2009&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;伴随着新的protocols和测序成本的降低，2014年左右被广泛推广&lt;/li&gt;
&lt;li&gt;适用于检测一群细胞的表达量分布水平；细胞特异性变化等（如鉴定细胞类型、细胞应激的异质性，基因表达的随机性、推测细胞间的基因调控网络&lt;/li&gt;
&lt;li&gt;数据集从10&lt;em&gt;2～  10 &lt;/em&gt;8细胞，且逐年增长&lt;/li&gt;
&lt;li&gt;目前的使用的protocols：SMART-seq2 (Picelli et al. &lt;a href=&quot;https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Picelli2013-sb&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;2013&lt;/a&gt;), CELL-seq (Hashimshony et al. &lt;a href=&quot;https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Hashimshony2012-kd&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;2012&lt;/a&gt;) and Drop-seq (Macosko et al. &lt;a href=&quot;https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Macosko2015-ix&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;2015&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;商业平台：&lt;a href=&quot;https://www.fluidigm.com/products/c1-system&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Fluidigm C1&lt;/a&gt;, &lt;a href=&quot;https://www.wafergen.com/products/icell8-single-cell-system&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Wafergen ICELL8&lt;/a&gt; and the &lt;a href=&quot;https://www.10xgenomics.com/single-cell/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;10X Genomics Chromium&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Bulk RNA-seq的一些方法也适合于scRNA-seq，大多情况需要新的方法&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="转录组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%BD%AC%E5%BD%95%E7%BB%84/"/>
    
    
      <category term="single cell" scheme="http://yoursite.com/tags/single-cell/"/>
    
      <category term="scRNA-seq" scheme="http://yoursite.com/tags/scRNA-seq/"/>
    
  </entry>
  
  <entry>
    <title>使用BETA整合分析ATAC-seq/ChIP-seq和RNA-seq数据</title>
    <link href="http://yoursite.com/2019/08/23/%E4%BD%BF%E7%94%A8BETA%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90ATAC-seq:ChIP-seq%E5%92%8CRNA-seq%E6%95%B0%E6%8D%AE/"/>
    <id>http://yoursite.com/2019/08/23/使用BETA整合分析ATAC-seq:ChIP-seq和RNA-seq数据/</id>
    <published>2019-08-23T05:15:08.000Z</published>
    <updated>2019-08-23T05:27:10.151Z</updated>
    
    <content type="html"><![CDATA[<p><strong><a href="http://cistrome.dfci.harvard.edu/BETA/tutorial.html" target="_blank" rel="noopener">BETA 网址</a></strong>: <a href="http://cistrome.dfci.harvard.edu/BETA/tutorial.html" target="_blank" rel="noopener">http://cistrome.dfci.harvard.edu/BETA/tutorial.html</a></p><h3 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h3><p><img src="https://upload-images.jianshu.io/upload_images/8242255-df9dfd4f7834cee4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><a id="more"></a><h3 id="数据准备："><a href="#数据准备：" class="headerlink" title="数据准备："></a>数据准备：</h3><ul><li><p>peak bed file</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># chr str end</span><br><span class="line">$head mep_ebDfpeak_deseq2_sig.bed</span><br><span class="line">chr8    12050808        12052743</span><br><span class="line">chr9    66492999        66494729</span><br><span class="line">chr4    125632449       125634758</span><br><span class="line">chr4    10182030        10183501</span><br></pre></td></tr></table></figure></li><li><p>df expression file</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># symbol log2FC pvalue</span><br><span class="line">$head mep_eb_dfexpre</span><br><span class="line">MELK    6.23721078699297        5.47784458574045e-218</span><br><span class="line">RAD51AP1        4.17541170218602        2.86774188064759e-217</span><br><span class="line">HMGN5   5.98876520905166        7.49359285750074e-216</span><br><span class="line">ZWILCH  3.74468061674801        2.42032701371558e-204</span><br><span class="line">HNRNPA2B1       2.76252025379004        3.05116228100538e-190</span><br><span class="line">HLA-DRA -5.19413815362273       2.27680965999626e-188</span><br></pre></td></tr></table></figure></li></ul><h3 id="软件下载安装"><a href="#软件下载安装" class="headerlink" title="软件下载安装"></a>软件下载安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://cistrome.dfci.harvard.edu/BETA/src/BETA_1.0.7.zip</span><br><span class="line">unzip BETA_1.0.7.zip</span><br><span class="line">cd BETA_1.0.7/</span><br><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h5 id="BETA-Basic"><a href="#BETA-Basic" class="headerlink" title="BETA Basic"></a>BETA Basic</h5><p>BETA Basic 预测调控因子的功能（激活或抑制）和靶基因<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETA basic –p 3656_peaks.bed –e AR_expr.xls –k LIM –g hg19 --da500 –n basic</span><br></pre></td></tr></table></figure></p><p><strong>参数：</strong><br><code>-p</code> ： peak bed file (必需参数）<br><code>-e</code>：df expression file (必需参数）<br><code>-k</code>：表达量文件格式是limma的标准格式（根据实际情况修改）<br><code>-g</code>：基因组文件，如hg19,hg38,mm10,mm9<br><code>-n</code>：输出文件前缀，BETA默认是<strong>NA</strong><br><code>-da</code>：选择显著性变化（上调和下调的）表达数据（根据实际情况修改）</p><p><strong>其他格式(不是limma和cuffdif标准格式）的差异表达文件格式：</strong></p><ul><li>需设置参数<code>--info</code>, geneID如果是smbol需要设置<code>--gname2</code></li></ul><h5 id="BETA-Plus"><a href="#BETA-Plus" class="headerlink" title="BETA Plus"></a>BETA Plus</h5><p>BETA Plus 预测调控因子的功能（激活或抑制）和靶基因，以及靶向区域的motif分析</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETA plus –p 3656_peaks.bed –e AR_expr.xls –k LIM –g hg19 --gs hg19.fa --bl</span><br></pre></td></tr></table></figure><p><strong>参数：</strong></p><p><code>--gs</code> : motif分析需要的参数, 基因组fasta格式<br><code>--bl</code> :可选参数，当考虑boundary（如CTCF）时需要的参数</p><h4 id="BETA-Minus"><a href="#BETA-Minus" class="headerlink" title="BETA Minus"></a>BETA Minus</h4><p>BETA Minus 只根据peak bed数据基于调控潜能值预测靶基因<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETA minus -p 3656_peaks.bed --bl -g hg19</span><br></pre></td></tr></table></figure></p><h5 id="其他可选参数"><a href="#其他可选参数" class="headerlink" title="其他可选参数"></a>其他可选参数</h5><p><code>-n</code>：结果文件的名字<br><code>-o</code>:输出文件路径<br><code>--gname2</code>：geneID如果是smbol需要设置<code>--gname2</code><br><code>--info</code>：其他格式(不是limma和cuffdif标准格式）的差异表达文件格式：需设置参数<code>--info</code>,<br><code>--pn</code>:peak 数目，默认是10，000<br><code>-d DISTANCE,--distance</code> 距离TSS的距离. DEFAULT=100000 (100kb)<br><code>--df DIFF_FDR</code> : 输入0-1的数值，表示统计的阈值，如FDR等，默认是1.<br><code>--da DIFF_AMOUNT</code>; 取显著表达的基因，0-1表示比例，大于1表示个数。如2000，表示去top 2000个上调和下调的差异基因；0.5表示取50%上调和下调的基因，默认是0.5。<br><code>-c CUTOFF, --cutoff</code>： 0~1的一个阈值。默认是1e-3。<br><code>-r REFERENCE, --reference</code>： 当参考基因组不是hg19,或mm9时使用此参数。<br><code>--bl BOUNDARY</code> :LIMIT Boolean Value. Whether or not use CTCF boundary to get a peak’s associated gene, DEFAULT=FALSE<br><code>-bf BOUNDARYFILE</code> : Some BED format boundary file, use this only when You set –bl and the genome is neither hg19 nor mm9</p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><p><strong>文章</strong>Wang, S., Sun, H., Ma, J., Zang, C., Wang, C., Wang, J., … &amp; Liu, X. S. (2013). Target analysis by integration of transcriptome and ChIP-seq data with BETA. Nature protocols, 8(12), 2502-2515.<br><strong>PMID:</strong> 24263090<br><strong>网址：</strong> <a href="http://cistrome.org/BETA/index.html" target="_blank" rel="noopener">http://cistrome.org/BETA/index.html</a></p><h3 id="使用代码"><a href="#使用代码" class="headerlink" title="使用代码"></a>使用代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/software/biosoft/software/python/python2.7/bin/BETA plus -P mep_ebDfpeak_deseq2_sig.bed --info -e mep_eb_dfexpre --gname2 -g hg 19 --gs hg19.fa --bl</span><br></pre></td></tr></table></figure><h3 id="几点疑问"><a href="#几点疑问" class="headerlink" title="几点疑问"></a>几点疑问</h3><p>BETA最初的设计主要是用于ChIP-Seq和RNA-seq的整合分析，最终可以预测特定一个转录因子的靶基因，以及这些基因是激活还是抑制的功能。但是对于ATAC-seq，它得到的信号整个基因组范围转录因子的信号，那么与转录组整合分析得到的结果怎么解释？只能知道一些基因的功能是激活的或抑制的，但是并不能知道这些基因是哪些转录因子的靶基因。所以BETA是否适合ATAC-seq和与RNA-seq的整合分析？如果可以，整合分析的结果能得到哪些有价值的信息？</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://cistrome.dfci.harvard.edu/BETA/tutorial.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;BETA 网址&lt;/a&gt;&lt;/strong&gt;: &lt;a href=&quot;http://cistrome.dfci.harvard.edu/BETA/tutorial.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://cistrome.dfci.harvard.edu/BETA/tutorial.html&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;功能介绍&quot;&gt;&lt;a href=&quot;#功能介绍&quot; class=&quot;headerlink&quot; title=&quot;功能介绍&quot;&gt;&lt;/a&gt;功能介绍&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8242255-df9dfd4f7834cee4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="文献" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/"/>
    
      <category term="methods" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/methods/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
  </entry>
  
  <entry>
    <title>转录因子足迹分析+启动子处染色质可及性与基因表达不一定成正相关</title>
    <link href="http://yoursite.com/2019/08/23/%E8%BD%AC%E5%BD%95%E5%9B%A0%E5%AD%90%E8%B6%B3%E8%BF%B9%E5%88%86%E6%9E%90+%E5%90%AF%E5%8A%A8%E5%AD%90%E5%A4%84%E6%9F%93%E8%89%B2%E8%B4%A8%E5%8F%AF%E5%8F%8A%E6%80%A7%E4%B8%8E%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E4%B8%8D%E4%B8%80%E5%AE%9A%E6%88%90%E6%AD%A3%E7%9B%B8%E5%85%B3/"/>
    <id>http://yoursite.com/2019/08/23/转录因子足迹分析+启动子处染色质可及性与基因表达不一定成正相关/</id>
    <published>2019-08-23T05:10:08.000Z</published>
    <updated>2019-08-24T12:35:03.825Z</updated>
    
    <content type="html"><![CDATA[<h3 id="题目：Identification-of-transcription-factorbinding-sites-using-ATAC-seq"><a href="#题目：Identification-of-transcription-factorbinding-sites-using-ATAC-seq" class="headerlink" title="题目：Identification of transcription factorbinding sites using ATAC-seq"></a>题目：Identification of transcription factorbinding sites using ATAC-seq</h3><p>DOI: 10.1186/s13059-019-1642-2<br>杂志/日期：Genome Biol. , 26 Feb 2019<br>关键词：ATAC-seq; Computational footprinting  </p><p>日期：2019年2月17日——2019-Week8</p><h3 id="主要内容："><a href="#主要内容：" class="headerlink" title="主要内容："></a>主要内容：</h3><p>这篇文章考虑到ATAC-seq实验的人工误差提出了第一个转录因子足迹的分析方法——HINT-ATAC，使用位置依赖模型探究转座酶的裂解偏好，观察到由局部核小体结构决定的转录因子结合位点周围的特异剪接模式，因此，HINT-ATAC可以更好的预测转录因子的结合位点。</p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/8242255-c303940cae18172b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="题目：Combined-analysis-of-dissimilar-promoter-accessibility-and-gene-expression-profiles-identifies-tissue-specific-genes-and-actively-repressed-networks"><a href="#题目：Combined-analysis-of-dissimilar-promoter-accessibility-and-gene-expression-profiles-identifies-tissue-specific-genes-and-actively-repressed-networks" class="headerlink" title="题目：Combined analysis of dissimilar promoter accessibility and gene expression profiles identifies tissue-specific genes and actively repressed networks"></a>题目：Combined analysis of dissimilar promoter accessibility and gene expression profiles identifies tissue-specific genes and actively repressed networks</h3><p>DOI: <a href="https://doi.org/10.1186/s13072-019-0260-2" target="_blank" rel="noopener">https://doi.org/10.1186/s13072-019-0260-2</a><br>杂志/日期：Epigenetics &amp; Chromatin, 12 Feb 2019<br>关键词：ATAC-seq; promoter  </p><p>日期：2019年2月17日——2019-Week8</p><h3 id="主要内容：-1"><a href="#主要内容：-1" class="headerlink" title="主要内容："></a>主要内容：</h3><p>许多研究都报道了启动子处的染色质可及性与基因表达成正相关，而这篇文章发现了一个不一样的趋势。他们发现相关性最强（高表达，强的染色质可及性）的可能与管家基因功能相关。组织特异性基因表达量高，但是染色质可及性仅为中低水平的coverage。此外，他们预测到中、低表达的、但是有高启动子覆盖的基因被积极抑制。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;题目：Identification-of-transcription-factorbinding-sites-using-ATAC-seq&quot;&gt;&lt;a href=&quot;#题目：Identification-of-transcription-factorbinding-sites-using-ATAC-seq&quot; class=&quot;headerlink&quot; title=&quot;题目：Identification of transcription factorbinding sites using ATAC-seq&quot;&gt;&lt;/a&gt;题目：Identification of transcription factorbinding sites using ATAC-seq&lt;/h3&gt;&lt;p&gt;DOI: 10.1186/s13059-019-1642-2&lt;br&gt;杂志/日期：Genome Biol. , 26 Feb 2019&lt;br&gt;关键词：ATAC-seq; Computational footprinting  &lt;/p&gt;
&lt;p&gt;日期：2019年2月17日——2019-Week8&lt;/p&gt;
&lt;h3 id=&quot;主要内容：&quot;&gt;&lt;a href=&quot;#主要内容：&quot; class=&quot;headerlink&quot; title=&quot;主要内容：&quot;&gt;&lt;/a&gt;主要内容：&lt;/h3&gt;&lt;p&gt;这篇文章考虑到ATAC-seq实验的人工误差提出了第一个转录因子足迹的分析方法——HINT-ATAC，使用位置依赖模型探究转座酶的裂解偏好，观察到由局部核小体结构决定的转录因子结合位点周围的特异剪接模式，因此，HINT-ATAC可以更好的预测转录因子的结合位点。&lt;/p&gt;
    
    </summary>
    
      <category term="文献" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/"/>
    
      <category term="ideas" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/ideas/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
  </entry>
  
  <entry>
    <title>scATAC-seq分析工具</title>
    <link href="http://yoursite.com/2019/08/23/scATAC-seq%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/"/>
    <id>http://yoursite.com/2019/08/23/scATAC-seq分析工具/</id>
    <published>2019-08-23T05:07:08.000Z</published>
    <updated>2019-08-23T05:25:43.934Z</updated>
    
    <content type="html"><![CDATA[<h3 id="题目：Destin-toolkit-for-single-cell-analysis-of-chromatin-accessibility"><a href="#题目：Destin-toolkit-for-single-cell-analysis-of-chromatin-accessibility" class="headerlink" title="题目：Destin: toolkit for single-cell analysis of chromatin accessibility"></a>题目：Destin: toolkit for single-cell analysis of chromatin accessibility</h3><blockquote><p>DOI: <a href="https://doi.org/10.1093/bioinformatics/btz141" target="_blank" rel="noopener">https://doi.org/10.1093/bioinformatics/btz141</a><br>杂志/日期： Bioinformatics, 01 March 2019<br>关键词：  scATAC-seq，GWAS<br>分类：「工具」<br>日期：2019年2月10日——2019-Week7</p></blockquote><h3 id="主要内容："><a href="#主要内容：" class="headerlink" title="主要内容："></a>主要内容：</h3><p><strong>「Destin」</strong>用于scATAC-seq分析的一个R工具包，其中的一个亮点是分析GWAS结果是否与特定细胞类型集群中染色质可及性的增加有关，这里他们采用的是最初用于scRNA -seq表达的两种方法:ECWE和MAGMA。除此之外还包括：</p><ul><li>从bam文件获取实验信息</li><li>peaks的注释区域</li><li>质控</li><li>确定分群数量</li><li>差异可及性染色质<br>（其中输入文件是peaks，cell的bam文件）</li></ul><a id="more"></a><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>「Destin」用于sc-ATAC分析的一个R工具包，包括分群，与gwas关联，差异peaks分析等。</p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><ul><li>github : <a href="https://github.com/urrutiag/destin" target="_blank" rel="noopener">https://github.com/urrutiag/destin</a></li></ul><hr><h3 id="题目：-A-rapid-and-robust-method-for-single-cell-chromatin-accessibility-profiling"><a href="#题目：-A-rapid-and-robust-method-for-single-cell-chromatin-accessibility-profiling" class="headerlink" title="题目： A rapid and robust method for single cell chromatin accessibility profiling"></a>题目： A rapid and robust method for single cell chromatin accessibility profiling</h3><blockquote><p>DOI: <a href="https://www.nature.com/articles/s41467-018-07771-0" target="_blank" rel="noopener">https://www.nature.com/articles/s41467-018-07771-0</a><br>杂志/日期： Nature Communications, 17 December 2018<br>关键词： scATAC-seq，<br>分类：「工具」<br>日期：2019年2月10日——2019-Week7</p></blockquote><h3 id="主要内容：-1"><a href="#主要内容：-1" class="headerlink" title="主要内容："></a>主要内容：</h3><p>plate-based的scATAC-seq方法，结合了前期bulk Tn5单核分选标签。</p><h3 id="相关资料："><a href="#相关资料：" class="headerlink" title="相关资料："></a>相关资料：</h3><p>代码：<a href="https://github.com/dbrg77/plate_scATAC-seq" target="_blank" rel="noopener">https://github.com/dbrg77/plate_scATAC-seq</a>.<br>数据：bulk ATAC 和scATAC-seq :<a href="http://genome-euro.ucsc.edu/cgi-bin/hgTracks?hgS_doOtherUser=submit&amp;hgS_otherUserName=dbrg77&amp;hgS_otherUserSessionName=mSpleen_scATAC_cluster" target="_blank" rel="noopener">http://genome-euro.ucsc.edu/cgi-bin/hgTracks?hgS_doOtherUser=submit&amp;hgS_otherUserName=dbrg77&amp;hgS_otherUserSessionName=mSpleen_scATAC_cluster</a>.</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;题目：Destin-toolkit-for-single-cell-analysis-of-chromatin-accessibility&quot;&gt;&lt;a href=&quot;#题目：Destin-toolkit-for-single-cell-analysis-of-chromatin-accessibility&quot; class=&quot;headerlink&quot; title=&quot;题目：Destin: toolkit for single-cell analysis of chromatin accessibility&quot;&gt;&lt;/a&gt;题目：Destin: toolkit for single-cell analysis of chromatin accessibility&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;DOI: &lt;a href=&quot;https://doi.org/10.1093/bioinformatics/btz141&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://doi.org/10.1093/bioinformatics/btz141&lt;/a&gt;&lt;br&gt;杂志/日期： Bioinformatics, 01 March 2019&lt;br&gt;关键词：  scATAC-seq，GWAS&lt;br&gt;分类：「工具」&lt;br&gt;日期：2019年2月10日——2019-Week7&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;主要内容：&quot;&gt;&lt;a href=&quot;#主要内容：&quot; class=&quot;headerlink&quot; title=&quot;主要内容：&quot;&gt;&lt;/a&gt;主要内容：&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;「Destin」&lt;/strong&gt;用于scATAC-seq分析的一个R工具包，其中的一个亮点是分析GWAS结果是否与特定细胞类型集群中染色质可及性的增加有关，这里他们采用的是最初用于scRNA -seq表达的两种方法:ECWE和MAGMA。除此之外还包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;从bam文件获取实验信息&lt;/li&gt;
&lt;li&gt;peaks的注释区域&lt;/li&gt;
&lt;li&gt;质控&lt;/li&gt;
&lt;li&gt;确定分群数量&lt;/li&gt;
&lt;li&gt;差异可及性染色质&lt;br&gt;（其中输入文件是peaks，cell的bam文件）&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="文献" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/"/>
    
      <category term="methods" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/methods/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="scATACseq" scheme="http://yoursite.com/tags/scATACseq/"/>
    
      <category term="文献摘要" scheme="http://yoursite.com/tags/%E6%96%87%E7%8C%AE%E6%91%98%E8%A6%81/"/>
    
  </entry>
  
  <entry>
    <title>esATAC_一个ATAC-seq分析的R包</title>
    <link href="http://yoursite.com/2019/08/23/esATAC_%E4%B8%80%E4%B8%AAATAC-seq%E5%88%86%E6%9E%90%E7%9A%84R%E5%8C%85/"/>
    <id>http://yoursite.com/2019/08/23/esATAC_一个ATAC-seq分析的R包/</id>
    <published>2019-08-23T05:03:08.000Z</published>
    <updated>2019-08-24T12:25:05.694Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>日期：2019年1月13日——2019-Week2<br>分类：「工具」<br>题目：esATAC: An Easy-to-use Systematic pipeline for ATAC-seq data analysis<br>DOI: 10.1093/bioinformatics/bty141<br>杂志：Bioinformatics，2018 Aug<br>关键词： ATAC; chromatin accessibility; transcription factor; regulatory network</p></blockquote><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>之前介绍过中科大Kun Qu老师实验室开发的用于bulk ATAC-seq分析的工具包 —— <a href="https://www.jianshu.com/p/df239acc1e62" target="_blank" rel="noopener">「ATAC-pipe」</a>，虽然个人并不推荐依赖使用这种打包工具包。但是他们的分析方法和原理还是值得了解和学习的。这里再介绍一个ATAC-seq分析的工具包——<strong>esATAC</strong>，是由清华大学Xiaowo Wang老师实验室开发的一个R/Bioconductor包，它的功能包括如下几方面：</p><ul><li>原始数据的质控和比对</li><li>peak calling</li><li>富集分析</li><li>转录因子足迹分析</li></ul><a id="more"></a><p><strong>具体分析方法参考vignettes:</strong><br><a href="https://www.bioconductor.org/packages/release/bioc/vignettes/esATAC/inst/doc/esATAC-Introduction.html" target="_blank" rel="noopener">https://www.bioconductor.org/packages/release/bioc/vignettes/esATAC/inst/doc/esATAC-Introduction.html</a></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-7618934170793d38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="数据分析流程"><a href="#数据分析流程" class="headerlink" title="数据分析流程"></a>数据分析流程</h3><ul><li>初始数据：可以直接处理fastq格式的测序数据</li><li>质控：多种质控方法，包括测序质量，read length分布等</li><li>去接头：AdapterRemoval</li><li>比对：Bowtie2</li><li>鉴定开放染色质peak：<strong>F-seq？？</strong><br>仔细了解(Boyle, et al., 2008,Koohy, et al., 2014)</li><li>peak的注释：ChIPseeker包</li><li>TF分析：结合JASPAR数据库</li><li>适用物种：人和鼠</li></ul><hr><p><strong>单细胞RNA-seq、ATAC-seq分析教程、工具大集锦:</strong> <a href="https://github.com/seandavi/awesome-single-cell" target="_blank" rel="noopener">https://github.com/seandavi/awesome-single-cell</a> </p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;日期：2019年1月13日——2019-Week2&lt;br&gt;分类：「工具」&lt;br&gt;题目：esATAC: An Easy-to-use Systematic pipeline for ATAC-seq data analysis&lt;br&gt;DOI: 10.1093/bioinformatics/bty141&lt;br&gt;杂志：Bioinformatics，2018 Aug&lt;br&gt;关键词： ATAC; chromatin accessibility; transcription factor; regulatory network&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;介绍&quot;&gt;&lt;a href=&quot;#介绍&quot; class=&quot;headerlink&quot; title=&quot;介绍&quot;&gt;&lt;/a&gt;介绍&lt;/h3&gt;&lt;p&gt;之前介绍过中科大Kun Qu老师实验室开发的用于bulk ATAC-seq分析的工具包 —— &lt;a href=&quot;https://www.jianshu.com/p/df239acc1e62&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;「ATAC-pipe」&lt;/a&gt;，虽然个人并不推荐依赖使用这种打包工具包。但是他们的分析方法和原理还是值得了解和学习的。这里再介绍一个ATAC-seq分析的工具包——&lt;strong&gt;esATAC&lt;/strong&gt;，是由清华大学Xiaowo Wang老师实验室开发的一个R/Bioconductor包，它的功能包括如下几方面：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;原始数据的质控和比对&lt;/li&gt;
&lt;li&gt;peak calling&lt;/li&gt;
&lt;li&gt;富集分析&lt;/li&gt;
&lt;li&gt;转录因子足迹分析&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="文献" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/"/>
    
      <category term="methods" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/methods/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
  </entry>
  
  <entry>
    <title>ATAC-pipe_ATAC-seq分析的工具包</title>
    <link href="http://yoursite.com/2019/08/23/ATAC-pipe_ATAC-seq%E5%88%86%E6%9E%90%E7%9A%84%E5%B7%A5%E5%85%B7%E5%8C%85/"/>
    <id>http://yoursite.com/2019/08/23/ATAC-pipe_ATAC-seq分析的工具包/</id>
    <published>2019-08-23T05:01:08.000Z</published>
    <updated>2019-08-24T12:30:01.871Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>日期：2019年1月6日——2019-Week1<br>分类：「工具」<br>题目：ATAC-pipe: general analysis of genome-wide chromatin accessibility<br>DOI: 10.1093/bib/bby056<br>杂志：Briefings in Bioinformatics<br>关键词： ATAC; chromatin accessibility; transcription factor; regulatory network</p></blockquote><h3 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h3><p>ATAC-pipe是中科大Kun Qu实验室开发的一个打包软件包，用于分析bulk ATAC-Seq。主要功能包括：</p><ul><li>鉴定显著差异的开放染色质区域</li><li>motif分析及相关的TFs对转录调控的影响</li><li>TF和motif的足迹分析以及核小体占位的可视化</li><li>基于相关性的细胞聚类分析</li><li>构建TF调控网络，评估TFs和基因间的相互作用</li></ul><a id="more"></a><p><strong>详细用法参考：</strong> <a href="https://github.com/QuKunLab/ATAC-pipe" target="_blank" rel="noopener">https://github.com/QuKunLab/ATAC-pipe</a><br>或者 manual for ATAC-pipe:<br><a href="https://github.com/QuKunLab/ATAC-pipe/blob/master/Manual_for_ATAC-pipe.pdf" target="_blank" rel="noopener">https://github.com/QuKunLab/ATAC-pipe/blob/master/Manual_for_ATAC-pipe.pdf</a><br><img src="https://upload-images.jianshu.io/upload_images/8242255-6a010cefce1de392.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="材料和方法"><a href="#材料和方法" class="headerlink" title="材料和方法"></a>材料和方法</h3><h4 id="1-流程和算法"><a href="#1-流程和算法" class="headerlink" title="1. 流程和算法"></a>1. 流程和算法</h4><p>ATAC-pipe是基于其他工具和软件包的，需要在Linux/MAC OS平台安装 requires Bowtie2, Picard, MACS2, HOMER, Python和R的环境，以及相关的参考基因组和DESeq R包。</p><ul><li>比对: Bowtie2</li><li>去重: Picard</li><li>peak calling: MACS2</li><li>count标准化和差异分析：DESeq</li><li>聚类和热图：Cluster 3.0 和 Treeview</li><li>TF motifs分析: Homer and msCentipede</li><li>序列迁移，TSS富集值和分布，V-plot, TF调控网络：他们自己实验室写的代码</li></ul><h4 id="2-与其他工具的比较"><a href="#2-与其他工具的比较" class="headerlink" title="2. 与其他工具的比较"></a>2. 与其他工具的比较</h4><p>他们的介绍是「ATAC-pipe功能多，其他工具可能只是包含QC，比对，peak calling等基本步骤，但是ATAC-pipe还包含样本聚类，motif 搜索，足迹验证、核小体占位分析和TF调控网络分析，而且更重要的是可以鉴定显著差异开放染色质区域和这些区域的TF motif富集, 另外所需时间与其他工具相比较少」。<br>（他们介绍的优点了解下即可，其实很多工具都可以实现相同的功能,其他工具的功能和原理也要了解一下）<br><img src="https://upload-images.jianshu.io/upload_images/8242255-00e3a65dc7a94075.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ATAC-pipe与其他工具的比较"></p><h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><p>看一下这个流程包可以给出哪些结果</p><h4 id="结果1：质控"><a href="#结果1：质控" class="headerlink" title="结果1：质控"></a>结果1：质控</h4><p><img src="https://upload-images.jianshu.io/upload_images/8242255-15f9acb35786f78c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="测序质量QC"><br><img src="https://upload-images.jianshu.io/upload_images/8242255-5a9da9e0aa35587e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实验QC"></p><h4 id="结果2：相关性和差异peaks分析"><a href="#结果2：相关性和差异peaks分析" class="headerlink" title="结果2：相关性和差异peaks分析"></a>结果2：相关性和差异peaks分析</h4><p><img src="https://upload-images.jianshu.io/upload_images/8242255-3f34efca235a3415.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="相关性和差异peaks分析"></p><h4 id="结果3：TF-富集分析"><a href="#结果3：TF-富集分析" class="headerlink" title="结果3：TF 富集分析"></a>结果3：TF 富集分析</h4><p><img src="https://upload-images.jianshu.io/upload_images/8242255-f4447516f707f93d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="差异开放染色质区域和这些区域的motif富集分析"></p><h4 id="结果4：TF-motif足迹分析和核小体占位分析"><a href="#结果4：TF-motif足迹分析和核小体占位分析" class="headerlink" title="结果4：TF motif足迹分析和核小体占位分析"></a>结果4：TF motif足迹分析和核小体占位分析</h4><p><img src="https://upload-images.jianshu.io/upload_images/8242255-9a61f22dbaed9e14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="TF motif足迹分析和核小体占位分析"></p><h4 id="结果5：TF驱动调控网络"><a href="#结果5：TF驱动调控网络" class="headerlink" title="结果5：TF驱动调控网络"></a>结果5：TF驱动调控网络</h4><h2 id><a href="#" class="headerlink" title></a><img src="https://upload-images.jianshu.io/upload_images/8242255-eeda0fad3ba7c092.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="TF驱动调控网络"></h2><h3 id="讨论"><a href="#讨论" class="headerlink" title="讨论"></a>讨论</h3><p>使用他人打包的工具包有人可能觉得省时方便，但是会有很多限制，不够灵活。而且他们这个工具包本身需要安装很多工具，最终是包装成python模块，使用时是需要有linux和python基础的。他们的分析结果有很多工具和方法可以实现，对于这篇文章也就是了解下他们进行ATAC-seq分析时使用的方法，同时了解下文章中做比较时提到其他工具。</p><p>如果想实现个性化和弹性化的分析，还是需要自己了解掌握每一步的分析流程，具体方法可以参考之前的帖子:</p><ul><li><a href="https://mp.weixin.qq.com/s/iVMY_0Su278OfWc2r2_brQ" target="_blank" rel="noopener">ATAC-Seq入门加高阶传送门，文末点击可进入交流群</a><br><a href="https://mp.weixin.qq.com/s/iVMY_0Su278OfWc2r2_brQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/iVMY_0Su278OfWc2r2_brQ</a></li><li><a href="https://mp.weixin.qq.com/s/7k2GEmPmnkVfmzegpxabQA" target="_blank" rel="noopener">第10篇：ATAC-Seq、ChIP-Seq、RNA-Seq整合分析（内附目录）</a><br><a href="https://mp.weixin.qq.com/s/7k2GEmPmnkVfmzegpxabQA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/7k2GEmPmnkVfmzegpxabQA</a></li><li><a href="https://mp.weixin.qq.com/s/XQITfdnS6Zn6iTBtuladPw" target="_blank" rel="noopener">给学徒的ATAC-seq数据实战（附上收费视频）</a><br><a href="https://mp.weixin.qq.com/s/XQITfdnS6Zn6iTBtuladPw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/XQITfdnS6Zn6iTBtuladPw</a></li></ul><hr><p>另外记得在去年苏州单细胞会议的海报展示，Kun Qu老师实验室展示了一个用于sc-ATAC分析的工具包APEC（不知道发表没）。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-a706382e4acfb3e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>APEC的文章已在预印版上发出：<a href="https://www.biorxiv.org/content/early/2019/05/23/646331.full.pdf" target="_blank" rel="noopener">https://www.biorxiv.org/content/early/2019/05/23/646331.full.pdf</a> </p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;日期：2019年1月6日——2019-Week1&lt;br&gt;分类：「工具」&lt;br&gt;题目：ATAC-pipe: general analysis of genome-wide chromatin accessibility&lt;br&gt;DOI: 10.1093/bib/bby056&lt;br&gt;杂志：Briefings in Bioinformatics&lt;br&gt;关键词： ATAC; chromatin accessibility; transcription factor; regulatory network&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;摘要&quot;&gt;&lt;a href=&quot;#摘要&quot; class=&quot;headerlink&quot; title=&quot;摘要&quot;&gt;&lt;/a&gt;摘要&lt;/h3&gt;&lt;p&gt;ATAC-pipe是中科大Kun Qu实验室开发的一个打包软件包，用于分析bulk ATAC-Seq。主要功能包括：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;鉴定显著差异的开放染色质区域&lt;/li&gt;
&lt;li&gt;motif分析及相关的TFs对转录调控的影响&lt;/li&gt;
&lt;li&gt;TF和motif的足迹分析以及核小体占位的可视化&lt;/li&gt;
&lt;li&gt;基于相关性的细胞聚类分析&lt;/li&gt;
&lt;li&gt;构建TF调控网络，评估TFs和基因间的相互作用&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="文献" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/"/>
    
      <category term="methods" scheme="http://yoursite.com/categories/%E6%96%87%E7%8C%AE/methods/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
  </entry>
  
  <entry>
    <title>第10篇：ATAC-Seq、ChIP-Seq、RNA-Seq整合分析</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC10%E7%AF%87%EF%BC%9AATAC-Seq%E3%80%81ChIP-Seq%E3%80%81RNA-Seq%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2019/08/23/第10篇：ATAC-Seq、ChIP-Seq、RNA-Seq整合分析/</id>
    <published>2019-08-23T04:57:08.000Z</published>
    <updated>2019-08-23T05:11:56.849Z</updated>
    
    <content type="html"><![CDATA[<p>由于基因表达调控机制的复杂性，多种组学数据的整合分析，从不同的层面探究生物问题越来越重要。从RNA-Seq层面，我们可以探究哪些基因具有显著差异，上调或下调；从ChIP-Seq层面，我们可以研究某个特定转录因子的调控作用；从ATAC-Seq我们可以了解到染色质可及性的动态变化，由于染色质的可及性与调控元件或转录因子的结合密切相关，在转录调控中发挥着重要的作用。因此，整合分析可以进一步探究调控某一生物学过程的关键因子（包括顺式调控元件和转录因子），以及哪个转录因子调控了感兴趣的基因，以及感兴趣的转录因子的靶基因等。<br>目前，好像并没有标准化的方法用来整合比较这三种数据。不过在文献中可以看到有很多相同的或不同的思路和方法做整合分析，大家可以在学习交流群中推荐文献，一起解读学习。</p><a id="more"></a><p>下面的内容主要介绍这一节课程中RNA-Seq和ChIP-Seq的整合分析中提到的两种方法：<br><strong>一是直接比较</strong>，即首先得到差异基因与ChIP-Seq靶基因的overlap，然后选择一些关键基因比较一下谱图。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-3a8682b8a3260f0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Gao et. al, Nature 2014，doi: 10.1038/nature13921"><br><strong>课程中提到的另一种方法是使用BETA工具：</strong><br><strong>BETA (Binding and Expression Target Analysis)</strong>是 Shirley Liu实验室开发的工具，通过整合转录因子或染色质调控因子的ChIP-Seq与差异基因的表达直接预测靶基因，而且有可能发现增强子区的蛋白质的靶基因。<br>BETA有三个功能：</p><ul><li>预测转录因子的功能是激活还是抑制</li><li>预测转录因子的靶基因</li><li>鉴定转录因子的motif以及调控转录因子激活或抑制的其他因子</li></ul><p>BETA包括三个命令取决于输入数据格式和想要的输出数据（可以参考嘉因的帖子<a href="https://mp.weixin.qq.com/s/Nm47ZMbdlIx-OI5j5wo4nA" target="_blank" rel="noopener">ChIP-seq和RNA-seq整合分析，BETA最擅长 | 自己分析数据的完美解决方案</a>）</p><ul><li>BETA basic: 预测转录因子的功能是激活还是抑制，直接检测靶标</li><li>BETA plus：BETA basic + 靶标区域的motif分析</li><li>BETA minus：只基于结合数据的调控潜能的值预测TF靶基因</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/8242255-126e213bad02247c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Nat Protoc. 2013 Dec; 8(12): 2502–2515."></p><p><strong>工作原理</strong></p><ul><li>每个基因的调控潜能值是通过计算基因TSS的指定范围内的所有结合位点来计算的</li><li>调控潜能是基因受因子调节的可能性，取决于TSS范围的结合位点数以及与结合位点与TSS之间的距离</li><li>BETA minus按照调控潜能值对基因排序来鉴定靶标</li><li>BETA basic需要特定格式的差异分析结果和显著性的结果。它使用CDF来判断上调基因和下调基因是否与NON-DE不同，这是用来识别激活和抑制功能。使用调控潜能和差异统计量计算每一个基因的得分排序，该得分排序可以用于识别靶标。<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3></li></ul><ol><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/integrating_rna-seq_and_chip-seq.md" target="_blank" rel="noopener">哈佛深度NGS数据分析课程，10-Integrating RNA-seq and ChIP-seq</a></li><li><a href="https://mp.weixin.qq.com/s/-7Bx29H5nM-LQJiu9hbYjw" target="_blank" rel="noopener">大牛新宠，转录调控研究神器！找关键转录因子、推测转录因子-靶基因关系</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;由于基因表达调控机制的复杂性，多种组学数据的整合分析，从不同的层面探究生物问题越来越重要。从RNA-Seq层面，我们可以探究哪些基因具有显著差异，上调或下调；从ChIP-Seq层面，我们可以研究某个特定转录因子的调控作用；从ATAC-Seq我们可以了解到染色质可及性的动态变化，由于染色质的可及性与调控元件或转录因子的结合密切相关，在转录调控中发挥着重要的作用。因此，整合分析可以进一步探究调控某一生物学过程的关键因子（包括顺式调控元件和转录因子），以及哪个转录因子调控了感兴趣的基因，以及感兴趣的转录因子的靶基因等。&lt;br&gt;目前，好像并没有标准化的方法用来整合比较这三种数据。不过在文献中可以看到有很多相同的或不同的思路和方法做整合分析，大家可以在学习交流群中推荐文献，一起解读学习。&lt;/p&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="ChIPseq" scheme="http://yoursite.com/tags/ChIPseq/"/>
    
  </entry>
  
  <entry>
    <title>第9篇：差异peaks分析——DiffBind</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC9%E7%AF%87%EF%BC%9A%E5%B7%AE%E5%BC%82peaks%E5%88%86%E6%9E%90%E2%80%94%E2%80%94DiffBind/"/>
    <id>http://yoursite.com/2019/08/23/第9篇：差异peaks分析——DiffBind/</id>
    <published>2019-08-23T04:50:56.000Z</published>
    <updated>2019-08-24T13:52:56.517Z</updated>
    
    <content type="html"><![CDATA[<h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><ul><li><p>学习用DiffBind流程评估两个样本间的差异结合区域</p></li><li><p>用PCA评估样本间的关系</p></li><li><p>评估不同工具得到的差异peaks的一致性</p><a id="more"></a></li></ul><h3 id="评估差异peaks富集的工具"><a href="#评估差异peaks富集的工具" class="headerlink" title="评估差异peaks富集的工具"></a>评估差异peaks富集的工具</h3><p>ATAC-Seq下游分析的另一个重点是差异peaks分析。如分析不同的实验条件、多个时间节点、不同的发育时期等的差异区域。鉴定这些差异peaks区域在生物医学研究中也具有重要意义，目前也有多种相关的工具被开发：<br><img src="https://upload-images.jianshu.io/upload_images/8242255-78b2f423dc7b0fa8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>选择合适的工具需考虑以下几个因素：</strong></p><ul><li>所用的软件不需要大量的代码移植，该工具是否被维护和频繁更新。</li><li>用户需要提供什么样的输入文件，是否与peaks calling所用工具可以衔接。</li><li>信号分布的基础统计模型是什么？是基于泊松分布或更灵活的负二项分布。</li><li>一些工具是专门针对特定的ATAC-seq或ChIP-seq 数据（信号类型）设计的，如组蛋白修饰或转录因子（TF）结合。</li></ul><p>具体选择哪种工具决定于实验设计，下面的决策树可以帮助缩小你的选择范围。</p><h2 id><a href="#" class="headerlink" title></a><img src="https://upload-images.jianshu.io/upload_images/8242255-3f133ad5e0d5b6e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></h2><h3 id="DiffBind"><a href="#DiffBind" class="headerlink" title="DiffBind"></a>DiffBind</h3><p>DiffBind是鉴定两个样本间差异结合位点的一个R包。主要用于peak数据集，包括对peaks的重叠和合并的处理，计算peaks重复间隔的测序reads数，并基于结合亲和力鉴定具有统计显著性的差异结合位点。适用的统计模型有DESeq、DESeq2、edgeR。详细内容可参考DiffBind的文档：<a href="http://bioconductor.org/packages/release/bioc/vignettes/DiffBind/inst/doc/DiffBind.pdf" target="_blank" rel="noopener">http://bioconductor.org/packages/release/bioc/vignettes/DiffBind/inst/doc/DiffBind.pdf</a></p><h3 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h3><h4 id="1-下载安装DiffBind"><a href="#1-下载安装DiffBind" class="headerlink" title="1. 下载安装DiffBind"></a>1. 下载安装DiffBind</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span>(<span class="string">"https://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"DiffBind"</span>)</span><br><span class="line"><span class="comment"># view documentation</span></span><br><span class="line">browseVignettes(<span class="string">"DiffBind"</span>)</span><br></pre></td></tr></table></figure><h4 id="2-准备输入文件"><a href="#2-准备输入文件" class="headerlink" title="2. 准备输入文件"></a>2. 准备输入文件</h4><p>需要准备一个SampleSheet文件，与<a href="（https://www.jianshu.com/p/a11147808d14）">ChIPQC</a>的方法一样。SampleSheet文件是根据实验设计和数据存储地址等信息创建的一个csv格式文件，包含的表头信息有<strong>“SampleID”、 “Tissue”、 “Factor”、 “Condition” 、”Treatment”、”Replicate” 、”bamReads” 、”ControlID”、 “bamControl” “Peaks”、 “PeakCaller”</strong>（bam,peak文件分别在比对和call peak的步骤产生）。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-e5e43bc02d122cc8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h4 id="3-差异peaks分析"><a href="#3-差异peaks分析" class="headerlink" title="3. 差异peaks分析"></a>3. 差异peaks分析</h4><p><strong>读入文件</strong><br>一旦读入了peaksets，合并函数就找到所有重叠的peaks，并导出一致性的peaksets。<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(DiffBind)</span><br><span class="line">dbObj &lt;- dba(sampleSheet=<span class="string">"SampleSheet.csv"</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-b45f2ad5b70f46af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>亲和结合矩阵</strong><br>计算每个peaks/regions的count信息。先对一致性的peaks数据集进行标准化，然后根据他们的峰值（point of greatest read overlap）再次中心化并修剪一些peaks，最终得到更加标准的peak间隔。使用函数dba.count()，参数<code>bUseSummarizeOverlaps</code>可以得到更加标准的计算流程。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dbObj &lt;- dba.count(dbObj, bUseSummarizeOverlaps=TRUE)</span><br><span class="line">dba.plotPCA(dbObj,  attributes=DBA_FACTOR, label=DBA_ID)</span><br><span class="line">plot(dbObj)</span><br></pre></td></tr></table></figure><p>结果中同时计算了FRiP (质量评估的一个标准，可以参考<a href="https://www.jianshu.com/p/a11147808d14" target="_blank" rel="noopener">第5篇：对ATAC-Seq/ChIP-seq的质量评估（二）——ChIPQC</a>)。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-bda08e59563ab91a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>样本间的聚类:<br><img src="https://upload-images.jianshu.io/upload_images/8242255-d806500399a287b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>Venn图展示样本间peaks的重合<br><img src="https://upload-images.jianshu.io/upload_images/8242255-d68a6b35c676e047.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>差异分析</strong><br>差异分析是DiffBind的核心功能，默认情况是基于DEseq2, 可以设置参数<code>method=DBA_EDGER</code>选择edgeR，或者设置<code>method=DBA_ALL_METHODS</code>。每种方法都会评估差异结果的p-vaue和FDR。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Establishing a contrast </span><br><span class="line">dbObj &lt;- dba.contrast(dbObj, categories=DBA_FACTOR,minMembers = 2)</span><br><span class="line">dbObj &lt;- dba.analyze(dbObj, method=DBA_ALL_METHODS)</span><br><span class="line">#  summary of results</span><br><span class="line">dba.show(dbObj, bContrasts=T)</span><br><span class="line">#  overlapping peaks identified by the two different tools (DESeq2 and edgeR)</span><br><span class="line">dba.plotVenn(dbObj,contrast=1,method=DBA_ALL_METHODS)</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/8242255-22e7d87169ae0a19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>提取结果</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">comp1.edgeR &lt;- dba.report(dbObj, method=DBA_EDGER, contrast = 1, th=1)</span><br><span class="line">comp1.deseq &lt;- dba.report(dbObj, method=DBA_DESEQ2, contrast = 1, th=1)</span><br></pre></td></tr></table></figure><p>结果文件包含所有位点的基因组坐标，以及差异富集的统计数据包括fold change、p值和FDR。<br>其中<code>Conc</code>的表示read的平均浓度，即对peak 的read counts进行log2标准化</p><blockquote><p>The value columns show the mean read concentration over all the samples (the default calculation uses log2 normalized ChIP read counts with control read counts subtracted) and the mean concentration over the first (Resistant) group and second (Responsive) group.</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8242255-9cbf839407929d40.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>保存文件</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># EdgeR</span></span><br><span class="line">out &lt;- as.data.frame(comp1.edgeR)</span><br><span class="line">write.table(out, file=<span class="string">"results/Nanog_vs_Pou5f1_edgeR.txt"</span>, sep=<span class="string">"\t"</span>, quote=<span class="literal">F</span>, col.names = <span class="literal">NA</span>)</span><br><span class="line"><span class="comment"># DESeq2</span></span><br><span class="line">out &lt;- as.data.frame(comp1.deseq)</span><br><span class="line">write.table(out, file=<span class="string">"results/Nanog_vs_Pou5f1_deseq2.txt"</span>, sep=<span class="string">"\t"</span>, quote=<span class="literal">F</span>, col.names = <span class="literal">NA</span>)</span><br></pre></td></tr></table></figure><p><strong>以bed格式保存显著性的差异结果</strong><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create bed files for each keeping only significant peaks (p &lt; 0.05)</span></span><br><span class="line"><span class="comment"># EdgeR</span></span><br><span class="line">out &lt;- as.data.frame(comp1.edgeR)</span><br><span class="line">edge.bed &lt;- out[ which(out$FDR &lt; <span class="number">0.05</span>), </span><br><span class="line">                 c(<span class="string">"seqnames"</span>, <span class="string">"start"</span>, <span class="string">"end"</span>, <span class="string">"strand"</span>, <span class="string">"Fold"</span>)]</span><br><span class="line">write.table(edge.bed, file=<span class="string">"results/Nanog_vs_Pou5f1_edgeR_sig.bed"</span>, sep=<span class="string">"\t"</span>, quote=<span class="literal">F</span>, row.names=<span class="literal">F</span>, col.names=<span class="literal">F</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># DESeq2</span></span><br><span class="line">out &lt;- as.data.frame(comp1.deseq)</span><br><span class="line">deseq.bed &lt;- out[ which(out$FDR &lt; <span class="number">0.05</span>), </span><br><span class="line">                 c(<span class="string">"seqnames"</span>, <span class="string">"start"</span>, <span class="string">"end"</span>, <span class="string">"strand"</span>, <span class="string">"Fold"</span>)]</span><br><span class="line">write.table(deseq.bed, file=<span class="string">"results/Nanog_vs_Pou5f1_deseq2_sig.bed"</span>, sep=<span class="string">"\t"</span>, quote=<span class="literal">F</span>, row.names=<span class="literal">F</span>, col.names=<span class="literal">F</span>)</span><br></pre></td></tr></table></figure></p><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol><li><a href="http://bioconductor.org/packages/release/bioc/vignettes/DiffBind/inst/doc/DiffBind.pdf" target="_blank" rel="noopener">DiffBind文档</a></li><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/09_differential_peaks.md" target="_blank" rel="noopener">哈佛深度NGS数据分析课程， 09- Differential Peak calling using DiffBind</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;学习目标&quot;&gt;&lt;a href=&quot;#学习目标&quot; class=&quot;headerlink&quot; title=&quot;学习目标&quot;&gt;&lt;/a&gt;学习目标&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;学习用DiffBind流程评估两个样本间的差异结合区域&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;用PCA评估样本间的关系&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;评估不同工具得到的差异peaks的一致性&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="ChIPseq" scheme="http://yoursite.com/tags/ChIPseq/"/>
    
      <category term="差异分析" scheme="http://yoursite.com/tags/%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>第8篇：用网页版工具做功能分析和motif分析</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC8%E7%AF%87%EF%BC%9A%E7%94%A8%E7%BD%91%E9%A1%B5%E7%89%88%E5%B7%A5%E5%85%B7%E5%81%9A%E5%8A%9F%E8%83%BD%E5%88%86%E6%9E%90%E5%92%8Cmotif%E5%88%86%E6%9E%90/"/>
    <id>http://yoursite.com/2019/08/23/第8篇：用网页版工具做功能分析和motif分析/</id>
    <published>2019-08-23T04:42:56.000Z</published>
    <updated>2019-08-24T13:50:03.933Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>上一篇介绍了使用ChIPseeker对peaks的分布和邻近基因的注释。除此之外，下游分析通常还包括<strong>鉴定我们感兴趣的蛋白质结合的motif；鉴定这些结合区域的基因以及这些基因的富集通路或网络。</strong></p></blockquote><h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><ul><li><strong>功能富集分析: [GREAT]</strong>(<a href="http://bejerano.stanford.edu/great/public/html/index.php" target="_blank" rel="noopener">http://bejerano.stanford.edu/great/public/html/index.php</a>)</li><li><strong>motif分析:MEME套件，如DREME(<a href="http://meme-suite.org/tools/dreme)" target="_blank" rel="noopener">http://meme-suite.org/tools/dreme)</a>, MEME-ChIP (<a href="http://meme-suite.org/tools/meme-chip" target="_blank" rel="noopener">http://meme-suite.org/tools/meme-chip</a>)</strong> </li></ul><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/8242255-8e8c5b7121002686.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="准备文件"><a href="#准备文件" class="headerlink" title="准备文件"></a>准备文件</h3><p><strong>提取IDR结果文件的前3列</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cut -f 1,2,3 Nanog-idr-merged.bed  &gt; Nanog-idr-merged-great.bed</span><br></pre></td></tr></table></figure></p><p><strong>使用<code>bedtools getfasta</code>提取peaks的序列</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bedtools getfasta -<span class="keyword">fi</span> \</span><br><span class="line">ref_genome.fa \</span><br><span class="line">-bed Nanog-idr-merged-great.bed \</span><br><span class="line">-fo Nanog-idr-merged-dreme.fasta</span><br></pre></td></tr></table></figure></p><h3 id="富集分析"><a href="#富集分析" class="headerlink" title="富集分析"></a>富集分析</h3><p>GREAT(<a href="http://bejerano.stanford.edu/great/public/html/index.php)对peaks的功能注释是对peaks临近基因的注释。" target="_blank" rel="noopener">http://bejerano.stanford.edu/great/public/html/index.php)对peaks的功能注释是对peaks临近基因的注释。</a><br><strong>方法：</strong></p><ul><li>1.打开GREAT网站：<a href="http://bejerano.stanford.edu/great/public/html/index.php" target="_blank" rel="noopener">http://bejerano.stanford.edu/great/public/html/index.php</a> 。上传<code>Nanog-idr-merged-great.bed</code>文件，选择参考基因组，选择<code>Whole genome</code>作为背景区域，然后点击<code>Submit</code>。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-28d362bcb09d151b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li><li><ol start="2"><li>点开<code>Job Description</code>,选择<code>View all genomic region-gene associations</code>，结果中的两个表给出peaks注释到的基因，一个是基因组区域和基因关联的表，一个是基因和基因组关联的表：<br><img src="https://upload-images.jianshu.io/upload_images/8242255-c858a398d92b19a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="3"><li><code>Region-Gene Association Graphs</code><br>这栏内容对结合位点的基因数和转录起始位点相关的基因做了图形展示。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-5e49b7856b712239.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="4"><li><code>Global Controls</code><br>选择想注释的信息，如GO注释<br><img src="https://upload-images.jianshu.io/upload_images/8242255-34e46431f660ae7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="5"><li>探究Nanog结合位点相关的GO BP term<br><img src="https://upload-images.jianshu.io/upload_images/8242255-f20dd9477422c904.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="6"><li>选择某个term,查看具体信息<br><img src="https://upload-images.jianshu.io/upload_images/8242255-752f9bd3f211869b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="7"><li>打开<code>This term&#39;s genomic region-gene association tables (140 regions, 116 genes)</code>，查看注释到的GO term相关的基因，可以下载表格。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-ac6510b361c9db44.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></li></ol></li><li><ol start="8"><li>在<code>This term&#39;s gene -&gt; genomic region association table</code>中点击基因相关的regions，可以在UCSC浏览器上直接查看结合区域。</li></ol></li></ul><hr><h3 id="找Motif"><a href="#找Motif" class="headerlink" title="找Motif"></a>找Motif</h3><p>motif是比较有特征的短序列，会多次出现的，并被假设拥有生物学功能。而且，经常是一些具有序列特异性的蛋白的结合位点（如转录因子）或者是涉及到重要生物过程的（如，RNA 起始，RNA 终止， RNA 剪切等等）。<br>有很多网页版工具提供了找motif的方法，2014年的一篇综述列出了目前常用的网页工具（<a href="https://doi.org/10.1186/1745-6150-9-4" target="_blank" rel="noopener">https://doi.org/10.1186/1745-6150-9-4</a> ）：<br><img src="https://upload-images.jianshu.io/upload_images/8242255-4e6d85633c68e1d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>最常用的有MEME工具套件，下面主要介绍DREME。<strong>DREME</strong>适用于大批量的ChIP-Seq数据找真核转录因子短的（4nt或8nt）核心DNA结合基序。</p><h4 id="DREME"><a href="#DREME" class="headerlink" title="DREME"></a>DREME</h4><ul><li>打开DREME网页 <a href="http://meme-suite.org/tools/dreme" target="_blank" rel="noopener">http://meme-suite.org/tools/dreme</a> ，只要输入fasta序列<code>Nanog-idr-merged-dreme.fasta</code>即可，同时可以写上email和每个任务的描述，任务完成时如右图所示，可以打开DREAM_HTML_output查看结果。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-f7d4e747bf2f1644.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>DREME’s HTML展示的结果包括找到的motif的序列logo和表示显著性的E-value。点击<code>More</code>可以查看更多的信息。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-da950ecc30a57391.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>Tomtom</strong><br>为了确定鉴定到的motif与已知转录因子的motif是否相似，可以将找到的motif再提交到<strong>Tomtom</strong>，与已知的转录因子数据库搜索匹配，同时还会给出motif-motif相似性的统计评估。<br>在DREAM’s HTML结果中选择某个预测到的motif，点击<code>Submit / Download</code>,然后选择<code>Tomtom</code>，点击<code>Submit</code>，在新打开的Tomtom界面可以选择转录因子的参考数据库，保持默认参数不变，也可以再添加其他参数，输入邮箱和任务描述就可以开始搜索。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-d9aa88cd750c93ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><h4 id="MEME-ChIP"><a href="#MEME-ChIP" class="headerlink" title="MEME-ChIP"></a>MEME-ChIP</h4>MEME-ChIP是MEME套件中的另一个工具，可以实现DREAM和Tomtom的分析功能，还可以评估motifs的中心富集性并整合相关的motifs合成相似性簇。MEME-ChIP能够鉴定更长的motifs（&lt;30bp）,但是运行时间比较长。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-1da222fab1a31f81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>另外可以用Homer找motif，详细用法参考<a href="https://vip.biotrainee.com/d/388-motif" target="_blank" rel="noopener">找个motif嘛，简单</a>。<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3></li></ul><ol><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/08_functional_analysis.md" target="_blank" rel="noopener">哈佛深度NGS数据分析课程, 08-Web-based functional analysis and motif discovery</a></li><li><a href="https://vip.biotrainee.com/d/388-motif" target="_blank" rel="noopener">找个motif嘛，简单</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;上一篇介绍了使用ChIPseeker对peaks的分布和邻近基因的注释。除此之外，下游分析通常还包括&lt;strong&gt;鉴定我们感兴趣的蛋白质结合的motif；鉴定这些结合区域的基因以及这些基因的富集通路或网络。&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;学习目标&quot;&gt;&lt;a href=&quot;#学习目标&quot; class=&quot;headerlink&quot; title=&quot;学习目标&quot;&gt;&lt;/a&gt;学习目标&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能富集分析: [GREAT]&lt;/strong&gt;(&lt;a href=&quot;http://bejerano.stanford.edu/great/public/html/index.php&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://bejerano.stanford.edu/great/public/html/index.php&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;motif分析:MEME套件，如DREME(&lt;a href=&quot;http://meme-suite.org/tools/dreme)&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://meme-suite.org/tools/dreme)&lt;/a&gt;, MEME-ChIP (&lt;a href=&quot;http://meme-suite.org/tools/meme-chip&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://meme-suite.org/tools/meme-chip&lt;/a&gt;)&lt;/strong&gt; &lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="ChIPseq" scheme="http://yoursite.com/tags/ChIPseq/"/>
    
      <category term="motif" scheme="http://yoursite.com/tags/motif/"/>
    
  </entry>
  
  <entry>
    <title>第7篇：用Y叔的ChIPseeker对peaks进行注释和可视化</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC7%E7%AF%87%EF%BC%9A%E7%94%A8Y%E5%8F%94%E7%9A%84ChIPseeker%E5%AF%B9peaks%E8%BF%9B%E8%A1%8C%E6%B3%A8%E9%87%8A%E5%92%8C%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    <id>http://yoursite.com/2019/08/23/第7篇：用Y叔的ChIPseeker对peaks进行注释和可视化/</id>
    <published>2019-08-23T04:40:56.000Z</published>
    <updated>2019-08-24T12:47:45.029Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>上一步骤（<a href="https://www.jianshu.com/p/d8a7056b4294" target="_blank" rel="noopener">第6篇：重复样本的处理——IDR</a>）用IDR对重复样本peaks的一致性进行了评估，同时得到了merge后的一致性的peaks——<code>sample-idr</code>，接下来就是对peaks的注释。这篇主要介绍用Y叔的R包<strong><a href="http://www.bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html" target="_blank" rel="noopener">ChIPseeker</a>对peaks的位置（如peaks位置落在启动子、UTR、内含子等）以及peaks临近基因的注释</strong>。</p></blockquote><h3 id="ChIPseeker"><a href="#ChIPseeker" class="headerlink" title="ChIPseeker"></a>ChIPseeker</h3><p>ChIPseeker虽然最初是为了ChIP-seq注释而写的一个R包，但它不只局限于ChIP-seq，也可用于ATAC-Seq等其他富集peaks注释，也可用于lincRNA注释、DNA breakpoints的断点位置注释等所有genomic coordination的注释，另外提供了丰富的可视化功能。<br>ChIPseeker的强大功能请参考Y叔的<a href="(https://mp.weixin.qq.com/mp/homepage?__biz=MzI5NjUyNzkxMg==&amp;hid=11&amp;sn=c22229f28bd00c3efd2c89cdadd63315&amp;scene=18&amp;devicetype=android-23&amp;version=26070238&amp;lang=zh_CN&amp;nettype=3gnet&amp;ascene=7&amp;session_us=gh_ba0578f6322d">ChIP-Seq系列文章</a>)，如：<br><a href="https://mp.weixin.qq.com/s/vWTf59KDs1lp_sQXjEhI_g" target="_blank" rel="noopener">CS3: peak注释</a><br><a href="https://mp.weixin.qq.com/s/_OPzvaEAbiMolCA2mqJXLw" target="_blank" rel="noopener">CS4：关于ChIPseq注释的几个问题</a><br><a href="https://mp.weixin.qq.com/s/MqpfgkMJSFj0pYwcEjV9kQ" target="_blank" rel="noopener">CS6: ChIPseeker的可视化方法（中秋节的视觉饕餮）</a></p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/8242255-ed9f825cf93a7fa8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><p>使用ChIPseeker需要准备两个文件：一个就是要注释的peaks的文件，需满足BED格式。另一个就是注释参考文件，即需要一个包含注释信息的TxDb对象。Bioconductor提供了30个TxDb包，如果其中有研究的物种就可以直接下载安装此物种的TxDb信息。如果研究的物种没有已知的TxDb，可以使用GenomicFeatures包的函数（makeTxDbFromUCSC，makeTxDbFromBiomart）制作TxDb对象：</p><blockquote><p>makeTxDbFromUCSC： 通过UCSC在线制作TxDb<br>makeTxDbFromBiomart: 通过ensembl在线制作TxDb<br>makeTxDbFromGRanges：通过GRanges对象制作TxDb<br>makeTxDbFromGFF：通过解析GFF文件制作TxDb</p></blockquote><p><strong>制作TxDb方法示例（<a href="https://mp.weixin.qq.com/s/_OPzvaEAbiMolCA2mqJXLw" target="_blank" rel="noopener">CS4：关于ChIPseq注释的几个问题</a>）：</strong></p><ul><li><p>如用人的参考基因信息来做注释，从UCSC生成TxDb:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(GenomicFeatures)</span><br><span class="line">hg19.refseq.db &lt;- makeTxDbFromUCSC(genome=<span class="string">"hg19"</span>, table=<span class="string">"refGene"</span>)</span><br></pre></td></tr></table></figure></li><li><p>用GFF文件做裂殖酵母的注释</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">download.file(<span class="string">"ftp://ftp.ebi.ac.uk/pub/databases/pombase/pombe/Chromosome_Dumps/gff3/schizosaccharomyces_pombe.chr.gff3"</span>, <span class="string">"schizosaccharomyces_pombe.chr.gff3"</span>)<span class="keyword">require</span>(GenomicFeatures)</span><br><span class="line">spombe &lt;- makeTxDbFromGFF(<span class="string">"schizosaccharomyces_pombe.chr.gff3"</span>)</span><br></pre></td></tr></table></figure></li></ul><p><strong>具体步骤如下：</strong></p><h3 id="第1步：下载安装ChIPseeker注释相关的包"><a href="#第1步：下载安装ChIPseeker注释相关的包" class="headerlink" title="第1步：下载安装ChIPseeker注释相关的包"></a>第1步：下载安装ChIPseeker注释相关的包</h3><p>从Bioconductor直接下载，或从github安装最新版本<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span> (<span class="string">"https://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"ChIPseeker"</span>)</span><br><span class="line"><span class="comment"># 下载人的基因和lincRNA的TxDb对象</span></span><br><span class="line">biocLite(<span class="string">"org.Hs.eg.db"</span>)</span><br><span class="line">biocLite(<span class="string">"TxDb.Hsapiens.UCSC.hg19.knownGene"</span>)</span><br><span class="line">biocLite(<span class="string">"TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts"</span>)</span><br><span class="line">biocLite(<span class="string">"clusterProfiler"</span>)</span><br><span class="line"><span class="comment">#载入各种包</span></span><br><span class="line"><span class="keyword">library</span>(<span class="string">"ChIPseeker"</span>)</span><br><span class="line"><span class="keyword">library</span>(clusterProfiler)</span><br><span class="line"><span class="keyword">library</span>(<span class="string">"org.Hs.eg.db"</span>)</span><br><span class="line"><span class="keyword">library</span>(TxDb.Hsapiens.UCSC.hg19.knownGene)</span><br><span class="line">txdb &lt;- TxDb.Hsapiens.UCSC.hg19.knownGene</span><br><span class="line"><span class="keyword">library</span>(<span class="string">"TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts"</span>)</span><br><span class="line">lincRNA_txdb=TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts</span><br></pre></td></tr></table></figure></p><h3 id="第2步：读入peaks文件"><a href="#第2步：读入peaks文件" class="headerlink" title="第2步：读入peaks文件"></a>第2步：读入peaks文件</h3><p>函数<code>readPeakFile</code>读入peaks文件<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nanog &lt;- readPeakFile(<span class="string">"./idr_out.bed/nanog_idr-bed"</span>)</span><br><span class="line">pou5f1 &lt;- readPeakFile(<span class="string">"./idr_out.bed/pou5f1_idr-bed"</span>)</span><br></pre></td></tr></table></figure></p><h3 id="第3步：注释peaks"><a href="#第3步：注释peaks" class="headerlink" title="第3步：注释peaks"></a>第3步：注释peaks</h3><p>peaks的注释是用的<code>annotatePeak</code>函数，可以单独对每个peaks文件进行注释，也可以将多个peaks制作成一个list，进行比较分析和可视化。<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 制作多个样本比较的list</span></span><br><span class="line">peaks &lt;- list(Nanog=nanog,Pou5f1=pou5f1)</span><br><span class="line"><span class="comment"># promotor区间范围可以自己设定</span></span><br><span class="line">promoter &lt;- getPromoters(TxDb=txdb, upstream=<span class="number">3000</span>, downstream=<span class="number">3000</span>)</span><br><span class="line">tagMatrixList &lt;- lapply(peaks, getTagMatrix, windows=promoter)</span><br><span class="line"><span class="comment">#annotatePeak传入annoDb参数,可进行基因ID转换（Entrez，ENSEMBL，SYMBOL，GENENAME）</span></span><br><span class="line">peakAnnoList &lt;- lapply(peaks, annotatePeak, TxDb=txdb,tssRegion=c(-<span class="number">3000</span>, <span class="number">3000</span>), verbose=<span class="literal">FALSE</span>,addFlankGeneInfo=<span class="literal">TRUE</span>, flankDistance=<span class="number">5000</span>,annoDb=<span class="string">"org.Hs.eg.db"</span>)</span><br></pre></td></tr></table></figure></p><p><strong>annotatePeak传入annoDb参数,即可进行基因ID转换，将Entrez ID转化为ENSEMBL，SYMBOL，GENENAME</strong>，peakAnnoList的结果如下：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">seqnamesstartendwidthstrandannotationgeneChrgeneStartgeneEndgeneLengthgeneStrandgeneIdtranscriptIddistanceToTSSENSEMBLSYMBOLGENENAMEflank_txIdsflank_geneIdsflank_gene_distances</span><br><span class="line"><span class="number">5</span>chr3<span class="number">196625522</span><span class="number">196625873</span><span class="number">352</span>*Intron (uc003fwz.4/<span class="number">205564</span>, intron <span class="number">2</span> of <span class="number">9</span>)<span class="number">3</span><span class="number">196594727</span><span class="number">196661584</span><span class="number">66858</span><span class="number">1</span><span class="number">205564</span>uc011bty.2<span class="number">30795</span>ENSG00000119231SENP5SUMO specific peptidase <span class="number">5</span>uc003fwz.4;uc011bty.2<span class="number">205564</span>;<span class="number">205564</span><span class="number">0</span>;<span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="第4步：可视化"><a href="#第4步：可视化" class="headerlink" title="第4步：可视化"></a>第4步：可视化</h3><p>提供了多种可视化方法，如plotAnnoBar(),vennpie(),plotAnnoPie(),plotDistToTSS()等，下面展示了两个样本在基因组特征区域的分布以及转录因子在TSS区域的结合。<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plotAnnoBar(peakAnnoList)</span><br><span class="line">plotDistToTSS(peakAnnoList,title=<span class="string">"Distribution of transcription factor-binding loci \n relative to TSS"</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-0f981c1bb6b89f8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="第5步：功能富集分析"><a href="#第5步：功能富集分析" class="headerlink" title="第5步：功能富集分析"></a>第5步：功能富集分析</h3><p>提取peakAnnolist中的基因，结合clusterProfiler包对peaks内的邻近基因进行富集注释。<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a list with genes from each sample</span></span><br><span class="line">gene = lapply(peakAnnoList, <span class="keyword">function</span>(i) as.data.frame(i)$geneId)</span><br><span class="line"><span class="comment"># Run GO enrichment analysis </span></span><br><span class="line">ego &lt;- enrichGO(gene = entrez, </span><br><span class="line">                    keytype = <span class="string">"ENTREZID"</span>, </span><br><span class="line">                    OrgDb = org.Hs.eg.db, </span><br><span class="line">                    ont = <span class="string">"BP"</span>, </span><br><span class="line">                    pAdjustMethod = <span class="string">"BH"</span>, </span><br><span class="line">                    qvalueCutoff = <span class="number">0.05</span>, </span><br><span class="line">                    readable = <span class="literal">TRUE</span>)</span><br><span class="line"><span class="comment"># Dotplot visualization</span></span><br><span class="line">dotplot(ego, showCategory=<span class="number">50</span>)</span><br><span class="line"><span class="comment"># Multiple samples KEGG analysis</span></span><br><span class="line">compKEGG &lt;- compareCluster(geneCluster = gene, </span><br><span class="line">                         fun = <span class="string">"enrichKEGG"</span>,</span><br><span class="line">                         organism = <span class="string">"human"</span>,</span><br><span class="line">                         pvalueCutoff  = <span class="number">0.05</span>, </span><br><span class="line">                         pAdjustMethod = <span class="string">"BH"</span>)</span><br><span class="line">dotplot(compKEGG, showCategory = <span class="number">20</span>, title = <span class="string">"KEGG Pathway Enrichment Analysis"</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-ebcdf242c4bc96f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="第6步：保存文件"><a href="#第6步：保存文件" class="headerlink" title="第6步：保存文件"></a>第6步：保存文件</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Output peakAnnolist file</span></span><br><span class="line">save(peakAnnoList,file=<span class="string">"peakAnnolist.rda"</span>)</span><br><span class="line">write.table(as.data.frame(peakAnnoList$Nanog),file=<span class="string">"Nanog.PeakAnno"</span>,sep=<span class="string">'\t'</span>,quote = <span class="literal">F</span>)</span><br><span class="line"><span class="comment"># Output results from GO analysis to a table</span></span><br><span class="line">cluster_summary &lt;- data.frame(ego)</span><br><span class="line">write.csv(cluster_summary, <span class="string">"results/clusterProfiler_Nanog.csv"</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p>ChIPseeker详细内容请参考:</p><ul><li><a href="http://www.bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html" target="_blank" rel="noopener">ChIPseeker文档</a></li><li>Y叔的<a href="https://mp.weixin.qq.com/mp/homepage?__biz=MzI5NjUyNzkxMg==&amp;hid=11&amp;sn=c22229f28bd00c3efd2c89cdadd63315&amp;scene=18&amp;devicetype=android-23&amp;version=26070238&amp;lang=zh_CN&amp;nettype=3gnet&amp;ascene=7&amp;session_us=gh_ba0578f6322d" target="_blank" rel="noopener">ChIP-Seq系列</a>：<br><a href="https://mp.weixin.qq.com/s/vWTf59KDs1lp_sQXjEhI_g" target="_blank" rel="noopener">CS3: peak注释</a><br><a href="https://mp.weixin.qq.com/s/_OPzvaEAbiMolCA2mqJXLw" target="_blank" rel="noopener">CS4：关于ChIPseq注释的几个问题</a><br><a href="https://mp.weixin.qq.com/s/MqpfgkMJSFj0pYwcEjV9kQ" target="_blank" rel="noopener">CS6: ChIPseeker的可视化方法（中秋节的视觉饕餮）</a></li><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons" target="_blank" rel="noopener">哈佛深度NGS数据分析课程</a></li><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/07_ChIPseeker_functional_analysis.md" target="_blank" rel="noopener">07-ChIPseeker for ChIP peak Annotation, Comparison, and Visualization</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;上一步骤（&lt;a href=&quot;https://www.jianshu.com/p/d8a7056b4294&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;第6篇：重复样本的处理——IDR&lt;/a&gt;）用IDR对重复样本peaks的一致性进行了评估，同时得到了merge后的一致性的peaks——&lt;code&gt;sample-idr&lt;/code&gt;，接下来就是对peaks的注释。这篇主要介绍用Y叔的R包&lt;strong&gt;&lt;a href=&quot;http://www.bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;ChIPseeker&lt;/a&gt;对peaks的位置（如peaks位置落在启动子、UTR、内含子等）以及peaks临近基因的注释&lt;/strong&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;ChIPseeker&quot;&gt;&lt;a href=&quot;#ChIPseeker&quot; class=&quot;headerlink&quot; title=&quot;ChIPseeker&quot;&gt;&lt;/a&gt;ChIPseeker&lt;/h3&gt;&lt;p&gt;ChIPseeker虽然最初是为了ChIP-seq注释而写的一个R包，但它不只局限于ChIP-seq，也可用于ATAC-Seq等其他富集peaks注释，也可用于lincRNA注释、DNA breakpoints的断点位置注释等所有genomic coordination的注释，另外提供了丰富的可视化功能。&lt;br&gt;ChIPseeker的强大功能请参考Y叔的&lt;a href=&quot;(https://mp.weixin.qq.com/mp/homepage?__biz=MzI5NjUyNzkxMg==&amp;amp;hid=11&amp;amp;sn=c22229f28bd00c3efd2c89cdadd63315&amp;amp;scene=18&amp;amp;devicetype=android-23&amp;amp;version=26070238&amp;amp;lang=zh_CN&amp;amp;nettype=3gnet&amp;amp;ascene=7&amp;amp;session_us=gh_ba0578f6322d&quot;&gt;ChIP-Seq系列文章&lt;/a&gt;)，如：&lt;br&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/vWTf59KDs1lp_sQXjEhI_g&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CS3: peak注释&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/_OPzvaEAbiMolCA2mqJXLw&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CS4：关于ChIPseq注释的几个问题&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://mp.weixin.qq.com/s/MqpfgkMJSFj0pYwcEjV9kQ&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;CS6: ChIPseeker的可视化方法（中秋节的视觉饕餮）&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="ChIPseq" scheme="http://yoursite.com/tags/ChIPseq/"/>
    
  </entry>
  
  <entry>
    <title>第6篇：重复样本的处理——IDR</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E9%87%8D%E5%A4%8D%E6%A0%B7%E6%9C%AC%E7%9A%84%E5%A4%84%E7%90%86%E2%80%94%E2%80%94IDR/"/>
    <id>http://yoursite.com/2019/08/23/第6篇：重复样本的处理——IDR/</id>
    <published>2019-08-23T04:38:56.000Z</published>
    <updated>2019-08-24T13:54:24.091Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>ATAC-seq/ChIP-Seq中重复样本的处理</strong></p><p>ATAC-Seq要求必须有2次或更多次生物学重复（十分珍贵或者稀有样本除外，但必须做至少2次技术重复）。理论上重复样本的peaks应该有高度的一致性，实际情况并不完全与预期一致。如何评价重复样本的重复性的好坏？如何得到一致性的peaks?</p><h3 id="这一节将介绍两种方法："><a href="#这一节将介绍两种方法：" class="headerlink" title="这一节将介绍两种方法："></a>这一节将介绍两种方法：</h3><p><strong>1. 用Bedtools进行简单的overlap合并重复样本</strong><br><strong>2. 用IDR（Irreproducibility Discovery Rate）的方法获得高重复性的peaks</strong></p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/8242255-f2cf66adfcbcc2d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><hr><h3 id="1-Overlapping-peaks-using-bedtools"><a href="#1-Overlapping-peaks-using-bedtools" class="headerlink" title="1. Overlapping peaks using bedtools"></a>1. Overlapping peaks using bedtools</h3><p>如何得到两个重复样本间一致性的peaks? 一种简单粗暴的方法就是用<code>bedtools</code>计算peaks的overlaps。<br>用法：<code>bedtools intersect [OPTIONS] -a &lt;bed/gff/vcf/bam&gt; -b &lt;bed/gff/vcf/bam&gt;</code></p><ul><li><code>-a</code>: 参数后加重复样本1（A）</li><li><code>-b</code>：参数后加重复样本2（B），也可以加多个样本</li></ul><p>其他常用参数解释和图解如下：</p><ul><li><code>-wo</code>：Write the original A and B entries plus the number of base pairs of overlap between the two features.</li><li><code>-wa</code>：Write the original entry in A for each overlap.</li><li><code>-v</code>：Only report those entries in A that have <em>no overlaps</em> with B<br>如果只有<code>-a</code>和<code>-b</code>参数，返回的是相对于A的overlaps。加上参数<code>-wo</code>返回A和B原始的记录加上overlap的记录。参数<code>-wa</code>返回每个overlap中A的原始记录。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-539217c9b07ba9fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>使用代码示例：</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bedtools intersect \</span><br><span class="line">-a macs2/Nanog-rep1_peaks.narrowPeak \</span><br><span class="line">-b macs2/Nanog-rep2_peaks.narrowPeak \</span><br><span class="line">-wo &gt; bedtools/Nanog-overlaps.bed</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-Irreproducibility-Discovery-Rate-IDR"><a href="#2-Irreproducibility-Discovery-Rate-IDR" class="headerlink" title="2. Irreproducibility Discovery Rate (IDR)"></a>2. Irreproducibility Discovery Rate (IDR)</h3><p>评估重复样本间peaks一致性的另一种方法是IDR。IDR是通过比较一对经过排序的regions/peaks 的列表，然后计算反映其重复性的值。<br>IDR在<a href="https://www.encodeproject.org/atac-seq/" target="_blank" rel="noopener">ENCODE</a>和modENCODE项目中被广泛使用，也是<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3431496/" target="_blank" rel="noopener">ChIP-seq指南和标准</a>中的一部分。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-ed3c5559db41126f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ENCODE_ATAC_pipeline"><br><strong>IDR的 优点：</strong></p><ul><li>避免了初始阈值的选择，解决了不同callers的不可比较性</li><li>IDR不依赖于阈值的选择，所有regions/peaks都被考虑在内。</li><li>它是依赖regions/peaks的排序，不要求对输入信号进行校准或标准化<br>IDR的详细说明参考: </li><li><a href="https://github.com/nboley/idr" target="_blank" rel="noopener">https://github.com/nboley/idr</a></li><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/06_handling-replicates.md#irreproducibility-discovery-rate-idr" target="_blank" rel="noopener">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/06_handling-replicates.md#irreproducibility-discovery-rate-idr</a></li></ul><p><strong>使用IDR的注意事项：</strong></p><ul><li>建议使用IDR时，MACS2 call peaks的步骤参数设置不要过于严格，以便鉴定出更多的peaks。</li><li><p>使用IDR需要先对MACS2的结果文件narrowPeak根据<code>-log10(p-value)</code>进行排序。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Call peaks</span><br><span class="line">macs2 callpeak -t  sample.final.bam -n sample --shift -100 --extsize 200 --nomodel -B --SPMR -g hs --outdir Macs2_out 2&gt; sample.macs2.log</span><br><span class="line">#Sort peak by -log10(p-value)</span><br><span class="line">sort -k8,8nr NAME_OF_INPUT_peaks.narrowPeak &gt; macs/NAME_FOR_OUPUT_peaks.narrowPeak</span><br></pre></td></tr></table></figure></li><li><p><strong>使用IDR示例</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">idr --samples sample_Rep1_sorted_peaks.narrowPeak sample_Rep2_sorted_peaks.narrowPeak \</span><br><span class="line">--input-file-type narrowPeak \</span><br><span class="line">--rank p.value \</span><br><span class="line">--output-file sample-idr \</span><br><span class="line">--plot \</span><br><span class="line">--<span class="built_in">log</span>-output-file sample.idr.log</span><br></pre></td></tr></table></figure></li></ul><p><code>--samples</code>:narrowPeak的输入文件（重复样本）<br><code>--input-file-type</code>：输入文件格式包括narrowPeak,broadPeak,bed<br><code>--rank p.value</code>：以p-value排序<br><code>--output-file</code>: 输出文件路径<br><code>--plot</code>：输出IDR度量值的结果</p><p><strong>输出文件解读：</strong><br>详细内容可参考：<a href="https://github.com/nboley/idr#output-file-format" target="_blank" rel="noopener">https://github.com/nboley/idr#output-file-format</a></p><blockquote><p>输出文件包括：</p><ul><li>sample-idr</li><li>sample-idr.log</li><li>sample-idr.png</li></ul></blockquote><p><strong>（1）sample-idr</strong><br>sample-idr是common peaks的结果输出文件，格式与输入文件格式类似，只是多了几列信息。前10列是标准的narrowPeak格式文件，包含重复样本整合后的peaks信息。</p><ul><li><strong>第5列：包含缩放的 IDR 值</strong><ul><li>score int<br>如min(int(log2(-125IDR), 1000)，那么IDR=0，缩放的IDR就是1000；IDR=0.05,  int(-125log2(0.05)) = 540；IDR=1.0,  int(-125log2(1.0) = 0。</li></ul></li><li><strong>第11列和第12列：分别是local和global IDR值</strong><ul><li>col11: localIDR float -log10(Local IDR value)</li><li>col12: globalIDR float -log10(Global IDR value)<br>global IDR值是第5列中用于计算缩放的IDR值，类似于对p值进行多个假设校正以计算FDR；local IDR类似于属于不可重复噪声部分的峰值的后验概率。详细内容可阅读<a href="https://projecteuclid.org/euclid.aoas/1318514284" target="_blank" rel="noopener">Measuring reproducibility of high-throughput experiments</a>。</li></ul></li><li><strong>第13、14、15、16列</strong>：是重复样本1相关的信息。<ul><li>col13: rep1_chromStart int</li><li>col14: rep1_chromEnd int</li><li>col15: rep1_signalValue float</li><li>col16: rep1_summit int</li></ul></li><li><strong>第17-20列</strong>：是重复样本2相关的信息，和13-16四列信息类似。</li></ul><p><strong>其他列信息如下：</strong></p><ul><li>col1: chrom string</li><li>col2: chromStart int</li><li>col3: chromEnd int</li><li>col4: name string</li><li>col6: strand [+-.] Use ‘.’ if no strand is assigned.</li><li>col7: signalValue float</li><li>col8: p-value float </li><li>col9: q-value float</li><li>col10: summit int</li></ul><p><code>wc -l *-idr</code> 计算下common peaks的个数，接着可再计算下与总peaks的比率。<br>如果想看IDR&lt;0.05的，可以通过第5列信息过滤：<br><code>awk &#39;{if($5 &gt;= 540) print $0}&#39; sample-idr | wc -l</code><br><strong>（2）sample-idr.log</strong><br>log文件会给出peaks通过IDR &lt; 0.05的比率，如下图所示<br><img src="https://upload-images.jianshu.io/upload_images/8242255-ca6774163e8a6207.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>（3）sample-idr.png</strong><br>png文件包括4个图<br><img src="https://upload-images.jianshu.io/upload_images/8242255-f605c94aaaf401d2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>左上： Rep1 peak ranks vs Rep2 peak ranks, 没有通过特定IDR阈值的peaks显示为红色。<br>右上：Rep1 log10 peak scores vs Rep2 log10 peak scores，没有通过特定IDR阈值的peaks显示为红色。<br>下面两个图： Peak rank vs IDR scores，箱线图展示了IDR值的分布，默认情况下，IDR值的阈值为-1E-6。</p><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons" target="_blank" rel="noopener">哈佛深度NGS数据分析课程</a><br><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/06_handling-replicates.md" target="_blank" rel="noopener">06-Handling replicates in ChIP-Seq</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ATAC-seq/ChIP-Seq中重复样本的处理&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ATAC-Seq要求必须有2次或更多次生物学重复（十分珍贵或者稀有样本除外，但必须做至少2次技术重复）。理论上重复样本的peaks应该有高度的一致性，实际情况并不完全与预期一致。如何评价重复样本的重复性的好坏？如何得到一致性的peaks?&lt;/p&gt;
&lt;h3 id=&quot;这一节将介绍两种方法：&quot;&gt;&lt;a href=&quot;#这一节将介绍两种方法：&quot; class=&quot;headerlink&quot; title=&quot;这一节将介绍两种方法：&quot;&gt;&lt;/a&gt;这一节将介绍两种方法：&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;1. 用Bedtools进行简单的overlap合并重复样本&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;2. 用IDR（Irreproducibility Discovery Rate）的方法获得高重复性的peaks&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="ChIPseq" scheme="http://yoursite.com/tags/ChIPseq/"/>
    
  </entry>
  
  <entry>
    <title>第5篇：对ATAC-Seq/ChIP-seq的质量评估（二）——ChIPQC</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E5%AF%B9ATAC-SeqChIP-seq%E7%9A%84%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BC%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E2%80%94%E2%80%94ChIPQC/"/>
    <id>http://yoursite.com/2019/08/23/第5篇：对ATAC-SeqChIP-seq的质量评估（二）——ChIPQC/</id>
    <published>2019-08-23T03:36:56.000Z</published>
    <updated>2019-08-24T12:56:28.890Z</updated>
    
    <content type="html"><![CDATA[<h3 id="1-学习目标"><a href="#1-学习目标" class="headerlink" title="1. 学习目标"></a>1. 学习目标</h3><ul><li>讨论ChIP-seq数据质量评估的其他方法</li><li>用ChIPQC产生质量统计报告</li><li>鉴定低质量数据的来源</li></ul><a id="more"></a><ul><li><p><strong>概览图</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-df6c67811efb85eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><p>ENCODE评估数据质量采用多种指标，如前面已经讨论过的链相关的指标NSC和RSC。这一节将会讨论评估信号分布的其他指标。</p><blockquote><p><strong>NOTE</strong>：这里给出的评估指标只是反映数据质量的好坏，符合阈值的并不意味着实验是成功的，不符合阈值的也不一定意味着失败。</p></blockquote><h3 id="2-常见质量评估指标的介绍"><a href="#2-常见质量评估指标的介绍" class="headerlink" title="2.常见质量评估指标的介绍"></a>2.常见质量评估指标的介绍</h3><ul><li><h4 id="SSD"><a href="#SSD" class="headerlink" title="SSD"></a>SSD</h4>SSD值是对富集效果的评估。SSD值依赖于全基因组的pile-up信号强度，对真实的ChIP富集和干扰的强信号区域都很敏感。SSD值越大表明富集越好。<blockquote><p>“It provides a measure of pileup across the genome and is computed by looking at the standard deviation of signal pile-up along the genome normalised to the total number of reads. ”</p></blockquote></li><li><h4 id="FRiP-Fraction-of-reads-in-peaks"><a href="#FRiP-Fraction-of-reads-in-peaks" class="headerlink" title="FRiP:Fraction of reads in peaks"></a>FRiP:Fraction of reads in peaks</h4>FRiP表示的是peaks中的reads与总reads的比例。它是另一个反映样本富集效果或IP好坏的评价指标。可以理解为是“信噪比”即文库中结合位点片段占背景reads的比例。<strong>一个典型质量好的TF富集FRiP值约5%或者更高，polII的FRiP值约为30%或者更高，也有一些质量好的数据FRiP值&lt;1%（如RNAPIII）</strong></li><li><h4 id="Relative-Enrichment-of-Genomic-Intervals-REGI"><a href="#Relative-Enrichment-of-Genomic-Intervals-REGI" class="headerlink" title="Relative Enrichment of Genomic Intervals (REGI)"></a>Relative Enrichment of Genomic Intervals (REGI)</h4>REGI是对peaks在不同基因组特征位点分布的统计。</li><li><h4 id="RiBL-Reads-overlapping-in-Blacklisted-Regions"><a href="#RiBL-Reads-overlapping-in-Blacklisted-Regions" class="headerlink" title="RiBL: Reads overlapping in Blacklisted Regions"></a>RiBL: Reads overlapping in Blacklisted Regions</h4>过滤人工造成的高信号区域非常重要，如ENCIDE和modENCODE提供的DAC Blacklisted Regions track。这些区域经常在特定的重复序列处出现，如着丝粒、端粒、卫星重复序列等，通过简单的比对过滤是不能去除的。来自blacklisted regions的信号会造成call peak 和片段长度评估的混淆。<br>RiBL值可以表示背景信号或input的信号水平，与input sample的SSD值以及input和ChIP sample的读长覆盖值相关。这些区域通常是基因组的0.5%，或者更高的比例（10%）。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-ffa899faf5d8e033.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ul><h3 id="3-ChIPQC-quality-metrics-report"><a href="#3-ChIPQC-quality-metrics-report" class="headerlink" title="3. ChIPQC: quality metrics report"></a>3. ChIPQC: quality metrics report</h3><p>ChIPQC是一个Bioconductor包，输入文件包括BAM和peak文件，可以自动计算一些质量评估值，并产生质量报告。</p><h4 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h4><ul><li><strong>BAM files</strong><br>首先对比对过滤后的bam数据（chr12_aln.bam）建索引，然后将bam和index文件从<code>~/ngs_course/chipseq/results/bowtie2</code>移动到自己的目录文件夹<code>data/bams</code></li><li><strong>peak files</strong><br>将narrowPeak 文件从macs2目录下<code>~/ngs_course/chipseq/results/macs2</code> 移动到自己目录下<code>data/peakcalls</code></li><li><p><strong>sampleSheet file</strong><br>sampleSheet file是唯一需要自己根据实验设计和数据存储地址等信息创建的一个csv格式文件（bam,peak文件分别在比对和call peak的步骤产生）。sampleSheet具体需要包含的信息如下：<br><img src="https://upload-images.jianshu.io/upload_images/8242255-3910ab7fab88b880.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="sampleSheet header"></p></li><li><p>SampleID: 样本ID</p></li><li>Tissue, Factor, Condition: 不同的实验设计对照信息，三列信息必须包含在sampleSheet里，如果没有某一列的信息设为NA。</li><li>Replicate : 重复样本的编号</li><li>bamReads : 实验组BAM 文件的路径（data/bams）</li><li>ControlID : 对照组样本ID</li><li>bamControl :对照组样本的bam文件路径</li><li>Peaks :样本peaks文件的路径</li><li>PeakCaller ：peak类型的字符串，可以是raw,bed,narrow,macs等。<h4 id="下载安装ChIPQC"><a href="#下载安装ChIPQC" class="headerlink" title="下载安装ChIPQC"></a>下载安装ChIPQC</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span>(<span class="string">"http://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"ChIPQC"</span>)</span><br></pre></td></tr></table></figure></li></ul><h4 id="Running-ChIPQC"><a href="#Running-ChIPQC" class="headerlink" title="Running ChIPQC"></a>Running ChIPQC</h4><p>ChIPQC只需要三步就可以完成质量评估和报告生成。</p><ul><li><p><strong>首先载入包和sampleSheet信息</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Load libraries</span></span><br><span class="line"><span class="keyword">library</span>(ChIPQC)</span><br><span class="line"><span class="comment">## Load sample data</span></span><br><span class="line">samples &lt;- read.csv(<span class="string">'meta/samplesheet_chr12.csv'</span>)</span><br><span class="line">View(samples)</span><br></pre></td></tr></table></figure></li><li><p><strong>创建ChIPQC对象</strong><br>利用sampleSheet的信息读取每个样本的bam和narrowpeak文件，并计算质量评估值，结果存在一个对象里。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Create ChIPQC object</span></span><br><span class="line">chipObj &lt;- ChIPQC(samples, annotation=<span class="string">"hg19"</span>)</span><br></pre></td></tr></table></figure></li><li><p><strong>生成ChIPQC报告</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Create ChIPQC report</span></span><br><span class="line">ChIPQCreport(chipObj, reportName=<span class="string">"ChIP QC report: Nanog and Pou5f1"</span>, reportFolder=<span class="string">"ChIPQCreport"</span>)</span><br></pre></td></tr></table></figure></li></ul><h4 id="ChIPQC报告解读"><a href="#ChIPQC报告解读" class="headerlink" title="ChIPQC报告解读"></a>ChIPQC报告解读</h4><p>ChIPQC生成的结果包含一个网页报告和报告中含有的所有图片。<br>网页报告有三部分：<strong>QC Summary ；QC Results；QC files and versions</strong><br><img src="https://upload-images.jianshu.io/upload_images/8242255-a929302bfd47dc9d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h5 id="（1）QC-Summary-Overview-of-results"><a href="#（1）QC-Summary-Overview-of-results" class="headerlink" title="（1）QC Summary - Overview of results"></a>（1）QC Summary - Overview of results</h5><p><img src="https://upload-images.jianshu.io/upload_images/8242255-01749f12cf83c9af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Table 1"><br>QC summary包含sampleSheet里填写的样本的基本信息Tissue,Factor,Condition,Replicate。另外还有上面提到的质量评估的常用指标SSD、RiP%和RiBL值。越高的SSD值表明富集效果越好，Pou5f1样本（2.6,3）有较高的SSD值，RiBL值不是很高，FRiP的比例在5%附近或者更高，除了Pou5f1-rep2。</p><ul><li><strong>SSD</strong> - SSD score (htSeqTools)</li><li><strong>RIP%</strong> - Percentage of reads wthin peaks</li><li><strong>RIBL%</strong> - Percentage of reads wthin Blacklist regions<br>同时表格中还给出了其他统计信息：</li><li><strong>Reads</strong> - Number of sample reads within analysed chromosomes.</li><li><strong>Dup%</strong> - Percentage of MapQ filter passing reads marked as duplicates</li><li><strong>FragLen</strong> - Estimated fragment length by cross-coverage method</li><li><strong>FragLenCC</strong> - Cross-Coverage score at the fragment length</li><li><strong>RelativeCC</strong> - Cross-coverage score at the fragment length over Cross-coverage at the read length</li></ul><h5 id="（2）QC-Results-Full-QC-results-and-figures"><a href="#（2）QC-Results-Full-QC-results-and-figures" class="headerlink" title="（2）QC Results - Full QC results and figures"></a>（2）QC Results - Full QC results and figures</h5><ul><li><strong>Mapping, Filtering and Duplication rate</strong><br>第一部分是比对、过滤和重复率质检结果，包括Table2 、Figure1和Figure2。<br><strong>Table 2</strong>主要给出了比对质量和重复率，因为BAM文件是过滤后的，所以这里Dup%都是0.<br><img src="https://upload-images.jianshu.io/upload_images/8242255-ae05107ee85bb02a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Table 2"><blockquote><ul><li><strong>Total Dup%</strong>-Percentage of all mapped reads which are marked as duplicates.</li><li><strong>Pass MapQ Filter%</strong>-Percentage of all mapped reads whichpass MapQ quality filter</li><li><strong>Pass MapQ Filter and Dup%</strong>-Percentage of all reads which pass MapQ filter and are marked asduplicates.</li></ul></blockquote></li></ul><p><strong>Figure 1</strong>展现了reads在blacklists中的比例，</p><p><strong>Figure 2</strong>是用基因组注释呈现了reads在基因组特征位置如启动子的分布。这幅图里显示在启动子区域富集最明显。</p><ul><li><p><strong>ChIP signal Distribution and Structure</strong><br>第二部分是ChIP信号分布和结构组成，包括Figure3和4。<br><strong>Figure 3</strong>是一个coverage plot， x轴代表在某bp位置read pileup的高度，y轴代表有多少位置有相同的pileup 高度(取log)。**有好的富集的ChIP样本会有一个tail，即更多的位置（y值大）有较高的测序深度。在我们的数据集中Nanog样本与Pou5f1 相比有较高的tails,尤其是重复样本2。但是Pou5f1有较高的SSD值。当SSD高但是coverage看起来低时，可能是存在大片段深度高的区域出现在blacklist 基因组区域。</p></li><li><p><strong>Peak Profile and ChIP Enrichment</strong><br>第3部分是peak的谱图和ChIP的富集，每个peak都集中在summit位置（summit 理解为peak的最高峰值点处）<img src="https://upload-images.jianshu.io/upload_images/8242255-d50435914800593a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li><li><p>peak的性状取决于研究对象的类型，如转录因子、组蛋白标记、或其他DNA结合蛋白如聚合酶等，相同类型的对象通常有独特特征的谱图。<br><strong>Figure6和7</strong>都是对比对到peak中的reads统计。富集效果好的ChIP样本的reads与peaks会有高比例的重合。尽管Nanog有较高的RiP,但是两个重复样本间的差异大于Pou5f1。</p></li><li><p>Figure8和9**表示样本的聚类效果，分别是相关性聚类热图和PCA。</p></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/8242255-ee0ccb984d0ea9dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-4f61fd17225198b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="4-实验偏差：ChIP-seq数据质量低的来源"><a href="#4-实验偏差：ChIP-seq数据质量低的来源" class="headerlink" title="4. 实验偏差：ChIP-seq数据质量低的来源"></a>4. 实验偏差：ChIP-seq数据质量低的来源</h3><ul><li>免疫沉淀的特异性和有效性<br>影响因素如抗体的特异性，结和沉淀的强度</li><li>片段化<br>超声裂解产生不同大小的片段可能引入偏差</li><li>文库构建时的偏差<br>如PCR扩增<h4 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h4><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons" target="_blank" rel="noopener">哈佛深度NGS数据分析课程</a><br><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/05_QC_quality_metrics.md" target="_blank" rel="noopener">05-ChIP-Seq Quality Assessment</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;1-学习目标&quot;&gt;&lt;a href=&quot;#1-学习目标&quot; class=&quot;headerlink&quot; title=&quot;1. 学习目标&quot;&gt;&lt;/a&gt;1. 学习目标&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;讨论ChIP-seq数据质量评估的其他方法&lt;/li&gt;
&lt;li&gt;用ChIPQC产生质量统计报告&lt;/li&gt;
&lt;li&gt;鉴定低质量数据的来源&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="ChIPseq" scheme="http://yoursite.com/tags/ChIPseq/"/>
    
      <category term="QC" scheme="http://yoursite.com/tags/QC/"/>
    
  </entry>
  
  <entry>
    <title>第4篇：对ATAC-Seq/ChIP-seq的质量评估（一）——phantompeakqualtools</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E5%AF%B9ATAC-SeqChIP-seq%E7%9A%84%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BC%B0%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94phantompeakqualtools/"/>
    <id>http://yoursite.com/2019/08/23/第4篇：对ATAC-SeqChIP-seq的质量评估（一）——phantompeakqualtools/</id>
    <published>2019-08-23T03:25:08.000Z</published>
    <updated>2019-08-24T12:59:41.999Z</updated>
    
    <content type="html"><![CDATA[<h3 id="学习目标："><a href="#学习目标：" class="headerlink" title="学习目标："></a>学习目标：</h3><ul><li>探讨ChIP-seq数据质量低的来源</li><li>理解链交叉相关性（ strand cross-correlation）</li><li>使用<code>phantompeakqualtools</code>计算交叉相关性和其他相关的质控度量值</li><li>评估交叉相关图</li></ul><a id="more"></a><h3 id="ChIP-Seq质量评估"><a href="#ChIP-Seq质量评估" class="headerlink" title="ChIP-Seq质量评估"></a>ChIP-Seq质量评估</h3><p>在下游分析前，最好是先对peak calling 后的ChIP-Seq数据进行质量评估。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-025dd4ff30ae61b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="链交叉相关（Strand-cross-correlation）"><a href="#链交叉相关（Strand-cross-correlation）" class="headerlink" title="链交叉相关（Strand cross-correlation）"></a>链交叉相关（Strand cross-correlation）</h3><p>链交叉相关是一个有效的评估ChIP-Seq质量的方法，它不依赖于peak calling，而是基于ChIP-Seq实验。如果ChIP-Seq实验成功，DNA富集序列标签（蛋白质相互作用的序列）会在reads的双峰富集中产生显著的聚集。<br><strong>产生reads的双峰富集的原因如下：</strong><br>在ChIP-Seq实验中，DNA被片段化，蛋白质结合的片段会被免疫沉淀，所以产生了有蛋白质结合的DNA片段（fragments ）。<br>DNA的正链从5’端开始被测序（如下图红色reads），DNA负链也从5’末端被测序产生如下图所示的蓝色reads。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-9095a287381f5ec6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Nat Biotechnol. 2008 Dec; 26(12): 1351–1359"><br>由于从DNA片段的5′末端测序，使+链reads的富集（下图中的蓝色部分）与负链reads的富集（下图红色部分）有少量的相互抵消区域。我们<strong>需要确定峰位移多少碱基数目可以在两个峰间产生最大的相关性。</strong>我们可以用<strong>交叉相关的度量值（cross-correlation metric）</strong>计算产生最大相关的位移。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-120795238a4bbaba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><p><strong>交叉相关性度量值</strong><br>交叉相关度量是在Watson移动k个碱基后，计算Crick链与Watson链之间的Pearson线性相关。如下面的示意图：<br>首先在链位移为0时，两个向量之间的Pearson相关值为0.539。</p><p>在链位移5bp，两个向量之间的Pearson相关值为0.931。</p><p>继续移动这些向量，对于每个链位移计算一个相关值。</p><p>最后，我们将有一个每个碱基对移位与皮尔森相关值的对应表。这是针对每个染色体的每一个峰计算的，然后该值乘以一个缩放因子，再对所有染色体的值相加，就可以绘交叉相关值（y轴）相对于移位值（x轴）生成的交叉相关图。<br><strong>典型的交叉相关图会产生两个峰</strong>：一个富集峰与主要的<strong>片段长度（predominant fragment length）</strong>相关（高相关性），另一个与<strong>read 长度（read length）</strong>相关，这个峰也被称为虚幻峰（“phantom” peak）。</p><ul><li><p>质量好的ChIP-Seq数据集倾向产生一个大的<strong>片段长度峰（fragment-length peak）</strong>，下图展示了一个来自于人细胞CTCF（zinc-finger transcription factor）的强信号。如果有好的抗体，转录因子通常产生45,000~60,000个peaks。下图红色的垂直线表示主峰的真实位移，蓝色的垂直线处有一个小的起伏表示read lenngth。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-f291e6c7288d5df6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><ul><li><p>下图是<strong>weaker signal</strong>的一个示例。这里<strong>Pol2</strong>的抗体不是很有效，有分散的峰。交叉相关图中有两个峰，一个是真实的峰位移（185-200bp），另外一个在read length。信号弱的数据集中read length的峰会成为主峰。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-2846dc6bb5085bf8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><ul><li><p>一个失败的实验产生的交叉相关图类似于<strong>input</strong>，在<strong>fragment length</strong>处很少或没有峰，在<strong>read length</strong>处有信号非常强的。这种现象的原因可能是在结合位点附近<strong>fragments</strong>没有显著聚集。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-8781f9f9bd780b15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><h3 id="交叉相关性质量评估度量值"><a href="#交叉相关性质量评估度量值" class="headerlink" title="交叉相关性质量评估度量值"></a>交叉相关性质量评估度量值</h3><p>交叉相关谱图可以计算评估ChIP_Seq实验信噪比的度量值，并且实验设计确保<strong>fragment length</strong>准确。低信噪比和不准确的fragment length 表明ChIP-Seq实验可能有问题。<br><strong>Normalized strand cross-correlation coefficent (NSC)：</strong><br>NSC是最大交叉相关值除以背景交叉相关的比率(所有可能的链转移的最小交叉相关值)。<strong>NSC值越大表明富集效果越好，NSC值低于1.1<br>表明较弱的富集，小于1表示无富集。</strong>NSC值稍微低于1.05，有较低的信噪比或很少的峰，这肯能是生物学真实现象，比如有的因子在特定组织类型中只有很少的结合位点；也可能确实是数据质量差。<br><strong>Relative strand cross-correlation coefficient (RSC):</strong><br>RSC是片段长度相关值减去背景相关值除以phantom-peak相关值减去背景相关值。<strong>RSC的最小值可能是0，表示无信号；富集好的实验RSC值大于1；低于1表示质量低。</strong></p><h3 id="phantompeakqualtools"><a href="#phantompeakqualtools" class="headerlink" title="phantompeakqualtools"></a>phantompeakqualtools</h3><p>phantompeakqualtools 是一个用于计算ChIP-Seq数据富集和质量度量值的一个工具包。我们将使用该包来计算基于链交叉相关峰的主要插入大小(fragment length)和基于相对phantom peak的数据质量度量值。<code>phantompeakqualtools</code>是一个R包，依赖<code>samtools</code>。<br><strong>下载<code>phantompeakqualtools</code></strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/phantompeakqualtools/ccQualityControl.v.1.1.tar.gz</span><br><span class="line">tar -xzf ccQualityControl.v.1.1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> phantompeakqualtools</span><br><span class="line"><span class="comment"># 查看README</span></span><br><span class="line">less README.txt</span><br></pre></td></tr></table></figure></p><p><strong>Linux下安装</strong><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">R </span><br><span class="line">install.packages(<span class="string">"caTools"</span>, lib=<span class="string">"~/R/library"</span>)</span><br></pre></td></tr></table></figure></p><p><strong>运行phantompeakqualtools</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p logs qual</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> bam <span class="keyword">in</span> bam_dir/sample1.final.bam bam_dir/sample2.final.bam</span><br><span class="line">do </span><br><span class="line">bam2=`basename $bam .final.bam`</span><br><span class="line">Rscript run_spp_nodups.R -c=$bam -savp -out=qual/$&#123;bam2&#125;.qual &gt; logs/$&#123;bam2&#125;.Rout</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p><strong>参数含义：</strong></p><ul><li><code>-c</code>: 比对过滤后的bam文件的全路径和名字</li><li><code>-savp</code>:保存交叉相关图</li><li><code>-out</code>：会产生数据集重要特征值的输出文件</li></ul><p><strong>输出文件解读</strong><br>输出文件会产生一个tab分割的名为qual的文件,包含的信息如下：</p><ul><li><p>COL1：Filename：比对过滤的bam文件名</p></li><li><p>COL2：numReads ：有效的测序深度</p></li><li><p>COL3：estFragLen：逗号分隔的交叉相关峰以相关性递减顺序排列的值</p></li><li><p>COL4: corr_estFragLen: 逗号分隔的以递减顺序排列交叉相关值</p></li><li><p>COL5: phantomPeak: Read length/phantom peak链位移</p></li><li><p>COL6: corr_phantomPeak: phantom peak相关值</p></li><li><p>COL7: argmin_corr:交叉相关最小的链位移</p></li><li><p>COL8: min_corr:交叉相关最小值</p></li><li><p>COL9: Normalized strand cross-correlation coefficient (NSC) = COL4 / COL8</p></li><li><p>COL10: Relative strand cross-correlation coefficient (RSC) = (COL4 - COL8) / (COL6 - COL8)</p></li><li><p>COL11: QualityTag: Quality tag based on thresholded RSC (codes: -2:veryLow,-1:Low,0:Medium,1:High,2:veryHigh)<br><strong>我们最关注的值是第9列和第11列。</strong><br><strong>Cross-correlation plots</strong><br>课程中的示例数据Nanog_rep1的交叉相关图</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-4e872e4a5d5fcdbb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons" target="_blank" rel="noopener">哈佛深度NGS数据分析课程</a><br><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/04_QC_cross_correlation.md" target="_blank" rel="noopener">04_ChIP-Seq Quality Assessment: Cross-correlation</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;学习目标：&quot;&gt;&lt;a href=&quot;#学习目标：&quot; class=&quot;headerlink&quot; title=&quot;学习目标：&quot;&gt;&lt;/a&gt;学习目标：&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;探讨ChIP-seq数据质量低的来源&lt;/li&gt;
&lt;li&gt;理解链交叉相关性（ strand cross-correlation）&lt;/li&gt;
&lt;li&gt;使用&lt;code&gt;phantompeakqualtools&lt;/code&gt;计算交叉相关性和其他相关的质控度量值&lt;/li&gt;
&lt;li&gt;评估交叉相关图&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="ChIPseq" scheme="http://yoursite.com/tags/ChIPseq/"/>
    
      <category term="QC" scheme="http://yoursite.com/tags/QC/"/>
    
  </entry>
  
  <entry>
    <title>第3篇：用MACS2软件call peaks</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E7%94%A8MACS2%E8%BD%AF%E4%BB%B6call%20peaks/"/>
    <id>http://yoursite.com/2019/08/23/第3篇：用MACS2软件call peaks/</id>
    <published>2019-08-23T02:21:08.000Z</published>
    <updated>2019-08-24T13:00:48.221Z</updated>
    
    <content type="html"><![CDATA[<h3 id="学习目标："><a href="#学习目标：" class="headerlink" title="学习目标："></a>学习目标：</h3><ul><li>学会用MACS2 call peaks</li><li>理解MACS2 call peaks的结果</li></ul><a id="more"></a><h3 id="Peak-Calling"><a href="#Peak-Calling" class="headerlink" title="Peak Calling"></a>Peak Calling</h3><p>Peak calling即利用计算的方法找出ChIP-seq或ATAC-seq中reads富集的基因组区域。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-1d1cb57462bd1803.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><p>如下图所示，比对结果的文件中reads在正负链不均匀分布，但在结合位点聚集。正负链5‘末端的reads各形成一组合，通过统计学的方法评估这些组合的分布并和对照组比较，确定这些结合位点是否是显著的。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-72a8be3b74bb6659.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><blockquote><p><strong>NOTE：</strong>ChIP-seq的分析方法可以鉴定两种类型的富集模式：<strong>broad domains</strong>和<strong>narrow peaks</strong>。broad domains，如组蛋白修饰在整个基因body区域的分布；narrow peak，如转录因子的结合。narrow peak相对于broad 或者分散的marks更易被检测到。也有一些混合的结合图谱，如PolII包括narrow和broad信号。</p></blockquote><hr><h3 id="MACS2"><a href="#MACS2" class="headerlink" title="MACS2"></a>MACS2</h3><p>peaks calling 有不同的方法，MACS2是最常用的call peaks工具。 <a href="https://github.com/taoliu/MACS" target="_blank" rel="noopener">MACS全称Model-based Analysis of ChIP-Seq</a>，最初的设计是用来鉴定转录因子的结合位点，但是它也可以用于其他类型的富集方式测序。<br>MACS通过整合序列标签位置信息和方向信息提高结合位点的空间分辨率。MACS的工作流如下所示：</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-b83dbfa6a5f77413.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><hr><h3 id="MACS2的使用方法"><a href="#MACS2的使用方法" class="headerlink" title="MACS2的使用方法"></a>MACS2的使用方法</h3><p>MACS2的用法，call peaks的参数及输出文件的解读可以参考<a href="https://www.jianshu.com/writer#/notebooks/22796191/notes/31999734/preview" target="_blank" rel="noopener">MACS2文档学习</a>。</p><h4 id="了解相关参数："><a href="#了解相关参数：" class="headerlink" title="了解相关参数："></a>了解相关参数：</h4><p><strong>输入文件参数：</strong></p><ul><li><code>-t</code>:实验组，IP的数据文件</li><li><code>c</code>: 对照组</li><li><code>f</code>：指定输入文件的格式，默认是自动检测输入数据是什么格式，支持bam,sam,bed等</li><li><code>g</code>:有效基因组大小，由于基因组序列的重复性，基因组实际可以mapping的大小小于原始的基因组。这个参数要根据实际物种计算基因组的有效大小。软件里也给出了几个默认的-g 值：hs – 2.7e9表示人类的基因组有效大小(UCSC human hg18 assembly).<ul><li>hs: 2.7e9</li><li>mm: 1.87e9</li><li>ce: 9e7</li><li>dm: 1.2e8</li></ul></li></ul><p><strong>输出文件参数：</strong></p><ul><li><code>--outdir</code>:输出结果的存储路径</li><li><code>-n</code>:输出文件名的前缀</li><li><code>-B/--bdg</code>:输出bedgraph格式的文件，输出文件以NAME+’_treat_pileup.bdg’ for treatment data, NAME+’_control_lambda.bdg’ for local lambda values from control显示。</li></ul><p><strong>peak calling 参数</strong></p><ul><li><code>-q/--qvalue</code> 和 <code>-p/--pvalue</code><br>q value默认值是0.05，与pvalue不能同时使用。</li><li><code>--broad</code><br>peak有narrow peak和broad peak, 设置时可以call broad peak 的结果文件。</li><li><code>--broad-cutoff</code><br>和pvalue、以及qvalue相似</li><li><code>--nolambda</code>: 不要考虑在峰值候选区域的局部偏差/λ<blockquote><p>q值与峰宽有一定的联系。理想情况下，如果放宽阈值，您将简单地获得更多的peaks，但是使用MACS2放松阈值也会导致更宽的peaks。</p></blockquote></li></ul><p><strong>Shift 模型参数：</strong></p><ul><li><code>--nomodel</code><br>这个参数和extsize、shift是配套使用的，有这个参数才可以设置extsize和shift。</li><li><code>--extsize</code><br>当设置了nomodel时，MACS会用<code>--extsize</code>这个参数从5’-&gt;3’方向扩展reads修复fragments。比如说你的转录因子结合范围200bp，就设置这个参数是200。</li><li><code>--shift</code><br>当设置了–nomodel，MACS用这个参数从5’ 端移动剪切，然后用–extsize延伸，如果–shift是负值表示从3’端方向移动。建议ChIP-seq数据集这个值保持默认值为0，对于检测富集剪切位点如DNAsel数据集设置为EXTSIZE的一半。<br><strong>示例：</strong></li></ul><ol><li>想找富集剪切位点，如DNAse-seq，所有5’端的序列reads应该从两个方向延伸，如果想设置移动的窗口是200bp，参数设置如下：<br><code>--nomodel --shift -100 --extsize 200</code></li><li>对nucleosome-seq数据，用核小体大小的一半进行extsize,所以参数设置如下：<br><code>--nomodel --shift 37 --extsize 73</code></li></ol><ul><li><code>--call-summits</code><br>MACS利用此参数重新分析信号谱，解析每个peak中包含的subpeak。对相似的结合图谱，推荐使用此参数，当使用此参数时，输出的subpeak会有相同的peak边界，不同的绩点和peak summit poisitions.</li></ul><hr><h4 id="ATAC-Seq-call-peaks示例"><a href="#ATAC-Seq-call-peaks示例" class="headerlink" title="ATAC-Seq call peaks示例"></a>ATAC-Seq call peaks示例</h4><p><strong>ATAC-seq关心的是在哪切断，断点才是peak的中心，所以使用shift模型，–shift -75或-100</strong><br>对人细胞系ATAC-seq 数据call peak的参数设置如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">macs2 callpeak -t H1hesc.final.bam -n sample --<span class="built_in">shift</span> -100 --extsize 200 --nomodel -B --SPMR -g hs --outdir Macs2_out 2&gt; sample.macs2.log</span><br></pre></td></tr></table></figure></p><h3 id="MACS2输出文件解读"><a href="#MACS2输出文件解读" class="headerlink" title="MACS2输出文件解读"></a>MACS2输出文件解读</h3><ul><li><strong>NAME_peaks.xls</strong><br>包含peak信息的tab分割的文件，前几行会显示callpeak时的命令。输出信息包含：<ul><li>染色体号</li><li>peak起始位点</li><li>peak结束位点</li><li>peak区域长度</li><li>peak的峰值位点（summit position）</li><li>peak 峰值的高度（pileup height at peak summit, -log10(pvalue) for the peak summit）</li><li>peak的富集倍数（相对于random Poisson distribution with local lambda）<br><img src="https://upload-images.jianshu.io/upload_images/8242255-6f70944596087547.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>Coordinates in XLS is 1-based which is different with BED format</strong><br>XLS里的坐标和bed格式的坐标还不一样，起始坐标需要减1才与narrowPeak的起始坐标一样。</li></ul></li><li><strong>NAME_peaks.narrowPeak</strong><br>*narrowPeak文件是BED6+4格式，可以上传到UCSC浏览。输出文件每列信息分别包含：<ul><li>1；染色体号</li><li>2：peak起始位点</li><li>3：结束位点</li><li>4：peak name</li><li>5：int(-10*log10qvalue)</li><li>6 ：正负链</li><li>7：fold change</li><li>8：-log10pvalue</li><li>9：-log10qvalue</li><li>10：relative summit position to peak start（？）<br><img src="https://upload-images.jianshu.io/upload_images/8242255-836a2990e5c80537.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ul></li><li><strong>NAME_summits.bed</strong><br>BED格式的文件，包含peak的summits位置，第5列是-log10pvalue。<strong>如果想找motif，推荐使用此文件。</strong><blockquote><p>Remove the beginning track line if you want to analyze it by other tools.???</p><ul><li><strong>.bdg</strong><br>bedGraph格式，可以导入UCSC或者转换为bigwig格式。两种bfg文件：treat_pileup, and control_lambda.</li></ul></blockquote></li><li><strong>NAME_peaks.broadPeak</strong><br>BED6+3格式与narrowPeak类似，只是没有第10列。</li></ul><hr><h3 id="summits-bed，narrowPeak，bdg-xls四种类型输出文件的比较："><a href="#summits-bed，narrowPeak，bdg-xls四种类型输出文件的比较：" class="headerlink" title="summits.bed，narrowPeak，bdg, xls四种类型输出文件的比较："></a>summits.bed，narrowPeak，bdg, xls四种类型输出文件的比较：</h3><p><img src="https://upload-images.jianshu.io/upload_images/8242255-539bc6f3090fc55f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><ul><li>xls文件<br>文件包含信息还是比较多的，和narrowPeak唯一不同的是peak的起始位置需要减1才是bed格式的文件，另外还包含fold_enrichment 和narrowPeak的fold change 对应，-log10pvalue,-log10qvalue,peak长度，peak 峰值位置等。</li><li>narrowPeak文件<br>和xls文件信息类似</li><li>summits.bed文件<br>包含峰的位置信息和-log10pvalue</li><li>bdg文件<br>bdg文件适合导入UCSC或IGV进行谱图可视化，或者转换为bigwig格式再进行可视化。<br><strong>为什么染色体号后面会出现其他的字符串？？？？</strong></li></ul><hr><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/03_peak_calling_macs.md" target="_blank" rel="noopener">HBC的深度NGS数据分析课程</a><br><a href="https://github.com/taoliu/MACS/" target="_blank" rel="noopener">MCAS2文档</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;学习目标：&quot;&gt;&lt;a href=&quot;#学习目标：&quot; class=&quot;headerlink&quot; title=&quot;学习目标：&quot;&gt;&lt;/a&gt;学习目标：&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;学会用MACS2 call peaks&lt;/li&gt;
&lt;li&gt;理解MACS2 call peaks的结果&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="ChIPseq" scheme="http://yoursite.com/tags/ChIPseq/"/>
    
  </entry>
  
  <entry>
    <title>第2篇：原始数据的质控、比对和过滤</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E8%B4%A8%E6%8E%A7%E3%80%81%E6%AF%94%E5%AF%B9%E5%92%8C%E8%BF%87%E6%BB%A4/"/>
    <id>http://yoursite.com/2019/08/23/第2篇：原始数据的质控、比对和过滤/</id>
    <published>2019-08-23T01:17:08.000Z</published>
    <updated>2019-08-24T13:01:36.900Z</updated>
    
    <content type="html"><![CDATA[<p>这部分内容包括对原始测序数据质控，然后比对过滤，这是所有NGS数据处理的上游分析。</p><ul><li><strong>ATAC-Seq与其他方法不同的一点是需要过滤去除线粒体（如果是植物，还需要过滤叶绿体），因为线粒体DNA是裸露的，也可以被Tn5酶识别切割。</strong></li><li><strong>另外一点需要注意的是课程中给出的是单端比对的示例代码，如果是双端测序做相应更改即可。</strong></li></ul><h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><ul><li>用FastQC进行质控检测</li><li>用Trimmomatic进行质量过滤</li><li>用Bowtie2比对，并理解相关参数含义</li></ul><a id="more"></a><h3 id="测序reads-的质控流程示意图"><a href="#测序reads-的质控流程示意图" class="headerlink" title="测序reads 的质控流程示意图"></a>测序reads 的质控流程示意图</h3><p><img src="https://upload-images.jianshu.io/upload_images/8242255-36f81589bdad9c92.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="FASTQC"><a href="#FASTQC" class="headerlink" title="FASTQC"></a>FASTQC</h3><p>首先对拿到的原始测序数据（fastq或fastq.gz格式）进行质控检测，直接用<code>fastqc</code>软件，再加上<code>multiqc</code>将多个检测结果一起展示。<br>如:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fastqc -o out_dir raw_data/*gz</span><br><span class="line">multiqc *fastqc.zip --ignore *.html</span><br></pre></td></tr></table></figure></p><h3 id="Trimmomatic"><a href="#Trimmomatic" class="headerlink" title="Trimmomatic"></a>Trimmomatic</h3><p>Trimmomatic 可以用于去除接头，过滤低质量数据。相同功能的软件还有很多，如<code>trim_galore</code>、<code>cutadapt</code>等，个人比较喜欢trim_galore可以自动识别接头类型。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 课程中给出的Trimmomatic 的用法（单端测序）</span></span><br><span class="line">$ java -jar /opt/Trimmomatic-0.33/trimmomatic-0.33.jar SE \</span><br><span class="line">-threads 2 \</span><br><span class="line">-phred33 \</span><br><span class="line">H1hesc_Input_Rep1_chr12.fastq \</span><br><span class="line">../results/trimmed/H1hesc_Input_Rep1_chr12.qualtrim20.minlen36.fq \</span><br><span class="line">LEADING:20 \</span><br><span class="line">TRAILING:20 \</span><br><span class="line">MINLEN:36</span><br></pre></td></tr></table></figure></p><p><strong>Trimmomatic参数含义：</strong>可以参考<a href="https://www.jianshu.com/p/a8935adebaae" target="_blank" rel="noopener">NGS 数据过滤之 Trimmomatic 详细说明</a><br><strong>trim_galore使用示例</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">trim_galore -q 20 --phred33 --stringency 3 --length 20 -e 0.1 --paired fq1 fq2  --gzip -o input_data_dir</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重新用fastqc检测进行过滤后的reads质量</span></span><br><span class="line">fastqc -o out_dir *fq.gz</span><br><span class="line">multiqc *fastqc.zip --ignore *.html</span><br></pre></td></tr></table></figure><h3 id="比对"><a href="#比对" class="headerlink" title="比对"></a>比对</h3><p>Bowtie2是一个快速精确的比对工具，基于Burrows-Wheeler Transform 构建基因组的FM 索引，比对过程所耗内存少。Bowtie2支持局部、双端、缺口比对模式，对大于50bp的reads比对效果更好（小于50bp的reads用Bowtie1）。</p><h4 id="创建Bowtie2索引"><a href="#创建Bowtie2索引" class="headerlink" title="创建Bowtie2索引"></a>创建Bowtie2索引</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bowtie2-build &lt;path_to_reference_genome.fa&gt; &lt;prefix_to_name_indexes&gt;</span><br><span class="line"><span class="comment"># Can find indexes for the entire genome on Orchestra using following path: /groups/shared_databases/igenome/Homo_sapiens/UCSC/hg19/Sequence/Bowtie2Index/</span></span><br></pre></td></tr></table></figure><h4 id="Bowtie2-比对"><a href="#Bowtie2-比对" class="headerlink" title="Bowtie2 比对"></a>Bowtie2 比对</h4><ul><li>p: 线程数</li><li>q: reads是fastq格式</li><li>x: index路径</li><li>U: fastq路径</li><li>S: 输出Sam格式文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 课程中给出的代码是单端比对</span></span><br><span class="line">bowtie2 -p 2 -q \</span><br><span class="line">-x ~/ngs_course/chipseq/reference_data/chr12\</span><br><span class="line">-U ~/ngs_course/chipseq/results/trimmed/H1hesc_Input_Rep1_chr12.qualtrim20.minlen36.fq \</span><br><span class="line">-S ~/ngs_course/chipseq/results/bowtie2/H1hesc_Input_Rep1_chr12_aln_unsorted.sam</span><br></pre></td></tr></table></figure></li></ul><p><strong>NOTE:</strong> 如果fastq文件是没有经过trim的，可以用局部比对执行soft-clipping，加上参数<code>--local</code></p><h3 id="过滤reads"><a href="#过滤reads" class="headerlink" title="过滤reads"></a>过滤reads</h3><p>首先将sam文件转为bam格式，再对bam文件进行排序，接着过滤唯一比对的reads，去除线粒体reads。<br><strong>转化为bam格式</strong><br>使用samtools转换格式<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">samtools view -h -S -b \</span><br><span class="line">-o H1hesc_Input_Rep1_chr12_aln_unsorted.bam \</span><br><span class="line">H1hesc_Input_Rep1_chr12_aln_unsorted.sam</span><br></pre></td></tr></table></figure></p><p><strong>对bam文件排序</strong><br>对bam文件按照基因组坐标排序，可以直接使用<code>samtools</code>，也可以使用<code>Sambamba</code>。<a href="http://lomereiter.github.io/sambamba/index.html" target="_blank" rel="noopener"><code>sambamba</code></a>快速处理bam和sam文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sambamba sort -t 2 \</span><br><span class="line">-o H1hesc_Input_Rep1_chr12_aln_sorted.bam \</span><br><span class="line">H1hesc_Input_Rep1_chr12_aln_unsorted.bam</span><br></pre></td></tr></table></figure><p><strong>过滤唯一比对的reads</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sambamba view -h -t 2 -f bam \</span><br><span class="line">-F <span class="string">"[XS] == null and not unmapped "</span> \</span><br><span class="line">H1hesc_Input_Rep1_chr12_aln_sorted.bam &gt; H1hesc_Input_Rep1_chr12_aln.bam</span><br></pre></td></tr></table></figure><p><strong>去除PCR重复</strong><br>PCR扩增和一些重复序列（如微卫星、着丝粒）会产生重复，干扰真实的富集信号，所以在call peaks前需要先去除重复，这里先用picard去除PCR重复。picard去除PCR重复时要加上参数<code>REMOVE_DUPLICATES=true</code>,否则只是标记了duplicates，并没有去除。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar picard-tools-1.119/MarkDuplicates.jar REMOVE_DUPLICATES=<span class="literal">true</span> I=H1hesc_Input_Rep1_chr12_aln.bam O=H1hesc_Input_Rep1_chr12_aln.dedup.bam M=H1hesc.duplicates.log</span><br></pre></td></tr></table></figure><p><strong>过滤线粒体reads</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">samtools index H1hesc_Input_Rep1_chr12_aln.dedup.bam</span><br><span class="line">samtools idxstats H1hesc_Input_Rep1_chr12_aln.dedup.bam &gt; H1hesc_Input_Rep1_chr12_aln.dedup.mitochondrial.stats</span><br><span class="line">samtools view -h H1hesc_Input_Rep1_chr12_aln.dedup.bam | grep -v <span class="string">'chrM'</span> | samtools view -bS -o H1hesc.final.bam</span><br></pre></td></tr></table></figure><p>上面给出的仅是示例代码，和参考课程不一样，实际运行需要修改相应文件。<br>此时就得到了唯一比对且已经去除过线粒体的比对文件，可以用于接下来的peaks calling。</p><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p>HBC的深度NGS数据分析课程：<a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/02_QC_and_alignment.md" target="_blank" rel="noopener">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/02_QC_and_alignment.md</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这部分内容包括对原始测序数据质控，然后比对过滤，这是所有NGS数据处理的上游分析。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ATAC-Seq与其他方法不同的一点是需要过滤去除线粒体（如果是植物，还需要过滤叶绿体），因为线粒体DNA是裸露的，也可以被Tn5酶识别切割。&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;另外一点需要注意的是课程中给出的是单端比对的示例代码，如果是双端测序做相应更改即可。&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;学习目标&quot;&gt;&lt;a href=&quot;#学习目标&quot; class=&quot;headerlink&quot; title=&quot;学习目标&quot;&gt;&lt;/a&gt;学习目标&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;用FastQC进行质控检测&lt;/li&gt;
&lt;li&gt;用Trimmomatic进行质量过滤&lt;/li&gt;
&lt;li&gt;用Bowtie2比对，并理解相关参数含义&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
      <category term="QC" scheme="http://yoursite.com/tags/QC/"/>
    
  </entry>
  
  <entry>
    <title>第1篇：ATAC-seq的背景介绍以及与ChIP-Seq的异同</title>
    <link href="http://yoursite.com/2019/08/23/%E7%AC%AC1%E7%AF%87%EF%BC%9AATAC-seq%E7%9A%84%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E4%B8%8EChIP-Seq%E7%9A%84%E5%BC%82%E5%90%8C/"/>
    <id>http://yoursite.com/2019/08/23/第1篇：ATAC-seq的背景介绍以及与ChIP-Seq的异同/</id>
    <published>2019-08-23T00:26:56.000Z</published>
    <updated>2019-08-24T13:04:13.448Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ATAC-Seq简介"><a href="#ATAC-Seq简介" class="headerlink" title="ATAC-Seq简介"></a>ATAC-Seq简介</h3><p><strong>ATAC-seq（Assay for Transposase-Accessible Chromatin with high throughput sequencing）</strong> 是2013年由斯坦福大学<a href="http://greenleaf.stanford.edu/index.html" target="_blank" rel="noopener">William J. Greenleaf</a>和<a href="http://changlab.stanford.edu/index.html" target="_blank" rel="noopener">Howard Y. Chang</a>实验室开发的用于研究染色质可及性（通常也理解为染色质的开放性）的方法， 原理是通过转座酶Tn5容易结合在开放染色质的特性，然后对Tn5酶捕获到的DNA序列进行测序。</p><p>真核生物的核DNA并不是裸露的，而是与组蛋白结合形成染色体的基本结构单位核小体，核小体再经逐步的压缩折叠最终形成染色体高级结构（如人的DNA链完整展开约2m长，经过这样的折叠就变成了纳米级至微米级的染色质结构而可以储存在小小的细胞核）。而DNA的复制转录是需要将DNA的紧密结构打开，从而允许一些调控因子结合（转录因子或其他调控因子）。这部分打开的染色质，就叫开放染色质，打开的染色质允许其他调控因子结合的特性称为染色质的可及性（chromatin accessibility）。因此，认为染色质的可及性与转录调控密切相关。<br>开放染色质的研究方法有ATAC-seq以及传统的DNase-Seq及FAIRE-seq等，ATAC-Seq由于所需细胞量少，实验简单，可以在全基因组范围内检测染色质的开放状态，目前已经成为研究染色质开放性的首选技术方法。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-a18ab4a1ad419cdf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="fig"></p><p><a href="https://www.ncbi.nlm.nih.gov/pubmed/24097267#" title="Nature methods." target="_blank" rel="noopener">Nat Methods, 2013</a>. <strong>doi: 10.1038/nmeth.2688. Epub 2013 Oct.</strong></p><a id="more"></a><h3 id="ATAC-Seq与ChIP-Seq的异同"><a href="#ATAC-Seq与ChIP-Seq的异同" class="headerlink" title="ATAC-Seq与ChIP-Seq的异同"></a>ATAC-Seq与ChIP-Seq的异同</h3><p>ATAC-Seq与ChIP-Seq的不同的是ATAC-Seq是全基因组范围内检测染色质的开放程度，可以得到全基因组范围内的蛋白质可能结合的位点信息，一般用于不知道特定的转录因子，用此方法与其他方法结合筛查感兴趣的特定调控因子；但是ChIP-Seq是明确知道感兴趣的转录因子是什么，根据感兴趣的转录因子设计抗体去做ChIP实验拉DNA，验证感兴趣的转录因子是否与DNA存在相互作用。ATAC-Seq、ChIP-Seq、Dnase-Seq、MNase-Seq、FAIRE-Seq整体的分析思路一致，找到富集区域，对富集区域进行功能分析。</p><ul><li><p><strong>ChIP-Seq</strong>是揭示特定转录因子或蛋白复合物的结合区域，实际是研究DNA和蛋白质的相互作用，利用抗体将蛋白质和DNA一起富集，并对富集到的DNA进行测序。</p></li><li><p><strong>DNase-Seq、ATAC-Seq、FAIRE-Seq</strong>都是用来研究开放染色质区域。DNase-Seq是用的DNase I内切酶识别开放染色质区域，而ATAC-seq是用的Tn5转座酶，随后进行富集和扩增；FAIRE-Seq是先进行超声裂解，然后用酚-氯仿富集。</p></li><li><p><strong>MNase-Seq</strong>是用来鉴定核小体区域。</p></li></ul><ul><li><img src="https://upload-images.jianshu.io/upload_images/8242255-333e68ef5995083f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ul><p><strong>翻译部分</strong><br>下面这一部分是对HBC课程中ChIP-Seq Introduction这一节的介绍，主要包括的ChIP-Seq的实验设计和分析方法总体思路。原文链接：<a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/01_Intro_chipseq_and_setup.md。" target="_blank" rel="noopener">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/01_Intro_chipseq_and_setup.md。</a></p><h2 id="ChIP-Seq-Introduction"><a href="#ChIP-Seq-Introduction" class="headerlink" title="ChIP-Seq Introduction"></a>ChIP-Seq Introduction</h2><h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><ul><li><strong>理解ChIP-Seq的实验设计</strong><h3 id="ChIP-Seq简介"><a href="#ChIP-Seq简介" class="headerlink" title="ChIP-Seq简介"></a>ChIP-Seq简介</h3>ChIP实验（Chromatin immunoprecipitation）即染色质免疫沉淀，根据DNA与蛋白质相互作用的原理，分离富集与感兴趣的蛋白相互作用的DNA。ChIP-Seq即对分离得到的DNA扩增测序，然后通过分析得到DNA的富集区域也称为peaks，同时可以鉴定过表达的序列motif以及进行功能注释分析。</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/8242255-6c4c141da0780fd4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ChIP-Seq Overall"></p><p>下面这一部分将会介绍ChIP-Seq数据分析的整个流程，从实验设计到产生原始的测序reads，以及到最后的功能富集分析和motif查找。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-5a3c0ba8ea4c59ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="实验设计和文库构建"><a href="#实验设计和文库构建" class="headerlink" title="实验设计和文库构建"></a>实验设计和文库构建</h3><p>文库构建包括以下5步骤：</p><ul><li>蛋白质与DNA的交联</li><li>超声打断DNA链</li><li>加附有抗体的磁珠用于免疫沉淀</li><li>解交联，纯化DNA</li><li>DNA片段大小选择和PCR扩增</li></ul><p>富集到的DNA片段只有一部分是真实的信号（感兴趣的蛋白结合的DNA区域），这个比例取决于<strong>number of active binding sites, the number of starting genomes, and the efficiency of the IP.</strong></p><p>ChIP-Seq富集序列存在以下特点：</p><ul><li>开放染色质区域比紧密区域更易打断；</li><li>重复序列会出现似乎被富集的现象</li><li>序列在整个基因组上不均匀分布</li></ul><p>因此，ChIP-Seq需要有合适的对照组，对照样本需要满足以下其中一个条件：</p><ul><li>没有IP（input DAN）</li><li>没有抗体 (“mock IP”)</li><li>没有特定的抗体 (IgG “mock IP”)</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/8242255-3258f63385c35669.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-57ffd903f1fc2766.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="示例数据介绍"><a href="#示例数据介绍" class="headerlink" title="示例数据介绍"></a>示例数据介绍</h3><p>所用到的示例数据是来自于人类胚胎干细胞系（h1-ESC）中<strong>Nanog和Pou5f1（Oct4）</strong>两个转录因子的结合图谱。这两个转录因子的功能涉及干细胞的多能性，该研究的目标之一是探究这两个转录因子在转录调控中单独和相互的调控作用。<br>两组重复，每组重复包括3个实验样本信息，共6个样本，数据分析中只用到了12号染色体的信息。<br>Nanog IP<br>Pou5f1 IP<br>Control input DNA</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-2a3a493c405b2b06.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="分析流程"><a href="#分析流程" class="headerlink" title="分析流程"></a>分析流程</h3><p>下面这幅图给出了整个分析流程，和每一步需要的数据格式，后面会展开介绍。</p><h3 id="分析环境配置"><a href="#分析环境配置" class="headerlink" title="分析环境配置"></a>分析环境配置</h3><p>这个课程提供了示例数据和分析代码，可以参考<a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/orchestra_mounting.md" target="_blank" rel="noopener">这里</a>连接他们的服务器，我没有连接成功，不知道是不是打开方式不对，大家可以尝试下，如果连接成功，这一部分就是配置服务器的环境，准备数据；如果也连接不上可以用自己的数据或者下载公共数据。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-42c0586d8549bb34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="https://zhuanlan.zhihu.com/p/31924355" target="_blank" rel="noopener">ATAC-seq：染色质开放性测序技术</a><br><a href="https://www.nature.com/articles/nrg3788#f1" target="_blank" rel="noopener">Clifford A. et al. Nature review, 2014</a><br>HBC课程V : <a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/01_Intro_chipseq_and_setup.md" target="_blank" rel="noopener">01-Introduction to ChIP-Seq</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;ATAC-Seq简介&quot;&gt;&lt;a href=&quot;#ATAC-Seq简介&quot; class=&quot;headerlink&quot; title=&quot;ATAC-Seq简介&quot;&gt;&lt;/a&gt;ATAC-Seq简介&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;ATAC-seq（Assay for Transposase-Accessible Chromatin with high throughput sequencing）&lt;/strong&gt; 是2013年由斯坦福大学&lt;a href=&quot;http://greenleaf.stanford.edu/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;William J. Greenleaf&lt;/a&gt;和&lt;a href=&quot;http://changlab.stanford.edu/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Howard Y. Chang&lt;/a&gt;实验室开发的用于研究染色质可及性（通常也理解为染色质的开放性）的方法， 原理是通过转座酶Tn5容易结合在开放染色质的特性，然后对Tn5酶捕获到的DNA序列进行测序。&lt;/p&gt;
&lt;p&gt;真核生物的核DNA并不是裸露的，而是与组蛋白结合形成染色体的基本结构单位核小体，核小体再经逐步的压缩折叠最终形成染色体高级结构（如人的DNA链完整展开约2m长，经过这样的折叠就变成了纳米级至微米级的染色质结构而可以储存在小小的细胞核）。而DNA的复制转录是需要将DNA的紧密结构打开，从而允许一些调控因子结合（转录因子或其他调控因子）。这部分打开的染色质，就叫开放染色质，打开的染色质允许其他调控因子结合的特性称为染色质的可及性（chromatin accessibility）。因此，认为染色质的可及性与转录调控密切相关。&lt;br&gt;开放染色质的研究方法有ATAC-seq以及传统的DNase-Seq及FAIRE-seq等，ATAC-Seq由于所需细胞量少，实验简单，可以在全基因组范围内检测染色质的开放状态，目前已经成为研究染色质开放性的首选技术方法。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/8242255-a18ab4a1ad419cdf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;fig&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.ncbi.nlm.nih.gov/pubmed/24097267#&quot; title=&quot;Nature methods.&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Nat Methods, 2013&lt;/a&gt;. &lt;strong&gt;doi: 10.1038/nmeth.2688. Epub 2013 Oct.&lt;/strong&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="组学" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/"/>
    
      <category term="表观组" scheme="http://yoursite.com/categories/%E7%BB%84%E5%AD%A6/%E8%A1%A8%E8%A7%82%E7%BB%84/"/>
    
    
      <category term="ATACseq" scheme="http://yoursite.com/tags/ATACseq/"/>
    
  </entry>
  
</feed>
