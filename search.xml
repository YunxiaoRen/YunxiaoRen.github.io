<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>多组学数据联合展示、且可以交互的基因组浏览器——trackViewer</title>
      <link href="/2019/11/23/%E5%A4%9A%E7%BB%84%E5%AD%A6%E6%95%B0%E6%8D%AE%E8%81%94%E5%90%88%E5%B1%95%E7%A4%BA%E3%80%81%E4%B8%94%E5%8F%AF%E4%BB%A5%E4%BA%A4%E4%BA%92%E7%9A%84%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%B5%8F%E8%A7%88%E5%99%A8%E2%80%94%E2%80%94trackViewer/"/>
      <url>/2019/11/23/%E5%A4%9A%E7%BB%84%E5%AD%A6%E6%95%B0%E6%8D%AE%E8%81%94%E5%90%88%E5%B1%95%E7%A4%BA%E3%80%81%E4%B8%94%E5%8F%AF%E4%BB%A5%E4%BA%A4%E4%BA%92%E7%9A%84%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%B5%8F%E8%A7%88%E5%99%A8%E2%80%94%E2%80%94trackViewer/</url>
      
        <content type="html"><![CDATA[<p>常见的可视化基因组track的Bioconductor package有<strong>rtracklayer</strong> 和 <strong>Gviz</strong>。rtracklayer提供了交互的基因组浏览器和相关tracks的注释；Gviz可以用于tracks覆盖度和注释的可视化。<strong>trackViewer</strong>是一个更轻量级的工具，且可以产生交互的可视化结果。可用于RNA-seq,ChIP-seq/ATAC-seq,miRNA-seq,DNA-seq,methylation等各种NGS组学数据的覆盖度和注释tracks的可视化展示，而且可以绘制发表级的棒棒糖图和蒲公英图。</p><p>先展示下极好看可视化效果</p><p><img src="/2019/11/23/多组学数据联合展示、且可以交互的基因组浏览器——trackViewer/fig.png" alt></p><p>使用方法可以参考文档：</p><ul><li><p>详细文档：<a href="http://127.0.0.1:31580/library/trackViewer/doc/trackViewer.html" target="_blank" rel="noopener">http://127.0.0.1:31580/library/trackViewer/doc/trackViewer.html</a></p></li><li><p>Web app: <a href="https://github.com/jianhong/trackViewer.documentation/tree/master/trackViewerShinyApp" target="_blank" rel="noopener">https://github.com/jianhong/trackViewer.documentation/tree/master/trackViewerShinyApp</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> R </tag>
            
            <tag> visualization </tag>
            
            <tag> ChIPseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>深度卷积神经网络分析低质量的ATAC-seq数据</title>
      <link href="/2019/11/23/%E6%B7%B1%E5%BA%A6%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90%E4%BD%8E%E8%B4%A8%E9%87%8F%E7%9A%84ATAC-seq%E6%95%B0%E6%8D%AE/"/>
      <url>/2019/11/23/%E6%B7%B1%E5%BA%A6%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90%E4%BD%8E%E8%B4%A8%E9%87%8F%E7%9A%84ATAC-seq%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>一个基于深度卷积神经网络分析低覆盖度和低质量ATAC-seq的工具</p><p><strong>文章信息</strong></p><p>题目：AtacWorks: A deep convolutional neural network toolkit for epigenomics</p><p>杂志：bioRxiv</p><p>时间：Nov. 4, 2019</p><p>链接: doi: <a href="http://dx.doi.org/10.1101/829481" target="_blank" rel="noopener">http://dx.doi.org/10.1101/829481</a>.</p><a id="more"></a><p><strong>文章介绍：</strong></p><p>这篇文章介绍了一个基于深度卷积神经网络的方法解析低覆盖度或低质量ATAC-seq数据的工具包——<strong>AtacWorks</strong> 。使用的架构是Resnet (residual neural network) 。训练模型的数据来自4个血细胞类型，之后利用得到的模型分析HSC，鉴定了差异调控元件、转录因子印迹。</p><p>工具介绍：<a href="https://github.com/clara-genomics/AtacWorks" target="_blank" rel="noopener">https://github.com/clara-genomics/AtacWorks</a></p><p><strong>安装方法：</strong></p><p><img src="/2019/11/23/深度卷积神经网络分析低质量的ATAC-seq数据/fig3.png" alt></p><p><strong>流程：</strong></p><p><img src="/2019/11/23/深度卷积神经网络分析低质量的ATAC-seq数据/fig2.png" alt></p><p><strong>figure</strong></p><p><img src="/2019/11/23/深度卷积神经网络分析低质量的ATAC-seq数据/fig1.png" alt></p><p><strong>碎碎念</strong></p><p>还看不懂深度学习的算法，一些基本概念都不理解</p><blockquote><p>每日文献摘要：第20篇  2019年11月23日 周六</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> software </tag>
            
            <tag> deep learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scATAC-seq与scRNA-seq的整合分析系统——MAESTRO</title>
      <link href="/2019/11/23/scATAC-seq%E4%B8%8EscRNA-seq%E7%9A%84%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%E2%80%94%E2%80%94MAESTRO/"/>
      <url>/2019/11/23/scATAC-seq%E4%B8%8EscRNA-seq%E7%9A%84%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F%E2%80%94%E2%80%94MAESTRO/</url>
      
        <content type="html"><![CDATA[<p>单细胞技术是目前比较火热的一个领域，从单细胞转录组、基因组扩展到单细胞表观组，如scATAC-seq, scHiC, scmethylation等，促使着相关的分析工具也不断涌出。单细胞领域相关工具的开发大致有两个方向：一是从本质上如算法、统计学方法入手开发新的分析工具；一种是整合多种基础工具，开发出具有功能全面，易用等特征的工具。</p><p><img src="/2019/11/23/scATAC-seq与scRNA-seq的整合分析系统——MAESTRO/fig2.png" style="zoom: 50%;"></p><a id="more"></a><p><strong>MAESTRO</strong>(Model-based AnalysEs of Single-cell Transcriptome and RegulOme)是刘小乐实验室基于snakemake新开发的用于分析scRNA-seq和scATAC-seq的工具。MAESTRO主要是打包了一些工具和软件包，目前可以实现的功能包括：对scRNA-seq和scATAC-seq数据的比对、质量控制、细胞过滤、标准化、非监督聚类、差异分析、peak calling、细胞类型注释和转录调控分析。支持 Smart-seq2, 10x-genomics, Drop-seq, SPLiT-seq for scRNA-seq protocols; microfudics-based, 10x-genomics and sci-ATAC-seq for scATAC-seq protocols.</p><p>提供的有docker镜像，<strong>安装可以参考软件介绍：<a href="https://github.com/liulab-dfci/MAESTRO/" target="_blank" rel="noopener">https://github.com/liulab-dfci/MAESTRO/</a></strong> </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh</span><br><span class="line">bash Miniconda3-latest-Linux-x86_64.sh</span><br><span class="line"></span><br><span class="line">conda config --add channels defaults</span><br><span class="line">conda config --add channels bioconda</span><br><span class="line">conda config --add channels conda-forge</span><br><span class="line">conda create -n MAESTRO maestro -c liulab-dfci</span><br></pre></td></tr></table></figure><p><strong>Installing the MAESTRO R package</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">R</span><br><span class="line">&gt; <span class="keyword">library</span>(devtools)</span><br><span class="line">&gt; install_github(<span class="string">"liulab-dfci/MAESTRO"</span>)</span><br></pre></td></tr></table></figure><p>另外依赖的cell ranger, RABIT/LISA等软件需要自行单独安装。</p><p>每种类型的数据的详细分析教程可以在原工具介绍网页点击下面每幅图查看</p><p><img src="/2019/11/23/scATAC-seq与scRNA-seq的整合分析系统——MAESTRO/fig1.png" alt></p><blockquote><p>PS: 目前还没有看到相关文章发表</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Data Sciences </category>
          
      </categories>
      
      
        <tags>
            
            <tag> scRNA-seq </tag>
            
            <tag> scATACseq </tag>
            
            <tag> software </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>叶酸与高血压、脑卒中精准防治的研究</title>
      <link href="/2019/11/22/%E5%8F%B6%E9%85%B8%E4%B8%8E%E9%AB%98%E8%A1%80%E5%8E%8B%E3%80%81%E8%84%91%E5%8D%92%E4%B8%AD%E7%B2%BE%E5%87%86%E9%98%B2%E6%B2%BB%E7%9A%84%E7%A0%94%E7%A9%B6/"/>
      <url>/2019/11/22/%E5%8F%B6%E9%85%B8%E4%B8%8E%E9%AB%98%E8%A1%80%E5%8E%8B%E3%80%81%E8%84%91%E5%8D%92%E4%B8%AD%E7%B2%BE%E5%87%86%E9%98%B2%E6%B2%BB%E7%9A%84%E7%A0%94%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<p>昨天组会，同学分享了北京大学第一人民医院霍勇老师关于<strong>脑卒中精准防治的研究</strong>。</p><p><img src="/2019/11/22/叶酸与高血压、脑卒中精准防治的研究/fig2.png" alt></p><a id="more"></a><p>脑卒中想必大家都不陌生，周围有的时候会听到某人因为脑卒中突然离世。给我的感觉就是发病急，没有特别明显的发病前症状，但是一旦发病了，往往就是不可救治。</p><p>有研究也报道脑卒中是中国人的第一位死因，发病率居世界首位。脑卒中的危险因素中高血压、膳食和年龄占权重较大。霍老师的研究发现中国高血压患者75%为H型高血压（即伴有HCY升高的高血压），而低等叶酸摄入显著增加高血压患者脑卒中的风险。进而发现叶酸缺乏与MTHFR C677T位点的多态性有关，MTHFR基因是叶酸代谢中的一个关键酶，C677T位点的多态性存在3种基因型：CC型（野生型）、CT型（杂合突变型）和TT型（纯合突变型）。</p><p>叶酸人体是无法自己合成的，主要从食物中获取。叶酸缺乏有两种类型，一种是膳食中摄入量不足，通过补充可以轻易恢复正常水平；另一种是MTHFR基因的突变，导致叶酸利用率低，即使摄入得很多，但是利用的却很少。而叶酸代谢异常既而可引起高同型半胱氨酸血症，血液异常凝固等，从而引起脑卒中、冠心病、血栓。而且易造成新生儿缺陷等疾病。<br><img src="/2019/11/22/叶酸与高血压、脑卒中精准防治的研究/1240-20191122123751293.png" alt></p><p>根据这一发现，他们提出了高血压患者叶酸治疗的研究（CSPPT），对20,702例45-75岁无心脑血管疾病的高血压患者随访4.5年，MTHFR的3种基因型每都类分为两组，分别用依那普利和依那普利叶酸治疗，他们最后的发现是<strong>与单纯使用依那普利降压比较，依那普利叶酸片（依叶）显著降低21%脑卒中风险</strong></p><p>这个治疗措施在山东荣成地区已经成为转化应用示范基地，据国家卫计委估计如果CSPPT（即高血压患者叶酸治疗的研究）研究成果广泛应用，每年可预防111万（30%）脑卒中发生。</p><blockquote><p>总结一下就是叶酸缺乏可能会引起脑卒中、高血压、新生儿缺陷等风险的增加</p></blockquote><p>听完之后，想起了自己的基因检测报告好像有叶酸营养需求的报告，打开一看</p><p><img src="/2019/11/22/叶酸与高血压、脑卒中精准防治的研究/1240-20191122123752093.png" alt></p><p>中招了，而且基因型还是AA<br><img src="/2019/11/22/叶酸与高血压、脑卒中精准防治的研究/1240.png" style="zoom:50%;"></p><p><img src="/2019/11/22/叶酸与高血压、脑卒中精准防治的研究/fig1.png" style="zoom:50%;"></p><p>看来以后要多补充叶酸了</p><hr><blockquote><p><strong>文献：</strong> 2015，JAMA, Efficacy of folic acid therapy in primary prevention of stroke among adults with hypertension in China: the CSPPT randomized clinical trial.</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> chronic disease </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>宏基因组物种鉴定工具</title>
      <link href="/2019/11/22/%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%89%A9%E7%A7%8D%E9%89%B4%E5%AE%9A%E5%B7%A5%E5%85%B7/"/>
      <url>/2019/11/22/%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%89%A9%E7%A7%8D%E9%89%B4%E5%AE%9A%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>宏基因组物种鉴定工具集锦</p><p><strong>文章信息</strong></p><p>题目：Benchmarking Metagenomics Tools for Taxonomic Classification</p><p>杂志：Cell</p><p>时间：August 8,2019</p><p>链接: <a href="https://doi.org/10.1016/j.cell.2019.07.010" target="_blank" rel="noopener">https://doi.org/10.1016/j.cell.2019.07.010</a></p><p><img src="/2019/11/22/宏基因组物种鉴定工具/abstract.png" alt></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>鉴定物种分类是宏基因组分析的一个必要和基础步骤，相关工具也是层出不穷，如何评价物种分类工具的性能，主要从鉴定的准确性、速度和所需要的计算资源这几方面考虑。</p><p>这篇文章针对20种常见的物种鉴定工具进行评估，并描述了如何评价工具性能。</p><p>下图展示了宏基因组的复杂的样本到物种鉴定和丰度计算的过程</p><p><strong>figure</strong></p><p><img src="/2019/11/22/宏基因组物种鉴定工具/fig1.png" alt></p><h3 id="参考数据库"><a href="#参考数据库" class="headerlink" title="参考数据库"></a>参考数据库</h3><p>宏基因组的物种鉴定依赖于数据库，常见的数据库有<strong>RefSeq, blast nt和nr，以及16S rRNA特有的数据库SILVA</strong>。</p><h3 id="评价物种分类工具性能的方法"><a href="#评价物种分类工具性能的方法" class="headerlink" title="评价物种分类工具性能的方法"></a>评价物种分类工具性能的方法</h3><p>召回率（Recall）和准精确度（Precision）是宏基因组物种鉴定中重要的两个度量概念，这两个概念也是统计学中经常见到的。</p><blockquote><p>其中精度是检索出相关文档数与检索出的文档总数的比率，衡量的是检索系统的<strong>查准率</strong>；召回率是指检索出的相关文档数和文档库中所有的相关文档数的比率，衡量的是检索系统的<strong>查全率</strong>。</p></blockquote><p>召回率 = 提取出的正确信息条数 /  样本中的信息条数  </p><p>精确度= 提取出的正确信息条数 /  提取出的信息条数 </p><p><strong>两者取值在0和1之间，数值越接近1，查准率或查全率就越高。</strong></p><p>F值  = 正确率 <em> 召回率 </em> 2 / (正确率 + 召回率) （F 值即为正确率和召回率的调和平均值）</p><p><strong>F值是Precision和Recall加权调和平均</strong></p><p><strong>AUPR:</strong>是指precision和recal曲线下面的面积，也是一个综合考虑P-R两者来评估结果准确性的一个度量值。</p><p><strong>L2 distance:</strong>是为了评估丰度准确性的参数值，通过计算在给定的分类水平上，每个已识别分类单元的ground-truth丰度和标准丰度计数之间的成对距离。</p><p><img src="/2019/11/22/宏基因组物种鉴定工具/fig2.png" alt></p><p>###物种分类工具和其性能</p><p>这里他们比较了20种宏基因组物种鉴定工具，利用相同的数据库 分别比较了他们的precision, recall, F1, 速度和其他值。包括DAN-DNA鉴定，DNA-protein鉴定，和基于marker的鉴定方法。</p><p><img src="/2019/11/22/宏基因组物种鉴定工具/fig3.png" alt></p><p><strong>AUPR值如下：</strong>值越接近1越好</p><p><img src="/2019/11/22/宏基因组物种鉴定工具/fig4.png" alt></p><p><strong>L2 distance</strong>: 值越小越好</p><p><img src="/2019/11/22/宏基因组物种鉴定工具/fig5.png" alt></p><p><strong>运行时间</strong></p><p><img src="/2019/11/22/宏基因组物种鉴定工具/fig6.png" alt></p><p><strong>碎碎念</strong></p><p>没有做过宏基因组分析实际项目，看着这些软件名字完全没有感觉，也记不住，后续研究若用到的话可以参考这里做选择。</p><blockquote><p>每日文献摘要：第19篇  2019年11月22日 周五</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> software </tag>
            
            <tag> metagenomics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>非编码RNA在肿瘤中扮演的角色</title>
      <link href="/2019/11/17/%E9%9D%9E%E7%BC%96%E7%A0%81RNA%E5%9C%A8%E8%82%BF%E7%98%A4%E4%B8%AD%E6%89%AE%E6%BC%94%E7%9A%84%E8%A7%92%E8%89%B2/"/>
      <url>/2019/11/17/%E9%9D%9E%E7%BC%96%E7%A0%81RNA%E5%9C%A8%E8%82%BF%E7%98%A4%E4%B8%AD%E6%89%AE%E6%BC%94%E7%9A%84%E8%A7%92%E8%89%B2/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>关于非编码RNA在肿瘤中作用的综述</p><p><strong>文章信息</strong></p><p>题目：The Role of Non-coding RNAs in Oncology</p><p>杂志：Cell</p><p>时间：November 14, 2019</p><p>链接: <a href="https://doi.org/10.1016/j.cell.2019.10.017" target="_blank" rel="noopener">https://doi.org/10.1016/j.cell.2019.10.017</a></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/abstract.jpg" style="zoom:50%;"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p><strong>非编码RNA作为致癌因子或抑癌因子的总结</strong></p><p>（且有体内实验验证）</p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig1.png" alt></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig2.png" alt></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig3.png" alt></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig4.png" alt></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig5.png" alt></p><p><strong>不同类型的致癌ncRNAs和癌症发生的机制</strong></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig6.png" alt></p><p><strong>不同类型的抑癌ncRNAs和阻碍癌症发展的通路</strong></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig7.png" alt></p><p><strong>非编码RNA作为肿瘤标志物</strong></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig8.png" alt></p><p><img src="/2019/11/17/非编码RNA在肿瘤中扮演的角色/fig9.png" alt></p><blockquote><p>每日文献摘要：第18篇  2019年11月17日 周日</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文献摘要 </tag>
            
            <tag> lncRNA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>准确聆听、有效沟通</title>
      <link href="/2019/11/16/%E5%87%86%E7%A1%AE%E8%81%86%E5%90%AC%E3%80%81%E6%9C%89%E6%95%88%E6%B2%9F%E9%80%9A/"/>
      <url>/2019/11/16/%E5%87%86%E7%A1%AE%E8%81%86%E5%90%AC%E3%80%81%E6%9C%89%E6%95%88%E6%B2%9F%E9%80%9A/</url>
      
        <content type="html"><![CDATA[<p>有效沟通始于准确聆听</p><p><img src="/2019/11/16/准确聆听、有效沟通/abstract.png" alt></p><a id="more"></a><p>以前觉得自己还是个好的聆听者，当与别人交流时会很认真的听，然后作出回应，但今天发现我并没有做到一个好的聆听者，也没有达到有效的沟通。往往没有了解清晰的状况、只是为了回应而回应，随便地给出评价或建议；或者无论对方说什么，都会联想到自己，开始说自己的事说个没完，陷入了典型的<strong>自传式回应</strong>沟通。</p><blockquote><p>A: “我这个周末要加班……” </p><p>B: “辞了辞了！对自己这么苛刻干嘛？”</p><p>A: “我妈妈不同意我去其他城市发展…..”</p><p>B:”我爸妈对我没有要求，无论我做什么都特别支持，而且我爸妈…..(ba la ba la说自己的事情没有完)”</p></blockquote><p><strong>自传式回应</strong>常见的现象有这样几种：</p><ul><li><p>价值判断–表示肯定或否定</p><p>如，你这样做是不对的哦；你肯定小时候怎么样；</p></li><li><p>追根究底–依据自己的立场，探究别人的隐私</p><p>这个貌似也经常触碰，问的有点多，忽略了别人的隐私</p></li><li><p>好为人师–以个人生活经验指导他人</p><p>经常会和别人说，我曾经怎么怎么的，你应该怎样做等</p></li><li><p>自以为是–根据自己的行为动机判断别人的</p></li></ul><p>如何做到准确聆听，一种做法是<strong>移情式聆听</strong>，即代入倾诉者的角色，感同深受地了解对方此番谈话的真正目的，并掌握准确清晰的事实，再通过对对方情感的客观反馈，来实现有效的沟通。</p><p><strong>记住，说出对方的感受，而不要判断。</strong></p><p><strong>更要切记，让别人说出感受，而不是陷入自传式的回应</strong></p>]]></content>
      
      
      <categories>
          
          <category> 杂想 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 胡思 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lncRNA-染色质相互作用数据库</title>
      <link href="/2019/11/16/lncRNA-%E6%9F%93%E8%89%B2%E8%B4%A8%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2019/11/16/lncRNA-%E6%9F%93%E8%89%B2%E8%B4%A8%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>lncRNA和染色质相互作用数据库</p><p><strong>文章信息</strong></p><p>题目：LnChrom: a resource of experimentally validated lncRNA–chromatin interactions in human and mouse</p><p>杂志：Database</p><p>时间：23 March 2018</p><p>链接: doi: 10.1093/database/bay039</p><p><strong>figure</strong></p><p><img src="/2019/11/16/lncRNA-染色质相互作用数据库/abstract.png" alt></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>lncRNA作用机制多样，可以与DNA、RNA和蛋白质相互作用，也是参与染色质调控的重要组成部分。许多lncRNA通过招募染色质修饰因子调控染色质状态，进而影响基因表达过程。作者对已经过实验验证的lncRNA-chromatin相互作用的数据资源进行整理，开发了lnChrom数据库。该数据库目前包括人类和鼠共382743个lncRNA-chromatin相互作用对，另外还收集了每个作用对的染色质修饰因子、表观标记特征、靶基因以及与疾病的关联信息。</p><p><img src="/2019/11/16/lncRNA-染色质相互作用数据库/fig1.png" alt></p><p>LnChrom提供了友好的交互界面，可以通过输入lncRNA ID或靶基因快速检索， 也可以通过选择物种、染色质修饰类型、染色质相关因子，以及基因名字进行高级检索 ，同时可以通过输入感兴趣的染色质区域进行region检索。搜索结果以一个概览的表格和相互作用网络图展示。用户点击某一感兴趣的相互作用对，可以了解到更多细节结果，包括详细的注释信息、Genome Browser，TF Co-occupancy和Cancer Exploration。</p><p>网站：<a href="http://biocc.hrbmu.edu.cn/LnChrom/" target="_blank" rel="noopener">http://biocc.hrbmu.edu.cn/LnChrom/</a></p><p><img src="/2019/11/16/lncRNA-染色质相互作用数据库/fig2.png" alt></p><blockquote><p>每日文献摘要：第17篇  2019年11月16日 周六</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文献摘要 </tag>
            
            <tag> lncRNA </tag>
            
            <tag> database </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微生物组学研究的相关概念</title>
      <link href="/2019/11/10/%E5%BE%AE%E7%94%9F%E7%89%A9%E7%BB%84%E5%AD%A6%E7%A0%94%E7%A9%B6%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5/"/>
      <url>/2019/11/10/%E5%BE%AE%E7%94%9F%E7%89%A9%E7%BB%84%E5%AD%A6%E7%A0%94%E7%A9%B6%E7%9A%84%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5/</url>
      
        <content type="html"><![CDATA[<p>这篇文章主要对微生物组学研究中常出现的概念进行整理，</p><p>资料摘抄原文如下：</p><ul><li><a href="https://zhuanlan.zhihu.com/p/72013570" target="_blank" rel="noopener">细菌16s rDNA微生物多样性研究中可变区的选择</a></li><li><a href="https://www.cnblogs.com/leezx/p/7053199.html" target="_blank" rel="noopener">16S 基础知识、分析工具和分析流程详解</a></li><li><a href="http://www.bgitechsolutions.com/sequencing/32" target="_blank" rel="noopener">16S/18S/ITS 扩增子测序</a></li><li><a href="https://www.cnblogs.com/nkwy2012/p/9961611.html" target="_blank" rel="noopener">微生物组学数据分析工具综述 | 16S+宏基因组＋宏病毒组＋宏转录组–转载</a></li></ul><h3 id="微生物组学的常见分类"><a href="#微生物组学的常见分类" class="headerlink" title="微生物组学的常见分类"></a>微生物组学的常见分类</h3><p>建立在高通量测序基础上的微生物群落研究，当前主要有三大类：</p><ul><li><strong>基于16S/18S/ITS等扩增子做物种分类的Metataxanomics、</strong></li><li><strong>鸟枪法打断全基因组DNA序列的Metagenomics</strong></li><li><strong>和基于mRNA信息的宏转录组方法Meta-transcriptomics。</strong></li></ul><p><img src="/2019/11/10/微生物组学研究的相关概念/abstract.png" alt></p><a id="more"></a><p>###16S/18S/ITS扩增子测序</p><p>16S rDNA是细菌分类学研究中最常用的“分子钟”，其序列包含9个可变区（Variable region）和10个保守区（constant region）。可变区因细菌而异，且变异程度与细菌的系统发育密切相关。通过检测16S rDNA的序列变异和丰度，可以了解环境样品中群落多样性信息。基于16S rDNA的分析在微生物分类鉴定、微生态研究等方面起到重要作用。</p><p><strong>16S rDNA结构：</strong>16s rRNA基因的序列（约1500bp）有10个保守区和9个高变区（v1-v9：长度分布范围约30~100bp）之分；保守区为所有细菌共有，细菌间无差别，能反映生物物种的亲缘关系，可变区具有属或种的特异性，序列则随菌间的亲缘关系不同而有一定的差异，所以能揭示生物物种的特征核酸序列，被认为是最适于细菌系统发育和分类鉴定的指标。根据保守区设计引物位点，扩增可变区获得的序列可以用于菌种鉴定。一种快速、廉价的菌种鉴定方法。</p><p><img src="/2019/11/10/微生物组学研究的相关概念/fig1.png" alt></p><p><strong>16s rRNA基因可变区考虑因素：</strong></p><p><img src="/2019/11/10/微生物组学研究的相关概念/fig2.png" alt></p><p><strong>16s rRNA基因数据库</strong></p><p>SILVA; GreenGenes, RDP, EzTaxon-e</p><p><img src="/2019/11/10/微生物组学研究的相关概念/fig3.png" alt></p><blockquote><p><strong>几个概念：</strong></p><p><strong>核糖体</strong>：Ribosome，由 RNA(rRNA）和蛋白质 组成，配合 tRNA 来翻译 mRNA。核糖体按沉降系数来分类，S就是沉降系数，原核70S，真核80S。我们一般研究微生物，70S，由50S和30S两个亚基组成。再细分为 5S、16S、23S，我们的 16S 就是指核糖体的亚基的一个组分，16S rRNA。（记住，这是原核生物核糖体的一个组分）</p><p><strong>16S rRNA</strong>：这并不是我们的研究对象，因为我们测序的不是它，而是它对应在DNA双链上的基因序列，</p></blockquote><blockquote><p><strong>16S rDNA</strong>。可以这样理解，我们所说的16S 就是指 <strong>16S rDNA。</strong></p><p><strong>分子钟</strong>：即氨基酸在单位时间以同样的速度进行置换。16S 的进化具有良好的时钟性质，在结构与功能上具有高度的保守性，在大多数原核生物中rDNA都具有多个拷贝，5S、16S、23S rDNA的拷贝数相同。16S rDNA由于大小适中，约1.5Kb左右，既能体现不同菌属之间的差异，又能利用测序技术较容易地得到其序列，故被细菌学家和分类学家接受。（来源百度）</p></blockquote><blockquote><p><strong>OTU</strong>：即Operational Taxonomic Units的缩写（千万表手滑写成OUT，否则就OUT了），在系统发生学或群体遗传学研究中，为了便于进行分析，人为给某一个分类单元（品系，属，种、分组等）设置的同一标志。理论上一个OTU代表一个微生物物种。</p><p>通过测序获得的大量reads，如何才能转变为我们需要的物种信息呢？首先需要对这些reads进行归类（cluster），通常在97%的相似水平划分为不同的OTU，将OTU代表序列与相应的微生物数据库比对（Silva、RDP、Greengene等），得到每个样本所含的物种信息，进而进行后续生物信息统计分析。</p></blockquote><blockquote><p><strong>Alpha多样性</strong>：用于度量群落生态单样本的物种多样性，是反映丰富度和均匀度的综合指标。</p><p>菌群丰富度（Community richness）指数有：Chao、Ace，Chao或Ace指数越大，说明菌群丰富度越高。  </p><p>菌群多样性（Community diversity）指数有：Shannon、Simpson，Shannon值越大，说明群落多样性越高；Simpson指数值越大，说明菌群多样性越低。</p><p>根据各样本生成的OTU，对样本序列进行随机取样，以取出的序列数及这些序列所能代表的OTU数构建曲线，计算样本的Alpha多样性。</p><p><strong>Beta-diversity：</strong> Beta多样性用于不同生态系统之间多样性的比较，利用各样本序列间的进化关系及丰度信息来计算样本间距离，反映样本（组）间是否具有显著的微生物群落差异。目前应用比较多的是PCA、PCoA、NMDS分析等。由于微生物多样性研究通常会涉及到大样本数量的样本，因此通过Beta-diversity分析可以直观地反映样本组间的差异情况。距离越远，微生物群落差异越大，即相似性越高。</p></blockquote><blockquote><p><strong>LEfSe</strong><br>LEfSe分析即LDA Effect Size分析，多用于多个分组（≧2）之间的比较，或者进行亚组比较分析，进而找到组间在丰度上有显著差异的物种（biomaker）。</p><p>基本过程是首先在多组样本中采用非参数因子Kruskal-Wallis秩和检验检测不同分组间丰度差异显著的物种；然后基于获得的显著差异物种，利用成组的Wilcoxon秩和检验进行组间差异分析；最后采用线性判别分析（LDA）对数据进行降维并评估差异显著的物种的影响力大小（即LDA score）。</p></blockquote><p>18S rDNA或ITS（Internal Transcribed Spacer）被广泛应用在真菌分类鉴定中。18S rDNA在系统发育研究中较适用于种级以上阶元的分类；ITS属于中度保守区域，利用它可研究种及种以下的分类阶元。 </p><p><strong>局限性</strong></p><p>16S虽然是一种相对快速和经济适用的方法，但是PCR导致了偏好的产生，这就降低了注释准确度。此外，由于原核、真核生物的“分类标签”完全不同，即使细菌和古菌的16S也相去甚远，以进化快著称的病毒更难以捕获。</p><p><strong>常规分析流程</strong></p><p>下机数据经过数据过滤，滤除低质量的reads，剩余高质量的Clean data方可用于后期分析；通过reads之间的Overlap关系将reads拼接成Tags；在给定的相似度下将Tags聚成OTU，然后通过OTU与数据库比对，对OTU进行物种注释；基于OTU和物种注释结果进行样品物种复杂度分析以及组间物种差异分析。</p><p><img src="/2019/11/10/微生物组学研究的相关概念/fig4.png" alt></p><hr><h3 id="宏基因组"><a href="#宏基因组" class="headerlink" title="宏基因组"></a>宏基因组</h3><p>宏基因组有效避免了扩增偏差，由于是直接打断，理论上不限制物种（细菌、真菌、古菌、真核生物等，事实上当前宏基因组测序多还是以细菌为主），可能组装获得新基因乃至新物种信息，但根据取样情况可能存在少量或大量的宿主污染，因需组装，数据量要求大，成本贵、周期长。</p><p><strong>宏基因组经典流程：</strong>环境微生物样本–Total DNA提取–文库构建–上机测序（经典短读长: illumina系列；长读长选择: PB, ONT）–数据质控（去除低质量和接头等，去除宿主基因组等干扰信息）–宏基因组组装–Contig Binning–基因组重建–分类注释（可基于reads、contig、bins、还原出来的基因组做物种注释）–其他下游分析。</p><hr><h3 id="宏转录组"><a href="#宏转录组" class="headerlink" title="宏转录组"></a>宏转录组</h3><p>宏转录组的好处是，跳出了DNA层面的束缚，可以获得实时活跃的、真正对群落有贡献的基因和通路，然而mRNA不如DNA稳定,此外多纯化和扩增的步骤也可能引入错误。</p><p>宏转录组也迎来了自己的专属软件–IMSA+A ( <a href="https://github.com/JeremyCoxBMI/IMSA-A" target="_blank" rel="noopener">https://github.com/JeremyCoxBMI/IMSA-A</a> )。IMSA+A在17年1月发表于Microbiome，是一种可应用于任意读长宏转录组学数据、可高效在同一份样品中鉴定出细菌、真菌、病毒的准确的分类分析的方法。</p>]]></content>
      
      
      <categories>
          
          <category> Data Sciences </category>
          
      </categories>
      
      
        <tags>
            
            <tag> metagenomics </tag>
            
            <tag> 16s rRNA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>三岔路口</title>
      <link href="/2019/11/06/%E4%B8%89%E5%B2%94%E8%B7%AF%E5%8F%A3/"/>
      <url>/2019/11/06/%E4%B8%89%E5%B2%94%E8%B7%AF%E5%8F%A3/</url>
      
        <content type="html"><![CDATA[<p>7月初毕业，到现在4个月过去了，终于在昨天正式入职，开始进入工作实习期。昨天配置了电脑，今天总管开始分配任务，虽然是新的领域，新的方法，之前了解的并不多，但是很多知识和方法论都是相通的，估计很快就能完全入手。</p><p><img src="/2019/11/06/三岔路口/fig1.png" style="zoom:50%;"></p><a id="more"></a><p>之前在即将毕业的一年时间里我一直在纠结是读博、工作还是创业，纠结的原因很多，最根本的原因是对自己不了解，不知道自己适合什么，也没有特别明确工作倾向，只是希望工作中可以经常接触新的东西，可以不断学习。纠结的再多，不如先去尝试。毕业先去了广州，朋友想让我过去做些创业的东西，结果毕业过去的时候，离项目资金申请剩余的时间很少，由于准备不足，申请直接在第一轮被刷下，项目也因此被搁置。这段其实称不上创业的经历，给我印象比较深的是创业最重要的是<strong>想法和团队</strong>。创业不是一个人的事，一定要有一个敢想敢做的团队。</p><p>目前选择了工作，虽然工作的方向和我最初想的领域不一样（最初想工作的领域是目前比较热的技术领域），但是觉得也挺有意思，是有战略发展潜力的一个方向。</p><p>不论选择哪条路，都认真、负责的对待。路上的风景也是靠自己创造的。</p><hr><p><strong>这里很感谢当初迷茫的时候，师兄师姐给的建议，无论哪条路，选择适合自己的路才是最好的方向。</strong></p><blockquote><p>师姐，你觉得在公司和在科研单位有什么不同吗？读博能学到的东西更多，还是工作呢？我现在很矛盾，不确定自己适合什么方向，你能有空的时候大概说说你的感受吗</p><p><strong>一师姐的回答</strong></p><p>我认为在公司和科研单位有很多不一样的地方。从工作内容上说，在科研单位主要是围绕课题，而且是开放性课题，包括申请课题、做课题、写总结性的报告公文之类的，所有的事情都是由计划的、相对弹性的；在公司，所有的事情要围绕公司的产品，无论是软件还是科研服务，都是以销售为导向的，所以开放性的研究不会有很多，即使是研发部门，也都是以应用为前提，所以基本上在公司，除了主管级以上会涉及到不同程度的前沿调研探索，如果是新入职的，最看重的还是实操技能，能够准确地完成领导布置的任务（生信相关的有软件开发维护，流程搭建等等）才是最重要的，如果做到高级领导，就需要有前瞻性的想法了，引导队伍向那个方向前进。在公司，一开始从基层做起的话，工作是具体的、指令型的，没有弹性，跟着项目走，项目急就必须很快反馈。</p><p>至于你说的哪个能学到更多的东西，我觉得这个没有办法去直接比较。去公司和读博，长远来看，是两条不同的路。如果你准备走科研这条道路，肯定是去读博，之后再出国读博后，是最直接的路径。如果准备进入公司打拼，走生信分析师-生信主管-总监-更高级管理层这条路，从目前的形势看，名校硕士在晋升方面还是没有太大的阻碍的，应该会比较顺利，不会像做科研这条路，硕士有很大的阻碍。读书学到的东西和工作学到的是不一样的，做科研相对单纯些，但是也寂寞些，在公司的话就复杂多了，但是也有更多的发展方向。最终还是看你个人喜欢和选择。至于自己适合哪个方向，你可以问问最了解你的人和自己，通常周围的人会更能看清楚你的能力，自己最清楚自己内心所想。</p></blockquote><blockquote><p><strong>另一师姐的看法：</strong></p><p>我自己接触的也不多，只能说说我目前的比较局限的看法。</p><p>先说方向，如果打算转行，比如去做金融，高中教师，或者房地产等等，硕士毕业去应届去找相应工作就行。</p><p>如果还是做现在的行业，我觉得公司和科研单位最大的不同，大概是公司更计较短期产粗，而做科研，是看长期产出的。科研单位是长时间比较深入的研究一个课题，发paper，遇到好点的老板可能就插科打诨，工作强度稍小，比较适合顾家，而遇到科研氛围比较浓烈的组，也要熬夜加班，拼一拼看能不能拼个职称，做个副研究员，如果选择科研这条路，博士学位非常重要。而公司，短期项目一个接着一个，一般不会给1年时间做一个项目，可能1,2个月就结束了，讲究项目成果，节奏稍微快，除非大公司，要不绝不可能养老的，加班也是常事，但博士学位相对科研来说，用工作经验也可以弥补。</p><p>还有一个比较现实的问题，科研单位的副研老师们，出来应该都比所里挣得多，但研究所里工作和在公司工作，毕竟在其他的待遇上面也有些许差别，类比公务员和公司工作，公积金等等养家糊口的部分也有差别。</p><p>所以还是看看你觉得自己更适合哪个更需要哪个</p></blockquote><blockquote><p><strong>另一师兄的看法</strong></p><p>我：师兄，你还想去国外读博吗</p><p>师兄：准备着吧,读个博士用处还是很大得</p><p>我：为什么呢？是将来想做科研吗？</p><p>师兄：不是, 即使不做科研，这行业对学历也是有要求得, 转行得话就无所谓了</p><p>我：你有想着创业吗</p><p>师兄：创业也想过啊，不过挺难的, 还是需要先积累一下经验</p><p>我：如果有觉得合适的合伙人和团队拉你入伙呢，但是对自己的评价就如你所说，没有一点经验，也不确定自己是否适合，你会考虑吗</p><p>师兄：看团队构成吧,不能都没有经验,如果没有什么顾虑的话，创业也是不错的选择，对自己的磨砺很大,</p><p>我：顾虑倒是没有，一没有钱，投入的可能是精力和时间，我担心的是怕我做不好，还有就是我可能有一个不错读博的机会，我不知道这次放弃了，之后还有没有</p><p>师兄：有读博的机会当然选择读博了,要是感觉科研不是自己喜欢的那就选择创业,还是要看你更想过什么样的生活, 科研算是比较稳定，但就是累</p><p>我：我可能不适合科研，</p><p>师兄：下定决心的话可以去创业,创业团队里不是只需要研发人员, 职位有很多方向, 找一下自己适合做什么</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 杂想 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 胡思 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>追踪非小细胞肺癌的进化</title>
      <link href="/2019/11/05/%E8%BF%BD%E8%B8%AA%E9%9D%9E%E5%B0%8F%E7%BB%86%E8%83%9E%E8%82%BA%E7%99%8C%E7%9A%84%E8%BF%9B%E5%8C%96/"/>
      <url>/2019/11/05/%E8%BF%BD%E8%B8%AA%E9%9D%9E%E5%B0%8F%E7%BB%86%E8%83%9E%E8%82%BA%E7%99%8C%E7%9A%84%E8%BF%9B%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<p>小时候觉得癌症这个词离自己很远很远，知道它很可怕，但实际上并不知道它具体是什么，只天真的觉得它永远也不会出现在我的身边。</p><p>高三时大奶从被检出肝癌晚期到去世不到两周，她在去世的前两天都不是特别清楚自己的病情，直到去世的前一天病情的加重，她才明白。</p><p>从高三到硕士毕业，7年的时间，大姑和婶婶接连也因为癌症去世。而爷爷今天也被检出贲门癌。爷爷是一个闲不住的人，虽然80多岁了，种地比我们家都多，大概是从4月份的时候开始吃东西容易打嗝，以前他每次从地里干完活回家总要吃两个馒头，现在基本吃不了馒头，只能吃些面条和粥。家里人一直劝他去医院检查，他总是不愿意去，最近才被说服去医院检查，却没想道是癌症。</p><p>真的很害怕，以前觉得不会出现在身边的癌症，却不断地夺走亲人的生命。我虽然是研究生命科学的，经常关注癌症相关方面的研究，但是我还是不知道为什么现在的癌症越来越多，我经常怀疑我每天的研究有什么意义，在面对真正的癌症时有什么帮助，似乎大多时候我们依然无能为力！</p><p>但是，没有这些基础研究的推动，临床上治疗又怎么能提升？</p><p><img src="/2019/11/05/追踪非小细胞肺癌的进化/absract.jpg" alt></p><a id="more"></a><p><strong>一句话评价</strong></p><p>用尽量简短的一句话说清文章亮点或者你的推荐理由。越短越好</p><p><strong>文章信息</strong></p><p>题目：Tracking the Evolution of Non–Small-Cell Lung Cancer</p><p>杂志：<em>The</em> new england journal <em>of</em> medicine</p><p>时间：June 1, 2017</p><p>链接: <a href="https://www.nejm.org/doi/full/10.1056/NEJMoa1616288" target="_blank" rel="noopener">https://www.nejm.org/doi/full/10.1056/NEJMoa1616288</a></p><p><strong>figure</strong></p><p><img src="/2019/11/05/追踪非小细胞肺癌的进化/fig1.png" style="zoom:50%;"></p><p><strong>文章介绍：</strong></p><blockquote><p><strong>BACKGROUND</strong></p><p>Among patients with non–small-cell lung cancer (NSCLC), data on intratumor heterogeneity and cancer genome evolution have been limited to small retrospective cohorts. We wanted to prospectively investigate intratumor heterogeneity in relation to clinical outcome and to determine the clonal nature of driver events and evolutionary processes in early-stage NSCLC.</p><p><strong>METHODS</strong></p><p>In this prospective cohort study, we performed multiregion whole-exome sequencing on 100 early-stage NSCLC tumors that had been resected before systemic therapy. We sequenced and analyzed 327 tumor regions to define evolutionary histories, obtain a census of clonal and subclonal events, and assess the relationship between intratumor heterogeneity and recurrence-free survival.</p><p><strong>RESULTS</strong></p><p>We observed widespread intratumor heterogeneity for both somatic copy-number altera- tions and mutations. Driver mutations in <em>EGFR</em>, <em>MET</em>, <em>BRAF</em>, and <em>TP53</em> were almost always clonal. However, heterogeneous driver alterations that occurred later in evolution were found in more than 75% of the tumors and were common in <em>PIK3CA</em> and <em>NF1</em> and in genes that are involved in chromatin modification and DNA damage response and repair. Genome doubling and ongoing dynamic chromosomal instability were associated with intratumor heterogeneity and resulted in parallel evolution of driver somatic copy-number alterations, including amplifications in <em>CDK4</em>, <em>FOXA1</em>, and <em>BCL11A</em>. Elevated copy-number heterogeneity was associated with an increased risk of recurrence or death (hazard ratio, 4.9; P=4.4×10−4), which remained significant in multivariate analysis.</p><p><strong>CONCLUSIONS</strong></p><p>Intratumor heterogeneity mediated through chromosome instability was associated with an increased risk of recurrence or death, a finding that supports the potential value of chromosome instability as a prognostic predictor. (Funded by Cancer Research UK and others; TRACERx ClinicalTrials.gov number, NCT01888601.)</p></blockquote><blockquote><p>每日文献摘要：第17篇 2019年11月05日 周二</p><p>今天没时间看了，改天再仔细看</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文献摘要 </tag>
            
            <tag> tumor evolution </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>抗微生物耐药性(Anti-microbial Resistance,AMR)</title>
      <link href="/2019/11/05/%E6%8A%97%E5%BE%AE%E7%94%9F%E7%89%A9%E8%80%90%E8%8D%AF%E6%80%A7-Anti-microbial-Resistance-AMR/"/>
      <url>/2019/11/05/%E6%8A%97%E5%BE%AE%E7%94%9F%E7%89%A9%E8%80%90%E8%8D%AF%E6%80%A7-Anti-microbial-Resistance-AMR/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>一篇研究抗微生物药物耐药性的测序方法和资源的超全综述</p><p><strong>文章信息</strong></p><p>题目：Sequencing-based methods and resources to study antimicrobial resistance</p><p>杂志：Nature Review Genetics</p><p>时间：<a href="https://www.nature.com/articles/s41576-019-0108-4#article-info" target="_blank" rel="noopener">18 March 2019</a></p><p>链接: <a href="https://doi.org/10.1038/s41576-019-0108-4" target="_blank" rel="noopener">https://doi.org/10.1038/s41576-019-0108-4</a></p><p><strong>figure</strong></p><p><img src="/2019/11/05/抗微生物耐药性-Anti-microbial-Resistance-AMR/fig2.png" alt></p><a id="more"></a><p><strong>文章介绍：</strong></p><blockquote><p><strong>抗微生物药物耐药性(antimicrobial resistance)指微生物（如细菌、病毒和某些寄生虫）阻止抗微生物药物（如抗生素、抗病毒药物和抗疟药物）对其产生作用的能力，致使标准治疗方法失去效力，感染持续存在并可能传播给他人。</strong></p><p>参考：<a href="https://www.who.int/antimicrobial-resistance/zh/" target="_blank" rel="noopener">https://www.who.int/antimicrobial-resistance/zh/</a></p></blockquote><p>日常生活中我们可能大多听说过抗生素耐药性，由于抗生素的过度使用或其他原因，导致细菌对用以治疗细菌感染（如尿道感染、肺炎、血流感染）的抗生素发生反应并改变，使治疗失去效果。</p><p>抗微生物药物耐药性是一个含义更为广泛的术语，包括对治疗由寄生虫（如疟疾或蠕虫）、病毒（如艾滋病毒）及真菌（如念珠菌）等其它微生物引起的感染的药物耐药。</p><p>抗微生物耐药性已经成为影响各个国家生命健康的重要隐患之一。2019年4月29日，联合国、国际机构和有关专家发布了联合行动，防止可能出现的灾难性耐药危机。其中报告中警告说，如果不采取行动，到2050年，耐药性疾病每年可能导致1000万人死亡，对经济造成的灾难性损失将堪比2008-2009年全球金融危机。到2030年，抗微生物药物耐药性问题可能会使多达2400万人陷入极端贫困。</p><p>这篇综述发表于2019年3月的Nature Review Genetics，文中对抗微生物耐药性的监测和鉴定方法做了详尽的概括，包括传统的基于培养的易感性监测、基于测序的监测、以及目前具有前景的深度学习的方法。对基于测序的方法还对相关的工具和数据库也做了详尽的总结。最后对每种方法的优缺点做了讨论，并对未来发展方向做了展望。</p><p><img src="/2019/11/05/抗微生物耐药性-Anti-microbial-Resistance-AMR/fig1.png" alt></p><p><strong>碎碎念</strong></p><p><strong>做相关研究的，这篇综述绝对值得细读！不做相关研究的也可以根据这篇综述简单了解该领域。</strong></p><blockquote><p>每日文献摘要：第16篇 2019年11月04日 周日</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AMR </tag>
            
            <tag> 每日摘要 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>利用深度学习从宏基因组数据中预测抗生素抗性基因——DeepARG</title>
      <link href="/2019/11/03/%E5%88%A9%E7%94%A8%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8E%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%95%B0%E6%8D%AE%E4%B8%AD%E9%A2%84%E6%B5%8B%E6%8A%97%E7%94%9F%E7%B4%A0%E6%8A%97%E6%80%A7%E5%9F%BA%E5%9B%A0%E2%80%94%E2%80%94DeepARG/"/>
      <url>/2019/11/03/%E5%88%A9%E7%94%A8%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E4%BB%8E%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%95%B0%E6%8D%AE%E4%B8%AD%E9%A2%84%E6%B5%8B%E6%8A%97%E7%94%9F%E7%B4%A0%E6%8A%97%E6%80%A7%E5%9F%BA%E5%9B%A0%E2%80%94%E2%80%94DeepARG/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>利用深度学习从宏基因组数据中预测抗生素抗性基因</p><p><strong>文章信息</strong></p><p>题目：DeepARG: a deep learning approach for predicting antibiotic resistance genes from metagenomic data</p><p>杂志：Microbiome</p><p>时间：2018</p><p>链接: DOI： 10.1186/s40168-018-0401-z</p><p><strong>figure</strong></p><p><img src="/2019/11/03/利用深度学习从宏基因组数据中预测抗生素抗性基因——DeepARG/abstract.jpg" alt></p><p><img src="/2019/11/03/利用深度学习从宏基因组数据中预测抗生素抗性基因——DeepARG/fig1.png" alt></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>随着抗生素耐药率的不断上升，人类面临着需要扩大和全面的全球监测，尤其需要的是改进监测环境介质（如废水、农业废弃物、食品和水）的方法，以确定新的抗生素抗性基因（antibiotic resistance genes (ARGs）的潜在来源、基因交换的热点以及ARGs的传播和人类接触的途径。二代测序现在能够直接访问和剖析总宏基因组DNA，其中ARGs通常基于对现有数据库的序列搜索的“best hits”来识别或预测。但是，这种方法产生了很高的假阴性率。为了解决这些限制，作者在这里提出一种深度学习方法，使用所有已知的ARGs类别创建的不同矩阵。分别针对短读长序列和全基因长度序列构建了两种深度学习模型：DeepARG-SS 和DeepARG-LS。</p><p>对30个抗生素耐药类别的深度学习模型的评价表明，DeepARG模型可以同时预测高精度的ARGs（&gt;0.97）和召回率（&gt;0.90）。与典型的best hits方法相比，该模型显示出一个优势，产生的假阴性率始终较低，因此整体召回率较高（&gt;0.9）。随着越来越多的数据可用于表示ARGs类别，由于底层神经网络的性质，DeepARG模型的性能有望进一步提高。他们最新开发的ARG数据库DeepARG-DB包含了高度可信的预测的ARGs和广泛的手动检查，极大地扩展了当前的ARG存储库。</p><p>DeepARG的模型和数据库网址：</p><p><a href="http://bench.cs.vt.edu/deeparg" target="_blank" rel="noopener">http://bench.cs.vt.edu/deeparg</a>.</p><p><strong>碎碎念</strong></p><p>各个领域都开始探索使用深度学习的方法解决问题了。深度学习、抗生素抗性、宏基因组三个热点方向，但是相关文章好像并不多。</p><blockquote><p>每日文献摘要：第15篇 2019年11月03日 周日</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> deep learning </tag>
            
            <tag> AMR </tag>
            
            <tag> metagenomics </tag>
            
            <tag> 每日摘要 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scATACseq分析方法评估</title>
      <link href="/2019/11/02/scATACseq%E5%88%86%E6%9E%90%E6%96%B9%E6%B3%95%E8%AF%84%E4%BC%B0/"/>
      <url>/2019/11/02/scATACseq%E5%88%86%E6%9E%90%E6%96%B9%E6%B3%95%E8%AF%84%E4%BC%B0/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>scATAC-seq分析方法评估</p><p><img src="/2019/11/02/scATACseq分析方法评估/abstract.jpg" style="zoom: 25%;"></p><a id="more"></a><p><strong>文章信息</strong></p><p>题目：Assessment of computational methods for the analysis of single-cell ATAC-seq data</p><p>杂志：bioRxiv</p><p>时间：Aug.18,2019</p><p>链接:  DOI: <a href="http://dx.doi.org/10.1101/739011" target="_blank" rel="noopener">http://dx.doi.org/10.1101/739011</a>.</p><p><strong>文章介绍：</strong></p><p>scATAC-seq技术目前广泛应用于不同领域转录调控的研究，伴随着很多计算方法相继被开发，用于分析、解释scATAC-seq数据背后的生物学意义。这篇文章对scATAC-seq分析的<strong>10个工具</strong>在<strong>13个数据集中</strong>(包括3个真实数据集和10个合成数据集)进行了测评。</p><p><strong>10个工具分别是：</strong></p><ol><li>BROCKMAN<ul><li>de Boer, C.G. and A. Regev, <em>BROCKMAN: deciphering variance in epigenomic regulators by k-mer factorization.</em> BMC Bioinformatics, <strong>2018. </strong>19(1): p. 253.</li></ul></li><li>chromVAR<ul><li>Schep, A.N., et al., chromVAR: inferring transcription-factor-associated accessibility from single-cell epigenomic data. Nat Methods, <strong>2017.</strong> 14(10): p. 975-978.</li></ul></li><li>Cicero<ul><li>Pliner, H.A., et al., Cicero Predicts cis-Regulatory DNA Interactions from Single-Cell Chromatin Accessibility Data. Mol Cell, <strong>2018.</strong> 71(5): p. 858-871 e8.</li></ul></li><li>cisTopic<ul><li>Bravo González-Blas, C., et al., cisTopic: cis-regulatory topic modeling on single-cell ATAC-seq data. Nature Methods, <strong>2019.</strong></li></ul></li><li>Cusanovich2018<ul><li>Cusanovich, D.A., et al., A Single-Cell Atlas of In Vivo Mammalian Chromatin Accessibility. Cell, <strong>2018.</strong> 174(5): p. 1309-1324 e18.</li><li>Cusanovich, D.A., et al., The cis-regulatory dynamics of embryonic development at single-cell resolution. Nature, <strong>2018.</strong> 555(7697): p. 538-542.</li><li>Cusanovich, D.A., et al., Multiplex single cell profiling of chromatin accessibility by combinatorial cellular indexing. Science, <strong>2015. </strong>348(6237): p. 910-4.</li></ul></li><li>Gene Scoring<ul><li>Lareau, C.A., et al., Droplet-based combinatorial indexing for massive scale single-cell epigenomics. bioRxiv, <strong>2019</strong>: p. 612713.</li></ul></li><li>scABC<ul><li>Zamanighomi, M., et al., Unsupervised clustering and epigenetic classification of single cells. Nat Commun, <strong>2018.</strong> 9(1): p. 2410.</li></ul></li><li>Scasat<ul><li>Baker, S.M., et al., <em>Classifying cells with Scasat, a single-cell ATAC-seq analysis tool.</em>Nucleic Acids Res, <strong>2019. </strong>47(2): p. e10.</li></ul></li><li>SCRAT<ul><li>Ji, Z., W. Zhou, and H. Ji, Single-cell regulome data analysis by SCRAT. Bioinformatics, <strong>2017. </strong>33(18): p. 2930-2932.</li></ul></li><li>SnapATAC<ul><li>Fang, R., et al., Fast and Accurate Clustering of Single Cell Epigenomes Reveals Cis- Regulatory Elements in Rare Cell Types. BioRxiv, <strong>2019</strong>.</li></ul></li></ol><p><strong>测评方法：</strong></p><p>利用收集到的3个公共数据集和10个合成模仿的不同覆盖度和噪音水平的数据集，从<code>bam</code>格式的比对文件开始，1）根据10种scATAC-seq工具原文提供的方法构建下游分析所需的特征矩阵；2）然后用3种常见的聚类方法<strong>K-means、Louvain、Hierarchical clustering</strong>和UMAP找出潜在的亚群，并可视化每种方法的细胞间相似性；3）对聚类结果进行评估，有FACS分选标记和有金标准的组织采用ARI(adjusted random)、AMI(adjusted mutual information)和H(homogeneity)的方法评估聚类结果，当只知道已知的marker 基因，采用RAGI (Gini-index-based metric called Residual Average Gini Index)的方法评估。4）最后对基于第3步得到的值，对每种方法的聚类效果进行打分排序。流程如下图所示：</p><p><img src="/2019/11/02/scATACseq分析方法评估/fig2.png" style="zoom:50%;"></p><p><strong>测评结果：</strong></p><p>他们的测评结果显示SnapATAC、cisTopic和Cusanovich2018是性能最好的对scATAC-seq数据<strong>聚类分析</strong>方法。另外基于peak-level（cisTopic, Cusanovich2018, Scasat）和bin-level（SnapATAC）保存信息的方法优于motif/k-mer level (chromVAR,BROCKMAN, SCRAT)或gene-body (Cicero, Gene Scoring) 。实现降维步骤的方法（BROCKMAN、cisTopic、Cusanovich2018、Scasat、SnapATAC）通常比没有这个重要步骤的其他方法显示出优势。此外，SnapATAC是最具伸缩性的方法,它是唯一能够处理超过80000个细胞的方法。CusanovicH2018是平衡分析性能和运行时间的最佳方法。下图展示了每种方法的聚类效果评估等级和时间需求。</p><p><img src="/2019/11/02/scATACseq分析方法评估/fig3.png" alt="fig3"></p><p><strong>参考价值：</strong></p><ul><li><p><strong>概述了scATAC-seq常见的分析流程</strong></p><p>如，建库方法常用的两种策略：Droplet-based(10X genomics, BioRad), split-pool(sciATA-seq)。<strong>下游常见分析：可视化、聚类、轨迹分析、差异可及性分析、顺式调控网络。</strong></p><p><img src="/2019/11/02/scATACseq分析方法评估/fig1.png" style="zoom: 33%;"></p></li><li><p><strong>比较了10种scATAC-seq分析方法，为选择合适的方法提供了重要的参考依据</strong></p></li><li><p><strong>github提供了作者的100多个测试流程Jupyter笔记本，不仅可以复现作者的测评结果，还可以学习每种scATAC-seq的分析方法</strong></p></li></ul><p><strong>github:</strong> <a href="https://github.com/pinellolab/scATAC-benchmarking/" target="_blank" rel="noopener">https://github.com/pinellolab/scATAC-benchmarking/</a></p><p><strong>不足：</strong></p><p>本文的测评主要基于不同方法对scATAC-seq数据的聚类效果，但是，实际项目中可能不仅关注聚类分群，还关注谱系发育轨迹、转录因子结合位点、重要的marker基因以及他们的调控方式。</p><p>作者在讨论中也对测评的局限性做了讨论，如，chromVAR更适合于轨迹预测，chromVAR，Cicero, Gene Scoring的设计主要是为了确定关键marker基因以及他们的调控方式等。所以具体选择哪种方法，还要结合实际的研究目的决定。</p><p><strong>碎碎念</strong></p><p><strong>找时间实践下github上给出的几种scATAC-seq方法</strong></p><blockquote><p>每日文献摘要：第15篇 2019年11月02日 周六</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> single cell </tag>
            
            <tag> 文献摘要 </tag>
            
            <tag> scATACseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>英语学习的网站资源</title>
      <link href="/2019/11/02/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%BD%91%E7%AB%99%E8%B5%84%E6%BA%90/"/>
      <url>/2019/11/02/%E8%8B%B1%E8%AF%AD%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%BD%91%E7%AB%99%E8%B5%84%E6%BA%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p><strong>The only safe thing is to take a chance.</strong></p><p>唯一稳妥的事是去冒险试一试。</p></blockquote><p><img src="/2019/11/02/英语学习的网站资源/abstract.png"></p><a id="more"></a><h3 id="1-TED"><a href="#1-TED" class="headerlink" title="1.  TED"></a>1.  TED</h3><ul><li><a href="https://www.ted.com/" target="_blank" rel="noopener">https://www.ted.com/</a></li></ul><p>关于不同话题的talks，一方面可以了解相关话题的观点，另一方面锻炼听力，学习其演讲式的表达。</p><p><img src="/2019/11/02/英语学习的网站资源/fig1.png" alt></p><h3 id="2-雅思口语预测"><a href="#2-雅思口语预测" class="headerlink" title="2.  雅思口语预测"></a>2.  雅思口语预测</h3><ul><li>慎小嶷口语预测博客：blog.sina.com.cn/ieltsguru</li></ul><p>实时更新口语题库，及时了解，可以准备相关的topics</p><h3 id="3-英语线上交流学习网站"><a href="#3-英语线上交流学习网站" class="headerlink" title="3.  英语线上交流学习网站"></a>3.  英语线上交流学习网站</h3><ul><li><a href="http://www.topics-mag.com" target="_blank" rel="noopener">http://www.topics-mag.com</a></li></ul><p><img src="/2019/11/02/英语学习的网站资源/fig2.png" style="zoom:50%;"></p><h3 id="4-podcast"><a href="#4-podcast" class="headerlink" title="4.  podcast"></a>4.  podcast</h3><p>在google上 搜索 <code>podcast English</code> ,会有有很多的英语听力资源，如<a href="https://www.podcastsinenglish.com/" target="_blank" rel="noopener">https://www.podcastsinenglish.com/</a></p><h3 id="5-全面的常考口语话题"><a href="#5-全面的常考口语话题" class="headerlink" title="5. 全面的常考口语话题"></a>5. 全面的常考口语话题</h3><ul><li>idebate.org/debatabase</li></ul><p>这是一个相当酷的辩论网站，覆盖了几乎所有的常用口语讨论话题。在页面中选择<code>Education,Culture,Enviroment &amp; Animals,Welfare</code>等主题后，就可以在<code>This house believes that</code>的后面看到各种各样的辩论话题。</p><p><img src="/2019/11/02/英语学习的网站资源/fig3.png" style="zoom:50%;"></p><h3 id="6-练习发音的网站"><a href="#6-练习发音的网站" class="headerlink" title="6.  练习发音的网站"></a>6.  练习发音的网站</h3><ul><li><a href="http://www.bbc.co.uk/worldservice/learningenglish/grammar/pron" target="_blank" rel="noopener">www.bbc.co.uk/worldservice/learningenglish/grammar/pron</a></li><li><a href="http://www.howjsay.com" target="_blank" rel="noopener">www.howjsay.com</a></li><li><a href="http://www.inogolo.com" target="_blank" rel="noopener">www.inogolo.com</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> English </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 每日英语 </tag>
            
            <tag> 学习资源 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RNA速度-RNA velocity是什么</title>
      <link href="/2019/11/01/RNA%E9%80%9F%E5%BA%A6-RNA-velocity%E6%98%AF%E4%BB%80%E4%B9%88/"/>
      <url>/2019/11/01/RNA%E9%80%9F%E5%BA%A6-RNA-velocity%E6%98%AF%E4%BB%80%E4%B9%88/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>通过动态模型评估细胞瞬间状态的RNA速度</p><p><strong>文章信息</strong></p><p>题目：Generalizing RNA velocity to transient cell states through dynamical modeling</p><p>杂志：bioRxiv</p><p>时间：Oct. 29,2019</p><p>链接: <a href="http://dx.doi.org/10.1101/820936" target="_blank" rel="noopener">http://dx.doi.org/10.1101/820936</a>.</p><p><strong>figure</strong></p><p>下图是作者利用该方法对胰腺内分泌发育构建的动态图谱</p><p><img src="/2019/11/01/RNA速度-RNA-velocity是什么/abstract.png" style="zoom:67%;"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>这篇文章介绍了利用一个新的模型—<strong>动态模型</strong>对细胞瞬间态的<strong>RNA速度（RNA velocity）</strong>进行评估计算。关键词动态模型和RNA速度，这里对动态模型的算法和实现过程暂不详细解释，主要了解<strong>RNA速度</strong>的概念和应用以及这篇文章中开发的方法的优点。</p><ul><li><strong>RNA velocity的概念</strong></li></ul><p><strong>RNA velocity, 我直译为RNA速度</strong>，这一概念是18年由瑞典卡罗林斯卡医学院的Sten Linnarsson和 Peter V. Kharchenko两个实验室提出的，相关研究成果发表Nature(<em>2018, August, Nature</em>)。RNA丰度是单个细胞状态的一个有力指标。单细胞测序技术可以灵敏、准确地揭示RNA的丰度。然而，这种方法仅能捕获在某个时间点的静态快照，使得分析随着时间动态变化的现象面临挑战（如胚胎发生或组织再生）。这里他们提出的<strong>RNA速度（RNA velocity）—可以理解为通过对unspliced(nascent) 和spliced(mature) mRNA丰度的评估在时间维度上揭示转录本动态变化的一个指标。</strong></p><ul><li><strong>RNA velocity应用</strong></li></ul><p>RNA velocity是一个转录本动态变化的指标，能预测细胞未来的状态变化。可以用于细胞分化、谱系发育、肿瘤微环境中细胞成分的动态变化等研究。张泽民老师实验室刚发表的肝癌免疫图谱的文章中就有通过RNA velocity的分析揭示肿瘤微环境中巨噬细胞的迁移(<em>2019,October,Cell</em>) （张老师实验室用的是Scanpy方法分析的RNA velocity）。</p><ul><li><strong>scVelo</strong>—以动态模型对细胞瞬间态的<strong>RNA velocity</strong>进行评估计算的方法</li></ul><p>回到这篇文章，作者认为现有的计算RNA velocity的模型在一些情况下存在不足，他称这种模型为<strong>稳态模型(steady-state model)</strong>, 这种模型有个两个基本的假设：即（i）在基因水平上，所有具有转录诱导、抑制和稳态mRNA水平的完整剪接动力学被捕捉到；（ii）在细胞水平上，所有基因具有共同的剪接率。但是，当一个种群包含多个具有不同动力学的异质亚种群时，这些假设常常被违背。</p><p>所以，他们开发的seVelo，一个基于<strong>似然的动力学模型(likelihood-based dynamical model)</strong>，它解决了以上提出的全基因转录动力学的问题，从而将RNA速度估计推广到瞬态系统和具有非均匀亚种群动力学的系统。scVelo提供了两种扩展：一种是包含二阶矩的随机模型，另一种是捕获全剪接动力学的动力学模型。与scanpy也兼容。</p><p>网址：scVelo: <a href="https://scvelo.org" target="_blank" rel="noopener">https://scvelo.org</a></p><p><strong>碎碎念</strong></p><p>评估科学研究的重要性通常有3方面：新的概念、新的方法、新的发现。18年Nature的那篇文章是提出了新的概念，这篇文章是开发了新的方法，我们还可以应用新的概念和新的方法，为自己关注的领域带来新的发现。</p><blockquote><p><strong>相关文献：</strong></p><ul><li>2018, August, Nature, RNA velocity of single cells：DOI: 10.1038/s41586-018-0414-6</li><li>2019, October,Cell,Landscape and Dynamics of Single Immune Cells in Hepatocellular Carcinoma. <a href="https://doi.org/10.1016/j.cell.2019.10.003" target="_blank" rel="noopener">https://doi.org/10.1016/j.cell.2019.10.003</a>. </li></ul></blockquote><blockquote><p>每日文献摘要：第14篇 2019年11月01日 周五</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> 文献摘要 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>人类红细胞生成过程中的转录组和表观图谱</title>
      <link href="/2019/10/28/%E4%BA%BA%E7%B1%BB%E7%BA%A2%E7%BB%86%E8%83%9E%E7%94%9F%E6%88%90%E8%BF%87%E7%A8%8B%E4%B8%AD%E7%9A%84%E8%BD%AC%E5%BD%95%E7%BB%84%E5%92%8C%E8%A1%A8%E8%A7%82%E5%9B%BE%E8%B0%B1/"/>
      <url>/2019/10/28/%E4%BA%BA%E7%B1%BB%E7%BA%A2%E7%BB%86%E8%83%9E%E7%94%9F%E6%88%90%E8%BF%87%E7%A8%8B%E4%B8%AD%E7%9A%84%E8%BD%AC%E5%BD%95%E7%BB%84%E5%92%8C%E8%A1%A8%E8%A7%82%E5%9B%BE%E8%B0%B1/</url>
      
        <content type="html"><![CDATA[<p>十月最后的一天，这一年还有两个月就又结束了。</p><p>对于小孩来说两三个月可能如两三年一样长，对于长大的人来说两三年就如两三天一样快。</p><p><img src="/2019/10/28/人类红细胞生成过程中的转录组和表观图谱/abstract.jpg" style="zoom:50%;"></p><a id="more"></a><p><strong>一句话评价</strong></p><p>ATAC-seq和RNA-seq联合分析策略</p><p><strong>文章信息</strong></p><p>题目：Transcriptional States and Chromatin Accessibility Underlying Human Erythropoiesis</p><p>杂志：Cell Report</p><p>时间：2019 June 11</p><p>链接: DOI: 10.1016/j.celrep.2019.05.046</p><p><strong>figure</strong></p><p><img src="/2019/10/28/人类红细胞生成过程中的转录组和表观图谱/ab.png" style="zoom:50%;"></p><p><strong>文章介绍：</strong></p><p><img src="/2019/10/28/人类红细胞生成过程中的转录组和表观图谱/01-chromatin state transcriptomics erythroisis GWAS.png" alt></p><p><strong>碎碎念</strong></p><p>虽然idea相似，但是这篇文章总体的逻辑更强，或者说写作的连贯性更强与自己。还有就是图做的也漂亮。</p><blockquote><p>每日文献摘要：第13篇 2019年10月31日 周四</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Smart-seq3问世</title>
      <link href="/2019/10/27/Smart-seq3%E9%97%AE%E4%B8%96/"/>
      <url>/2019/10/27/Smart-seq3%E9%97%AE%E4%B8%96/</url>
      
        <content type="html"><![CDATA[<p>单细胞技术发展的如火如荼，实验方法、算法、分析工具不断迭代更新和完善。瑞典Karolinska Institute 的Rickard Sandberg实验室14年发表了Smart-seq和Smart-seq2，是至今较为流行的单细胞实验方法之一，由于其具有全长转录本覆盖度的优点，由此可以用于研究可变剪接、变异、等位基因、转录本亚型等转录后调控。但是由于其通量低，价格较贵，限制了其广泛的推广应用。而10X Genomics的出现，由于通量高，价格低，迅速占领了单细胞技术的大部分市场。</p><p><img src="/2019/10/27/Smart-seq3问世/abstract.jpg" style="zoom:67%;"></p><a id="more"></a><p><strong>Smart-seq3相比Smart-seq2具有什么改进呢？</strong></p><p>最显著的改进特点就是整合了5‘-UMI定量计数的策略，使通量大幅提高。同时还保留Smart-seq2的优点，就是全长转录本的覆盖度。因此，依然在等位基因和转录本亚型层次上具有巨大的应用。</p><p><img src="/2019/10/27/Smart-seq3问世/fig1.png" style="zoom: 67%;"></p><hr><p><strong>一句话评价</strong></p><p>Smart-seq3——等位基因和亚型分辨率的单细胞RNA 计数</p><p><strong>文章信息</strong></p><p>题目：Single-cell RNA counting at allele- and isoform-resolution using Smart-seq3</p><p>杂志：bioRxiv </p><p>时间：Oct. 25, 2019</p><p>链接:  <a href="https://www.biorxiv.org/content/biorxiv/early/2019/10/25/817924.full.pdf" target="_blank" rel="noopener">https://www.biorxiv.org/content/biorxiv/early/2019/10/25/817924.full.pdf</a></p><p><strong>figure</strong></p><p><img src="/2019/10/27/Smart-seq3问世/fig2.png" style="zoom:50%;"></p><p><strong>文章介绍：</strong></p><p>瑞典Karolinska Institute 的Rickard Sandberg实验室于10月25日在bioRxiv上发表了Smart-seq3，在等位基因和转录本亚型的研究中具有独特的优点。为大家熟知的Smart-seq2也是由Rickard实验室开发，具有全长转录本的覆盖度的优点，可以进行等位基因表达谱分析等问题，但是由于通量低，价格昂贵，应用推广也受到一定的限制。Smart-seq3针对Smart-seq2的限制性特点做了改进，依然保留全长转录本覆盖度的优点，同时结合5‘ UMI（unique molecular identifier）的RNA计数策略，与Smart-seq2相比通量显著提高，可以达到每个细胞比Smart-seq2多检测出上千个基因。</p><p>另外与全长转录本测序相比，虽然长read测序技术可以直接定量等位基因和亚型的表达水平，但是测序深度阻碍了其大范围应用。而Smart-seq3不仅克服了Smart-seq2的缺点，也克服了长读长测序的缺点，采用灵敏的短读长测序、整合5‘UMI和全长转录本覆盖度的优点，可以在单细胞层面上检测等位基因和亚型的变化，通量显著提高，且价格合理（一个测序细胞文库成本约为0.5-1欧元），可以在普通的分子实验室实现该protocol (dx.doi.org/10.17504/protocols.io.7dnhi5e), 不需要特殊的设备。</p><p>期待其他实验室对该方法的尝试和验证，预测该方法在转录后调控研究中将有巨大潜在的应用。</p><blockquote><p>每日文献摘要：第12篇 2019年10月27日 周日</p><p>捧一杯咖啡，听着咖啡屋淡淡的音乐，打开电脑，专注工作～时光静好</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> transciptomics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> scRNA-seq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基因组结构变异</title>
      <link href="/2019/10/26/%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%BB%93%E6%9E%84%E5%8F%98%E5%BC%82/"/>
      <url>/2019/10/26/%E5%9F%BA%E5%9B%A0%E7%BB%84%E7%BB%93%E6%9E%84%E5%8F%98%E5%BC%82/</url>
      
        <content type="html"><![CDATA[<h3 id="基因组变异"><a href="#基因组变异" class="headerlink" title="基因组变异"></a>基因组变异</h3><p>这里重温下基因组变异的知识，尤其是结构变异的知识点：</p><blockquote><ul><li>单碱基变异，即单核苷酸多态性(SNP)，最常见也最简单的一种基因组变异形式；</li><li>很短的Insertion 和 Deletion，也常被我们合并起来称为Indel。主要指在基因组某个位置上发生较短长度的<strong>线性片段</strong>插入或者删除的现象。强调<strong>线性</strong>的原因是，这里的插入和删除是<strong>有前后顺序的</strong>与下述的结构性变异不同。Indel长度通常在50bp以下，更多时候甚至是不超过10bp，这个长度范围内的序列变化可以通过Smith-Waterman 的局部比对算法来<strong>准确</strong>获得，并且也能够在目前短读长的测序数据中较好地检测出来</li><li>基因组结构性变异**（Structure Variantions，简称SVs），这篇文章的重点，通常就是指基因组上大长度的序列变化和位置关系变化。类型很多，包括长度在50bp以上的长片段序列插入或者删除（Big Indel）、串联重复（Tandem repeate）、染色体倒位（Inversion）、染色体内部或染色体之间的序列易位（Translocation）、拷贝数变异（CNV）以及形式更为复杂的嵌合性变异。</li></ul></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程</title>
      <link href="/2019/10/26/%E5%88%A9%E7%94%A8%E5%89%8D%E5%88%97%E8%85%BA%E7%99%8C%E6%97%A9%E6%9C%9F%E7%9A%84%E5%88%86%E5%AD%90%E8%BF%9B%E5%8C%96%E7%89%B9%E5%BE%81%E9%89%B4%E5%AE%9A%E5%89%8D%E5%88%97%E8%85%BA%E7%99%8C%E7%9A%84%E9%A3%8E%E9%99%A9%E6%A0%87%E5%BF%97%E7%89%A9%E5%92%8C%E4%B8%B4%E5%BA%8A%E5%8F%91%E5%B1%95%E8%BF%87%E7%A8%8B/"/>
      <url>/2019/10/26/%E5%88%A9%E7%94%A8%E5%89%8D%E5%88%97%E8%85%BA%E7%99%8C%E6%97%A9%E6%9C%9F%E7%9A%84%E5%88%86%E5%AD%90%E8%BF%9B%E5%8C%96%E7%89%B9%E5%BE%81%E9%89%B4%E5%AE%9A%E5%89%8D%E5%88%97%E8%85%BA%E7%99%8C%E7%9A%84%E9%A3%8E%E9%99%A9%E6%A0%87%E5%BF%97%E7%89%A9%E5%92%8C%E4%B8%B4%E5%BA%8A%E5%8F%91%E5%B1%95%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>肿瘤的分子进化特征为肿瘤的早期诊断提供参考</p><p><strong>文章信息</strong></p><p>题目：Molecular Evolution of Early-Onset Prostate Cancer Identifies Molecular Risk Markers and Clinical Trajectories</p><p>杂志：Cancer Cell</p><p>时间：December 10, 2018</p><p>链接: <a href="https://doi.org/10.1016/j.ccell.2018.10.016" target="_blank" rel="noopener">https://doi.org/10.1016/j.ccell.2018.10.016</a></p><p><strong>figure</strong></p><p><img src="/2019/10/26/利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程/abstract.png" style="zoom:50%;"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>这篇文章发表于2018年12月，由丹麦哥本哈根大学和德国海德堡大学主导完成，文章利用前列腺癌早期的分子进化特征鉴定前列腺癌不同等级风险的标志物和临床发展轨迹，主要结果包括4个方面：</p><ul><li>APOBEC3的类时钟（clock-like）突变过程介导了前列腺癌（Prostate Cancer，PC）的早期突变</li><li>鉴定出能够区分中等危险疾病（intermediate-risk）的四个分子亚群</li><li><em>ESRP1</em>位点的重排与癌症的侵袭性和增殖性相关</li><li>开发了利用DNA测序数据预测PC临床轨迹的方法</li></ul><p>文中用到的数据包括WGS，450K 甲基化以及RNA-seq共292个前列腺癌样本，当然不同数据类型的样本并不是一一对应的，另外还用到了公共的Hi-C数据（具体数据来源在文中还没有找到）。</p><blockquote><p>注：EOPC(early-onset PC): 早期前列腺癌； LOPC(late-onset PC): 晚期前列腺癌</p></blockquote><table><thead><tr><th>数据类型</th><th>EOPC 样本数</th><th>LOPC样本数</th></tr></thead><tbody><tr><td>WGS</td><td>184</td><td>85</td></tr><tr><td>Methylomes(450K)</td><td>203</td><td>45</td></tr><tr><td>mRNA-seq</td><td>96</td><td></td></tr><tr><td>Hi-C data</td><td></td></tr></tbody></table><h3 id="作者利用这些数据进行了什么分析呢"><a href="#作者利用这些数据进行了什么分析呢" class="headerlink" title="作者利用这些数据进行了什么分析呢"></a>作者利用这些数据进行了什么分析呢</h3><h4 id="首先鉴定EOPC的体细胞突变模式"><a href="#首先鉴定EOPC的体细胞突变模式" class="headerlink" title="首先鉴定EOPC的体细胞突变模式"></a>首先鉴定EOPC的体细胞突变模式</h4><p><strong>通过somatic和germline的call变异流程，分析SNVs、InDels和SVs。</strong> 从SNVs的结果来看，与以前研究的结果一致，前列腺癌的SNVs非常低；EOPC与LOPC相比，EOPC的SNVs数量低于LOPC(平均每M b的SNVs数量，EOPC=0.47,LOPC=0.53)，其中EOPC中<em>TP53</em>的变异率最高。SVs是前列腺癌出现频率较高的变异，SVs常与PC中肿瘤抑制基因的反复融合的形成或丢失有关。基于此作者鉴定了<strong>复发性基因组变异位点（recurrent genomic altered loci ，RGA)</strong>，结果揭示70%的EOPC携带的SV与ETS融合基因的形成有关，EOPC中第二、三易变异的位点分别是8号染色体的<em>NKX3-1</em>和3号染色体的<em>FOXP1</em>基因附近。为了鉴定RGAs与年龄的关系（即RGAs与前列腺癌发展的早期阶段和晚期阶段的关联），作者继续对LOPC做了对应的基因组变异分析，结果显示LOPC中RGAs的整体比例高于EOPC，另外EOPC中展现出较高的单克隆结构，表明EOPC可能主要与克隆起源有关。</p><p><strong>肿瘤发展的过程常伴随这表观结构的变异，如DNA双链的开放和紧密压缩状态的改变。</strong>实验室之前的研究发现EOPC基因组中<strong>断裂点(breakpoits)</strong>常出现在雄性激素受体结合位点(AR-binding sites)附近，这增加了年龄相关的染色质状态改变影响断点发生的可能性。因此，他们整合公共的Hi-C数据检测与特定染色质区域相关的EOPC基因组断裂点，发现断裂点与染色质loop和H3K27ac peaks的数量显著相关。表明EOPC的断裂点主要出现在染色质开放区域，与活性元件相关；LOPC断裂点主要出现在异染色质区域。</p><p><img src="/2019/10/26/利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程/fig1.png" style="zoom:50%;"></p><blockquote><p><strong>小结：</strong>这一部分主要利用基因组数据分析前列腺癌早期和晚期的变异特征（SNVs,InDels和SVs）。展示了EOPC和LOPC中断裂点的不同的分布特征，以及与染色质状态的变化。</p></blockquote><blockquote><p><strong>疑问：</strong>有两个概念不怎么理解，一个是RGA，一个是breakpoints，而这两个概念又是这篇文中分析的重点内容。</p></blockquote><blockquote><ul><li>RGAs(recurrent genomic altered loci ): 字面意思<em>反复出现的基因组变异位点</em>，文中说SVs常与PC中肿瘤抑制基因的反复融合的形成或丢失有关，基于此作者鉴定了RGAs。RGAs是否是染色质结构变异中的DNA重排呢？与SV以及融合基因有什么关联？如何鉴定RGAs呢？</li><li>Genome Breakpoints：基因组断裂点。B图（瀑布图）中对变异类型的描述中有个break，可能和Genome Breakpoints有关，是一个变异类型？那么和loss, gain，mutation有什么区别呢？查阅资料发现breakpoints结各种结构变异类型分析中的一个概念</li><li>另外文中说做了germline和somatic的call变异，但只提供了WGS数据，为什么没有WES数据？只用WGS进行的somatic variants的分析吗？</li></ul></blockquote><h4 id="DNA重排分析"><a href="#DNA重排分析" class="headerlink" title="DNA重排分析"></a>DNA重排分析</h4><p><strong>DNA重排是结构变异的一个形式。作者鉴定到EOPC中有两个RGAs位于13q22和8q22。</strong> 13q22的最小重叠峰区域以KLF5为中心，以往的研究表明KLF5编码一个参与抑制细胞增殖的转录激活因子, 13q22的丢失与KLF5 mRNA水平的降低以及SV和SNV负荷的整体增加有关。该研究发现KLF5与<em>SPOP</em>（有一个鼠的胚胎干细胞研究中发现<em>SPOP</em>是KLF5的一个靶基因，是一个泛素连接酶基因） mRNA表达水平呈正相关关系，但是与<em>SPOP</em>的突变无关。</p><p>8q22处的一个区域显示以<em>ESRP1</em>为中心的反复基因组复制，最小重叠峰区域在<em>MYC</em>附近。这些重复与<em>ESRP1</em>和<em>MYC</em>都有重叠，但只有<em>ESRP1</em>在PC样本中显示出显著的mRNA水平增加。此外，<em>ESRP1</em>重排与格里森评分（GS，前列腺癌评估的一个重要指标）升高显著相关。ESRP1蛋白水平的升高与增殖率升高相关。另外发现其可以作为一个独立的预后标志物。</p><blockquote><p><strong>小结：</strong> 根据DNA重排分析，发现ESRP1重排与ESRP1蛋白表达增加、细胞增殖水平升高、GS和肿瘤分期升高有关，并证明ESRP1表达是PC中一个独立的预后生物标记物。</p></blockquote><blockquote><p><strong>基因组变异的背景知识</strong></p><ul><li>单碱基变异，即单核苷酸多态性(SNP)，最常见也最简单的一种基因组变异形式；</li><li>很短的Insertion 和 Deletion，也常被我们合并起来称为Indel。主要指在基因组某个位置上发生较短长度的<strong>线性片段</strong>插入或者删除的现象。强调<strong>线性</strong>的原因是，这里的插入和删除是<strong>有前后顺序的</strong>与下述的结构性变异不同。Indel长度通常在50bp以下，更多时候甚至是不超过10bp，这个长度范围内的序列变化可以通过Smith-Waterman 的局部比对算法来<strong>准确</strong>获得，并且也能够在目前短读长的测序数据中较好地检测出来</li><li><strong>基因组结构性变异</strong>（Structure Variantions，简称SVs），这篇文章的重点，通常就是指基因组上大长度的序列变化和位置关系变化。类型很多，包括长度在50bp以上的长片段序列插入或者删除（Big Indel）、串联重复（Tandem repeate）、染色体倒位（Inversion）、染色体内部或染色体之间的序列易位（Translocation）、拷贝数变异（CNV）以及形式更为复杂的嵌合性变异。</li></ul><p><strong>参考来源</strong>：碱基矿工黄树嘉老师的文章—<a href="https://zhuanlan.zhihu.com/p/40290546" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/40290546</a></p><p><strong>经典的SVs综述：</strong></p><ul><li>Alkan, C., Coe, B. P. &amp; Eichler, E. E. Genome structural variation discovery and genotyping. <em>Nature reviews. Genetics**</em>12**, 363–76.</li></ul></blockquote><p><img src="/2019/10/26/利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程/fig2.png" style="zoom:50%;"></p><h4 id="突变特征（mutational-signature-分析"><a href="#突变特征（mutational-signature-分析" class="headerlink" title="突变特征（mutational signature)分析"></a>突变特征（mutational signature)分析</h4><p><strong>突变信号(mutational signature)可以用来描述作用于肿瘤细胞的内源性和外源性介导的突变过程。</strong>通过突变特征的分析发现APOBEC3的类时钟（clock-like）突变过程介导了PC的早期突变，APOBEC3蛋白是一种胞苷脱氨酶，在单链DNA复制周期中起到限制反转录因子的作用，但也可以诱导癌症基因组的突变。</p><p><img src="/2019/10/26/利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程/fig3.png" style="zoom:50%;"></p><blockquote><p><strong>背景知识</strong></p><p><strong>mutaional signature: </strong> 下文内容来自：作者-ksxg ，公众号BioKSXG，文章题目：看文献，详解Mutational signatures（突变指标/签名/特征）</p><p>不同的体细胞突变过程会产生各种结果，不同的突变过程产生突变类型的独特组合,称为“Mutational Signatures”。截止到2018年已经有30种定义的Mutational Signatures：</p><table><thead><tr><th style="text-align:left">Signature</th><th style="text-align:left">涉及的癌症种类</th><th style="text-align:left">病因学</th><th style="text-align:left">额外的突变特征</th><th style="text-align:left">Comments</th></tr></thead><tbody><tr><td style="text-align:left">1</td><td style="text-align:left">所有癌症，大部分样品</td><td style="text-align:left">5-甲基胞嘧啶脱氨基作用自发的内源性突变过程导致</td><td style="text-align:left">小数量的小插入和在大多数组织类型的删除</td><td style="text-align:left">与诊断年龄相关</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">主要在子宫癌和膀胱癌</td><td style="text-align:left">AID/APOBEC家族的胞嘧啶核苷脱氨酶的活动</td><td style="text-align:left">观察到外显子中转录链偏差的突变,但是在内含子中不存在或者较弱</td><td style="text-align:left">2和13常在同一样本中被鉴定出，常伴随kataegis突变机制</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">乳腺癌、卵巢癌、胰腺癌</td><td style="text-align:left">通过同源重组的DNA双链断裂修复</td><td style="text-align:left">断点连接中活跃的大片段（大于3bp）插入和删除，伴随着重叠的微同源序列</td><td style="text-align:left">乳腺癌、胰腺癌和卵巢癌中生殖系和体细胞的BRCA1和BRCA2突变，特别是胰腺癌中铂疗法</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left">头颈癌、肝癌、肺腺癌、肺鳞癌、小细胞肺癌、食道癌</td><td style="text-align:left">吸烟相关，烟草诱变剂</td><td style="text-align:left">偏向C &gt;A突变,也与CC &gt; AA二核苷酸替换相关</td><td style="text-align:left">29也与烟草咀嚼相关癌症有关，但是与4不同</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left">所有癌症，大部分样品</td><td style="text-align:left">未知</td><td style="text-align:left">T &gt; C替换（ApTpN）</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">6</td><td style="text-align:left">17种癌症，但主要在结直肠和子宫癌症</td><td style="text-align:left">DNA错配修复缺陷和微卫星不稳定的肿瘤</td><td style="text-align:left">单核/多核苷酸重复中活跃的小片段（小于3bp）的插入和删除</td><td style="text-align:left">4和15、20、26属于DNA错配修复缺陷相关的四大mutational signature</td></tr><tr><td style="text-align:left">7</td><td style="text-align:left">皮肤癌,头部和口腔鳞状上皮癌</td><td style="text-align:left">紫外线暴露</td><td style="text-align:left">大量的CC &gt; TT二核苷酸突变，被转录的核苷酸切除修复嘧啶突变</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">8</td><td style="text-align:left">乳腺癌和成神经管细胞瘤</td><td style="text-align:left">微弱的C &gt;A替换,与双核苷酸替换,尤其是CC &gt; AA相关</td><td style="text-align:left">未知</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">9</td><td style="text-align:left">慢性淋巴细胞白血病和恶性B细胞淋巴瘤</td><td style="text-align:left">聚合酶η引起的突变模式，涉及体细胞超突变的活动</td><td style="text-align:left">未知</td><td style="text-align:left">9中，与那些没有超突变的免疫球蛋白基因相比，具有免疫球蛋白基因超突变(IGHV-mutated)的慢性淋巴细胞白血病有大量突变</td></tr><tr><td style="text-align:left">10</td><td style="text-align:left">六种癌症,尤其是肠癌和子宫癌,通常会在一小部分样品中产生大量的突变</td><td style="text-align:left">容易出错的聚合酶极的活动，10中有大量的复发性杆体细胞突变,即Pro286Arg Val411Leu</td><td style="text-align:left">C &gt;A突变(TpCpT)和T &gt; G突变(TpTpT)</td><td style="text-align:left">与大部分突变的癌症样本相关，这个mutational signature定义为ultra-hypermutators（超-超突变子？不懂）</td></tr><tr><td style="text-align:left">11</td><td style="text-align:left">黑色素瘤和胶质母细胞瘤</td><td style="text-align:left">类似于烷化剂的突变模式</td><td style="text-align:left">强烈的C &gt; T替换，能被转录的核苷酸切除有效修复</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">12</td><td style="text-align:left">肝癌</td><td style="text-align:left">未知</td><td style="text-align:left">强烈的T &gt; C替换</td><td style="text-align:left">12在肝癌样本中突变率较小（&lt;20%）</td></tr><tr><td style="text-align:left">13</td><td style="text-align:left">22种癌症中，常见于宫颈和膀胱癌</td><td style="text-align:left">AID/ APOBEC家族的胞嘧啶核苷脱氨酶将胞嘧啶转化为尿嘧啶活动引起的，尤其是APOBEC1, APOBEC3A 和/或者 APOBEC3B，13导致显著的C &gt; G突变</td><td style="text-align:left">观察到外显子中转录链偏差的突变,但是在内含子中不存在或者较弱</td><td style="text-align:left">经常和2在同一样品中被鉴定出，病毒感染、逆转录转座子跳跃或组织炎症引起的AID/ APOBEC胞嘧啶核苷脱氨酶激活，常伴随kataegis突变机制</td></tr><tr><td style="text-align:left">14</td><td style="text-align:left">四种子宫癌症和一种成人轻度神经胶质瘤样本</td><td style="text-align:left">未知</td><td style="text-align:left">未知</td><td style="text-align:left">在所有样本中都有较高的体细胞突变数（每MB大于200个突变）</td></tr><tr><td style="text-align:left">15</td><td style="text-align:left">几种胃癌症和一种小细胞肺癌</td><td style="text-align:left">DNA错配修复缺陷相关</td><td style="text-align:left">单核/多核苷酸重复中活跃的小片段（小于3bp）的插入和删除</td><td style="text-align:left">15和6、20、26属于DNA错配修复缺陷相关的四大mutational signature</td></tr><tr><td style="text-align:left">16</td><td style="text-align:left">肝癌</td><td style="text-align:left">未知</td><td style="text-align:left">强烈的T &gt; C替换</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">17</td><td style="text-align:left">食管肿瘤、乳腺癌、肝癌、肺腺癌,B细胞淋巴瘤、胃癌和黑色素瘤</td><td style="text-align:left">未知</td><td style="text-align:left">未知</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">18</td><td style="text-align:left">神经母细胞瘤。此外还在乳腺癌和胃癌癌被观察到</td><td style="text-align:left">未知</td><td style="text-align:left">未知</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">19</td><td style="text-align:left">只在纤维状细胞的星形细胞瘤</td><td style="text-align:left">未知</td><td style="text-align:left">未知</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">20</td><td style="text-align:left">胃和乳腺癌</td><td style="text-align:left">DNA错配修复缺陷相关</td><td style="text-align:left">单核/多核苷酸重复中活跃的小片段（小于3bp）的插入和删除</td><td style="text-align:left">20和6、15、26属于DNA错配修复缺陷相关的四大mutational signature</td></tr><tr><td style="text-align:left">21</td><td style="text-align:left">只在胃癌</td><td style="text-align:left">未知</td><td style="text-align:left">未知</td><td style="text-align:left">只在来自同一测序中心的四个样本中被发现，与26有一些类似，只在有15和20的样本中被发现，可能与微卫星不稳定的肿瘤相关</td></tr><tr><td style="text-align:left">22</td><td style="text-align:left">肾盂移行细胞癌</td><td style="text-align:left">发现于马兜铃酸癌症样本</td><td style="text-align:left">活跃的T&gt;A突变，表明腺嘌呤损伤被转录的核苷酸切除修复</td><td style="text-align:left">移行细胞癌中突变很高，但在肝癌很低</td></tr><tr><td style="text-align:left">23</td><td style="text-align:left">仅在一例肝癌样品中</td><td style="text-align:left">未知</td><td style="text-align:left">强烈的C &gt; T替换</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">24</td><td style="text-align:left">肝癌的子集</td><td style="text-align:left">黄曲霉毒素暴露</td><td style="text-align:left">活跃的C &gt;A突变，表明鸟嘌呤损伤被转录的核苷酸切除修复</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">25</td><td style="text-align:left">霍奇金淋巴瘤</td><td style="text-align:left">未知</td><td style="text-align:left">活跃的T&gt;A突变</td><td style="text-align:left">仅在何杰金氏细胞系中被鉴定出，没有原发霍奇金淋巴瘤的数据</td></tr><tr><td style="text-align:left">26</td><td style="text-align:left">乳腺癌、宫颈癌、胃癌、子宫癌</td><td style="text-align:left">DNA错配修复缺陷相关</td><td style="text-align:left">单核/多核苷酸重复中活跃的小片段（小于3bp）的插入和删除</td><td style="text-align:left">26和6、15、20属于DNA错配修复缺陷相关的四大mutational signature</td></tr><tr><td style="text-align:left">27</td><td style="text-align:left">肾透明细胞癌的子集</td><td style="text-align:left">未知</td><td style="text-align:left">活跃的T&gt;A突变，断点连接中活跃的大片段（大于3bp）插入和删除，伴随着重叠的微同源序列</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">28</td><td style="text-align:left">胃癌的子集</td><td style="text-align:left">未知</td><td style="text-align:left">未知</td><td style="text-align:left">无</td></tr><tr><td style="text-align:left">29</td><td style="text-align:left">仅在齿龈颊口腔鳞状细胞癌</td><td style="text-align:left">烟草咀嚼习惯相关的样本</td><td style="text-align:left">偏向C &gt;A突变,也与CC &gt; AA二核苷酸替换相关</td><td style="text-align:left">4也与烟草咀嚼相关癌症有关，但是与29不同</td></tr><tr><td style="text-align:left">30</td><td style="text-align:left">乳腺癌一小部分子集</td><td style="text-align:left">未知</td><td style="text-align:left">未知</td><td style="text-align:left">无</td></tr></tbody></table></blockquote><h4 id="肿瘤纯度与甲基化联合分析"><a href="#肿瘤纯度与甲基化联合分析" class="headerlink" title="肿瘤纯度与甲基化联合分析"></a>肿瘤纯度与甲基化联合分析</h4><p>正常人前列腺组织由基底细胞、管腔细胞和基质细胞组成，而PC则失去基底细胞，获得肿瘤特异性管腔（T-管腔）细胞和浸润性免疫细胞。考虑到DNA甲基化图谱是细胞类型（cell type,ct）特异性的，作者试图通过使用可用的参考甲基化图谱来解释甲基化分析中ct组成的差异。为此，他们从良性前列腺增生患者和前列腺癌患者中获取了额外的切除样本，并进行荧光激活细胞分类，以识别前列腺癌中存在的主要ct，这使他们能够识别前列腺癌基因组中每个甲基化位点的ct特征。</p><p>他们发现在高GS肿瘤中，基底细胞和管腔细胞向T管腔细胞和浸润性免疫细胞的反复转移。鉴于T-管腔和免疫细胞含量在鉴别高级别肿瘤中的相关性，他们将此信息合并为前列腺癌肿瘤侵袭性的经纯度调整的表观遗传指数（PEPCI）。他们发现高PEPCI与高pt、高GS和BCR风险增高密切相关。此外，PEPCI能够对中等风险病例进行分层，并且他们在主要LOPC样本的TCGA队列中验证了这一点。最后，我们的PEPCI评分也能够独立预测GS和BCR。</p><p><img src="/2019/10/26/利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程/fig4.png" style="zoom:50%;"></p><blockquote><p>小结：将肿瘤纯度分析与甲基化分析结合分析，提出经纯度调整的表观遗传指数值（PEPCI），证明了PEPCI可以区别不同等级风险PC。</p></blockquote><blockquote><p><strong>需补充的知识：</strong></p><ul><li>肿瘤纯度的分析</li><li>这篇文章提出的PEPCI</li></ul></blockquote><h4 id="整合分析鉴定肿瘤发展的分子亚型"><a href="#整合分析鉴定肿瘤发展的分子亚型" class="headerlink" title="整合分析鉴定肿瘤发展的分子亚型"></a>整合分析鉴定肿瘤发展的分子亚型</h4><p>他们利用CLICK算法对96个病人的mRNA-seq数据进行分析，将共表达基因共分成7个不同的CLICK clusters(CC)。然后整合CC表达谱与ct比例以及PEPCI的信息的综合分析将患者分为四个与预后相关的亚组，其在生物学通路的表达上有明显差异。</p><p><img src="/2019/10/26/利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程/fig5.png" style="zoom:50%;"></p><blockquote><p>需补充的知识：</p><ul><li>CLICK的聚类方法</li></ul></blockquote><h4 id="预测肿瘤演化顺序的计算方法"><a href="#预测肿瘤演化顺序的计算方法" class="headerlink" title="预测肿瘤演化顺序的计算方法"></a>预测肿瘤演化顺序的计算方法</h4><p>他们开发了一种基于条件概率的网络模型PRESCIENT (prediction of sequential changes in the evolution of nascent tumors——预测新生肿瘤演化的顺序变化），用于预测PC和相关临床outcom中体细胞事件的时间序列。</p><p><img src="/2019/10/26/利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程/fig6.png" style="zoom:50%;"></p><blockquote><p>需补充的知识：理解PRESCIENT模型</p></blockquote><p><strong>碎碎念</strong></p><ul><li><p>最后再对这篇文章做一个总结：</p><p>这篇文章通过292个前列腺癌样本的WGS，450K 甲基化以及RNA-seq数据以及公共的Hi-C数据，发现早期前列腺癌的分子进化特征可以鉴定前列腺癌不同等级风险的标志物和临床发展轨迹。1）文中首先利用基因组数据分析前列腺癌早期和晚期的变异特征（包括SNVs,InDels和SVs），展示了EOPC和LOPC中断裂点的不同分布特征，以及与染色质状态的变化。2）由于SVs是前列腺癌出现频率较高的变异，所以文中主要做的是SVs相关的分析。基因组重排的分析主要结果是发现了<em>ESRP1</em>位点的重排与癌症的侵袭性和增殖性相关。3）mutational signature的分析发现APOBEC3的类时钟（clock-like）突变过程介导了前列腺癌（Prostate Cancer，PC）的早期突变。4）将肿瘤纯度分析与甲基化分析结合，提出经纯度调整的表观遗传指数值的方法（PEPCI），证明了PEPCI可以区别不同等级风险PC。5）利用CLICK算法对96个病人的mRNA-seq数据进行共表达基因聚类分析，然后整合细胞纯度分析以及PEPCI的信息，将患者分为四个与预后相关的亚组，其在生物学通路的表达上有明显差异。6）开发了一种基于条件概率的网络模型PRESCIENT (prediction of sequential changes in the evolution of nascent tumors——预测新生肿瘤演化的顺序变化），用于预测PC和相关临床outcom中体细胞事件的时间序列。</p><p>开发的预测新生肿瘤演化顺序的方法——PRESCIENT ：</p><ul><li>PRESCIENT：<a href="https://bitbucket.org/weischenfeldt/prescient/src/master/" target="_blank" rel="noopener">https://bitbucket.org/weischenfeldt/prescient/src/master/</a></li></ul></li></ul><p>总之，这篇文章可以作为对肿瘤分子进化特征与肿瘤早期诊断研究感兴趣的参考，文中涉及的方法和开发的新方法也值得学习。</p><ul><li><p>断断续续花了两天时间才看懂了这篇文章的思路框架，方法部分还没有认真细看。粗略估计看懂这篇cancer cell的文章，包括文章思路和结果以及方法，可能需要一个星期的时间。另外一个对我来说这篇文章难于理解的原因是背景知识的缺乏，如结构变异（SVs）的理解，分析原理和方法，以及肿瘤相关方面的背景知识缺乏，我之前是不知道mutaion signature的，也不知道肿瘤中常见的肿瘤纯度，肿瘤进化等是如何分析的，虽然听说过这几个概念，也常见这样的帖子，但是都没有细看。不过认真看一篇文章，学到的知识点真多，以后再看相关的其他文章就有了背景知识。</p></li><li><p>方法学下次更新</p></li></ul><p>> 每日文献摘要：第11篇 2019年10月26日 周六</p>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tumor evolution </tag>
            
            <tag> prostate cancer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基础常见的条形图</title>
      <link href="/2019/10/24/%E5%9F%BA%E7%A1%80%E5%B8%B8%E8%A7%81%E7%9A%84%E6%9D%A1%E5%BD%A2%E5%9B%BE/"/>
      <url>/2019/10/24/%E5%9F%BA%E7%A1%80%E5%B8%B8%E8%A7%81%E7%9A%84%E6%9D%A1%E5%BD%A2%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<p>今天已进入24节气中的霜降，《二十四节气解》中说：“气肃而霜降，阴始凝也。”可见“霜降”表示天气逐渐变冷，开始降霜。北京的天气也格外应景，从早上就开始淅淅沥沥下雨，呆在屋里，甚至窝在被窝里，都感觉凉凉的。时间过得真快，刚毕业的时候还是三伏天的夏季，转眼又在北京迎来了冬季～</p><p><img src="/2019/10/24/基础常见的条形图/abstract2.jpg" style="zoom:50%"></p><a id="more"></a><p>条形图是常见的一种数据可视化方式，常用于表示类变量（x)对应的数值（y）。这里以ggplot2示例展示如何设置绘制简单的bar plot，如何设置其他图形参数，以及进阶的bar plot示例展示。</p><p><strong>ggplot2中绘制条形图的函数有<code>geom_col()</code>和<code>geom_bar()</code></strong>。</p><h3 id="条形图的填充色，边框色，背景色和背景框线的设置"><a href="#条形图的填充色，边框色，背景色和背景框线的设置" class="headerlink" title="条形图的填充色，边框色，背景色和背景框线的设置"></a>条形图的填充色，边框色，背景色和背景框线的设置</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 简单的条形图 (左图)</span></span><br><span class="line">ggplot(pg_mean, aes(x = group, y = weight)) +</span><br><span class="line">  geom_col()</span><br><span class="line"></span><br><span class="line"><span class="comment">## 条形的填充色，边框，背景色和框线的设置 （右图）</span></span><br><span class="line">ggplot(pg_mean, aes(x = group, y = weight)) +</span><br><span class="line">  geom_col(fill=<span class="string">"lightblue"</span>, colour = <span class="string">"black"</span>) + <span class="comment">#设置条形的填充颜色fill, 边框颜色colour</span></span><br><span class="line">  theme_bw() +  <span class="comment"># 去掉背景颜色                          </span></span><br><span class="line">  theme( panel.grid.major.x = element_blank(),  <span class="comment"># 去掉背景框线</span></span><br><span class="line">         panel.grid.major.y = element_blank()</span><br><span class="line">         )</span><br></pre></td></tr></table></figure><p><img src="/2019/10/24/基础常见的条形图/fig1.png" style="zoom:50%;"></p><h3 id="填充色设置和变量排序"><a href="#填充色设置和变量排序" class="headerlink" title="填充色设置和变量排序"></a>填充色设置和变量排序</h3><p>非默认的填充色设置可以借助<code>scale_fill_brewer()</code> 或 <code>scale_fill_manual()</code>， 对变量的排序:<code>reorder()</code>函数，这里是基于<code>Change</code>的变化对<code>Abb</code>排序。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 输入数据处理</span></span><br><span class="line"><span class="keyword">library</span>(gcookbook) <span class="comment"># Load gcookbook for the uspopchange data set</span></span><br><span class="line"><span class="keyword">library</span>(dplyr)</span><br><span class="line">upc &lt;- uspopchange %&gt;%</span><br><span class="line">  arrange(desc(Change)) %&gt;%</span><br><span class="line">  slice(<span class="number">1</span>:<span class="number">10</span>)</span><br><span class="line"><span class="comment">## fill()函数以Region 因子变量填充bar的颜色</span></span><br><span class="line">ggplot(upc, aes(x = Abb, y = Change, fill = Region)) +</span><br><span class="line">  geom_col()</span><br><span class="line"></span><br><span class="line"><span class="comment">## scale_fill_brewer() or scale_fill_manual()选择其他颜色，reorder对Abb</span></span><br><span class="line">ggplot(upc, aes(x = reorder(Abb, Change), y = Change, fill = Region)) +</span><br><span class="line">  geom_col(colour = <span class="string">"black"</span>) +</span><br><span class="line">  scale_fill_manual(values = c(<span class="string">"#669933"</span>, <span class="string">"#FFCC66"</span>)) +</span><br><span class="line">  xlab(<span class="string">"State"</span>)</span><br></pre></td></tr></table></figure><p><img src="/2019/10/24/基础常见的条形图/fig2.png" alt></p><h3 id="不同颜色表示正负数值的变化"><a href="#不同颜色表示正负数值的变化" class="headerlink" title="不同颜色表示正负数值的变化"></a>不同颜色表示正负数值的变化</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ggplot(climate_sub, aes(x = Year, y = Anomaly10y, fill = pos)) +</span><br><span class="line">  geom_col(position = <span class="string">"identity"</span>, colour = <span class="string">"black"</span>, size = <span class="number">0.25</span>) +   <span class="comment"># 边框线的颜色colour和宽度size</span></span><br><span class="line">  scale_fill_manual(values = c(<span class="string">"#CCEEFF"</span>, <span class="string">"#FFDDDD"</span>), guide = <span class="literal">FALSE</span>) <span class="comment"># scale_fill_manual() 设置颜色， guide = FALSE 去除legend</span></span><br></pre></td></tr></table></figure><p><img src="/2019/10/24/基础常见的条形图/fig3.png" style="zoom: 33%;"></p><h3 id="一对变量，调整bar的宽度和空间"><a href="#一对变量，调整bar的宽度和空间" class="headerlink" title="一对变量，调整bar的宽度和空间"></a>一对变量，调整bar的宽度和空间</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 一对变量水平同时展示 dodge</span></span><br><span class="line">ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) +</span><br><span class="line">  geom_col(position = <span class="string">"dodge"</span>, colour = <span class="string">"black"</span>) + <span class="comment"># dodge 映射要填充的变量</span></span><br><span class="line">  scale_fill_brewer(palette = <span class="string">"Pastel1"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 调整bar width 和 dodge位置，默认是0.9</span></span><br><span class="line">ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) +</span><br><span class="line">  geom_col(width = <span class="number">0.5</span>, colour = <span class="string">"black"</span>,position = position_dodge(<span class="number">0.7</span>)) + </span><br><span class="line">  scale_fill_brewer(palette = <span class="string">"Pastel1"</span>)</span><br></pre></td></tr></table></figure><p><img src="/2019/10/24/基础常见的条形图/fig4.png" style="zoom:50%"></p><h3 id="堆积图"><a href="#堆积图" class="headerlink" title="堆积图"></a>堆积图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## position_stack(reverse = FALSE) 堆积图的顺序调整，guide_legend(reverse = TRUE)：legend顺序调整</span></span><br><span class="line">ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) +</span><br><span class="line">  geom_col(position = position_stack(reverse = <span class="literal">FALSE</span>),colour = <span class="string">"black"</span>) +</span><br><span class="line">  guides(fill = guide_legend(reverse = <span class="literal">TRUE</span>))+</span><br><span class="line">  scale_fill_brewer(palette = <span class="string">"Pastel1"</span>)</span><br><span class="line"><span class="comment">## geom_col(position = "fill") 以比例展示每个类型的堆积，堆积图总分值是1</span></span><br><span class="line">ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) +</span><br><span class="line">  geom_col(position = <span class="string">"fill"</span>,colour = <span class="string">"black"</span>) +</span><br><span class="line">  guides(fill = guide_legend(reverse = <span class="literal">TRUE</span>))+</span><br><span class="line">  scale_fill_brewer(palette = <span class="string">"Pastel1"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## scale_y_continuous(labels = scales::percent) 以百分制表示比例</span></span><br><span class="line">ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) +</span><br><span class="line">  geom_col(colour = <span class="string">"black"</span>, position = <span class="string">"fill"</span>) +</span><br><span class="line">  scale_y_continuous(labels = scales::percent) +</span><br><span class="line">  scale_fill_brewer(palette = <span class="string">"Pastel1"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">## geom_text添加文本</span></span><br><span class="line">ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) +</span><br><span class="line">  geom_col() +</span><br><span class="line">  geom_text(aes(label = Weight), vjust = <span class="number">2</span>)</span><br></pre></td></tr></table></figure><p><img src="/2019/10/24/基础常见的条形图/fig5.png" style="zoom:50%;"></p><h3 id="圈圈图-Dot-plot"><a href="#圈圈图-Dot-plot" class="headerlink" title="圈圈图 Dot plot"></a>圈圈图 Dot plot</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 图1；dot plot: geom_point()</span></span><br><span class="line"><span class="keyword">library</span>(gcookbook) <span class="comment"># Load gcookbook for the tophitters2001 data set</span></span><br><span class="line">tophit &lt;- tophitters2001[<span class="number">1</span>:<span class="number">25</span>, ] <span class="comment"># Take the top 25 from the tophitters data set</span></span><br><span class="line"></span><br><span class="line">ggplot(tophit, aes(x = avg, y = name)) +</span><br><span class="line">  geom_point()</span><br><span class="line"></span><br><span class="line"><span class="comment">## 图2 排序:reorder</span></span><br><span class="line">ggplot(tophit, aes(x = avg, y = reorder(name, avg))) +</span><br><span class="line">  geom_point(size = <span class="number">3</span>) +  <span class="comment"># Use a larger dot</span></span><br><span class="line">  theme_bw() +</span><br><span class="line">  theme(</span><br><span class="line">    panel.grid.major.x = element_blank(),</span><br><span class="line">    panel.grid.minor.x = element_blank(),</span><br><span class="line">    panel.grid.major.y = element_line(colour = <span class="string">"grey60"</span>, linetype = <span class="string">"dashed"</span>)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"><span class="comment">## 图3 置换坐标方向</span></span><br><span class="line">ggplot(tophit, aes(x = reorder(name, avg), y = avg)) +</span><br><span class="line">  geom_point(size = <span class="number">3</span>) +  <span class="comment"># Use a larger dot</span></span><br><span class="line">  theme_bw() +</span><br><span class="line">  theme(</span><br><span class="line">    panel.grid.major.y = element_blank(),</span><br><span class="line">    panel.grid.minor.y = element_blank(),</span><br><span class="line">    panel.grid.major.x = element_line(colour = <span class="string">"grey60"</span>, linetype = <span class="string">"dashed"</span>),</span><br><span class="line">    axis.text.x = element_text(angle = <span class="number">60</span>, hjust = <span class="number">1</span>)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"><span class="comment">## 图4 添加分类颜色</span></span><br><span class="line"><span class="comment"># Get the names, sorted first by lg, then by avg</span></span><br><span class="line">nameorder &lt;- tophit$name[order(tophit$lg, tophit$avg)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Turn name into a factor, with levels in the order of nameorder</span></span><br><span class="line">tophit$name &lt;- factor(tophit$name, levels = nameorder)</span><br><span class="line"></span><br><span class="line">ggplot(tophit, aes(x = avg, y = name)) +</span><br><span class="line">  geom_segment(aes(yend = name), xend = <span class="number">0</span>, colour = <span class="string">"grey50"</span>) +</span><br><span class="line">  geom_point(size = <span class="number">3</span>, aes(colour = lg)) +</span><br><span class="line">  scale_colour_brewer(palette = <span class="string">"Set1"</span>, limits = c(<span class="string">"NL"</span>, <span class="string">"AL"</span>)) +</span><br><span class="line">  theme_bw() +</span><br><span class="line">  theme(</span><br><span class="line">    panel.grid.major.y = element_blank(),   <span class="comment"># No horizontal grid lines</span></span><br><span class="line">    legend.position = c(<span class="number">1</span>, <span class="number">0.55</span>),           <span class="comment"># Put legend inside plot area</span></span><br><span class="line">    legend.justification = c(<span class="number">1</span>, <span class="number">0.5</span>)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line"><span class="comment">## 图5 分面 facet_grid</span></span><br><span class="line">ggplot(tophit, aes(x = avg, y = name)) +</span><br><span class="line">  geom_segment(aes(yend = name), xend = <span class="number">0</span>, colour = <span class="string">"grey50"</span>) +</span><br><span class="line">  geom_point(size = <span class="number">3</span>, aes(colour = lg)) +</span><br><span class="line">  scale_colour_brewer(palette = <span class="string">"Set1"</span>, limits = c(<span class="string">"NL"</span>, <span class="string">"AL"</span>), guide = <span class="literal">FALSE</span>) +</span><br><span class="line">  theme_bw() +</span><br><span class="line">  theme(panel.grid.major.y = element_blank()) +</span><br><span class="line">  facet_grid(lg ~ ., scales = <span class="string">"free_y"</span>, space = <span class="string">"free_y"</span>)</span><br></pre></td></tr></table></figure><p><img src="/2019/10/24/基础常见的条形图/fig6.png" style="zoom: 33%;"></p><p><img src="/2019/10/24/基础常见的条形图/fig7.png" style="zoom: 33%;"></p><p><img src="/2019/10/24/基础常见的条形图/fig8.png" style="zoom: 33%;"></p>]]></content>
      
      
      <categories>
          
          <category> Data Sciences </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R </tag>
            
            <tag> 每日一图 </tag>
            
            <tag> visualization </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>base plot与ggplot2语法比较</title>
      <link href="/2019/10/23/base-plot%E4%B8%8Eggplot2%E8%AF%AD%E6%B3%95%E6%AF%94%E8%BE%83/"/>
      <url>/2019/10/23/base-plot%E4%B8%8Eggplot2%E8%AF%AD%E6%B3%95%E6%AF%94%E8%BE%83/</url>
      
        <content type="html"><![CDATA[<p>通过base plot和ggplot2的简单实例，直接感受下base plot和ggplot2的语法差别。</p><p><img src="/2019/10/23/base-plot与ggplot2语法比较/abstract.png" style="zoom: 33%;"></p><a id="more"></a><h3 id="条形图"><a href="#条形图" class="headerlink" title="条形图"></a>条形图</h3><ul><li><strong>基本绘图</strong></li></ul><p><strong><code>barplot()</code></strong>是基本绘图中绘制条形图的函数，需要一个向量参数指定bar的高度（必须），每个bar的label是可选参数。</p><p><img src style="zoom:30%"></p><p><img src style="zoom:30%"></p><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig1.png" style="zoom:50%"></p><ul><li><strong>ggplot2</strong></li></ul><p>ggplot2中绘制bar plot使用<strong><code>geom_col</code>或<code>geom_bar</code></strong>, 注意这里使用factor将x变量转换为离散变量。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Bar graph of values. This uses the BOD data frame, with the</span></span><br><span class="line"><span class="comment"># "Time" column for x values and the "demand" column for y values.</span></span><br><span class="line">ggplot(BOD, aes(x = Time, y = demand)) +</span><br><span class="line">  geom_col()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert the x variable to a factor, so that it is treated as discrete</span></span><br><span class="line">ggplot(BOD, aes(x = factor(Time), y = demand)) +</span><br><span class="line">  geom_col()</span><br></pre></td></tr></table></figure><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig2.png" style="zoom:50%"></p><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig3.png" style="zoom:50%"></p><h3 id="直方图"><a href="#直方图" class="headerlink" title="直方图"></a>直方图</h3><ul><li><strong>基本绘图</strong></li></ul><p><strong><code>hist</code></strong>是基本绘图中直方图的函数。</p><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig4.png" style="zoom:50%"></p><ul><li><strong>ggplot2</strong></li></ul><p>ggplot2中绘制直方图使用<strong><code>geom_histogram()</code></strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">ggplot(mtcars, aes(x = mpg)) +</span><br><span class="line">  geom_histogram()</span><br><span class="line"><span class="comment">#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># With wider bins</span></span><br><span class="line">ggplot(mtcars, aes(x = mpg)) +</span><br><span class="line">  geom_histogram(binwidth = <span class="number">4</span>)</span><br></pre></td></tr></table></figure><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig5.png" style="zoom:50%"></p><h3 id="箱线图"><a href="#箱线图" class="headerlink" title="箱线图"></a>箱线图</h3><ul><li><strong>基本绘图</strong></li></ul><p>箱线图可以直接用<strong><code>plot()</code></strong>函数（如果x变量是factor，会自动产生bo x plot)， 当然也可以用<strong><code>boxplot()</code></strong>函数。如果想在X轴展示两个变量，也是可以的。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">plot(ToothGrowth$supp, ToothGrowth$len)</span><br><span class="line"><span class="comment"># Formula syntax</span></span><br><span class="line">boxplot(len ~ supp, data = ToothGrowth)</span><br></pre></td></tr></table></figure><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig6.png" style="zoom: 33%;"></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Put interaction of two variables on x-axis</span></span><br><span class="line">boxplot(len ~ supp + dose, data = ToothGrowth)</span><br></pre></td></tr></table></figure><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig7.png" style="zoom: 33%;"></p><ul><li><strong>ggplot2</strong></li></ul><p>ggplot2使用<strong><code>geom_boxplot()</code></strong> 函数，x轴展示两个变量时可以用<strong><code>interaction()</code></strong>函数</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">ggplot(ToothGrowth, aes(x = supp, y = len)) +</span><br><span class="line">  geom_boxplot()</span><br></pre></td></tr></table></figure><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig8.png" style="zoom: 33%;"></p><p><strong>x轴展示两个变量</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ggplot(ToothGrowth, aes(x = interaction(supp, dose), y = len)) +</span><br><span class="line">  geom_boxplot()</span><br></pre></td></tr></table></figure><p><img src="/2019/10/23/base-plot与ggplot2语法比较/fig9.png" style="zoom: 33%;"></p><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul><li><p><strong>条形图、直方图、箱线图的区别</strong></p><p>条形图x和y变量是一对一的关系，绘图时必须传递y变量。直方图是频率分布图，箱线图x变量对应的y变量有多个值。</p></li><li><p>Base plot和ggpplot2的绘图特征</p><p>Base plot直接指定变量参数即可，ggplot2的语法通常包括3个部分，首先是数据框，然后以aes指定参数变量，再加上图形的类型，如geom_boxplot等</p></li><li><p>箱线图展示一对变量的特征</p></li></ul><p>如果用base plot实现，可以直接在x参数变量后加上另一个参数，如果是ggplot2，借助interaction()将一对变量添加。</p><p>个人感觉这里base plot画的图更简单好看。</p>]]></content>
      
      
      <categories>
          
          <category> Data Sciences </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R </tag>
            
            <tag> 每日一图 </tag>
            
            <tag> visualization </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千里之行始于足下_R Basics</title>
      <link href="/2019/10/22/%E5%8D%83%E9%87%8C%E4%B9%8B%E8%A1%8C%E5%A7%8B%E4%BA%8E%E8%B6%B3%E4%B8%8B-R-Basics/"/>
      <url>/2019/10/22/%E5%8D%83%E9%87%8C%E4%B9%8B%E8%A1%8C%E5%A7%8B%E4%BA%8E%E8%B6%B3%E4%B8%8B-R-Basics/</url>
      
        <content type="html"><![CDATA[<p>坚持做一件事很难，总会被最初的意外和后来的惰性扰乱而半路放弃。今天看到几句话，感觉说到心窝里了:</p><p><strong>规律地做一些事情，据说可以增加对生活的掌控感，从而缓解焦虑。</strong></p><p><strong>对时间最好的利用，就是做自己想做的事情，并且全身心的享受每一刻。</strong></p><p><img src="/2019/10/22/千里之行始于足下-R-Basics/abstract.jpg" style="zoom:30%"> </p><a id="more"></a><p>这里就立一个Flag：<strong>每日一图</strong>，每天至少专注的做一件自己喜欢做的想做的事情。</p><p>这里就以<a href="https://mp.weixin.qq.com/s/CX_fwbuyPTelOgaj7852qg" target="_blank" rel="noopener">推荐三本学习R画图的免费好书</a>推荐的第一本书起航吧：<strong>R G raphics Cookbook</strong></p><p>这本书主要基于ggplot2的绘图语法，以及tidyverse的数据清理方法。书中使用的数据和例子整合在<strong>gcookbook</strong></p><h4 id="所以首先安装载入需要的R包"><a href="#所以首先安装载入需要的R包" class="headerlink" title="所以首先安装载入需要的R包"></a>所以首先安装载入需要的R包</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">install.packages(c(<span class="string">"ggplot2"</span>, <span class="string">"gcookbook"</span>, <span class="string">"MASS"</span>, <span class="string">"dplyr"</span>,<span class="string">"tidyverse"</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">library</span>(tidyverse)</span><br><span class="line"><span class="keyword">library</span>(gcookbook)</span><br><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line"><span class="keyword">library</span>(dplyr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># update</span></span><br><span class="line">update.packages()</span><br></pre></td></tr></table></figure><h4 id="base-plot与ggplot2的简单实例对比"><a href="#base-plot与ggplot2的简单实例对比" class="headerlink" title="base plot与ggplot2的简单实例对比"></a>base plot与ggplot2的简单实例对比</h4><p><strong>Scatter plot</strong> </p><p>使用plot函数，仅需传递给plot两个变量：<strong>x, y</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plot(mtcars$wt, mtcars$mpg)</span><br></pre></td></tr></table></figure><p>使用ggplot2, 首先创建一个plot 对象，然后加一个点的图层。ggplot2通常以数据框为画图对象（<code>mtcars</code>)，然后指明哪列是<code>x</code>, 哪列是<code>y</code>。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">ggplot(mtcars, aes(x = wt, y = mpg)) +</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure><p><img src="/2019/10/22/千里之行始于足下-R-Basics/fig1.png" alt></p><p><strong>Line Graph</strong></p><p>Base plot新增line时，第一次以plot函数，第二次lines函数</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 左图</span></span><br><span class="line">plot(pressure$temperature, pressure$pressure, type = <span class="string">"l"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 右图</span></span><br><span class="line">plot(pressure$temperature, pressure$pressure, type = <span class="string">"l"</span>)</span><br><span class="line">points(pressure$temperature, pressure$pressure)</span><br><span class="line"></span><br><span class="line">lines(pressure$temperature, pressure$pressure/<span class="number">2</span>, col = <span class="string">"red"</span>)</span><br><span class="line">points(pressure$temperature, pressure$pressure/<span class="number">2</span>, col = <span class="string">"red"</span>)</span><br></pre></td></tr></table></figure><p><img src="/2019/10/22/千里之行始于足下-R-Basics/fig2.png" alt></p><p>ggplot2对图像的图形的选择需加上geom_line()，或者geom_point()</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 左图</span></span><br><span class="line"><span class="keyword">library</span>(ggplot2)</span><br><span class="line">ggplot(pressure, aes(x = temperature, y = pressure)) +</span><br><span class="line">  geom_line()</span><br><span class="line"><span class="comment"># 右图，加points</span></span><br><span class="line">ggplot(pressure, aes(x = temperature, y = pressure)) +</span><br><span class="line">  geom_line() +</span><br><span class="line">  geom_point()</span><br></pre></td></tr></table></figure><p><img src="/2019/10/22/千里之行始于足下-R-Basics/fig3.png" alt></p>]]></content>
      
      
      <categories>
          
          <category> Data Sciences </category>
          
      </categories>
      
      
        <tags>
            
            <tag> R </tag>
            
            <tag> 每日一图 </tag>
            
            <tag> visualization </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scATAC-seq和深度学习联合揭示2型糖尿病的调控特征</title>
      <link href="/2019/09/28/scATAC-seq%E5%92%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%81%94%E5%90%88%E6%8F%AD%E7%A4%BA2%E5%9E%8B%E7%B3%96%E5%B0%BF%E7%97%85%E7%9A%84%E8%B0%83%E6%8E%A7%E7%89%B9%E5%BE%81/"/>
      <url>/2019/09/28/scATAC-seq%E5%92%8C%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E8%81%94%E5%90%88%E6%8F%AD%E7%A4%BA2%E5%9E%8B%E7%B3%96%E5%B0%BF%E7%97%85%E7%9A%84%E8%B0%83%E6%8E%A7%E7%89%B9%E5%BE%81/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>scATAC-seq和深度学习联合揭示2型糖尿病的调控特征</p><p><strong>文章信息</strong></p><p>题目：Single cell ATAC-seq in human pancreatic islets and deep learning upscaling of rare cells reveals cell-specific type 2 diabetes regulatory signature</p><p>杂志：bioRxiv</p><p>时间：Sep. 7, 2019</p><p>链接: DOI: <a href="http://dx.doi.org/10.1101/749283" target="_blank" rel="noopener">http://dx.doi.org/10.1101/749283</a></p><p><strong>figure</strong></p><p><img src="/2019/09/28/scATAC-seq和深度学习联合揭示2型糖尿病的调控特征/abstrat-fig.png" style="zoom:50%"> </p><a id="more"></a><p><strong>文章介绍：</strong></p><p>II型糖尿病(T2D)是一种以胰岛功能障碍、胰岛素抵抗和血糖紊乱为特征的复杂疾病。全基因组关联研究（GWAS）已经鉴定出超过400个编码遗传倾向的独立信号。超过90%相关的单核苷酸多态性（SNP）定位于非编码区，并富集在染色质定义的胰岛增强子元件中。另外胰岛包含不同的细胞类型，每种细胞类型都有可能参与T2D的转录调控，bulk-seq的方法会掩盖了细胞异质性的特点。所以这里文章采取sci-ATAC-seq (single-cell-combinatorial-indexing ATAC-seq) 的方法，观察到α、β和δ细胞群并识别T2D的细胞特异性的调控信号；另外，他们发现T2D GWAS SNPs显著富集在β细胞，和α或δ细胞与其他细胞类型跨细胞型差异的开放染色质。此外，他们基于U-Net架构还开发了一个深度学习模型用于准确地预测在稀有细胞群体中的开放染色质峰值。</p><p>深度学习的代码： <a href="https://github.com/ParkerLab/PillowNet" target="_blank" rel="noopener">https://github.com/ParkerLab/PillowNet</a>. </p><p>其他代码在：<a href="https://github.com/ParkerLab/islet_sci-ATAC-seq_2019" target="_blank" rel="noopener">https://github.com/ParkerLab/islet_sci-ATAC-seq_2019</a></p><p><strong>碎碎念</strong></p><p>这篇文章结合scATAC-seq和深度学习的方法探究疾病的转录调控特征的思路和以及文章用到的方法值得学习。</p><blockquote><p>每日文献摘要：第10篇 2019年09月28日 周六</p><p>持久确实是一件不易的事！</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文献摘要 </tag>
            
            <tag> scATACseq </tag>
            
            <tag> deep learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scRNA-seq构建表达矩阵</title>
      <link href="/2019/09/27/scRNA-seq%E6%9E%84%E5%BB%BA%E8%A1%A8%E8%BE%BE%E7%9F%A9%E9%98%B5/"/>
      <url>/2019/09/27/scRNA-seq%E6%9E%84%E5%BB%BA%E8%A1%A8%E8%BE%BE%E7%9F%A9%E9%98%B5/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> scRNA-seq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>蛋白质体外液液相分离数据库</title>
      <link href="/2019/09/26/%E8%9B%8B%E7%99%BD%E8%B4%A8%E4%BD%93%E5%A4%96%E6%B6%B2%E6%B6%B2%E7%9B%B8%E5%88%86%E7%A6%BB%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
      <url>/2019/09/26/%E8%9B%8B%E7%99%BD%E8%B4%A8%E4%BD%93%E5%A4%96%E6%B6%B2%E6%B6%B2%E7%9B%B8%E5%88%86%E7%A6%BB%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>蛋白质体外液液相分离数据库—— LLPSDB</p><p><strong>文章信息</strong></p><p>题目：LLPSDB: a database of proteins undergoing liquid–liquid phase separation in vitro</p><p>杂志：Nucleic Acids Research</p><p>时间：August 28, 2019</p><p>链接: DOI: 10.1093/nar/gkz778</p><p><strong>figure</strong></p><p><img src="/2019/09/26/蛋白质体外液液相分离数据库/fig1.png" style="zoom:50%"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>之前分享过一篇文章 <a href="https://www.jianshu.com/p/74bda9d18b35" target="_blank" rel="noopener">火起来的相分离是什么</a>, </p><blockquote><p>相分离/相变（Phase separation）描述的是一种细胞里不同成分间相互碰撞、融合形成液滴，从而使一些成分被包裹在液滴内，一些成分被阻隔在液滴外的现象，类似于水油相混，或者可以想象成下雨天伞上的雨滴逐渐滴落的过程。这种现象在液体之间是常见的，但是，2009年，Brangwynne和Hyman关于线虫P颗粒的研究，发现P颗粒（一种蛋白质）并非像我们通常认为的是一种固体，而是像液滴一样，相互碰撞融合，剧烈摇晃后会分散成很小的液滴，而后又很快地融合形成大液滴。之后科学家发现细胞内的许多无膜细胞器——核仁、Cajal bodies、stress granules、miRISC，及突触的细胞骨架——都是特定的蛋白质/RNA的相变。</p></blockquote><blockquote><p>相分离/相变（Phase separation，Phase Transition）是目前比较火的一个研究领域，已有的研究表明相分离在细胞中普遍存在，与基因组的组装、转录调控可能密切相关，相分离的失调可能是一些疾病（如神经/肌肉退行性疾病）发生的病因，相关领域的科学家也开始通过相分离这个视角重新审视相关疾病，通过干扰异常“相分离”来达到治疗相关疾病的目的。</p></blockquote><p>刚刚明白过相分离是什么，这里已经有人整理出了液液相分离体外蛋白质数据库（(LLPS,Liquid-liquid phase separation)——<a href="http://bio-comp. ucas.ac.cn/llpsdb" target="_blank" rel="noopener"> <strong>LLPSDB </strong></a> </p><p>该数据库提供全面、精心收集的与LLPS有关的蛋白质，以及相应的体外实验条件。<strong>LLPSDB </strong> 目前开放的版本包含<strong>1182个条目，273个独立蛋白和2394个特定条件</strong>。数据库提供多种数据，包括生物分子信息（蛋白质序列、蛋白质修饰、核酸等）、特定相分离信息（实验条件、相行为描述等）和综合注释。<strong>LLPSDB </strong> 是第一个专门为LLPS相关蛋白设计的数据库。它为探索蛋白质序列与相变行为之间的关系提供了大量有价值的资源，并将促进相分离预处理方法的发展，为进一步全面了解LLPS在细胞功能中的作用以及相关疾病提供更多的视角。</p><p><strong>LLPSDB网址</strong>:</p><ul><li><a href="http://bio-comp.ucas.ac.cn/llpsdb" target="_blank" rel="noopener">http://bio-comp.ucas.ac.cn/llpsdb</a></li><li><a href="http://bio-comp.org.cn/llpsdb" target="_blank" rel="noopener">http://bio-comp.org.cn/llpsdb</a></li></ul><blockquote><p>每日文献摘要：第9篇 2019年09月27日 周五</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> database </tag>
            
            <tag> 相分离 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>摘要-单细胞多组学揭示混合表型急性白血病的恶性调控特征</title>
      <link href="/2019/09/26/%E6%91%98%E8%A6%81-%E5%8D%95%E7%BB%86%E8%83%9E%E5%A4%9A%E7%BB%84%E5%AD%A6%E6%8F%AD%E7%A4%BA%E6%B7%B7%E5%90%88%E8%A1%A8%E5%9E%8B%E6%80%A5%E6%80%A7%E7%99%BD%E8%A1%80%E7%97%85%E7%9A%84%E6%81%B6%E6%80%A7%E8%B0%83%E6%8E%A7%E7%89%B9%E5%BE%81/"/>
      <url>/2019/09/26/%E6%91%98%E8%A6%81-%E5%8D%95%E7%BB%86%E8%83%9E%E5%A4%9A%E7%BB%84%E5%AD%A6%E6%8F%AD%E7%A4%BA%E6%B7%B7%E5%90%88%E8%A1%A8%E5%9E%8B%E6%80%A5%E6%80%A7%E7%99%BD%E8%A1%80%E7%97%85%E7%9A%84%E6%81%B6%E6%80%A7%E8%B0%83%E6%8E%A7%E7%89%B9%E5%BE%81/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>单细胞多组学联合分析急性白血病的恶性调控特征</p><p><strong>文章信息</strong></p><p>题目：A single cell framework for multi-omic analysis of disease identifies malignant regulatory signatures in mixed phenotype acute leukemia</p><p>杂志：bioRxiv</p><p>时间：Jul. 9, 2019</p><p>链接: DOI: <a href="http://dx.doi.org/10.1101/696328" target="_blank" rel="noopener">http://dx.doi.org/10.1101/696328</a></p><p><strong>figure</strong></p><p><img src="/2019/09/26/摘要-单细胞多组学揭示混合表型急性白血病的恶性调控特征/fig-abstract.png" style="zoom:50%"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>单细胞转录组和表观组的整合方法示例，通过比较正常样本和疾病样本转录组和表观组的差异，鉴定调控疾病发生特征。这里以混合表型急性白血病（mixed phenotype acute leukemia，MPAL)为例。首先从健康的外周血和骨髓单个核细胞建立造血发育的免疫表型、转录组和表观遗传学单细胞图。同时在一组混合表型急性白血病（MPAL）临床样本中，从单个细胞中鉴定出癌症特异性转录和染色质特征。测序方法包括droplet-based <strong>CITE-seq</strong> (single-cell antibody derived tag and RNA sequencing) 和 <strong>scATAC-seq </strong>(single-cell chromatin accessibility profiling),以及<strong>scRNA-seq</strong>和<strong>scADT-seq</strong>（antibody derived tag sequencing）</p><p><strong>碎碎念</strong></p><p>借助技术和方法的创新，William J. Greenleaf1对造血系统的正常发育和异常疾病的研究可真多。</p><blockquote><p>每日文献摘要：第8篇 2019年09月27日 周五</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> 文献摘要 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>摘要-揭示RNA相关染色质构象的方法——HiChIRP</title>
      <link href="/2019/09/26/%E6%91%98%E8%A6%81-%E6%8F%AD%E7%A4%BARNA%E7%9B%B8%E5%85%B3%E6%9F%93%E8%89%B2%E8%B4%A8%E6%9E%84%E8%B1%A1%E7%9A%84%E6%96%B9%E6%B3%95%E2%80%94%E2%80%94HiChIRP/"/>
      <url>/2019/09/26/%E6%91%98%E8%A6%81-%E6%8F%AD%E7%A4%BARNA%E7%9B%B8%E5%85%B3%E6%9F%93%E8%89%B2%E8%B4%A8%E6%9E%84%E8%B1%A1%E7%9A%84%E6%96%B9%E6%B3%95%E2%80%94%E2%80%94HiChIRP/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>研究RNA与染色质构象相互作用的方法</p><p><strong>文章信息</strong></p><p>题目：HiChIRP reveals RNA-associated chromosome conformation</p><p>杂志：Nature Method</p><p>时间：2019 June</p><p>链接: DOI:10.1038/s41592-019-0407-x</p><p><strong>figure</strong></p><p><img src="/2019/09/26/摘要-揭示RNA相关染色质构象的方法——HiChIRP/abstract.png" style="zoom:50%"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>lncRNA作用方式多样，其中有许多lncRNA可以利用它们的模块化结构域结合蛋白质、DNA或其他RNA，使它们能够进行长距离的染色质相互作用。尽管在RNA与染色质相互作用的研究中已取得进展，开发了如<strong><a href="https://www.ncbi.nlm.nih.gov/pubmed/?term=28922346" target="_blank" rel="noopener">GRID-seq</a></strong>、<strong><a href="https://elifesciences.org/articles/27024" target="_blank" rel="noopener">ChAR-seq</a></strong>等方法，但是这些方法只适用于大量的RNA。这里提出的<strong>HiChIRP</strong>方法是利用靶向技术，只关注感兴趣的RNA与染色质的相互作用。</p><p><strong>HiChIRP</strong>用RNA纯化（ChIRP）富集的染色质分离代替HiChIP方案中的染色质免疫沉淀步骤来识别RNA相关的染色质contracts。由于ChIRP（和类似的方法）需要生物素化探针捕获RNA，因此我们在染色体构象捕获(3C)期间将azido修饰的核苷酸并入染色质contacts中，并且在生物素化探针富集RNA之后，含叠氮的染色质contacts受到无铜二苯并环辛(DIBO)“点击”化学作用从而共价结合生物素进行后续的contracts富集。</p><blockquote><p>每日文献摘要：第7篇 2019年09月27日 周五</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文献摘要 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scRNA-seq最佳实践分析教程</title>
      <link href="/2019/09/20/scRNA-seq%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E5%88%86%E6%9E%90%E6%95%99%E7%A8%8B/"/>
      <url>/2019/09/20/scRNA-seq%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E5%88%86%E6%9E%90%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>scRNA-seq目前最佳实践分析教程</p><p><strong>文章信息</strong></p><p>题目：<strong>Current best practices in single-cell RNA-seq analysis: a tutorial</strong></p><p>杂志：Molecular systems biology</p><p>时间：Jul. 13, 2019</p><p>链接: doi: <a href="http://dx.doi.org/10.1101/701680" target="_blank" rel="noopener">http://dx.doi.org/10.1101/701680</a></p><p><strong>figure</strong></p><p><img src="/2019/09/20/scRNA-seq最佳实践分析教程/abstract-fig.png" style="zoom:50%"></p><a id="more"></a><p><strong>文章介绍</strong></p><p>这篇文章通过对单细胞方法的总结，提出了一个目前最佳的实践分析流程，代码在<a href="https://github.com/theislab/single-cell-tutorial。" target="_blank" rel="noopener">https://github.com/theislab/single-cell-tutorial。</a></p><p>单细胞上游分析：raw data 经过处理得到Count 矩阵，然后进行质量控制，标准化，数据矫正，特征选择和可视化</p><p>单细胞下游分析：聚类，marker基因的鉴定，注释，轨迹预测，差异基因，基因调控网络，模块组成等</p><p>常见平台：</p><ul><li>命令行平台：<ul><li>Scater</li><li>Seurat</li><li>Scanpy</li></ul></li><li>图形用户交互平台：<ul><li>Granatum</li><li>ASAP</li><li>FASTGenmics</li></ul></li></ul><p>常用的方法工具：</p><ul><li>Scater: <a href="https://bioconductor.org/packages/release/bioc/vignettes/scater/inst/doc/vignette-intro.html" target="_blank" rel="noopener">https://bioconductor.org/packages/release/bioc/vignettes/scater/inst/doc/vignette-intro.html</a></li><li>Seurat:<a href="https://satijalab.org/seurat/vignettes.html" target="_blank" rel="noopener">https://satijalab.org/seurat/vignettes.html</a></li><li>Scanpy: <a href="https://scanpy.readthedocs.io/en/stable/tutorials.html" target="_blank" rel="noopener">https://scanpy.readthedocs.io/en/stable/tutorials.html</a></li></ul><p>教程：</p><ul><li><p>Analysis of single-cell RNA-seq data with R and Bioconductor</p><ul><li><a href="https://github.com/drisso/bioc2016singlecell" target="_blank" rel="noopener">https://github.com/drisso/bioc2016singlecell</a></li></ul></li><li><p>Analysis of single cell RNA-seq data</p><ul><li><a href="https://scrnaseq-course.cog.sanger.ac.uk/website/index.html" target="_blank" rel="noopener">https://scrnaseq-course.cog.sanger.ac.uk/website/index.html</a></li></ul></li><li>Current best-practices in single-cell RNA-seq: a tutorial<ul><li><a href="https://github.com/theislab/single-cell-tutorial" target="_blank" rel="noopener">https://github.com/theislab/single-cell-tutorial</a></li></ul></li></ul><p><strong>碎碎念</strong></p><p>方法更新太快，这里推荐的最佳流程不一定在任何时候都适合，还是要根据目的和具体情况选择</p><blockquote><p>每日文献摘要：第6篇 2019年09月20日 周五</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> transciptomics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> scRNA-seq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>摘要-单细胞空间转录组整合分析和可视化流程_Giotto</title>
      <link href="/2019/09/20/%E6%91%98%E8%A6%81-%E5%8D%95%E7%BB%86%E8%83%9E%E7%A9%BA%E9%97%B4%E8%BD%AC%E5%BD%95%E7%BB%84%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90%E5%92%8C%E5%8F%AF%E8%A7%86%E5%8C%96%E6%B5%81%E7%A8%8B-Giotto/"/>
      <url>/2019/09/20/%E6%91%98%E8%A6%81-%E5%8D%95%E7%BB%86%E8%83%9E%E7%A9%BA%E9%97%B4%E8%BD%AC%E5%BD%95%E7%BB%84%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90%E5%92%8C%E5%8F%AF%E8%A7%86%E5%8C%96%E6%B5%81%E7%A8%8B-Giotto/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>单细胞空间转录组分析和可视化流程</p><p><strong>文章信息</strong></p><p>题目：<strong>Giotto, a pipeline for integrative analysis and visualization of single-cell spatial transcriptomic data</strong></p><p>杂志：bioRxiv</p><p>时间：Jul. 13, 2019</p><p>链接: doi: <a href="http://dx.doi.org/10.1101/701680" target="_blank" rel="noopener">http://dx.doi.org/10.1101/701680</a></p><p><strong>figure</strong></p><p><img src="/2019/09/20/摘要-单细胞空间转录组整合分析和可视化流程-Giotto/fig-abstract.png" style="zoom:50%"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>空间转录组技术有助于研究细胞与其原生的微环境的相互作用，对于理解组织中细胞的身份和功能至关重要。2016年，来自瑞典卡罗琳斯卡研究所和皇家理工学院等机构的研究人员首先开发出空间转录组学（spatial transcriptomics）的高分辨率方法（<a href="https://science.sciencemag.org/content/353/6294/78" target="_blank" rel="noopener">Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</a> ）。2017年，景乃禾研究员和彭广敦研究员研发的空间转录组学技术——Geo-seq发表在《Nature Protocols》。</p><blockquote><p>Geo-seq技术是通过整合与优化单细胞测序和激光显微切割，构建的一种能够获得少量细胞转录组信息、同时保留细胞原有空间位置信息的测序方法。该技术通过激光显微切割可以直观地在组织上直接捕获细胞，每个获取的样本（此技术可以获取低至5个细胞）都保留了位置信息，然后与单细胞转录组测序技术结合，从而完成了高效率、高分辨率的空间转录组分析。</p></blockquote><p>空间转录组学的技术伴随着单细胞技术不断发展，相关分析工具也被相继开发，这篇文章介绍的是对单细胞空间转录组数据进行整合分析和可视化的流程——<strong>Giotto</strong>.</p><p><strong>Giotto</strong>包括两个部分，第一部分是分析空间单细胞转录组数据的详细流程，第二部分是空间单细胞转录组数据的可视化浏览。</p><p>分析部分需要的输入数据是<strong>gene-by-cell count matrix</strong>和每个细胞的空间坐标。分析的内容包括单细胞的常规分析，如：数据预处理、特征选择、降维、聚类等。最重要的是整合了基因表达和空间位置信息。</p><p>可视化部分提供了交互的工作环境，既可以探索分析结果，也可以可视化其他信息如细胞形态、转录本位置等。</p><p><img src="/2019/09/20/摘要-单细胞空间转录组整合分析和可视化流程-Giotto/fig-2.png" alt></p><p>使用教程：<a href="http://spatial.rc.fas.harvard.edu/giotto-viewer/tutorial.html" target="_blank" rel="noopener">http://spatial.rc.fas.harvard.edu/giotto-viewer/tutorial.html</a></p><p><strong>碎碎念</strong></p><p>空间转录组结合单细胞技术是一个新的热点研究方向</p><blockquote><p>每日文献摘要：第5篇 2019年08月28日 周三</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> spatial transcriptomics </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>肿瘤基质边界的酸性微环境与肿瘤迁徙</title>
      <link href="/2019/08/30/%E8%82%BF%E7%98%A4%E5%9F%BA%E8%B4%A8%E8%BE%B9%E7%95%8C%E7%9A%84%E9%85%B8%E6%80%A7%E5%BE%AE%E7%8E%AF%E5%A2%83%E4%B8%8E%E8%82%BF%E7%98%A4%E8%BF%81%E5%BE%99/"/>
      <url>/2019/08/30/%E8%82%BF%E7%98%A4%E5%9F%BA%E8%B4%A8%E8%BE%B9%E7%95%8C%E7%9A%84%E9%85%B8%E6%80%A7%E5%BE%AE%E7%8E%AF%E5%A2%83%E4%B8%8E%E8%82%BF%E7%98%A4%E8%BF%81%E5%BE%99/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>酸性环境改变转录组的变化影响肿瘤的恶性发展</p><p><strong>文章信息</strong></p><p>题目：Acidification of Tumor at Stromal Boundaries Drives Transcriptome Alterations Associated with Aggressive Phenotypes</p><p>杂志：Cancer research</p><p>时间：April 15, 2019</p><p>链接: DOI: 10.1158/0008-5472.CAN-18-1604</p><p><strong>figure</strong></p><p><img src="/2019/08/30/肿瘤基质边界的酸性微环境与肿瘤迁徙/fig-abstract.png" alt></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>肿瘤微环境的3大特征：</p><ul><li>异质性</li><li>缺氧</li><li>酸性</li></ul><p><strong>异质性</strong>我们听到的报道可能很多，肿瘤微环境不是仅仅有肿瘤细胞组成，还包括免疫细胞、基质细胞等各种成分。</p><p><strong>缺氧</strong>我们可能也不难理解，肿瘤细胞的快速繁殖使肿瘤微环境中的血管化异常以及血液供应的异常，导致缺氧的环境。</p><p><strong>酸性环境</strong>如果是做肿瘤代谢的肯定不会陌生，因为著名的瓦博格效应，即大家广泛认同的肿瘤酸性环境产生的原因，认为肿瘤在无氧环境中的糖酵解产生大量乳酸，导致了肿瘤的酸性环境。</p><p><strong>酸性环境对肿瘤有什么影响？</strong></p><p>常见的研究有：酸性环境影响肿瘤的恶性发展、基因组和表观组的变化、肿瘤的转移、药物的抵抗性等。</p><p><img src="/2019/08/30/肿瘤基质边界的酸性微环境与肿瘤迁徙/review-acidic-TME.png" alt></p><p>这篇文章介绍的是酸性环境影响基因的表达以及可变剪接，进而影响肿瘤的恶性发展。</p><blockquote><p>每日文献摘要：第<strong>4</strong>篇 2019年08月27日 周二</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 文献摘要 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scATAC的一篇经典文献-研究人细胞发育和肿瘤内T细胞耗竭</title>
      <link href="/2019/08/26/scATAC%E7%9A%84%E4%B8%80%E7%AF%87%E7%BB%8F%E5%85%B8%E6%96%87%E7%8C%AE-%E7%A0%94%E7%A9%B6%E4%BA%BA%E7%BB%86%E8%83%9E%E5%8F%91%E8%82%B2%E5%92%8C%E8%82%BF%E7%98%A4%E5%86%85T%E7%BB%86%E8%83%9E%E8%80%97%E7%AB%AD/"/>
      <url>/2019/08/26/scATAC%E7%9A%84%E4%B8%80%E7%AF%87%E7%BB%8F%E5%85%B8%E6%96%87%E7%8C%AE-%E7%A0%94%E7%A9%B6%E4%BA%BA%E7%BB%86%E8%83%9E%E5%8F%91%E8%82%B2%E5%92%8C%E8%82%BF%E7%98%A4%E5%86%85T%E7%BB%86%E8%83%9E%E8%80%97%E7%AB%AD/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>学习scATAC-seq的必读文献</p><p><strong>文章信息</strong></p><p>题目：Massively parallel single-cell chromatin landscapes of human immune cell development and intratumoral T cell exhaustion</p><p>杂志：Nature biotechnology</p><p>时间：August, 2019</p><p>链接: <a href="https://www.nature.com/articles/s41587-019-0206-z" target="_blank" rel="noopener">https://www.nature.com/articles/s41587-019-0206-z</a></p><p><strong>figure</strong></p><p><img src="/2019/08/26/scATAC的一篇经典文献-研究人细胞发育和肿瘤内T细胞耗竭/fig1-method.png" style="zoom:50%"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>利用商业化10X Genomics平台进行scATAC-seq测序，同时研究健康人的血液细胞发育和肿瘤内T细胞的耗竭。共得到200,000个单细胞的染色质可及性图谱。</p><p>在血液细胞发育中的应用，得到的结果包括：</p><ul><li>鉴定到细胞特异的cis- 和trans调控元件</li><li>疾病相关的enhancer活动</li><li>细胞分化发育轨迹</li></ul><p>在肿瘤基底细胞中的应用，结果包括：</p><ul><li>构建了肿瘤微环境中的基底细胞、恶性细胞和免疫细胞的调控网络</li><li>发现一些染色质调控因子或许可作为免疫治疗的靶标</li></ul><p><img src="/2019/08/26/scATAC的一篇经典文献-研究人细胞发育和肿瘤内T细胞耗竭/fig2-造血谱系发育.png" alt></p><p><strong>碎碎念</strong></p><p>William J. Greenleaf 和 Howard Y. Chang合作的又一篇巨作文章，值得细细解读，一是学习scATAC-seq的分析方法，重现文章的部分分析；二是总结文章思路，思考如何利用该数据资源做进一步挖掘，对其他课题的借鉴意义</p><ul><li><p>数据资源：scATAC-seq处理前的数据和处理后的数据都提供在10X平台</p><p><a href="https://support.10xgenomics.com/single-cell-atac/datasets" target="_blank" rel="noopener">https://support.10xgenomics.com/single-cell-atac/datasets</a>. </p></li><li><p>代码：<a href="https://github.com/GreenleafLab/10x-scATAC-2019" target="_blank" rel="noopener">https://github.com/GreenleafLab/10x-scATAC-2019</a>.</p></li></ul><blockquote><p>每日文献摘要：第<strong>4</strong>篇 2019年08月27日 周二</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> single cell </tag>
            
            <tag> 文献摘要 </tag>
            
            <tag> scATACseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>awk基本命令使用</title>
      <link href="/2019/08/25/awk%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/08/25/awk%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<p>awk是一个处理文本文件的程序，也是一门强大的编程语言。awk是把文件逐行的读入，以空格为默认分隔符将每行分割，切开的部分再进行各种分析处理，非常适用于每行格式相同的文本文件。</p><p><img src="/2019/08/25/awk基本命令使用/fig-head.png" alt></p><a id="more"></a><p><strong>示例数据：</strong></p><p>DEseq2得到的差异表达矩阵<strong>(dfdata)</strong>作为示例数据：</p><p>包括9列数据，分别为<code>id</code>, <code>baseMeanA</code>, <code>baseMeanB</code>,<code>baseMean</code>,  <code>log2FoldChange</code>,<code>lfcSE</code>,<code>stat</code>,<code>pvalue</code>,<code>padj</code></p><p><img src="/2019/08/25/awk基本命令使用/fig1-rawdata.png" alt></p><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><ul><li><strong>输出文件内容</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 格式</span></span><br><span class="line">$ awk <span class="string">'&#123;动作&#125;'</span> 文件名</span><br><span class="line"><span class="comment"># 示例</span></span><br><span class="line">$ head dfdata | awk <span class="string">'&#123;print $0&#125;'</span></span><br></pre></td></tr></table></figure><p>将输出差异基因结构的前5行</p><ul><li><p><strong>提取基因ID，log2FoldChange, pvalue三列信息</strong></p><p><code>awk</code>会根据空格和制表符等分隔符，将每一行分成若干字段，依次用<code>$1</code>、<code>$2</code>、<code>$3</code>代表第一个字段、第二个字段、第三个字段等，<code>$1, $2</code>可以理解为被分隔符分割的第一列，第二列</p><p><code>-F</code> ：输入分隔符，这里是<code>\t</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将输出差异基因前10行的第1、5和8列，默认是以空格分割，所以输出结果</span></span><br><span class="line">head dfdata | awk -F <span class="string">'\t'</span> <span class="string">'&#123;print $1,$5,$8&#125;'</span></span><br></pre></td></tr></table></figure><p><img src="/2019/08/25/awk基本命令使用/fig-eg1.png" style="zoom:50%"></p><p><code>OFS</code>: 输出分隔符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以tab分割输出</span></span><br><span class="line">head dfdata | awk -F <span class="string">'\t'</span> <span class="string">'&#123;print $1,$5,$8&#125;'</span> OFS=<span class="string">'\t'</span></span><br></pre></td></tr></table></figure><p><img src="/2019/08/25/awk基本命令使用/fig-eg2.png" style="zoom:50%"></p></li></ul><p><strong>其他变量</strong></p><ul><li><code>FILENAME</code>：当前文件名</li><li><code>FS</code>：字段分隔符，默认是空格和制表符。</li><li><code>RS</code>：行分隔符，用于分割每一行，默认是换行符。</li><li><code>OFS</code>：输出字段的分隔符，用于打印时分隔字段，默认为空格。</li><li><code>ORS</code>：输出记录的分隔符，用于打印时分隔记录，默认为换行符。</li><li><code>OFMT</code>：数字输出的格式，默认为<code>％.6g</code></li></ul><h3 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'条件 &#123;动作&#125;'</span> 文件名</span><br></pre></td></tr></table></figure><p>可以结合正则表达式规则使用</p><ul><li><strong>输出特定基因ID的行</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk -F <span class="string">'\t'</span> <span class="string">'/id/ &#123;print $0&#125;'</span> dfdata</span><br><span class="line"><span class="comment"># idbaseMeanAbaseMeanBbaseMeanlog2FoldChangelfcSEstatpvaluepadj</span></span><br></pre></td></tr></table></figure><h3 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h3><p>判断语句和执行语句必须用在<code>{}</code>中，且判断语句用<code>()</code>扩起来 </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;if () action; else action&#125;'</span> file</span><br></pre></td></tr></table></figure><ul><li>输出 |log2FoldChange | &gt; 1且pvalue &lt; 0.05的所有信息</li></ul><p><strong>符合|log2FoldChange | &gt; 1且pvalue &lt; 0.05的基因有多少个</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'&#123;if ($5&gt;1 || $5 &lt; -1 &amp;&amp; $8&lt;0.05 ) print $0&#125;'</span> dfdata | wc</span><br></pre></td></tr></table></figure><p><strong>且同时输出header</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/id/ &#123;print $0&#125;; &#123;if ($5&gt;1 || $5 &lt; -1 &amp;&amp; $8&lt;0.05 ) print $0&#125;'</span> dfdata | less -S</span><br><span class="line"><span class="comment"># 两个完整语句间用分号分割</span></span><br></pre></td></tr></table></figure><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><ul><li><code>tolower()</code>：字符转为小写。</li><li><code>length()</code>：返回字符串长度。</li><li><code>substr()</code>：返回子字符串。</li><li><code>sin()</code>：正弦。</li><li><code>cos()</code>：余弦。</li><li><code>sqrt()</code>：平方根。</li><li><code>rand()</code>：随机数</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">awk <span class="string">'/id/ &#123;print $0&#125; dfdata</span></span><br><span class="line"><span class="string"># idbaseMeanAbaseMeanBbaseMeanlog2FoldChangelfcSEstatpvaluepadj</span></span><br><span class="line"><span class="string">awk '</span>/id/ &#123;<span class="built_in">print</span> toupper(<span class="variable">$0</span>)&#125;<span class="string">' rawcount </span></span><br><span class="line"><span class="string"># IDBASEMEANABASEMEANBBASEMEANLOG2FOLDCHANGELFCSESTATPVALUEPADJ</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Data Sciences </category>
          
      </categories>
      
      
        <tags>
            
            <tag> awk </tag>
            
            <tag> text processing </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scRNA-seq数据预处理</title>
      <link href="/2019/08/25/scRNA-seq%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/"/>
      <url>/2019/08/25/scRNA-seq%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>scRNA-seq的上游处理与bulk RNA-seq有相似的地方，也有不同的地方。相似的地方如：对原始数据的质控检测、去除低质量的reads、adpter、比对。不同的地方如scRNA-seq数据有的需要考虑<strong>Demultiplexing</strong>。而且scRNA-seq根据采用的不同的protocols，产生的数据和处理方法也有不同。</p><p>这里提供的练习数据是SMART-seq2建库，SMRT-seq2建库的测序数据上游分析与bulk RNA-seq相似，如这节课内容中的分析方法：</p><ul><li>FastQC 对原始数据进行质控检测</li><li>Trim Galore 质控</li><li>STAR或Kallisto比对</li></ul><a id="more"></a><h3 id="练习数据"><a href="#练习数据" class="headerlink" title="练习数据"></a>练习数据</h3><p>mouse ESC的单细胞数据(Kolodziejczyk et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/processing-raw-scrna-seq-data.html#ref-Kolodziejczyk2015-xy" target="_blank" rel="noopener">2015</a>)，数据下载位置：<a href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-2600/samples/" target="_blank" rel="noopener">https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-2600/samples/</a></p><p>直接点击下载按钮即可下载fastq的数据。</p><ul><li>ERR522959_1.fastq</li><li>ERR522959_2.fastq</li></ul><h3 id="质控"><a href="#质控" class="headerlink" title="质控"></a>质控</h3><ul><li>FastQC</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir fastqc_results</span><br><span class="line">fastqc -o fastqc_results Share/ERR522959_1.fastq Share/ERR522959_2.fastq</span><br></pre></td></tr></table></figure><ul><li>Trim galore 是一个自动识别adpter的质控软件</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir fastqc_trimmed_results</span><br><span class="line">trim_galore --nextera -o fastqc_trimmed_results Share/ERR522959_1.fastq Share/ERR522959_2.fastq</span><br></pre></td></tr></table></figure><h3 id="Demultiplexing"><a href="#Demultiplexing" class="headerlink" title="Demultiplexing"></a>Demultiplexing</h3><p>不同的protocol和pipeline决定了demultiplexing的方法也不同，最灵活的方法是<strong>zUMI</strong>,可以用于大多的demultiplexing和基于UMI的protocols。SMARTseq2直接提供的是已经demultiplexing的数据。</p><p><strong>如何理解demultiplexing？</strong></p><p>demultiplexing的过程即识别并移除cell barcode序列。</p><p>scRNA-seq质控中需要考虑的另一个因素是不包含细胞或包含两个细胞的<strong>droplets</strong>。</p><h3 id="STAR比对"><a href="#STAR比对" class="headerlink" title="STAR比对"></a>STAR比对</h3><p>STAR比对的优点有考虑到了剪切体，输出文件内容丰富，（可以进行下游融合基因的分析，bulk seq可以）缺点是耗费计算资源。</p><p>比对的步骤首先需要构建参考基因组或转录组的index文件，由于考虑到练习运行时间，这里提供的代码是比对到参考转录本</p><ul><li>Make index</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir indices</span><br><span class="line">mkdir indices/STAR</span><br><span class="line">STAR --runThreadN 4 --runMode genomeGenerate --genomeDir indices/STAR --genomeFastaFiles Share/2000_reference.transcripts.fa</span><br></pre></td></tr></table></figure><ul><li><p>alingment</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir results</span><br><span class="line">mkdir results/STAR</span><br><span class="line"></span><br><span class="line">STAR --runThreadN 4 --genomeDir indices/STAR --readFilesIn Share/ERR522959_1.fastq Share/ERR522959_2.fastq --outFileNamePrefix results/STAR/</span><br></pre></td></tr></table></figure></li></ul><h3 id="Kallisto-比对（Pseudo-Alignment）"><a href="#Kallisto-比对（Pseudo-Alignment）" class="headerlink" title="Kallisto 比对（Pseudo-Alignment）"></a>Kallisto 比对（Pseudo-Alignment）</h3><p>Kallisto比对也称为pseudo-alignment（假比对）,即它的比对方法和STAR不同，不是将完整reads比对到参考转录本上，而是将<strong>kmer(特定长度的序列)</strong>比对到参考转录本上。</p><p><strong>k-mers和reads相比的特点是</strong>：</p><ul><li>快</li><li>处理测序error的能力强于传统的比对工具</li><li>与STAR不同的另一点Kallisto是比对到转录本的</li></ul><p><strong>Kallisto’s pseudo mode</strong></p><p>专门为scRNA-seq设计的，</p><p><strong>index</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir indices/Kallisto</span><br><span class="line">kallisto index -i indices/Kallisto/transcripts.idx Share/2000_reference.transcripts.fa</span><br></pre></td></tr></table></figure><p><strong>Kallisto Pseudo-Alignment</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir results/Kallisto</span><br><span class="line">kallisto pseudo -i indices/Kallisto/transcripts.idx -o results/Kallisto -b batch.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> transciptomics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> scRNA-seq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>摘要-scRNAseq探究健康人胰岛和T2D的转录组图谱</title>
      <link href="/2019/08/25/%E6%91%98%E8%A6%81-scRNAseq%E6%8E%A2%E7%A9%B6%E5%81%A5%E5%BA%B7%E4%BA%BA%E8%83%B0%E5%B2%9B%E5%92%8CT2D%E7%9A%84%E8%BD%AC%E5%BD%95%E7%BB%84%E5%9B%BE%E8%B0%B1/"/>
      <url>/2019/08/25/%E6%91%98%E8%A6%81-scRNAseq%E6%8E%A2%E7%A9%B6%E5%81%A5%E5%BA%B7%E4%BA%BA%E8%83%B0%E5%B2%9B%E5%92%8CT2D%E7%9A%84%E8%BD%AC%E5%BD%95%E7%BB%84%E5%9B%BE%E8%B0%B1/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>健康人胰岛和T2D的单细胞转录组图谱</p><p><strong>文章信息</strong></p><p>题目：Single-Cell Transcriptome Profiling of Human Pancreatic Islets in Health and Type 2 Diabetes</p><p>杂志：Cell Metabolism</p><p>时间：October 11, 2016</p><p>链接: <a href="http://dx.doi.org/10.1016/j.cmet.2016.08.020" target="_blank" rel="noopener">http://dx.doi.org/10.1016/j.cmet.2016.08.020</a></p><p><strong>figure</strong></p><p><img src="/2019/08/25/摘要-scRNAseq探究健康人胰岛和T2D的转录组图谱/fig1-abstract.png" style="zoom:50%"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>利用单细胞RNA技术探究健康人胰岛和T2D的转录组图谱。数据来源于6个健康人和4个T2D病人，利用SMRT2-seq的方法得到2,209个单细胞。主要分析包括对<strong>1）细胞分群</strong>；<strong>2）鉴定alpha 和beta细胞亚群</strong> ；<strong>3）肥胖或T2D相关基因与BMI的关联</strong>；<strong>4）T2D的基因变异</strong></p><p><strong>碎碎念</strong></p><ol><li><p>与16年发表在Cell systerm上的文章相比，这篇文章的分析相对丰富些，一是数据即包括健康人胰腺又包括糖尿病，二是不仅对细胞进行了分群和标记物的鉴定，还将T2D基因和肥胖基因与BMI关联，以及通过与正常组比较发现了T2D的基因变异。将健康和疾病的对照研究，凸显了鉴定的靶标具有重要的临床意义。</p></li><li><p>Rickard Sandberg实验室发表的文章，SMRT-seq2的开发者，分析方法可以学习</p></li><li><p>数据资源：<strong>E-MTAB-5061， E-MTAB-5060</strong></p></li></ol><blockquote><p>每日文献摘要：第<strong>3</strong>篇 2019年08月26日 周一</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> 文献摘要 </tag>
            
            <tag> scRNA-seq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>摘要-scRNA-seq探究人胰腺转录组图谱</title>
      <link href="/2019/08/25/%E6%91%98%E8%A6%81-scRNA-seq%E6%8E%A2%E7%A9%B6%E4%BA%BA%E8%83%B0%E8%85%BA%E8%BD%AC%E5%BD%95%E7%BB%84%E5%9B%BE%E8%B0%B1/"/>
      <url>/2019/08/25/%E6%91%98%E8%A6%81-scRNA-seq%E6%8E%A2%E7%A9%B6%E4%BA%BA%E8%83%B0%E8%85%BA%E8%BD%AC%E5%BD%95%E7%BB%84%E5%9B%BE%E8%B0%B1/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>人胰腺单细胞转录组图谱</p><p><strong>文章信息</strong></p><p>题目：A Single-Cell Transcriptome Atlas of the Human Pancreas</p><p>杂志：Cell Systems</p><p>时间：October 26, 2016</p><p>链接: <a href="http://dx.doi.org/10.1016/j.cels.2016.09.002" target="_blank" rel="noopener">http://dx.doi.org/10.1016/j.cels.2016.09.002</a></p><p><strong>figure</strong></p><p><img src="/2019/08/25/摘要-scRNA-seq探究人胰腺转录组图谱/fig1-abstarct.png" style="zoom:50%"></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>利用scRNA-seq对人胰腺的组成进行分群以及鉴定特定细胞群的标记基因。样本来自4个过亡的捐赠者，scRNA-seq采用CEL-Seq2 protocol结合FACS分选和机器学技术。所做的分析包括两个方面，首先利用StemID算法对细胞分群，然后鉴定特定细胞亚群的标记基因和转录因子。主要结果有：鉴定到<strong>CD24</strong>和<strong>TM4SF4</strong>可以作为alpha 和beta 细胞的标记基因。</p><p><strong>碎碎念</strong></p><ol><li>只进行了分群和细胞标记基因的鉴定，所做的分析很少，可以利用该数据进行进一步的挖掘</li><li>数据资源：<strong>GSE85241</strong>提供了表达矩阵</li></ol><blockquote><p>每日文献摘要：第2篇 2019年08月25日 周日</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> 文献摘要 </tag>
            
            <tag> scRNA-seq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>摘要-scRNA-seq揭示胰腺导管癌的肿瘤内部抑制性和恶性发展过程</title>
      <link href="/2019/08/24/%E6%91%98%E8%A6%81-scRNA-seq%E6%8F%AD%E7%A4%BA%E8%83%B0%E8%85%BA%E5%AF%BC%E7%AE%A1%E7%99%8C%E7%9A%84%E8%82%BF%E7%98%A4%E5%86%85%E9%83%A8%E6%8A%91%E5%88%B6%E6%80%A7%E5%92%8C%E6%81%B6%E6%80%A7%E5%8F%91%E5%B1%95%E8%BF%87%E7%A8%8B/"/>
      <url>/2019/08/24/%E6%91%98%E8%A6%81-scRNA-seq%E6%8F%AD%E7%A4%BA%E8%83%B0%E8%85%BA%E5%AF%BC%E7%AE%A1%E7%99%8C%E7%9A%84%E8%82%BF%E7%98%A4%E5%86%85%E9%83%A8%E6%8A%91%E5%88%B6%E6%80%A7%E5%92%8C%E6%81%B6%E6%80%A7%E5%8F%91%E5%B1%95%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p><strong>一句话评价</strong></p><p>胰腺导管癌(PDAC)异质性和恶性发展的单细胞研究</p><p><strong>文章信息</strong></p><p>题目：Single-cell RNA-seq highlights intra-tumoral heterogeneity and malignant progression in pancreatic ductal adenocarcinoma</p><p>杂志：Cell Research</p><p>时间：04 July 2019</p><p>链接: <a href="https://www.nature.com/articles/s41422-019-0195-y" target="_blank" rel="noopener">https://www.nature.com/articles/s41422-019-0195-y</a></p><p><strong>figure</strong></p><p><img src="/2019/08/24/摘要-scRNA-seq揭示胰腺导管癌的肿瘤内部抑制性和恶性发展过程/fig1-abstract.png" alt></p><a id="more"></a><p><strong>文章介绍：</strong></p><p>利用单细胞RNA-seq技术对胰腺导管癌的肿瘤内部异质性和恶性发展进行探究。样本量包括24个肿瘤样本和11个对照样本，利用droplet建库的方法，得到57,530个细胞。主要分析包括：首先对细胞进行<strong>1）分群</strong>，鉴定到10个群，其中有2个导管细胞型群分别具有异常和恶性基因表达特征，然后又对两个导管细胞群进行亚群分析。<strong>2）细胞轨迹分析（拟时间分析）</strong>揭示了PDAC恶性发展过程中的相关的通路和转录因子。<strong>3）免疫浸润分析</strong>：结合TCGA胰腺癌相关的公共数据发现了肿瘤浸润T细胞失活状态相关的基因，为肿瘤免疫治疗提供了参考靶点。</p><p><strong>碎碎念</strong></p><ol><li><p>细胞分群是单细胞数据分析的常规步骤</p></li><li><p>拟时间分析这里用于探究肿瘤恶性程度的发展值得借鉴</p></li><li><p>另外如何从拟时间分析得到了相关的转录因子呢？（细看原文）</p></li><li><p>最后与肿瘤免疫扯上关系，升华了研究的价值和意义</p></li></ol><blockquote><p>每日文献摘要：第1篇  2019年08月24日 周六 </p></blockquote>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> 文献摘要 </tag>
            
            <tag> scRNA-seq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scRNA-seq基础知识扫盲篇</title>
      <link href="/2019/08/24/scRNA-seq%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%89%AB%E7%9B%B2%E7%AF%87/"/>
      <url>/2019/08/24/scRNA-seq%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E6%89%AB%E7%9B%B2%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h2 id="Bulk-RNA-seq与scRNA-seq的优势和局限性"><a href="#Bulk-RNA-seq与scRNA-seq的优势和局限性" class="headerlink" title="Bulk RNA-seq与scRNA-seq的优势和局限性"></a>Bulk RNA-seq与scRNA-seq的优势和局限性</h2><h4 id="Bulk-RNA-seq"><a href="#Bulk-RNA-seq" class="headerlink" title="Bulk RNA-seq"></a>Bulk RNA-seq</h4><ul><li>20世纪末即芯片技术后的又一个突破性技术，之后被广泛应用，逐渐替代芯片</li><li>评估测量<strong>一个大群体内所有细胞的平均表达量水平</strong></li><li>适用于比较转录组学，如不同物种相同组织的不同样本间的转录表达差异比较；或者用于评估疾病等表达量特征</li><li>不适用于研究系统的异质性，如早期胚胎发育、复杂组织（脑）</li><li>不能提供基因表达量的随机特征</li></ul><h4 id="scRNA-seq"><a href="#scRNA-seq" class="headerlink" title="scRNA-seq"></a>scRNA-seq</h4><ul><li>2009年出现 (Tang et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Tang2009-bu" target="_blank" rel="noopener">2009</a>)</li><li>伴随着新的protocols和测序成本的降低，2014年左右被广泛推广</li><li>适用于检测一群细胞的表达量分布水平；细胞特异性变化等（如鉴定细胞类型、细胞应激的异质性，基因表达的随机性、推测细胞间的基因调控网络</li><li>数据集从10<em>2～  10 </em>8细胞，且逐年增长</li><li>目前的使用的protocols：SMART-seq2 (Picelli et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Picelli2013-sb" target="_blank" rel="noopener">2013</a>), CELL-seq (Hashimshony et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Hashimshony2012-kd" target="_blank" rel="noopener">2012</a>) and Drop-seq (Macosko et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Macosko2015-ix" target="_blank" rel="noopener">2015</a>)</li><li>商业平台：<a href="https://www.fluidigm.com/products/c1-system" target="_blank" rel="noopener">Fluidigm C1</a>, <a href="https://www.wafergen.com/products/icell8-single-cell-system" target="_blank" rel="noopener">Wafergen ICELL8</a> and the <a href="https://www.10xgenomics.com/single-cell/" target="_blank" rel="noopener">10X Genomics Chromium</a></li><li>Bulk RNA-seq的一些方法也适合于scRNA-seq，大多情况需要新的方法</li></ul><a id="more"></a><h2 id="单细胞RNA测序流程"><a href="#单细胞RNA测序流程" class="headerlink" title="单细胞RNA测序流程"></a>单细胞RNA测序流程</h2><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig1-workflow.png" style="zoom:50%"></p><h2 id="分析方法"><a href="#分析方法" class="headerlink" title="分析方法"></a>分析方法</h2><p>scRNA-seq上游分析方法与bulk 相同，对测序数据进行<strong>质控、比对、比对结果的质控（黄色部分）</strong>，接着是细胞质控、标准化，这一部分与bulk有相同的也有不同的地方，下游分析就是解释实际生物学问题，包括差异分析、聚类、网络分析等，所用的方法一般都是scRNA特有的算法。</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig2-analysis.png" style="zoom:50%"></p><blockquote><p>scRNA-seq 分析的综述：(Stegle, Teichmann, and Marioni <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Stegle2015-uv" target="_blank" rel="noopener">2015</a>)</p></blockquote><ul><li><a href="https://github.com/VCCRI/Falco/" target="_blank" rel="noopener">Falco</a> ：云端处理scRNA-seq分析.</li><li><a href="https://github.com/YosefLab/scone" target="_blank" rel="noopener">SCONE</a> (Single-Cell Overview of Normalized Expression), scRNA-seq质控和标准化的R包</li><li><a href="http://satijalab.org/seurat/" target="_blank" rel="noopener">Seurat</a> ：scRNA-seq分析的常用的四大R包之一，包括对数据的质控、分析等</li><li><a href="https://asap.epfl.ch/" target="_blank" rel="noopener">ASAP</a> (Automated Single-cell Analysis Pipeline) ：scRNA-seq交互分析的网络平台</li></ul><h2 id="挑战"><a href="#挑战" class="headerlink" title="挑战"></a>挑战</h2><p>bulk RNA-seq与scRNA-seq最主要的不同是scRNA-seq的每个测序文库代表一个细胞而不是一群细胞。文库的不同来源于：</p><ul><li>扩增 (达到1 million倍)</li><li>Gene ‘dropouts’：指一个细胞在一个细胞中是中等表达水平，但是在另一个细胞中没有被检测到</li></ul><p>上面的差异主要来自于RNA的起始量很低，因此提高转录本的捕获率、降低扩增偏差是一个热门的研究方向。</p><h2 id="实验方法"><a href="#实验方法" class="headerlink" title="实验方法"></a>实验方法</h2><p>发展新的scRNA-seq protocol也是一个热门领域，目前已有的方法包括：</p><ul><li>CEL-seq (Hashimshony et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Hashimshony2012-kd" target="_blank" rel="noopener">2012</a>)</li><li>CEL-seq2 (Hashimshony et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Hashimshony2016-lx" target="_blank" rel="noopener">2016</a>)</li><li>Drop-seq (Macosko et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Macosko2015-ix" target="_blank" rel="noopener">2015</a>)</li><li>InDrop-seq (Klein et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Klein2015-kz" target="_blank" rel="noopener">2015</a>)</li><li>MARS-seq (Jaitin et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Jaitin2014-ko" target="_blank" rel="noopener">2014</a>)</li><li>SCRB-seq (Soumillon et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Soumillon2014-eu" target="_blank" rel="noopener">2014</a>)</li><li>Seq-well (Gierahn et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Gierahn2017-es" target="_blank" rel="noopener">2017</a>)</li><li>Smart-seq (Picelli et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Picelli2014-ic" target="_blank" rel="noopener">2014</a>)</li><li>Smart-seq2 (Picelli et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Picelli2014-ic" target="_blank" rel="noopener">2014</a>)</li><li><a href="http://www.clontech.com/US/Products/cDNA_Synthesis_and_Library_Construction/Next_Gen_Sequencing_Kits/Total_RNA-Seq/Universal_RNA_Seq_Random_Primed" target="_blank" rel="noopener">SMARTer</a></li><li>STRT-seq (Islam et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Islam2014-cn" target="_blank" rel="noopener">2013</a>)</li></ul><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig3-expre-method.png" style="zoom:50%"></p><p>不同的方法实现方式不同，其中<strong>定量</strong>和<strong>捕获</strong>是最重要的两个方面</p><p><strong>定量有两种类型：</strong></p><ul><li>全长（full length): <ul><li>致力于实现每个转录本一致的read coverage</li><li>理论上的一致的coverage很难实现，经常会存在偏差</li></ul></li><li>基于标签(tag-based):<ul><li>只捕获RNA的5‘ 端或3’端，</li><li>可以和UMI(unique molecular identifiers )结合提高定量准确性</li><li>由于只捕获单端RNA可能会降低比对率</li><li>很难鉴定isoforms</li></ul></li></ul><p><strong>捕获</strong>：</p><p>捕获策略决定了测序通量，以及得到细胞的方式和其他信息。常用的捕获策略有：</p><ul><li><p><strong>microwell-based</strong></p><p>使用吸液管或激光捕获等方法分离细胞，并将其放置在微流体管中。该方法的优缺点是：</p><ul><li><p>优点是：可以与FACS分选结合使用，从而可以根据细胞表面marker筛选感兴趣的特定类型的细胞，同时在分选时可以拍摄细胞。图像可以用于识别受损细胞或dublets。</p></li><li><p>缺点是：通量低、耗时费工</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig4-microwell.png" style="zoom:30%"></p></li></ul></li></ul><ul><li><p><strong>microfluidic-based</strong></p><ul><li><p>如Fluidigm’s C1，提供了一个更为集成的系统，用于捕捉细胞和进行建库准备所需的反应。</p></li><li><p>优点是：通量比microwell-based 高</p></li><li><p>缺点是：捕获效率低，只有10%的细胞可以被捕获，因此不适用于细胞类型罕见或者输入细胞量少的研究；另外芯片价格相对贵</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig5-fluidigm.png" style="zoom:30%"></p></li></ul></li><li><p><strong>droplet- based</strong></p><ul><li><p>将每一个细胞封装在一个毫微升的液滴中，并加上一个珠子（bead), bead中含有建库所需的酶和唯一的条形码（barcode)，条形码可以将reads来自于哪个细胞关联。因此，所有的液滴都可以汇集起来，排序在一起，然后根据条形码将reads分配给原始细胞。</p></li><li><p>优点是：通量最高</p></li><li><p>缺点是：测序成本、低覆盖率 (Ziegenhain et al. <a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html#ref-Ziegenhain2017-cu" target="_blank" rel="noopener">2017</a>)</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig6-drop-seq.png" alt></p></li></ul></li></ul><h2 id="如何选择合适的平台"><a href="#如何选择合适的平台" class="headerlink" title="如何选择合适的平台"></a>如何选择合适的平台</h2><p>如何选择合适的protocols，只有根据研究的生物学问题。如果感兴趣一个组织的组成，那么droplet-based的方法可以得到大量的细胞，或许是最适合的；如果研究的是罕见细胞，并且知道细胞marker,那么结合FACS富集，测少量的细胞也可以实现目的。</p><p>全长转录本适合于对不同亚型感兴趣的研究，tagged的protocols可以和UMI结合，适用于基因水平的定量。</p><p><img src="/2019/08/24/scRNA-seq基础知识扫盲篇/fig7-comparison-methods.png" style="zoom:40%"></p><blockquote><p>内容来自<em>Hemberg</em> lab’s 单细胞课程学习笔记 ： </p><p>Introduction to single-cell RNA-seq：</p><p><a href="https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html" target="_blank" rel="noopener">https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> transciptomics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> single cell </tag>
            
            <tag> scRNA-seq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用BETA整合分析ATAC-seq/ChIP-seq和RNA-seq数据</title>
      <link href="/2019/08/23/%E4%BD%BF%E7%94%A8BETA%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90ATAC-seq:ChIP-seq%E5%92%8CRNA-seq%E6%95%B0%E6%8D%AE/"/>
      <url>/2019/08/23/%E4%BD%BF%E7%94%A8BETA%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90ATAC-seq:ChIP-seq%E5%92%8CRNA-seq%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<p><strong><a href="http://cistrome.dfci.harvard.edu/BETA/tutorial.html" target="_blank" rel="noopener">BETA 网址</a></strong>: <a href="http://cistrome.dfci.harvard.edu/BETA/tutorial.html" target="_blank" rel="noopener">http://cistrome.dfci.harvard.edu/BETA/tutorial.html</a></p><h3 id="功能介绍"><a href="#功能介绍" class="headerlink" title="功能介绍"></a>功能介绍</h3><p><img src="https://upload-images.jianshu.io/upload_images/8242255-df9dfd4f7834cee4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><a id="more"></a><h3 id="数据准备："><a href="#数据准备：" class="headerlink" title="数据准备："></a>数据准备：</h3><ul><li><p>peak bed file</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># chr str end</span><br><span class="line">$head mep_ebDfpeak_deseq2_sig.bed</span><br><span class="line">chr8    12050808        12052743</span><br><span class="line">chr9    66492999        66494729</span><br><span class="line">chr4    125632449       125634758</span><br><span class="line">chr4    10182030        10183501</span><br></pre></td></tr></table></figure></li><li><p>df expression file</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># symbol log2FC pvalue</span><br><span class="line">$head mep_eb_dfexpre</span><br><span class="line">MELK    6.23721078699297        5.47784458574045e-218</span><br><span class="line">RAD51AP1        4.17541170218602        2.86774188064759e-217</span><br><span class="line">HMGN5   5.98876520905166        7.49359285750074e-216</span><br><span class="line">ZWILCH  3.74468061674801        2.42032701371558e-204</span><br><span class="line">HNRNPA2B1       2.76252025379004        3.05116228100538e-190</span><br><span class="line">HLA-DRA -5.19413815362273       2.27680965999626e-188</span><br></pre></td></tr></table></figure></li></ul><h3 id="软件下载安装"><a href="#软件下载安装" class="headerlink" title="软件下载安装"></a>软件下载安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://cistrome.dfci.harvard.edu/BETA/src/BETA_1.0.7.zip</span><br><span class="line">unzip BETA_1.0.7.zip</span><br><span class="line">cd BETA_1.0.7/</span><br><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h5 id="BETA-Basic"><a href="#BETA-Basic" class="headerlink" title="BETA Basic"></a>BETA Basic</h5><p>BETA Basic 预测调控因子的功能（激活或抑制）和靶基因<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETA basic –p 3656_peaks.bed –e AR_expr.xls –k LIM –g hg19 --da500 –n basic</span><br></pre></td></tr></table></figure></p><p><strong>参数：</strong><br><code>-p</code> ： peak bed file (必需参数）<br><code>-e</code>：df expression file (必需参数）<br><code>-k</code>：表达量文件格式是limma的标准格式（根据实际情况修改）<br><code>-g</code>：基因组文件，如hg19,hg38,mm10,mm9<br><code>-n</code>：输出文件前缀，BETA默认是<strong>NA</strong><br><code>-da</code>：选择显著性变化（上调和下调的）表达数据（根据实际情况修改）</p><p><strong>其他格式(不是limma和cuffdif标准格式）的差异表达文件格式：</strong></p><ul><li>需设置参数<code>--info</code>, geneID如果是smbol需要设置<code>--gname2</code></li></ul><h5 id="BETA-Plus"><a href="#BETA-Plus" class="headerlink" title="BETA Plus"></a>BETA Plus</h5><p>BETA Plus 预测调控因子的功能（激活或抑制）和靶基因，以及靶向区域的motif分析</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETA plus –p 3656_peaks.bed –e AR_expr.xls –k LIM –g hg19 --gs hg19.fa --bl</span><br></pre></td></tr></table></figure><p><strong>参数：</strong></p><p><code>--gs</code> : motif分析需要的参数, 基因组fasta格式<br><code>--bl</code> :可选参数，当考虑boundary（如CTCF）时需要的参数</p><h4 id="BETA-Minus"><a href="#BETA-Minus" class="headerlink" title="BETA Minus"></a>BETA Minus</h4><p>BETA Minus 只根据peak bed数据基于调控潜能值预测靶基因<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BETA minus -p 3656_peaks.bed --bl -g hg19</span><br></pre></td></tr></table></figure></p><h5 id="其他可选参数"><a href="#其他可选参数" class="headerlink" title="其他可选参数"></a>其他可选参数</h5><p><code>-n</code>：结果文件的名字<br><code>-o</code>:输出文件路径<br><code>--gname2</code>：geneID如果是smbol需要设置<code>--gname2</code><br><code>--info</code>：其他格式(不是limma和cuffdif标准格式）的差异表达文件格式：需设置参数<code>--info</code>,<br><code>--pn</code>:peak 数目，默认是10，000<br><code>-d DISTANCE,--distance</code> 距离TSS的距离. DEFAULT=100000 (100kb)<br><code>--df DIFF_FDR</code> : 输入0-1的数值，表示统计的阈值，如FDR等，默认是1.<br><code>--da DIFF_AMOUNT</code>; 取显著表达的基因，0-1表示比例，大于1表示个数。如2000，表示去top 2000个上调和下调的差异基因；0.5表示取50%上调和下调的基因，默认是0.5。<br><code>-c CUTOFF, --cutoff</code>： 0~1的一个阈值。默认是1e-3。<br><code>-r REFERENCE, --reference</code>： 当参考基因组不是hg19,或mm9时使用此参数。<br><code>--bl BOUNDARY</code> :LIMIT Boolean Value. Whether or not use CTCF boundary to get a peak’s associated gene, DEFAULT=FALSE<br><code>-bf BOUNDARYFILE</code> : Some BED format boundary file, use this only when You set –bl and the genome is neither hg19 nor mm9</p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><p><strong>文章</strong>Wang, S., Sun, H., Ma, J., Zang, C., Wang, C., Wang, J., … &amp; Liu, X. S. (2013). Target analysis by integration of transcriptome and ChIP-seq data with BETA. Nature protocols, 8(12), 2502-2515.<br><strong>PMID:</strong> 24263090<br><strong>网址：</strong> <a href="http://cistrome.org/BETA/index.html" target="_blank" rel="noopener">http://cistrome.org/BETA/index.html</a></p><h3 id="使用代码"><a href="#使用代码" class="headerlink" title="使用代码"></a>使用代码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/software/biosoft/software/python/python2.7/bin/BETA plus -P mep_ebDfpeak_deseq2_sig.bed --info -e mep_eb_dfexpre --gname2 -g hg 19 --gs hg19.fa --bl</span><br></pre></td></tr></table></figure><h3 id="几点疑问"><a href="#几点疑问" class="headerlink" title="几点疑问"></a>几点疑问</h3><p>BETA最初的设计主要是用于ChIP-Seq和RNA-seq的整合分析，最终可以预测特定一个转录因子的靶基因，以及这些基因是激活还是抑制的功能。但是对于ATAC-seq，它得到的信号整个基因组范围转录因子的信号，那么与转录组整合分析得到的结果怎么解释？只能知道一些基因的功能是激活的或抑制的，但是并不能知道这些基因是哪些转录因子的靶基因。所以BETA是否适合ATAC-seq和与RNA-seq的整合分析？如果可以，整合分析的结果能得到哪些有价值的信息？</p>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>转录因子足迹分析+启动子处染色质可及性与基因表达不一定成正相关</title>
      <link href="/2019/08/23/%E8%BD%AC%E5%BD%95%E5%9B%A0%E5%AD%90%E8%B6%B3%E8%BF%B9%E5%88%86%E6%9E%90+%E5%90%AF%E5%8A%A8%E5%AD%90%E5%A4%84%E6%9F%93%E8%89%B2%E8%B4%A8%E5%8F%AF%E5%8F%8A%E6%80%A7%E4%B8%8E%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E4%B8%8D%E4%B8%80%E5%AE%9A%E6%88%90%E6%AD%A3%E7%9B%B8%E5%85%B3/"/>
      <url>/2019/08/23/%E8%BD%AC%E5%BD%95%E5%9B%A0%E5%AD%90%E8%B6%B3%E8%BF%B9%E5%88%86%E6%9E%90+%E5%90%AF%E5%8A%A8%E5%AD%90%E5%A4%84%E6%9F%93%E8%89%B2%E8%B4%A8%E5%8F%AF%E5%8F%8A%E6%80%A7%E4%B8%8E%E5%9F%BA%E5%9B%A0%E8%A1%A8%E8%BE%BE%E4%B8%8D%E4%B8%80%E5%AE%9A%E6%88%90%E6%AD%A3%E7%9B%B8%E5%85%B3/</url>
      
        <content type="html"><![CDATA[<h3 id="题目：Identification-of-transcription-factorbinding-sites-using-ATAC-seq"><a href="#题目：Identification-of-transcription-factorbinding-sites-using-ATAC-seq" class="headerlink" title="题目：Identification of transcription factorbinding sites using ATAC-seq"></a>题目：Identification of transcription factorbinding sites using ATAC-seq</h3><p>DOI: 10.1186/s13059-019-1642-2<br>杂志/日期：Genome Biol. , 26 Feb 2019<br>关键词：ATAC-seq; Computational footprinting  </p><p>日期：2019年2月17日——2019-Week8</p><h3 id="主要内容："><a href="#主要内容：" class="headerlink" title="主要内容："></a>主要内容：</h3><p>这篇文章考虑到ATAC-seq实验的人工误差提出了第一个转录因子足迹的分析方法——HINT-ATAC，使用位置依赖模型探究转座酶的裂解偏好，观察到由局部核小体结构决定的转录因子结合位点周围的特异剪接模式，因此，HINT-ATAC可以更好的预测转录因子的结合位点。</p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/8242255-c303940cae18172b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="题目：Combined-analysis-of-dissimilar-promoter-accessibility-and-gene-expression-profiles-identifies-tissue-specific-genes-and-actively-repressed-networks"><a href="#题目：Combined-analysis-of-dissimilar-promoter-accessibility-and-gene-expression-profiles-identifies-tissue-specific-genes-and-actively-repressed-networks" class="headerlink" title="题目：Combined analysis of dissimilar promoter accessibility and gene expression profiles identifies tissue-specific genes and actively repressed networks"></a>题目：Combined analysis of dissimilar promoter accessibility and gene expression profiles identifies tissue-specific genes and actively repressed networks</h3><p>DOI: <a href="https://doi.org/10.1186/s13072-019-0260-2" target="_blank" rel="noopener">https://doi.org/10.1186/s13072-019-0260-2</a><br>杂志/日期：Epigenetics &amp; Chromatin, 12 Feb 2019<br>关键词：ATAC-seq; promoter  </p><p>日期：2019年2月17日——2019-Week8</p><h3 id="主要内容：-1"><a href="#主要内容：-1" class="headerlink" title="主要内容："></a>主要内容：</h3><p>许多研究都报道了启动子处的染色质可及性与基因表达成正相关，而这篇文章发现了一个不一样的趋势。他们发现相关性最强（高表达，强的染色质可及性）的可能与管家基因功能相关。组织特异性基因表达量高，但是染色质可及性仅为中低水平的coverage。此外，他们预测到中、低表达的、但是有高启动子覆盖的基因被积极抑制。</p>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>scATAC-seq分析工具</title>
      <link href="/2019/08/23/scATAC-seq%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/"/>
      <url>/2019/08/23/scATAC-seq%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/</url>
      
        <content type="html"><![CDATA[<h3 id="题目：Destin-toolkit-for-single-cell-analysis-of-chromatin-accessibility"><a href="#题目：Destin-toolkit-for-single-cell-analysis-of-chromatin-accessibility" class="headerlink" title="题目：Destin: toolkit for single-cell analysis of chromatin accessibility"></a>题目：Destin: toolkit for single-cell analysis of chromatin accessibility</h3><blockquote><p>DOI: <a href="https://doi.org/10.1093/bioinformatics/btz141" target="_blank" rel="noopener">https://doi.org/10.1093/bioinformatics/btz141</a><br>杂志/日期： Bioinformatics, 01 March 2019<br>关键词：  scATAC-seq，GWAS<br>分类：「工具」<br>日期：2019年2月10日——2019-Week7</p></blockquote><h3 id="主要内容："><a href="#主要内容：" class="headerlink" title="主要内容："></a>主要内容：</h3><p><strong>「Destin」</strong>用于scATAC-seq分析的一个R工具包，其中的一个亮点是分析GWAS结果是否与特定细胞类型集群中染色质可及性的增加有关，这里他们采用的是最初用于scRNA -seq表达的两种方法:ECWE和MAGMA。除此之外还包括：</p><ul><li>从bam文件获取实验信息</li><li>peaks的注释区域</li><li>质控</li><li>确定分群数量</li><li>差异可及性染色质<br>（其中输入文件是peaks，cell的bam文件）</li></ul><a id="more"></a><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>「Destin」用于sc-ATAC分析的一个R工具包，包括分群，与gwas关联，差异peaks分析等。</p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><ul><li>github : <a href="https://github.com/urrutiag/destin" target="_blank" rel="noopener">https://github.com/urrutiag/destin</a></li></ul><hr><h3 id="题目：-A-rapid-and-robust-method-for-single-cell-chromatin-accessibility-profiling"><a href="#题目：-A-rapid-and-robust-method-for-single-cell-chromatin-accessibility-profiling" class="headerlink" title="题目： A rapid and robust method for single cell chromatin accessibility profiling"></a>题目： A rapid and robust method for single cell chromatin accessibility profiling</h3><blockquote><p>DOI: <a href="https://www.nature.com/articles/s41467-018-07771-0" target="_blank" rel="noopener">https://www.nature.com/articles/s41467-018-07771-0</a><br>杂志/日期： Nature Communications, 17 December 2018<br>关键词： scATAC-seq，<br>分类：「工具」<br>日期：2019年2月10日——2019-Week7</p></blockquote><h3 id="主要内容：-1"><a href="#主要内容：-1" class="headerlink" title="主要内容："></a>主要内容：</h3><p>plate-based的scATAC-seq方法，结合了前期bulk Tn5单核分选标签。</p><h3 id="相关资料："><a href="#相关资料：" class="headerlink" title="相关资料："></a>相关资料：</h3><p>代码：<a href="https://github.com/dbrg77/plate_scATAC-seq" target="_blank" rel="noopener">https://github.com/dbrg77/plate_scATAC-seq</a>.<br>数据：bulk ATAC 和scATAC-seq :<a href="http://genome-euro.ucsc.edu/cgi-bin/hgTracks?hgS_doOtherUser=submit&amp;hgS_otherUserName=dbrg77&amp;hgS_otherUserSessionName=mSpleen_scATAC_cluster" target="_blank" rel="noopener">http://genome-euro.ucsc.edu/cgi-bin/hgTracks?hgS_doOtherUser=submit&amp;hgS_otherUserName=dbrg77&amp;hgS_otherUserSessionName=mSpleen_scATAC_cluster</a>.</p>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> 文献摘要 </tag>
            
            <tag> scATACseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>esATAC_一个ATAC-seq分析的R包</title>
      <link href="/2019/08/23/esATAC_%E4%B8%80%E4%B8%AAATAC-seq%E5%88%86%E6%9E%90%E7%9A%84R%E5%8C%85/"/>
      <url>/2019/08/23/esATAC_%E4%B8%80%E4%B8%AAATAC-seq%E5%88%86%E6%9E%90%E7%9A%84R%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<blockquote><p>日期：2019年1月13日——2019-Week2<br>分类：「工具」<br>题目：esATAC: An Easy-to-use Systematic pipeline for ATAC-seq data analysis<br>DOI: 10.1093/bioinformatics/bty141<br>杂志：Bioinformatics，2018 Aug<br>关键词： ATAC; chromatin accessibility; transcription factor; regulatory network</p></blockquote><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>之前介绍过中科大Kun Qu老师实验室开发的用于bulk ATAC-seq分析的工具包 —— <a href="https://www.jianshu.com/p/df239acc1e62" target="_blank" rel="noopener">「ATAC-pipe」</a>，虽然个人并不推荐依赖使用这种打包工具包。但是他们的分析方法和原理还是值得了解和学习的。这里再介绍一个ATAC-seq分析的工具包——<strong>esATAC</strong>，是由清华大学Xiaowo Wang老师实验室开发的一个R/Bioconductor包，它的功能包括如下几方面：</p><ul><li>原始数据的质控和比对</li><li>peak calling</li><li>富集分析</li><li>转录因子足迹分析</li></ul><a id="more"></a><p><strong>具体分析方法参考vignettes:</strong><br><a href="https://www.bioconductor.org/packages/release/bioc/vignettes/esATAC/inst/doc/esATAC-Introduction.html" target="_blank" rel="noopener">https://www.bioconductor.org/packages/release/bioc/vignettes/esATAC/inst/doc/esATAC-Introduction.html</a></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-7618934170793d38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="数据分析流程"><a href="#数据分析流程" class="headerlink" title="数据分析流程"></a>数据分析流程</h3><ul><li>初始数据：可以直接处理fastq格式的测序数据</li><li>质控：多种质控方法，包括测序质量，read length分布等</li><li>去接头：AdapterRemoval</li><li>比对：Bowtie2</li><li>鉴定开放染色质peak：<strong>F-seq？？</strong><br>仔细了解(Boyle, et al., 2008,Koohy, et al., 2014)</li><li>peak的注释：ChIPseeker包</li><li>TF分析：结合JASPAR数据库</li><li>适用物种：人和鼠</li></ul><hr><p><strong>单细胞RNA-seq、ATAC-seq分析教程、工具大集锦:</strong> <a href="https://github.com/seandavi/awesome-single-cell" target="_blank" rel="noopener">https://github.com/seandavi/awesome-single-cell</a> </p>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ATAC-pipe_ATAC-seq分析的工具包</title>
      <link href="/2019/08/23/ATAC-pipe_ATAC-seq%E5%88%86%E6%9E%90%E7%9A%84%E5%B7%A5%E5%85%B7%E5%8C%85/"/>
      <url>/2019/08/23/ATAC-pipe_ATAC-seq%E5%88%86%E6%9E%90%E7%9A%84%E5%B7%A5%E5%85%B7%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<blockquote><p>日期：2019年1月6日——2019-Week1<br>分类：「工具」<br>题目：ATAC-pipe: general analysis of genome-wide chromatin accessibility<br>DOI: 10.1093/bib/bby056<br>杂志：Briefings in Bioinformatics<br>关键词： ATAC; chromatin accessibility; transcription factor; regulatory network</p></blockquote><h3 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h3><p>ATAC-pipe是中科大Kun Qu实验室开发的一个打包软件包，用于分析bulk ATAC-Seq。主要功能包括：</p><ul><li>鉴定显著差异的开放染色质区域</li><li>motif分析及相关的TFs对转录调控的影响</li><li>TF和motif的足迹分析以及核小体占位的可视化</li><li>基于相关性的细胞聚类分析</li><li>构建TF调控网络，评估TFs和基因间的相互作用</li></ul><a id="more"></a><p><strong>详细用法参考：</strong> <a href="https://github.com/QuKunLab/ATAC-pipe" target="_blank" rel="noopener">https://github.com/QuKunLab/ATAC-pipe</a><br>或者 manual for ATAC-pipe:<br><a href="https://github.com/QuKunLab/ATAC-pipe/blob/master/Manual_for_ATAC-pipe.pdf" target="_blank" rel="noopener">https://github.com/QuKunLab/ATAC-pipe/blob/master/Manual_for_ATAC-pipe.pdf</a><br><img src="https://upload-images.jianshu.io/upload_images/8242255-6a010cefce1de392.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="材料和方法"><a href="#材料和方法" class="headerlink" title="材料和方法"></a>材料和方法</h3><h4 id="1-流程和算法"><a href="#1-流程和算法" class="headerlink" title="1. 流程和算法"></a>1. 流程和算法</h4><p>ATAC-pipe是基于其他工具和软件包的，需要在Linux/MAC OS平台安装 requires Bowtie2, Picard, MACS2, HOMER, Python和R的环境，以及相关的参考基因组和DESeq R包。</p><ul><li>比对: Bowtie2</li><li>去重: Picard</li><li>peak calling: MACS2</li><li>count标准化和差异分析：DESeq</li><li>聚类和热图：Cluster 3.0 和 Treeview</li><li>TF motifs分析: Homer and msCentipede</li><li>序列迁移，TSS富集值和分布，V-plot, TF调控网络：他们自己实验室写的代码</li></ul><h4 id="2-与其他工具的比较"><a href="#2-与其他工具的比较" class="headerlink" title="2. 与其他工具的比较"></a>2. 与其他工具的比较</h4><p>他们的介绍是「ATAC-pipe功能多，其他工具可能只是包含QC，比对，peak calling等基本步骤，但是ATAC-pipe还包含样本聚类，motif 搜索，足迹验证、核小体占位分析和TF调控网络分析，而且更重要的是可以鉴定显著差异开放染色质区域和这些区域的TF motif富集, 另外所需时间与其他工具相比较少」。<br>（他们介绍的优点了解下即可，其实很多工具都可以实现相同的功能,其他工具的功能和原理也要了解一下）<br><img src="https://upload-images.jianshu.io/upload_images/8242255-00e3a65dc7a94075.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ATAC-pipe与其他工具的比较"></p><h3 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h3><p>看一下这个流程包可以给出哪些结果</p><h4 id="结果1：质控"><a href="#结果1：质控" class="headerlink" title="结果1：质控"></a>结果1：质控</h4><p><img src="https://upload-images.jianshu.io/upload_images/8242255-15f9acb35786f78c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="测序质量QC"><br><img src="https://upload-images.jianshu.io/upload_images/8242255-5a9da9e0aa35587e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实验QC"></p><h4 id="结果2：相关性和差异peaks分析"><a href="#结果2：相关性和差异peaks分析" class="headerlink" title="结果2：相关性和差异peaks分析"></a>结果2：相关性和差异peaks分析</h4><p><img src="https://upload-images.jianshu.io/upload_images/8242255-3f34efca235a3415.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="相关性和差异peaks分析"></p><h4 id="结果3：TF-富集分析"><a href="#结果3：TF-富集分析" class="headerlink" title="结果3：TF 富集分析"></a>结果3：TF 富集分析</h4><p><img src="https://upload-images.jianshu.io/upload_images/8242255-f4447516f707f93d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="差异开放染色质区域和这些区域的motif富集分析"></p><h4 id="结果4：TF-motif足迹分析和核小体占位分析"><a href="#结果4：TF-motif足迹分析和核小体占位分析" class="headerlink" title="结果4：TF motif足迹分析和核小体占位分析"></a>结果4：TF motif足迹分析和核小体占位分析</h4><p><img src="https://upload-images.jianshu.io/upload_images/8242255-9a61f22dbaed9e14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="TF motif足迹分析和核小体占位分析"></p><h4 id="结果5：TF驱动调控网络"><a href="#结果5：TF驱动调控网络" class="headerlink" title="结果5：TF驱动调控网络"></a>结果5：TF驱动调控网络</h4><h2 id><a href="#" class="headerlink" title></a><img src="https://upload-images.jianshu.io/upload_images/8242255-eeda0fad3ba7c092.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="TF驱动调控网络"></h2><h3 id="讨论"><a href="#讨论" class="headerlink" title="讨论"></a>讨论</h3><p>使用他人打包的工具包有人可能觉得省时方便，但是会有很多限制，不够灵活。而且他们这个工具包本身需要安装很多工具，最终是包装成python模块，使用时是需要有linux和python基础的。他们的分析结果有很多工具和方法可以实现，对于这篇文章也就是了解下他们进行ATAC-seq分析时使用的方法，同时了解下文章中做比较时提到其他工具。</p><p>如果想实现个性化和弹性化的分析，还是需要自己了解掌握每一步的分析流程，具体方法可以参考之前的帖子:</p><ul><li><a href="https://mp.weixin.qq.com/s/iVMY_0Su278OfWc2r2_brQ" target="_blank" rel="noopener">ATAC-Seq入门加高阶传送门，文末点击可进入交流群</a><br><a href="https://mp.weixin.qq.com/s/iVMY_0Su278OfWc2r2_brQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/iVMY_0Su278OfWc2r2_brQ</a></li><li><a href="https://mp.weixin.qq.com/s/7k2GEmPmnkVfmzegpxabQA" target="_blank" rel="noopener">第10篇：ATAC-Seq、ChIP-Seq、RNA-Seq整合分析（内附目录）</a><br><a href="https://mp.weixin.qq.com/s/7k2GEmPmnkVfmzegpxabQA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/7k2GEmPmnkVfmzegpxabQA</a></li><li><a href="https://mp.weixin.qq.com/s/XQITfdnS6Zn6iTBtuladPw" target="_blank" rel="noopener">给学徒的ATAC-seq数据实战（附上收费视频）</a><br><a href="https://mp.weixin.qq.com/s/XQITfdnS6Zn6iTBtuladPw" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/XQITfdnS6Zn6iTBtuladPw</a></li></ul><hr><p>另外记得在去年苏州单细胞会议的海报展示，Kun Qu老师实验室展示了一个用于sc-ATAC分析的工具包APEC（不知道发表没）。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-a706382e4acfb3e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>APEC的文章已在预印版上发出：<a href="https://www.biorxiv.org/content/early/2019/05/23/646331.full.pdf" target="_blank" rel="noopener">https://www.biorxiv.org/content/early/2019/05/23/646331.full.pdf</a> </p>]]></content>
      
      
      <categories>
          
          <category> literature </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第10篇：ATAC-Seq、ChIP-Seq、RNA-Seq整合分析</title>
      <link href="/2019/08/23/%E7%AC%AC10%E7%AF%87%EF%BC%9AATAC-Seq%E3%80%81ChIP-Seq%E3%80%81RNA-Seq%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90/"/>
      <url>/2019/08/23/%E7%AC%AC10%E7%AF%87%EF%BC%9AATAC-Seq%E3%80%81ChIP-Seq%E3%80%81RNA-Seq%E6%95%B4%E5%90%88%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>由于基因表达调控机制的复杂性，多种组学数据的整合分析，从不同的层面探究生物问题越来越重要。从RNA-Seq层面，我们可以探究哪些基因具有显著差异，上调或下调；从ChIP-Seq层面，我们可以研究某个特定转录因子的调控作用；从ATAC-Seq我们可以了解到染色质可及性的动态变化，由于染色质的可及性与调控元件或转录因子的结合密切相关，在转录调控中发挥着重要的作用。因此，整合分析可以进一步探究调控某一生物学过程的关键因子（包括顺式调控元件和转录因子），以及哪个转录因子调控了感兴趣的基因，以及感兴趣的转录因子的靶基因等。<br>目前，好像并没有标准化的方法用来整合比较这三种数据。不过在文献中可以看到有很多相同的或不同的思路和方法做整合分析，大家可以在学习交流群中推荐文献，一起解读学习。</p><a id="more"></a><p>下面的内容主要介绍这一节课程中RNA-Seq和ChIP-Seq的整合分析中提到的两种方法：<br><strong>一是直接比较</strong>，即首先得到差异基因与ChIP-Seq靶基因的overlap，然后选择一些关键基因比较一下谱图。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-3a8682b8a3260f0c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Gao et. al, Nature 2014，doi: 10.1038/nature13921"><br><strong>课程中提到的另一种方法是使用BETA工具：</strong><br><strong>BETA (Binding and Expression Target Analysis)</strong>是 Shirley Liu实验室开发的工具，通过整合转录因子或染色质调控因子的ChIP-Seq与差异基因的表达直接预测靶基因，而且有可能发现增强子区的蛋白质的靶基因。<br>BETA有三个功能：</p><ul><li>预测转录因子的功能是激活还是抑制</li><li>预测转录因子的靶基因</li><li>鉴定转录因子的motif以及调控转录因子激活或抑制的其他因子</li></ul><p>BETA包括三个命令取决于输入数据格式和想要的输出数据（可以参考嘉因的帖子<a href="https://mp.weixin.qq.com/s/Nm47ZMbdlIx-OI5j5wo4nA" target="_blank" rel="noopener">ChIP-seq和RNA-seq整合分析，BETA最擅长 | 自己分析数据的完美解决方案</a>）</p><ul><li>BETA basic: 预测转录因子的功能是激活还是抑制，直接检测靶标</li><li>BETA plus：BETA basic + 靶标区域的motif分析</li><li>BETA minus：只基于结合数据的调控潜能的值预测TF靶基因</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/8242255-126e213bad02247c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Nat Protoc. 2013 Dec; 8(12): 2502–2515."></p><p><strong>工作原理</strong></p><ul><li>每个基因的调控潜能值是通过计算基因TSS的指定范围内的所有结合位点来计算的</li><li>调控潜能是基因受因子调节的可能性，取决于TSS范围的结合位点数以及与结合位点与TSS之间的距离</li><li>BETA minus按照调控潜能值对基因排序来鉴定靶标</li><li>BETA basic需要特定格式的差异分析结果和显著性的结果。它使用CDF来判断上调基因和下调基因是否与NON-DE不同，这是用来识别激活和抑制功能。使用调控潜能和差异统计量计算每一个基因的得分排序，该得分排序可以用于识别靶标。<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3></li></ul><ol><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/integrating_rna-seq_and_chip-seq.md" target="_blank" rel="noopener">哈佛深度NGS数据分析课程，10-Integrating RNA-seq and ChIP-seq</a></li><li><a href="https://mp.weixin.qq.com/s/-7Bx29H5nM-LQJiu9hbYjw" target="_blank" rel="noopener">大牛新宠，转录调控研究神器！找关键转录因子、推测转录因子-靶基因关系</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> ChIPseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第9篇：差异peaks分析——DiffBind</title>
      <link href="/2019/08/23/%E7%AC%AC9%E7%AF%87%EF%BC%9A%E5%B7%AE%E5%BC%82peaks%E5%88%86%E6%9E%90%E2%80%94%E2%80%94DiffBind/"/>
      <url>/2019/08/23/%E7%AC%AC9%E7%AF%87%EF%BC%9A%E5%B7%AE%E5%BC%82peaks%E5%88%86%E6%9E%90%E2%80%94%E2%80%94DiffBind/</url>
      
        <content type="html"><![CDATA[<h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><ul><li><p>学习用DiffBind流程评估两个样本间的差异结合区域</p></li><li><p>用PCA评估样本间的关系</p></li><li><p>评估不同工具得到的差异peaks的一致性</p><a id="more"></a></li></ul><h3 id="评估差异peaks富集的工具"><a href="#评估差异peaks富集的工具" class="headerlink" title="评估差异peaks富集的工具"></a>评估差异peaks富集的工具</h3><p>ATAC-Seq下游分析的另一个重点是差异peaks分析。如分析不同的实验条件、多个时间节点、不同的发育时期等的差异区域。鉴定这些差异peaks区域在生物医学研究中也具有重要意义，目前也有多种相关的工具被开发：<br><img src="https://upload-images.jianshu.io/upload_images/8242255-78b2f423dc7b0fa8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>选择合适的工具需考虑以下几个因素：</strong></p><ul><li>所用的软件不需要大量的代码移植，该工具是否被维护和频繁更新。</li><li>用户需要提供什么样的输入文件，是否与peaks calling所用工具可以衔接。</li><li>信号分布的基础统计模型是什么？是基于泊松分布或更灵活的负二项分布。</li><li>一些工具是专门针对特定的ATAC-seq或ChIP-seq 数据（信号类型）设计的，如组蛋白修饰或转录因子（TF）结合。</li></ul><p>具体选择哪种工具决定于实验设计，下面的决策树可以帮助缩小你的选择范围。</p><h2 id><a href="#" class="headerlink" title></a><img src="https://upload-images.jianshu.io/upload_images/8242255-3f133ad5e0d5b6e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></h2><h3 id="DiffBind"><a href="#DiffBind" class="headerlink" title="DiffBind"></a>DiffBind</h3><p>DiffBind是鉴定两个样本间差异结合位点的一个R包。主要用于peak数据集，包括对peaks的重叠和合并的处理，计算peaks重复间隔的测序reads数，并基于结合亲和力鉴定具有统计显著性的差异结合位点。适用的统计模型有DESeq、DESeq2、edgeR。详细内容可参考DiffBind的文档：<a href="http://bioconductor.org/packages/release/bioc/vignettes/DiffBind/inst/doc/DiffBind.pdf" target="_blank" rel="noopener">http://bioconductor.org/packages/release/bioc/vignettes/DiffBind/inst/doc/DiffBind.pdf</a></p><h3 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h3><h4 id="1-下载安装DiffBind"><a href="#1-下载安装DiffBind" class="headerlink" title="1. 下载安装DiffBind"></a>1. 下载安装DiffBind</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span>(<span class="string">"https://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"DiffBind"</span>)</span><br><span class="line"><span class="comment"># view documentation</span></span><br><span class="line">browseVignettes(<span class="string">"DiffBind"</span>)</span><br></pre></td></tr></table></figure><h4 id="2-准备输入文件"><a href="#2-准备输入文件" class="headerlink" title="2. 准备输入文件"></a>2. 准备输入文件</h4><p>需要准备一个SampleSheet文件，与<a href="（https://www.jianshu.com/p/a11147808d14）">ChIPQC</a>的方法一样。SampleSheet文件是根据实验设计和数据存储地址等信息创建的一个csv格式文件，包含的表头信息有<strong>“SampleID”、 “Tissue”、 “Factor”、 “Condition” 、”Treatment”、”Replicate” 、”bamReads” 、”ControlID”、 “bamControl” “Peaks”、 “PeakCaller”</strong>（bam,peak文件分别在比对和call peak的步骤产生）。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-e5e43bc02d122cc8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h4 id="3-差异peaks分析"><a href="#3-差异peaks分析" class="headerlink" title="3. 差异peaks分析"></a>3. 差异peaks分析</h4><p><strong>读入文件</strong><br>一旦读入了peaksets，合并函数就找到所有重叠的peaks，并导出一致性的peaksets。<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(DiffBind)</span><br><span class="line">dbObj &lt;- dba(sampleSheet=<span class="string">"SampleSheet.csv"</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-b45f2ad5b70f46af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>亲和结合矩阵</strong><br>计算每个peaks/regions的count信息。先对一致性的peaks数据集进行标准化，然后根据他们的峰值（point of greatest read overlap）再次中心化并修剪一些peaks，最终得到更加标准的peak间隔。使用函数dba.count()，参数<code>bUseSummarizeOverlaps</code>可以得到更加标准的计算流程。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dbObj &lt;- dba.count(dbObj, bUseSummarizeOverlaps=TRUE)</span><br><span class="line">dba.plotPCA(dbObj,  attributes=DBA_FACTOR, label=DBA_ID)</span><br><span class="line">plot(dbObj)</span><br></pre></td></tr></table></figure><p>结果中同时计算了FRiP (质量评估的一个标准，可以参考<a href="https://www.jianshu.com/p/a11147808d14" target="_blank" rel="noopener">第5篇：对ATAC-Seq/ChIP-seq的质量评估（二）——ChIPQC</a>)。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-bda08e59563ab91a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>样本间的聚类:<br><img src="https://upload-images.jianshu.io/upload_images/8242255-d806500399a287b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>Venn图展示样本间peaks的重合<br><img src="https://upload-images.jianshu.io/upload_images/8242255-d68a6b35c676e047.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>差异分析</strong><br>差异分析是DiffBind的核心功能，默认情况是基于DEseq2, 可以设置参数<code>method=DBA_EDGER</code>选择edgeR，或者设置<code>method=DBA_ALL_METHODS</code>。每种方法都会评估差异结果的p-vaue和FDR。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Establishing a contrast </span><br><span class="line">dbObj &lt;- dba.contrast(dbObj, categories=DBA_FACTOR,minMembers = 2)</span><br><span class="line">dbObj &lt;- dba.analyze(dbObj, method=DBA_ALL_METHODS)</span><br><span class="line">#  summary of results</span><br><span class="line">dba.show(dbObj, bContrasts=T)</span><br><span class="line">#  overlapping peaks identified by the two different tools (DESeq2 and edgeR)</span><br><span class="line">dba.plotVenn(dbObj,contrast=1,method=DBA_ALL_METHODS)</span><br></pre></td></tr></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/8242255-22e7d87169ae0a19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>提取结果</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">comp1.edgeR &lt;- dba.report(dbObj, method=DBA_EDGER, contrast = 1, th=1)</span><br><span class="line">comp1.deseq &lt;- dba.report(dbObj, method=DBA_DESEQ2, contrast = 1, th=1)</span><br></pre></td></tr></table></figure><p>结果文件包含所有位点的基因组坐标，以及差异富集的统计数据包括fold change、p值和FDR。<br>其中<code>Conc</code>的表示read的平均浓度，即对peak 的read counts进行log2标准化</p><blockquote><p>The value columns show the mean read concentration over all the samples (the default calculation uses log2 normalized ChIP read counts with control read counts subtracted) and the mean concentration over the first (Resistant) group and second (Responsive) group.</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/8242255-9cbf839407929d40.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>保存文件</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># EdgeR</span></span><br><span class="line">out &lt;- as.data.frame(comp1.edgeR)</span><br><span class="line">write.table(out, file=<span class="string">"results/Nanog_vs_Pou5f1_edgeR.txt"</span>, sep=<span class="string">"\t"</span>, quote=<span class="literal">F</span>, col.names = <span class="literal">NA</span>)</span><br><span class="line"><span class="comment"># DESeq2</span></span><br><span class="line">out &lt;- as.data.frame(comp1.deseq)</span><br><span class="line">write.table(out, file=<span class="string">"results/Nanog_vs_Pou5f1_deseq2.txt"</span>, sep=<span class="string">"\t"</span>, quote=<span class="literal">F</span>, col.names = <span class="literal">NA</span>)</span><br></pre></td></tr></table></figure><p><strong>以bed格式保存显著性的差异结果</strong><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create bed files for each keeping only significant peaks (p &lt; 0.05)</span></span><br><span class="line"><span class="comment"># EdgeR</span></span><br><span class="line">out &lt;- as.data.frame(comp1.edgeR)</span><br><span class="line">edge.bed &lt;- out[ which(out$FDR &lt; <span class="number">0.05</span>), </span><br><span class="line">                 c(<span class="string">"seqnames"</span>, <span class="string">"start"</span>, <span class="string">"end"</span>, <span class="string">"strand"</span>, <span class="string">"Fold"</span>)]</span><br><span class="line">write.table(edge.bed, file=<span class="string">"results/Nanog_vs_Pou5f1_edgeR_sig.bed"</span>, sep=<span class="string">"\t"</span>, quote=<span class="literal">F</span>, row.names=<span class="literal">F</span>, col.names=<span class="literal">F</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># DESeq2</span></span><br><span class="line">out &lt;- as.data.frame(comp1.deseq)</span><br><span class="line">deseq.bed &lt;- out[ which(out$FDR &lt; <span class="number">0.05</span>), </span><br><span class="line">                 c(<span class="string">"seqnames"</span>, <span class="string">"start"</span>, <span class="string">"end"</span>, <span class="string">"strand"</span>, <span class="string">"Fold"</span>)]</span><br><span class="line">write.table(deseq.bed, file=<span class="string">"results/Nanog_vs_Pou5f1_deseq2_sig.bed"</span>, sep=<span class="string">"\t"</span>, quote=<span class="literal">F</span>, row.names=<span class="literal">F</span>, col.names=<span class="literal">F</span>)</span><br></pre></td></tr></table></figure></p><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ol><li><a href="http://bioconductor.org/packages/release/bioc/vignettes/DiffBind/inst/doc/DiffBind.pdf" target="_blank" rel="noopener">DiffBind文档</a></li><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/09_differential_peaks.md" target="_blank" rel="noopener">哈佛深度NGS数据分析课程， 09- Differential Peak calling using DiffBind</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> ChIPseq </tag>
            
            <tag> 差异分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第8篇：用网页版工具做功能分析和motif分析</title>
      <link href="/2019/08/23/%E7%AC%AC8%E7%AF%87%EF%BC%9A%E7%94%A8%E7%BD%91%E9%A1%B5%E7%89%88%E5%B7%A5%E5%85%B7%E5%81%9A%E5%8A%9F%E8%83%BD%E5%88%86%E6%9E%90%E5%92%8Cmotif%E5%88%86%E6%9E%90/"/>
      <url>/2019/08/23/%E7%AC%AC8%E7%AF%87%EF%BC%9A%E7%94%A8%E7%BD%91%E9%A1%B5%E7%89%88%E5%B7%A5%E5%85%B7%E5%81%9A%E5%8A%9F%E8%83%BD%E5%88%86%E6%9E%90%E5%92%8Cmotif%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<blockquote><p>上一篇介绍了使用ChIPseeker对peaks的分布和邻近基因的注释。除此之外，下游分析通常还包括<strong>鉴定我们感兴趣的蛋白质结合的motif；鉴定这些结合区域的基因以及这些基因的富集通路或网络。</strong></p></blockquote><h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><ul><li><strong>功能富集分析: [GREAT]</strong>(<a href="http://bejerano.stanford.edu/great/public/html/index.php" target="_blank" rel="noopener">http://bejerano.stanford.edu/great/public/html/index.php</a>)</li><li><strong>motif分析:MEME套件，如DREME(<a href="http://meme-suite.org/tools/dreme)" target="_blank" rel="noopener">http://meme-suite.org/tools/dreme)</a>, MEME-ChIP (<a href="http://meme-suite.org/tools/meme-chip" target="_blank" rel="noopener">http://meme-suite.org/tools/meme-chip</a>)</strong> </li></ul><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/8242255-8e8c5b7121002686.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="准备文件"><a href="#准备文件" class="headerlink" title="准备文件"></a>准备文件</h3><p><strong>提取IDR结果文件的前3列</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cut -f 1,2,3 Nanog-idr-merged.bed  &gt; Nanog-idr-merged-great.bed</span><br></pre></td></tr></table></figure></p><p><strong>使用<code>bedtools getfasta</code>提取peaks的序列</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bedtools getfasta -<span class="keyword">fi</span> \</span><br><span class="line">ref_genome.fa \</span><br><span class="line">-bed Nanog-idr-merged-great.bed \</span><br><span class="line">-fo Nanog-idr-merged-dreme.fasta</span><br></pre></td></tr></table></figure></p><h3 id="富集分析"><a href="#富集分析" class="headerlink" title="富集分析"></a>富集分析</h3><p>GREAT(<a href="http://bejerano.stanford.edu/great/public/html/index.php)对peaks的功能注释是对peaks临近基因的注释。" target="_blank" rel="noopener">http://bejerano.stanford.edu/great/public/html/index.php)对peaks的功能注释是对peaks临近基因的注释。</a><br><strong>方法：</strong></p><ul><li>1.打开GREAT网站：<a href="http://bejerano.stanford.edu/great/public/html/index.php" target="_blank" rel="noopener">http://bejerano.stanford.edu/great/public/html/index.php</a> 。上传<code>Nanog-idr-merged-great.bed</code>文件，选择参考基因组，选择<code>Whole genome</code>作为背景区域，然后点击<code>Submit</code>。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-28d362bcb09d151b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li><li><ol start="2"><li>点开<code>Job Description</code>,选择<code>View all genomic region-gene associations</code>，结果中的两个表给出peaks注释到的基因，一个是基因组区域和基因关联的表，一个是基因和基因组关联的表：<br><img src="https://upload-images.jianshu.io/upload_images/8242255-c858a398d92b19a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="3"><li><code>Region-Gene Association Graphs</code><br>这栏内容对结合位点的基因数和转录起始位点相关的基因做了图形展示。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-5e49b7856b712239.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="4"><li><code>Global Controls</code><br>选择想注释的信息，如GO注释<br><img src="https://upload-images.jianshu.io/upload_images/8242255-34e46431f660ae7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="5"><li>探究Nanog结合位点相关的GO BP term<br><img src="https://upload-images.jianshu.io/upload_images/8242255-f20dd9477422c904.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="6"><li>选择某个term,查看具体信息<br><img src="https://upload-images.jianshu.io/upload_images/8242255-752f9bd3f211869b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ol></li><li><ol start="7"><li>打开<code>This term&#39;s genomic region-gene association tables (140 regions, 116 genes)</code>，查看注释到的GO term相关的基因，可以下载表格。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-ac6510b361c9db44.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></li></ol></li><li><ol start="8"><li>在<code>This term&#39;s gene -&gt; genomic region association table</code>中点击基因相关的regions，可以在UCSC浏览器上直接查看结合区域。</li></ol></li></ul><hr><h3 id="找Motif"><a href="#找Motif" class="headerlink" title="找Motif"></a>找Motif</h3><p>motif是比较有特征的短序列，会多次出现的，并被假设拥有生物学功能。而且，经常是一些具有序列特异性的蛋白的结合位点（如转录因子）或者是涉及到重要生物过程的（如，RNA 起始，RNA 终止， RNA 剪切等等）。<br>有很多网页版工具提供了找motif的方法，2014年的一篇综述列出了目前常用的网页工具（<a href="https://doi.org/10.1186/1745-6150-9-4" target="_blank" rel="noopener">https://doi.org/10.1186/1745-6150-9-4</a> ）：<br><img src="https://upload-images.jianshu.io/upload_images/8242255-4e6d85633c68e1d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>最常用的有MEME工具套件，下面主要介绍DREME。<strong>DREME</strong>适用于大批量的ChIP-Seq数据找真核转录因子短的（4nt或8nt）核心DNA结合基序。</p><h4 id="DREME"><a href="#DREME" class="headerlink" title="DREME"></a>DREME</h4><ul><li>打开DREME网页 <a href="http://meme-suite.org/tools/dreme" target="_blank" rel="noopener">http://meme-suite.org/tools/dreme</a> ，只要输入fasta序列<code>Nanog-idr-merged-dreme.fasta</code>即可，同时可以写上email和每个任务的描述，任务完成时如右图所示，可以打开DREAM_HTML_output查看结果。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-f7d4e747bf2f1644.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>DREME’s HTML展示的结果包括找到的motif的序列logo和表示显著性的E-value。点击<code>More</code>可以查看更多的信息。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-da950ecc30a57391.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>Tomtom</strong><br>为了确定鉴定到的motif与已知转录因子的motif是否相似，可以将找到的motif再提交到<strong>Tomtom</strong>，与已知的转录因子数据库搜索匹配，同时还会给出motif-motif相似性的统计评估。<br>在DREAM’s HTML结果中选择某个预测到的motif，点击<code>Submit / Download</code>,然后选择<code>Tomtom</code>，点击<code>Submit</code>，在新打开的Tomtom界面可以选择转录因子的参考数据库，保持默认参数不变，也可以再添加其他参数，输入邮箱和任务描述就可以开始搜索。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-d9aa88cd750c93ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><h4 id="MEME-ChIP"><a href="#MEME-ChIP" class="headerlink" title="MEME-ChIP"></a>MEME-ChIP</h4>MEME-ChIP是MEME套件中的另一个工具，可以实现DREAM和Tomtom的分析功能，还可以评估motifs的中心富集性并整合相关的motifs合成相似性簇。MEME-ChIP能够鉴定更长的motifs（&lt;30bp）,但是运行时间比较长。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-1da222fab1a31f81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br>另外可以用Homer找motif，详细用法参考<a href="https://vip.biotrainee.com/d/388-motif" target="_blank" rel="noopener">找个motif嘛，简单</a>。<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3></li></ul><ol><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/08_functional_analysis.md" target="_blank" rel="noopener">哈佛深度NGS数据分析课程, 08-Web-based functional analysis and motif discovery</a></li><li><a href="https://vip.biotrainee.com/d/388-motif" target="_blank" rel="noopener">找个motif嘛，简单</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> ChIPseq </tag>
            
            <tag> motif </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第7篇：用Y叔的ChIPseeker对peaks进行注释和可视化</title>
      <link href="/2019/08/23/%E7%AC%AC7%E7%AF%87%EF%BC%9A%E7%94%A8Y%E5%8F%94%E7%9A%84ChIPseeker%E5%AF%B9peaks%E8%BF%9B%E8%A1%8C%E6%B3%A8%E9%87%8A%E5%92%8C%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
      <url>/2019/08/23/%E7%AC%AC7%E7%AF%87%EF%BC%9A%E7%94%A8Y%E5%8F%94%E7%9A%84ChIPseeker%E5%AF%B9peaks%E8%BF%9B%E8%A1%8C%E6%B3%A8%E9%87%8A%E5%92%8C%E5%8F%AF%E8%A7%86%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<blockquote><p>上一步骤（<a href="https://www.jianshu.com/p/d8a7056b4294" target="_blank" rel="noopener">第6篇：重复样本的处理——IDR</a>）用IDR对重复样本peaks的一致性进行了评估，同时得到了merge后的一致性的peaks——<code>sample-idr</code>，接下来就是对peaks的注释。这篇主要介绍用Y叔的R包<strong><a href="http://www.bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html" target="_blank" rel="noopener">ChIPseeker</a>对peaks的位置（如peaks位置落在启动子、UTR、内含子等）以及peaks临近基因的注释</strong>。</p></blockquote><h3 id="ChIPseeker"><a href="#ChIPseeker" class="headerlink" title="ChIPseeker"></a>ChIPseeker</h3><p>ChIPseeker虽然最初是为了ChIP-seq注释而写的一个R包，但它不只局限于ChIP-seq，也可用于ATAC-Seq等其他富集peaks注释，也可用于lincRNA注释、DNA breakpoints的断点位置注释等所有genomic coordination的注释，另外提供了丰富的可视化功能。<br>ChIPseeker的强大功能请参考Y叔的<a href="(https://mp.weixin.qq.com/mp/homepage?__biz=MzI5NjUyNzkxMg==&amp;hid=11&amp;sn=c22229f28bd00c3efd2c89cdadd63315&amp;scene=18&amp;devicetype=android-23&amp;version=26070238&amp;lang=zh_CN&amp;nettype=3gnet&amp;ascene=7&amp;session_us=gh_ba0578f6322d">ChIP-Seq系列文章</a>)，如：<br><a href="https://mp.weixin.qq.com/s/vWTf59KDs1lp_sQXjEhI_g" target="_blank" rel="noopener">CS3: peak注释</a><br><a href="https://mp.weixin.qq.com/s/_OPzvaEAbiMolCA2mqJXLw" target="_blank" rel="noopener">CS4：关于ChIPseq注释的几个问题</a><br><a href="https://mp.weixin.qq.com/s/MqpfgkMJSFj0pYwcEjV9kQ" target="_blank" rel="noopener">CS6: ChIPseeker的可视化方法（中秋节的视觉饕餮）</a></p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/8242255-ed9f825cf93a7fa8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><p>使用ChIPseeker需要准备两个文件：一个就是要注释的peaks的文件，需满足BED格式。另一个就是注释参考文件，即需要一个包含注释信息的TxDb对象。Bioconductor提供了30个TxDb包，如果其中有研究的物种就可以直接下载安装此物种的TxDb信息。如果研究的物种没有已知的TxDb，可以使用GenomicFeatures包的函数（makeTxDbFromUCSC，makeTxDbFromBiomart）制作TxDb对象：</p><blockquote><p>makeTxDbFromUCSC： 通过UCSC在线制作TxDb<br>makeTxDbFromBiomart: 通过ensembl在线制作TxDb<br>makeTxDbFromGRanges：通过GRanges对象制作TxDb<br>makeTxDbFromGFF：通过解析GFF文件制作TxDb</p></blockquote><p><strong>制作TxDb方法示例（<a href="https://mp.weixin.qq.com/s/_OPzvaEAbiMolCA2mqJXLw" target="_blank" rel="noopener">CS4：关于ChIPseq注释的几个问题</a>）：</strong></p><ul><li><p>如用人的参考基因信息来做注释，从UCSC生成TxDb:</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span>(GenomicFeatures)</span><br><span class="line">hg19.refseq.db &lt;- makeTxDbFromUCSC(genome=<span class="string">"hg19"</span>, table=<span class="string">"refGene"</span>)</span><br></pre></td></tr></table></figure></li><li><p>用GFF文件做裂殖酵母的注释</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">download.file(<span class="string">"ftp://ftp.ebi.ac.uk/pub/databases/pombase/pombe/Chromosome_Dumps/gff3/schizosaccharomyces_pombe.chr.gff3"</span>, <span class="string">"schizosaccharomyces_pombe.chr.gff3"</span>)<span class="keyword">require</span>(GenomicFeatures)</span><br><span class="line">spombe &lt;- makeTxDbFromGFF(<span class="string">"schizosaccharomyces_pombe.chr.gff3"</span>)</span><br></pre></td></tr></table></figure></li></ul><p><strong>具体步骤如下：</strong></p><h3 id="第1步：下载安装ChIPseeker注释相关的包"><a href="#第1步：下载安装ChIPseeker注释相关的包" class="headerlink" title="第1步：下载安装ChIPseeker注释相关的包"></a>第1步：下载安装ChIPseeker注释相关的包</h3><p>从Bioconductor直接下载，或从github安装最新版本<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span> (<span class="string">"https://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"ChIPseeker"</span>)</span><br><span class="line"><span class="comment"># 下载人的基因和lincRNA的TxDb对象</span></span><br><span class="line">biocLite(<span class="string">"org.Hs.eg.db"</span>)</span><br><span class="line">biocLite(<span class="string">"TxDb.Hsapiens.UCSC.hg19.knownGene"</span>)</span><br><span class="line">biocLite(<span class="string">"TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts"</span>)</span><br><span class="line">biocLite(<span class="string">"clusterProfiler"</span>)</span><br><span class="line"><span class="comment">#载入各种包</span></span><br><span class="line"><span class="keyword">library</span>(<span class="string">"ChIPseeker"</span>)</span><br><span class="line"><span class="keyword">library</span>(clusterProfiler)</span><br><span class="line"><span class="keyword">library</span>(<span class="string">"org.Hs.eg.db"</span>)</span><br><span class="line"><span class="keyword">library</span>(TxDb.Hsapiens.UCSC.hg19.knownGene)</span><br><span class="line">txdb &lt;- TxDb.Hsapiens.UCSC.hg19.knownGene</span><br><span class="line"><span class="keyword">library</span>(<span class="string">"TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts"</span>)</span><br><span class="line">lincRNA_txdb=TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts</span><br></pre></td></tr></table></figure></p><h3 id="第2步：读入peaks文件"><a href="#第2步：读入peaks文件" class="headerlink" title="第2步：读入peaks文件"></a>第2步：读入peaks文件</h3><p>函数<code>readPeakFile</code>读入peaks文件<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nanog &lt;- readPeakFile(<span class="string">"./idr_out.bed/nanog_idr-bed"</span>)</span><br><span class="line">pou5f1 &lt;- readPeakFile(<span class="string">"./idr_out.bed/pou5f1_idr-bed"</span>)</span><br></pre></td></tr></table></figure></p><h3 id="第3步：注释peaks"><a href="#第3步：注释peaks" class="headerlink" title="第3步：注释peaks"></a>第3步：注释peaks</h3><p>peaks的注释是用的<code>annotatePeak</code>函数，可以单独对每个peaks文件进行注释，也可以将多个peaks制作成一个list，进行比较分析和可视化。<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 制作多个样本比较的list</span></span><br><span class="line">peaks &lt;- list(Nanog=nanog,Pou5f1=pou5f1)</span><br><span class="line"><span class="comment"># promotor区间范围可以自己设定</span></span><br><span class="line">promoter &lt;- getPromoters(TxDb=txdb, upstream=<span class="number">3000</span>, downstream=<span class="number">3000</span>)</span><br><span class="line">tagMatrixList &lt;- lapply(peaks, getTagMatrix, windows=promoter)</span><br><span class="line"><span class="comment">#annotatePeak传入annoDb参数,可进行基因ID转换（Entrez，ENSEMBL，SYMBOL，GENENAME）</span></span><br><span class="line">peakAnnoList &lt;- lapply(peaks, annotatePeak, TxDb=txdb,tssRegion=c(-<span class="number">3000</span>, <span class="number">3000</span>), verbose=<span class="literal">FALSE</span>,addFlankGeneInfo=<span class="literal">TRUE</span>, flankDistance=<span class="number">5000</span>,annoDb=<span class="string">"org.Hs.eg.db"</span>)</span><br></pre></td></tr></table></figure></p><p><strong>annotatePeak传入annoDb参数,即可进行基因ID转换，将Entrez ID转化为ENSEMBL，SYMBOL，GENENAME</strong>，peakAnnoList的结果如下：</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">seqnamesstartendwidthstrandannotationgeneChrgeneStartgeneEndgeneLengthgeneStrandgeneIdtranscriptIddistanceToTSSENSEMBLSYMBOLGENENAMEflank_txIdsflank_geneIdsflank_gene_distances</span><br><span class="line"><span class="number">5</span>chr3<span class="number">196625522</span><span class="number">196625873</span><span class="number">352</span>*Intron (uc003fwz.4/<span class="number">205564</span>, intron <span class="number">2</span> of <span class="number">9</span>)<span class="number">3</span><span class="number">196594727</span><span class="number">196661584</span><span class="number">66858</span><span class="number">1</span><span class="number">205564</span>uc011bty.2<span class="number">30795</span>ENSG00000119231SENP5SUMO specific peptidase <span class="number">5</span>uc003fwz.4;uc011bty.2<span class="number">205564</span>;<span class="number">205564</span><span class="number">0</span>;<span class="number">0</span></span><br></pre></td></tr></table></figure><h3 id="第4步：可视化"><a href="#第4步：可视化" class="headerlink" title="第4步：可视化"></a>第4步：可视化</h3><p>提供了多种可视化方法，如plotAnnoBar(),vennpie(),plotAnnoPie(),plotDistToTSS()等，下面展示了两个样本在基因组特征区域的分布以及转录因子在TSS区域的结合。<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plotAnnoBar(peakAnnoList)</span><br><span class="line">plotDistToTSS(peakAnnoList,title=<span class="string">"Distribution of transcription factor-binding loci \n relative to TSS"</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-0f981c1bb6b89f8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="第5步：功能富集分析"><a href="#第5步：功能富集分析" class="headerlink" title="第5步：功能富集分析"></a>第5步：功能富集分析</h3><p>提取peakAnnolist中的基因，结合clusterProfiler包对peaks内的邻近基因进行富集注释。<br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create a list with genes from each sample</span></span><br><span class="line">gene = lapply(peakAnnoList, <span class="keyword">function</span>(i) as.data.frame(i)$geneId)</span><br><span class="line"><span class="comment"># Run GO enrichment analysis </span></span><br><span class="line">ego &lt;- enrichGO(gene = entrez, </span><br><span class="line">                    keytype = <span class="string">"ENTREZID"</span>, </span><br><span class="line">                    OrgDb = org.Hs.eg.db, </span><br><span class="line">                    ont = <span class="string">"BP"</span>, </span><br><span class="line">                    pAdjustMethod = <span class="string">"BH"</span>, </span><br><span class="line">                    qvalueCutoff = <span class="number">0.05</span>, </span><br><span class="line">                    readable = <span class="literal">TRUE</span>)</span><br><span class="line"><span class="comment"># Dotplot visualization</span></span><br><span class="line">dotplot(ego, showCategory=<span class="number">50</span>)</span><br><span class="line"><span class="comment"># Multiple samples KEGG analysis</span></span><br><span class="line">compKEGG &lt;- compareCluster(geneCluster = gene, </span><br><span class="line">                         fun = <span class="string">"enrichKEGG"</span>,</span><br><span class="line">                         organism = <span class="string">"human"</span>,</span><br><span class="line">                         pvalueCutoff  = <span class="number">0.05</span>, </span><br><span class="line">                         pAdjustMethod = <span class="string">"BH"</span>)</span><br><span class="line">dotplot(compKEGG, showCategory = <span class="number">20</span>, title = <span class="string">"KEGG Pathway Enrichment Analysis"</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-ebcdf242c4bc96f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="第6步：保存文件"><a href="#第6步：保存文件" class="headerlink" title="第6步：保存文件"></a>第6步：保存文件</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Output peakAnnolist file</span></span><br><span class="line">save(peakAnnoList,file=<span class="string">"peakAnnolist.rda"</span>)</span><br><span class="line">write.table(as.data.frame(peakAnnoList$Nanog),file=<span class="string">"Nanog.PeakAnno"</span>,sep=<span class="string">'\t'</span>,quote = <span class="literal">F</span>)</span><br><span class="line"><span class="comment"># Output results from GO analysis to a table</span></span><br><span class="line">cluster_summary &lt;- data.frame(ego)</span><br><span class="line">write.csv(cluster_summary, <span class="string">"results/clusterProfiler_Nanog.csv"</span>)</span><br></pre></td></tr></table></figure><hr><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p>ChIPseeker详细内容请参考:</p><ul><li><a href="http://www.bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.html" target="_blank" rel="noopener">ChIPseeker文档</a></li><li>Y叔的<a href="https://mp.weixin.qq.com/mp/homepage?__biz=MzI5NjUyNzkxMg==&amp;hid=11&amp;sn=c22229f28bd00c3efd2c89cdadd63315&amp;scene=18&amp;devicetype=android-23&amp;version=26070238&amp;lang=zh_CN&amp;nettype=3gnet&amp;ascene=7&amp;session_us=gh_ba0578f6322d" target="_blank" rel="noopener">ChIP-Seq系列</a>：<br><a href="https://mp.weixin.qq.com/s/vWTf59KDs1lp_sQXjEhI_g" target="_blank" rel="noopener">CS3: peak注释</a><br><a href="https://mp.weixin.qq.com/s/_OPzvaEAbiMolCA2mqJXLw" target="_blank" rel="noopener">CS4：关于ChIPseq注释的几个问题</a><br><a href="https://mp.weixin.qq.com/s/MqpfgkMJSFj0pYwcEjV9kQ" target="_blank" rel="noopener">CS6: ChIPseeker的可视化方法（中秋节的视觉饕餮）</a></li><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons" target="_blank" rel="noopener">哈佛深度NGS数据分析课程</a></li><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/07_ChIPseeker_functional_analysis.md" target="_blank" rel="noopener">07-ChIPseeker for ChIP peak Annotation, Comparison, and Visualization</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> ChIPseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第6篇：重复样本的处理——IDR</title>
      <link href="/2019/08/23/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E9%87%8D%E5%A4%8D%E6%A0%B7%E6%9C%AC%E7%9A%84%E5%A4%84%E7%90%86%E2%80%94%E2%80%94IDR/"/>
      <url>/2019/08/23/%E7%AC%AC6%E7%AF%87%EF%BC%9A%E9%87%8D%E5%A4%8D%E6%A0%B7%E6%9C%AC%E7%9A%84%E5%A4%84%E7%90%86%E2%80%94%E2%80%94IDR/</url>
      
        <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>ATAC-seq/ChIP-Seq中重复样本的处理</strong></p><p>ATAC-Seq要求必须有2次或更多次生物学重复（十分珍贵或者稀有样本除外，但必须做至少2次技术重复）。理论上重复样本的peaks应该有高度的一致性，实际情况并不完全与预期一致。如何评价重复样本的重复性的好坏？如何得到一致性的peaks?</p><h3 id="这一节将介绍两种方法："><a href="#这一节将介绍两种方法：" class="headerlink" title="这一节将介绍两种方法："></a>这一节将介绍两种方法：</h3><p><strong>1. 用Bedtools进行简单的overlap合并重复样本</strong><br><strong>2. 用IDR（Irreproducibility Discovery Rate）的方法获得高重复性的peaks</strong></p><a id="more"></a><p><img src="https://upload-images.jianshu.io/upload_images/8242255-f2cf66adfcbcc2d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><hr><h3 id="1-Overlapping-peaks-using-bedtools"><a href="#1-Overlapping-peaks-using-bedtools" class="headerlink" title="1. Overlapping peaks using bedtools"></a>1. Overlapping peaks using bedtools</h3><p>如何得到两个重复样本间一致性的peaks? 一种简单粗暴的方法就是用<code>bedtools</code>计算peaks的overlaps。<br>用法：<code>bedtools intersect [OPTIONS] -a &lt;bed/gff/vcf/bam&gt; -b &lt;bed/gff/vcf/bam&gt;</code></p><ul><li><code>-a</code>: 参数后加重复样本1（A）</li><li><code>-b</code>：参数后加重复样本2（B），也可以加多个样本</li></ul><p>其他常用参数解释和图解如下：</p><ul><li><code>-wo</code>：Write the original A and B entries plus the number of base pairs of overlap between the two features.</li><li><code>-wa</code>：Write the original entry in A for each overlap.</li><li><code>-v</code>：Only report those entries in A that have <em>no overlaps</em> with B<br>如果只有<code>-a</code>和<code>-b</code>参数，返回的是相对于A的overlaps。加上参数<code>-wo</code>返回A和B原始的记录加上overlap的记录。参数<code>-wa</code>返回每个overlap中A的原始记录。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-539217c9b07ba9fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>使用代码示例：</strong><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bedtools intersect \</span><br><span class="line">-a macs2/Nanog-rep1_peaks.narrowPeak \</span><br><span class="line">-b macs2/Nanog-rep2_peaks.narrowPeak \</span><br><span class="line">-wo &gt; bedtools/Nanog-overlaps.bed</span><br></pre></td></tr></table></figure></li></ul><h3 id="2-Irreproducibility-Discovery-Rate-IDR"><a href="#2-Irreproducibility-Discovery-Rate-IDR" class="headerlink" title="2. Irreproducibility Discovery Rate (IDR)"></a>2. Irreproducibility Discovery Rate (IDR)</h3><p>评估重复样本间peaks一致性的另一种方法是IDR。IDR是通过比较一对经过排序的regions/peaks 的列表，然后计算反映其重复性的值。<br>IDR在<a href="https://www.encodeproject.org/atac-seq/" target="_blank" rel="noopener">ENCODE</a>和modENCODE项目中被广泛使用，也是<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3431496/" target="_blank" rel="noopener">ChIP-seq指南和标准</a>中的一部分。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-ed3c5559db41126f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ENCODE_ATAC_pipeline"><br><strong>IDR的 优点：</strong></p><ul><li>避免了初始阈值的选择，解决了不同callers的不可比较性</li><li>IDR不依赖于阈值的选择，所有regions/peaks都被考虑在内。</li><li>它是依赖regions/peaks的排序，不要求对输入信号进行校准或标准化<br>IDR的详细说明参考: </li><li><a href="https://github.com/nboley/idr" target="_blank" rel="noopener">https://github.com/nboley/idr</a></li><li><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/06_handling-replicates.md#irreproducibility-discovery-rate-idr" target="_blank" rel="noopener">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/06_handling-replicates.md#irreproducibility-discovery-rate-idr</a></li></ul><p><strong>使用IDR的注意事项：</strong></p><ul><li>建议使用IDR时，MACS2 call peaks的步骤参数设置不要过于严格，以便鉴定出更多的peaks。</li><li><p>使用IDR需要先对MACS2的结果文件narrowPeak根据<code>-log10(p-value)</code>进行排序。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Call peaks</span><br><span class="line">macs2 callpeak -t  sample.final.bam -n sample --shift -100 --extsize 200 --nomodel -B --SPMR -g hs --outdir Macs2_out 2&gt; sample.macs2.log</span><br><span class="line">#Sort peak by -log10(p-value)</span><br><span class="line">sort -k8,8nr NAME_OF_INPUT_peaks.narrowPeak &gt; macs/NAME_FOR_OUPUT_peaks.narrowPeak</span><br></pre></td></tr></table></figure></li><li><p><strong>使用IDR示例</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">idr --samples sample_Rep1_sorted_peaks.narrowPeak sample_Rep2_sorted_peaks.narrowPeak \</span><br><span class="line">--input-file-type narrowPeak \</span><br><span class="line">--rank p.value \</span><br><span class="line">--output-file sample-idr \</span><br><span class="line">--plot \</span><br><span class="line">--<span class="built_in">log</span>-output-file sample.idr.log</span><br></pre></td></tr></table></figure></li></ul><p><code>--samples</code>:narrowPeak的输入文件（重复样本）<br><code>--input-file-type</code>：输入文件格式包括narrowPeak,broadPeak,bed<br><code>--rank p.value</code>：以p-value排序<br><code>--output-file</code>: 输出文件路径<br><code>--plot</code>：输出IDR度量值的结果</p><p><strong>输出文件解读：</strong><br>详细内容可参考：<a href="https://github.com/nboley/idr#output-file-format" target="_blank" rel="noopener">https://github.com/nboley/idr#output-file-format</a></p><blockquote><p>输出文件包括：</p><ul><li>sample-idr</li><li>sample-idr.log</li><li>sample-idr.png</li></ul></blockquote><p><strong>（1）sample-idr</strong><br>sample-idr是common peaks的结果输出文件，格式与输入文件格式类似，只是多了几列信息。前10列是标准的narrowPeak格式文件，包含重复样本整合后的peaks信息。</p><ul><li><strong>第5列：包含缩放的 IDR 值</strong><ul><li>score int<br>如min(int(log2(-125IDR), 1000)，那么IDR=0，缩放的IDR就是1000；IDR=0.05,  int(-125log2(0.05)) = 540；IDR=1.0,  int(-125log2(1.0) = 0。</li></ul></li><li><strong>第11列和第12列：分别是local和global IDR值</strong><ul><li>col11: localIDR float -log10(Local IDR value)</li><li>col12: globalIDR float -log10(Global IDR value)<br>global IDR值是第5列中用于计算缩放的IDR值，类似于对p值进行多个假设校正以计算FDR；local IDR类似于属于不可重复噪声部分的峰值的后验概率。详细内容可阅读<a href="https://projecteuclid.org/euclid.aoas/1318514284" target="_blank" rel="noopener">Measuring reproducibility of high-throughput experiments</a>。</li></ul></li><li><strong>第13、14、15、16列</strong>：是重复样本1相关的信息。<ul><li>col13: rep1_chromStart int</li><li>col14: rep1_chromEnd int</li><li>col15: rep1_signalValue float</li><li>col16: rep1_summit int</li></ul></li><li><strong>第17-20列</strong>：是重复样本2相关的信息，和13-16四列信息类似。</li></ul><p><strong>其他列信息如下：</strong></p><ul><li>col1: chrom string</li><li>col2: chromStart int</li><li>col3: chromEnd int</li><li>col4: name string</li><li>col6: strand [+-.] Use ‘.’ if no strand is assigned.</li><li>col7: signalValue float</li><li>col8: p-value float </li><li>col9: q-value float</li><li>col10: summit int</li></ul><p><code>wc -l *-idr</code> 计算下common peaks的个数，接着可再计算下与总peaks的比率。<br>如果想看IDR&lt;0.05的，可以通过第5列信息过滤：<br><code>awk &#39;{if($5 &gt;= 540) print $0}&#39; sample-idr | wc -l</code><br><strong>（2）sample-idr.log</strong><br>log文件会给出peaks通过IDR &lt; 0.05的比率，如下图所示<br><img src="https://upload-images.jianshu.io/upload_images/8242255-ca6774163e8a6207.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>（3）sample-idr.png</strong><br>png文件包括4个图<br><img src="https://upload-images.jianshu.io/upload_images/8242255-f605c94aaaf401d2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p>左上： Rep1 peak ranks vs Rep2 peak ranks, 没有通过特定IDR阈值的peaks显示为红色。<br>右上：Rep1 log10 peak scores vs Rep2 log10 peak scores，没有通过特定IDR阈值的peaks显示为红色。<br>下面两个图： Peak rank vs IDR scores，箱线图展示了IDR值的分布，默认情况下，IDR值的阈值为-1E-6。</p><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons" target="_blank" rel="noopener">哈佛深度NGS数据分析课程</a><br><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/06_handling-replicates.md" target="_blank" rel="noopener">06-Handling replicates in ChIP-Seq</a></p>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> ChIPseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第5篇：对ATAC-Seq/ChIP-seq的质量评估（二）——ChIPQC</title>
      <link href="/2019/08/23/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E5%AF%B9ATAC-SeqChIP-seq%E7%9A%84%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BC%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E2%80%94%E2%80%94ChIPQC/"/>
      <url>/2019/08/23/%E7%AC%AC5%E7%AF%87%EF%BC%9A%E5%AF%B9ATAC-SeqChIP-seq%E7%9A%84%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BC%B0%EF%BC%88%E4%BA%8C%EF%BC%89%E2%80%94%E2%80%94ChIPQC/</url>
      
        <content type="html"><![CDATA[<h3 id="1-学习目标"><a href="#1-学习目标" class="headerlink" title="1. 学习目标"></a>1. 学习目标</h3><ul><li>讨论ChIP-seq数据质量评估的其他方法</li><li>用ChIPQC产生质量统计报告</li><li>鉴定低质量数据的来源</li></ul><a id="more"></a><ul><li><p><strong>概览图</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-df6c67811efb85eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><p>ENCODE评估数据质量采用多种指标，如前面已经讨论过的链相关的指标NSC和RSC。这一节将会讨论评估信号分布的其他指标。</p><blockquote><p><strong>NOTE</strong>：这里给出的评估指标只是反映数据质量的好坏，符合阈值的并不意味着实验是成功的，不符合阈值的也不一定意味着失败。</p></blockquote><h3 id="2-常见质量评估指标的介绍"><a href="#2-常见质量评估指标的介绍" class="headerlink" title="2.常见质量评估指标的介绍"></a>2.常见质量评估指标的介绍</h3><ul><li><h4 id="SSD"><a href="#SSD" class="headerlink" title="SSD"></a>SSD</h4>SSD值是对富集效果的评估。SSD值依赖于全基因组的pile-up信号强度，对真实的ChIP富集和干扰的强信号区域都很敏感。SSD值越大表明富集越好。<blockquote><p>“It provides a measure of pileup across the genome and is computed by looking at the standard deviation of signal pile-up along the genome normalised to the total number of reads. ”</p></blockquote></li><li><h4 id="FRiP-Fraction-of-reads-in-peaks"><a href="#FRiP-Fraction-of-reads-in-peaks" class="headerlink" title="FRiP:Fraction of reads in peaks"></a>FRiP:Fraction of reads in peaks</h4>FRiP表示的是peaks中的reads与总reads的比例。它是另一个反映样本富集效果或IP好坏的评价指标。可以理解为是“信噪比”即文库中结合位点片段占背景reads的比例。<strong>一个典型质量好的TF富集FRiP值约5%或者更高，polII的FRiP值约为30%或者更高，也有一些质量好的数据FRiP值&lt;1%（如RNAPIII）</strong></li><li><h4 id="Relative-Enrichment-of-Genomic-Intervals-REGI"><a href="#Relative-Enrichment-of-Genomic-Intervals-REGI" class="headerlink" title="Relative Enrichment of Genomic Intervals (REGI)"></a>Relative Enrichment of Genomic Intervals (REGI)</h4>REGI是对peaks在不同基因组特征位点分布的统计。</li><li><h4 id="RiBL-Reads-overlapping-in-Blacklisted-Regions"><a href="#RiBL-Reads-overlapping-in-Blacklisted-Regions" class="headerlink" title="RiBL: Reads overlapping in Blacklisted Regions"></a>RiBL: Reads overlapping in Blacklisted Regions</h4>过滤人工造成的高信号区域非常重要，如ENCIDE和modENCODE提供的DAC Blacklisted Regions track。这些区域经常在特定的重复序列处出现，如着丝粒、端粒、卫星重复序列等，通过简单的比对过滤是不能去除的。来自blacklisted regions的信号会造成call peak 和片段长度评估的混淆。<br>RiBL值可以表示背景信号或input的信号水平，与input sample的SSD值以及input和ChIP sample的读长覆盖值相关。这些区域通常是基因组的0.5%，或者更高的比例（10%）。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-ffa899faf5d8e033.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ul><h3 id="3-ChIPQC-quality-metrics-report"><a href="#3-ChIPQC-quality-metrics-report" class="headerlink" title="3. ChIPQC: quality metrics report"></a>3. ChIPQC: quality metrics report</h3><p>ChIPQC是一个Bioconductor包，输入文件包括BAM和peak文件，可以自动计算一些质量评估值，并产生质量报告。</p><h4 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h4><ul><li><strong>BAM files</strong><br>首先对比对过滤后的bam数据（chr12_aln.bam）建索引，然后将bam和index文件从<code>~/ngs_course/chipseq/results/bowtie2</code>移动到自己的目录文件夹<code>data/bams</code></li><li><strong>peak files</strong><br>将narrowPeak 文件从macs2目录下<code>~/ngs_course/chipseq/results/macs2</code> 移动到自己目录下<code>data/peakcalls</code></li><li><p><strong>sampleSheet file</strong><br>sampleSheet file是唯一需要自己根据实验设计和数据存储地址等信息创建的一个csv格式文件（bam,peak文件分别在比对和call peak的步骤产生）。sampleSheet具体需要包含的信息如下：<br><img src="https://upload-images.jianshu.io/upload_images/8242255-3910ab7fab88b880.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="sampleSheet header"></p></li><li><p>SampleID: 样本ID</p></li><li>Tissue, Factor, Condition: 不同的实验设计对照信息，三列信息必须包含在sampleSheet里，如果没有某一列的信息设为NA。</li><li>Replicate : 重复样本的编号</li><li>bamReads : 实验组BAM 文件的路径（data/bams）</li><li>ControlID : 对照组样本ID</li><li>bamControl :对照组样本的bam文件路径</li><li>Peaks :样本peaks文件的路径</li><li>PeakCaller ：peak类型的字符串，可以是raw,bed,narrow,macs等。<h4 id="下载安装ChIPQC"><a href="#下载安装ChIPQC" class="headerlink" title="下载安装ChIPQC"></a>下载安装ChIPQC</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span>(<span class="string">"http://bioconductor.org/biocLite.R"</span>)</span><br><span class="line">biocLite(<span class="string">"ChIPQC"</span>)</span><br></pre></td></tr></table></figure></li></ul><h4 id="Running-ChIPQC"><a href="#Running-ChIPQC" class="headerlink" title="Running ChIPQC"></a>Running ChIPQC</h4><p>ChIPQC只需要三步就可以完成质量评估和报告生成。</p><ul><li><p><strong>首先载入包和sampleSheet信息</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Load libraries</span></span><br><span class="line"><span class="keyword">library</span>(ChIPQC)</span><br><span class="line"><span class="comment">## Load sample data</span></span><br><span class="line">samples &lt;- read.csv(<span class="string">'meta/samplesheet_chr12.csv'</span>)</span><br><span class="line">View(samples)</span><br></pre></td></tr></table></figure></li><li><p><strong>创建ChIPQC对象</strong><br>利用sampleSheet的信息读取每个样本的bam和narrowpeak文件，并计算质量评估值，结果存在一个对象里。</p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Create ChIPQC object</span></span><br><span class="line">chipObj &lt;- ChIPQC(samples, annotation=<span class="string">"hg19"</span>)</span><br></pre></td></tr></table></figure></li><li><p><strong>生成ChIPQC报告</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Create ChIPQC report</span></span><br><span class="line">ChIPQCreport(chipObj, reportName=<span class="string">"ChIP QC report: Nanog and Pou5f1"</span>, reportFolder=<span class="string">"ChIPQCreport"</span>)</span><br></pre></td></tr></table></figure></li></ul><h4 id="ChIPQC报告解读"><a href="#ChIPQC报告解读" class="headerlink" title="ChIPQC报告解读"></a>ChIPQC报告解读</h4><p>ChIPQC生成的结果包含一个网页报告和报告中含有的所有图片。<br>网页报告有三部分：<strong>QC Summary ；QC Results；QC files and versions</strong><br><img src="https://upload-images.jianshu.io/upload_images/8242255-a929302bfd47dc9d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h5 id="（1）QC-Summary-Overview-of-results"><a href="#（1）QC-Summary-Overview-of-results" class="headerlink" title="（1）QC Summary - Overview of results"></a>（1）QC Summary - Overview of results</h5><p><img src="https://upload-images.jianshu.io/upload_images/8242255-01749f12cf83c9af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Table 1"><br>QC summary包含sampleSheet里填写的样本的基本信息Tissue,Factor,Condition,Replicate。另外还有上面提到的质量评估的常用指标SSD、RiP%和RiBL值。越高的SSD值表明富集效果越好，Pou5f1样本（2.6,3）有较高的SSD值，RiBL值不是很高，FRiP的比例在5%附近或者更高，除了Pou5f1-rep2。</p><ul><li><strong>SSD</strong> - SSD score (htSeqTools)</li><li><strong>RIP%</strong> - Percentage of reads wthin peaks</li><li><strong>RIBL%</strong> - Percentage of reads wthin Blacklist regions<br>同时表格中还给出了其他统计信息：</li><li><strong>Reads</strong> - Number of sample reads within analysed chromosomes.</li><li><strong>Dup%</strong> - Percentage of MapQ filter passing reads marked as duplicates</li><li><strong>FragLen</strong> - Estimated fragment length by cross-coverage method</li><li><strong>FragLenCC</strong> - Cross-Coverage score at the fragment length</li><li><strong>RelativeCC</strong> - Cross-coverage score at the fragment length over Cross-coverage at the read length</li></ul><h5 id="（2）QC-Results-Full-QC-results-and-figures"><a href="#（2）QC-Results-Full-QC-results-and-figures" class="headerlink" title="（2）QC Results - Full QC results and figures"></a>（2）QC Results - Full QC results and figures</h5><ul><li><strong>Mapping, Filtering and Duplication rate</strong><br>第一部分是比对、过滤和重复率质检结果，包括Table2 、Figure1和Figure2。<br><strong>Table 2</strong>主要给出了比对质量和重复率，因为BAM文件是过滤后的，所以这里Dup%都是0.<br><img src="https://upload-images.jianshu.io/upload_images/8242255-ae05107ee85bb02a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Table 2"><blockquote><ul><li><strong>Total Dup%</strong>-Percentage of all mapped reads which are marked as duplicates.</li><li><strong>Pass MapQ Filter%</strong>-Percentage of all mapped reads whichpass MapQ quality filter</li><li><strong>Pass MapQ Filter and Dup%</strong>-Percentage of all reads which pass MapQ filter and are marked asduplicates.</li></ul></blockquote></li></ul><p><strong>Figure 1</strong>展现了reads在blacklists中的比例，</p><p><strong>Figure 2</strong>是用基因组注释呈现了reads在基因组特征位置如启动子的分布。这幅图里显示在启动子区域富集最明显。</p><ul><li><p><strong>ChIP signal Distribution and Structure</strong><br>第二部分是ChIP信号分布和结构组成，包括Figure3和4。<br><strong>Figure 3</strong>是一个coverage plot， x轴代表在某bp位置read pileup的高度，y轴代表有多少位置有相同的pileup 高度(取log)。**有好的富集的ChIP样本会有一个tail，即更多的位置（y值大）有较高的测序深度。在我们的数据集中Nanog样本与Pou5f1 相比有较高的tails,尤其是重复样本2。但是Pou5f1有较高的SSD值。当SSD高但是coverage看起来低时，可能是存在大片段深度高的区域出现在blacklist 基因组区域。</p></li><li><p><strong>Peak Profile and ChIP Enrichment</strong><br>第3部分是peak的谱图和ChIP的富集，每个peak都集中在summit位置（summit 理解为peak的最高峰值点处）<img src="https://upload-images.jianshu.io/upload_images/8242255-d50435914800593a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li><li><p>peak的性状取决于研究对象的类型，如转录因子、组蛋白标记、或其他DNA结合蛋白如聚合酶等，相同类型的对象通常有独特特征的谱图。<br><strong>Figure6和7</strong>都是对比对到peak中的reads统计。富集效果好的ChIP样本的reads与peaks会有高比例的重合。尽管Nanog有较高的RiP,但是两个重复样本间的差异大于Pou5f1。</p></li><li><p>Figure8和9**表示样本的聚类效果，分别是相关性聚类热图和PCA。</p></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/8242255-ee0ccb984d0ea9dc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-4f61fd17225198b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="4-实验偏差：ChIP-seq数据质量低的来源"><a href="#4-实验偏差：ChIP-seq数据质量低的来源" class="headerlink" title="4. 实验偏差：ChIP-seq数据质量低的来源"></a>4. 实验偏差：ChIP-seq数据质量低的来源</h3><ul><li>免疫沉淀的特异性和有效性<br>影响因素如抗体的特异性，结和沉淀的强度</li><li>片段化<br>超声裂解产生不同大小的片段可能引入偏差</li><li>文库构建时的偏差<br>如PCR扩增<h4 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h4><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons" target="_blank" rel="noopener">哈佛深度NGS数据分析课程</a><br><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/05_QC_quality_metrics.md" target="_blank" rel="noopener">05-ChIP-Seq Quality Assessment</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> ChIPseq </tag>
            
            <tag> QC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第4篇：对ATAC-Seq/ChIP-seq的质量评估（一）——phantompeakqualtools</title>
      <link href="/2019/08/23/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E5%AF%B9ATAC-SeqChIP-seq%E7%9A%84%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BC%B0%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94phantompeakqualtools/"/>
      <url>/2019/08/23/%E7%AC%AC4%E7%AF%87%EF%BC%9A%E5%AF%B9ATAC-SeqChIP-seq%E7%9A%84%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BC%B0%EF%BC%88%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94phantompeakqualtools/</url>
      
        <content type="html"><![CDATA[<h3 id="学习目标："><a href="#学习目标：" class="headerlink" title="学习目标："></a>学习目标：</h3><ul><li>探讨ChIP-seq数据质量低的来源</li><li>理解链交叉相关性（ strand cross-correlation）</li><li>使用<code>phantompeakqualtools</code>计算交叉相关性和其他相关的质控度量值</li><li>评估交叉相关图</li></ul><a id="more"></a><h3 id="ChIP-Seq质量评估"><a href="#ChIP-Seq质量评估" class="headerlink" title="ChIP-Seq质量评估"></a>ChIP-Seq质量评估</h3><p>在下游分析前，最好是先对peak calling 后的ChIP-Seq数据进行质量评估。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-025dd4ff30ae61b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="链交叉相关（Strand-cross-correlation）"><a href="#链交叉相关（Strand-cross-correlation）" class="headerlink" title="链交叉相关（Strand cross-correlation）"></a>链交叉相关（Strand cross-correlation）</h3><p>链交叉相关是一个有效的评估ChIP-Seq质量的方法，它不依赖于peak calling，而是基于ChIP-Seq实验。如果ChIP-Seq实验成功，DNA富集序列标签（蛋白质相互作用的序列）会在reads的双峰富集中产生显著的聚集。<br><strong>产生reads的双峰富集的原因如下：</strong><br>在ChIP-Seq实验中，DNA被片段化，蛋白质结合的片段会被免疫沉淀，所以产生了有蛋白质结合的DNA片段（fragments ）。<br>DNA的正链从5’端开始被测序（如下图红色reads），DNA负链也从5’末端被测序产生如下图所示的蓝色reads。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-9095a287381f5ec6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Nat Biotechnol. 2008 Dec; 26(12): 1351–1359"><br>由于从DNA片段的5′末端测序，使+链reads的富集（下图中的蓝色部分）与负链reads的富集（下图红色部分）有少量的相互抵消区域。我们<strong>需要确定峰位移多少碱基数目可以在两个峰间产生最大的相关性。</strong>我们可以用<strong>交叉相关的度量值（cross-correlation metric）</strong>计算产生最大相关的位移。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-120795238a4bbaba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><p><strong>交叉相关性度量值</strong><br>交叉相关度量是在Watson移动k个碱基后，计算Crick链与Watson链之间的Pearson线性相关。如下面的示意图：<br>首先在链位移为0时，两个向量之间的Pearson相关值为0.539。</p><p>在链位移5bp，两个向量之间的Pearson相关值为0.931。</p><p>继续移动这些向量，对于每个链位移计算一个相关值。</p><p>最后，我们将有一个每个碱基对移位与皮尔森相关值的对应表。这是针对每个染色体的每一个峰计算的，然后该值乘以一个缩放因子，再对所有染色体的值相加，就可以绘交叉相关值（y轴）相对于移位值（x轴）生成的交叉相关图。<br><strong>典型的交叉相关图会产生两个峰</strong>：一个富集峰与主要的<strong>片段长度（predominant fragment length）</strong>相关（高相关性），另一个与<strong>read 长度（read length）</strong>相关，这个峰也被称为虚幻峰（“phantom” peak）。</p><ul><li><p>质量好的ChIP-Seq数据集倾向产生一个大的<strong>片段长度峰（fragment-length peak）</strong>，下图展示了一个来自于人细胞CTCF（zinc-finger transcription factor）的强信号。如果有好的抗体，转录因子通常产生45,000~60,000个peaks。下图红色的垂直线表示主峰的真实位移，蓝色的垂直线处有一个小的起伏表示read lenngth。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-f291e6c7288d5df6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><ul><li><p>下图是<strong>weaker signal</strong>的一个示例。这里<strong>Pol2</strong>的抗体不是很有效，有分散的峰。交叉相关图中有两个峰，一个是真实的峰位移（185-200bp），另外一个在read length。信号弱的数据集中read length的峰会成为主峰。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-2846dc6bb5085bf8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><ul><li><p>一个失败的实验产生的交叉相关图类似于<strong>input</strong>，在<strong>fragment length</strong>处很少或没有峰，在<strong>read length</strong>处有信号非常强的。这种现象的原因可能是在结合位点附近<strong>fragments</strong>没有显著聚集。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-8781f9f9bd780b15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><h3 id="交叉相关性质量评估度量值"><a href="#交叉相关性质量评估度量值" class="headerlink" title="交叉相关性质量评估度量值"></a>交叉相关性质量评估度量值</h3><p>交叉相关谱图可以计算评估ChIP_Seq实验信噪比的度量值，并且实验设计确保<strong>fragment length</strong>准确。低信噪比和不准确的fragment length 表明ChIP-Seq实验可能有问题。<br><strong>Normalized strand cross-correlation coefficent (NSC)：</strong><br>NSC是最大交叉相关值除以背景交叉相关的比率(所有可能的链转移的最小交叉相关值)。<strong>NSC值越大表明富集效果越好，NSC值低于1.1<br>表明较弱的富集，小于1表示无富集。</strong>NSC值稍微低于1.05，有较低的信噪比或很少的峰，这肯能是生物学真实现象，比如有的因子在特定组织类型中只有很少的结合位点；也可能确实是数据质量差。<br><strong>Relative strand cross-correlation coefficient (RSC):</strong><br>RSC是片段长度相关值减去背景相关值除以phantom-peak相关值减去背景相关值。<strong>RSC的最小值可能是0，表示无信号；富集好的实验RSC值大于1；低于1表示质量低。</strong></p><h3 id="phantompeakqualtools"><a href="#phantompeakqualtools" class="headerlink" title="phantompeakqualtools"></a>phantompeakqualtools</h3><p>phantompeakqualtools 是一个用于计算ChIP-Seq数据富集和质量度量值的一个工具包。我们将使用该包来计算基于链交叉相关峰的主要插入大小(fragment length)和基于相对phantom peak的数据质量度量值。<code>phantompeakqualtools</code>是一个R包，依赖<code>samtools</code>。<br><strong>下载<code>phantompeakqualtools</code></strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/phantompeakqualtools/ccQualityControl.v.1.1.tar.gz</span><br><span class="line">tar -xzf ccQualityControl.v.1.1.tar.gz</span><br><span class="line"><span class="built_in">cd</span> phantompeakqualtools</span><br><span class="line"><span class="comment"># 查看README</span></span><br><span class="line">less README.txt</span><br></pre></td></tr></table></figure></p><p><strong>Linux下安装</strong><br><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">R </span><br><span class="line">install.packages(<span class="string">"caTools"</span>, lib=<span class="string">"~/R/library"</span>)</span><br></pre></td></tr></table></figure></p><p><strong>运行phantompeakqualtools</strong></p><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p logs qual</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> bam <span class="keyword">in</span> bam_dir/sample1.final.bam bam_dir/sample2.final.bam</span><br><span class="line">do </span><br><span class="line">bam2=`basename $bam .final.bam`</span><br><span class="line">Rscript run_spp_nodups.R -c=$bam -savp -out=qual/$&#123;bam2&#125;.qual &gt; logs/$&#123;bam2&#125;.Rout</span><br><span class="line">done</span><br></pre></td></tr></table></figure><p><strong>参数含义：</strong></p><ul><li><code>-c</code>: 比对过滤后的bam文件的全路径和名字</li><li><code>-savp</code>:保存交叉相关图</li><li><code>-out</code>：会产生数据集重要特征值的输出文件</li></ul><p><strong>输出文件解读</strong><br>输出文件会产生一个tab分割的名为qual的文件,包含的信息如下：</p><ul><li><p>COL1：Filename：比对过滤的bam文件名</p></li><li><p>COL2：numReads ：有效的测序深度</p></li><li><p>COL3：estFragLen：逗号分隔的交叉相关峰以相关性递减顺序排列的值</p></li><li><p>COL4: corr_estFragLen: 逗号分隔的以递减顺序排列交叉相关值</p></li><li><p>COL5: phantomPeak: Read length/phantom peak链位移</p></li><li><p>COL6: corr_phantomPeak: phantom peak相关值</p></li><li><p>COL7: argmin_corr:交叉相关最小的链位移</p></li><li><p>COL8: min_corr:交叉相关最小值</p></li><li><p>COL9: Normalized strand cross-correlation coefficient (NSC) = COL4 / COL8</p></li><li><p>COL10: Relative strand cross-correlation coefficient (RSC) = (COL4 - COL8) / (COL6 - COL8)</p></li><li><p>COL11: QualityTag: Quality tag based on thresholded RSC (codes: -2:veryLow,-1:Low,0:Medium,1:High,2:veryHigh)<br><strong>我们最关注的值是第9列和第11列。</strong><br><strong>Cross-correlation plots</strong><br>课程中的示例数据Nanog_rep1的交叉相关图</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-4e872e4a5d5fcdbb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p></li></ul><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/tree/master/sessionV/lessons" target="_blank" rel="noopener">哈佛深度NGS数据分析课程</a><br><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/04_QC_cross_correlation.md" target="_blank" rel="noopener">04_ChIP-Seq Quality Assessment: Cross-correlation</a></p>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> ChIPseq </tag>
            
            <tag> QC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第3篇：用MACS2软件call peaks</title>
      <link href="/2019/08/23/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E7%94%A8MACS2%E8%BD%AF%E4%BB%B6call%20peaks/"/>
      <url>/2019/08/23/%E7%AC%AC3%E7%AF%87%EF%BC%9A%E7%94%A8MACS2%E8%BD%AF%E4%BB%B6call%20peaks/</url>
      
        <content type="html"><![CDATA[<h3 id="学习目标："><a href="#学习目标：" class="headerlink" title="学习目标："></a>学习目标：</h3><ul><li>学会用MACS2 call peaks</li><li>理解MACS2 call peaks的结果</li></ul><a id="more"></a><h3 id="Peak-Calling"><a href="#Peak-Calling" class="headerlink" title="Peak Calling"></a>Peak Calling</h3><p>Peak calling即利用计算的方法找出ChIP-seq或ATAC-seq中reads富集的基因组区域。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-1d1cb57462bd1803.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><p>如下图所示，比对结果的文件中reads在正负链不均匀分布，但在结合位点聚集。正负链5‘末端的reads各形成一组合，通过统计学的方法评估这些组合的分布并和对照组比较，确定这些结合位点是否是显著的。<br><img src="https://upload-images.jianshu.io/upload_images/8242255-72a8be3b74bb6659.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><blockquote><p><strong>NOTE：</strong>ChIP-seq的分析方法可以鉴定两种类型的富集模式：<strong>broad domains</strong>和<strong>narrow peaks</strong>。broad domains，如组蛋白修饰在整个基因body区域的分布；narrow peak，如转录因子的结合。narrow peak相对于broad 或者分散的marks更易被检测到。也有一些混合的结合图谱，如PolII包括narrow和broad信号。</p></blockquote><hr><h3 id="MACS2"><a href="#MACS2" class="headerlink" title="MACS2"></a>MACS2</h3><p>peaks calling 有不同的方法，MACS2是最常用的call peaks工具。 <a href="https://github.com/taoliu/MACS" target="_blank" rel="noopener">MACS全称Model-based Analysis of ChIP-Seq</a>，最初的设计是用来鉴定转录因子的结合位点，但是它也可以用于其他类型的富集方式测序。<br>MACS通过整合序列标签位置信息和方向信息提高结合位点的空间分辨率。MACS的工作流如下所示：</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-b83dbfa6a5f77413.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><hr><h3 id="MACS2的使用方法"><a href="#MACS2的使用方法" class="headerlink" title="MACS2的使用方法"></a>MACS2的使用方法</h3><p>MACS2的用法，call peaks的参数及输出文件的解读可以参考<a href="https://www.jianshu.com/writer#/notebooks/22796191/notes/31999734/preview" target="_blank" rel="noopener">MACS2文档学习</a>。</p><h4 id="了解相关参数："><a href="#了解相关参数：" class="headerlink" title="了解相关参数："></a>了解相关参数：</h4><p><strong>输入文件参数：</strong></p><ul><li><code>-t</code>:实验组，IP的数据文件</li><li><code>c</code>: 对照组</li><li><code>f</code>：指定输入文件的格式，默认是自动检测输入数据是什么格式，支持bam,sam,bed等</li><li><code>g</code>:有效基因组大小，由于基因组序列的重复性，基因组实际可以mapping的大小小于原始的基因组。这个参数要根据实际物种计算基因组的有效大小。软件里也给出了几个默认的-g 值：hs – 2.7e9表示人类的基因组有效大小(UCSC human hg18 assembly).<ul><li>hs: 2.7e9</li><li>mm: 1.87e9</li><li>ce: 9e7</li><li>dm: 1.2e8</li></ul></li></ul><p><strong>输出文件参数：</strong></p><ul><li><code>--outdir</code>:输出结果的存储路径</li><li><code>-n</code>:输出文件名的前缀</li><li><code>-B/--bdg</code>:输出bedgraph格式的文件，输出文件以NAME+’_treat_pileup.bdg’ for treatment data, NAME+’_control_lambda.bdg’ for local lambda values from control显示。</li></ul><p><strong>peak calling 参数</strong></p><ul><li><code>-q/--qvalue</code> 和 <code>-p/--pvalue</code><br>q value默认值是0.05，与pvalue不能同时使用。</li><li><code>--broad</code><br>peak有narrow peak和broad peak, 设置时可以call broad peak 的结果文件。</li><li><code>--broad-cutoff</code><br>和pvalue、以及qvalue相似</li><li><code>--nolambda</code>: 不要考虑在峰值候选区域的局部偏差/λ<blockquote><p>q值与峰宽有一定的联系。理想情况下，如果放宽阈值，您将简单地获得更多的peaks，但是使用MACS2放松阈值也会导致更宽的peaks。</p></blockquote></li></ul><p><strong>Shift 模型参数：</strong></p><ul><li><code>--nomodel</code><br>这个参数和extsize、shift是配套使用的，有这个参数才可以设置extsize和shift。</li><li><code>--extsize</code><br>当设置了nomodel时，MACS会用<code>--extsize</code>这个参数从5’-&gt;3’方向扩展reads修复fragments。比如说你的转录因子结合范围200bp，就设置这个参数是200。</li><li><code>--shift</code><br>当设置了–nomodel，MACS用这个参数从5’ 端移动剪切，然后用–extsize延伸，如果–shift是负值表示从3’端方向移动。建议ChIP-seq数据集这个值保持默认值为0，对于检测富集剪切位点如DNAsel数据集设置为EXTSIZE的一半。<br><strong>示例：</strong></li></ul><ol><li>想找富集剪切位点，如DNAse-seq，所有5’端的序列reads应该从两个方向延伸，如果想设置移动的窗口是200bp，参数设置如下：<br><code>--nomodel --shift -100 --extsize 200</code></li><li>对nucleosome-seq数据，用核小体大小的一半进行extsize,所以参数设置如下：<br><code>--nomodel --shift 37 --extsize 73</code></li></ol><ul><li><code>--call-summits</code><br>MACS利用此参数重新分析信号谱，解析每个peak中包含的subpeak。对相似的结合图谱，推荐使用此参数，当使用此参数时，输出的subpeak会有相同的peak边界，不同的绩点和peak summit poisitions.</li></ul><hr><h4 id="ATAC-Seq-call-peaks示例"><a href="#ATAC-Seq-call-peaks示例" class="headerlink" title="ATAC-Seq call peaks示例"></a>ATAC-Seq call peaks示例</h4><p><strong>ATAC-seq关心的是在哪切断，断点才是peak的中心，所以使用shift模型，–shift -75或-100</strong><br>对人细胞系ATAC-seq 数据call peak的参数设置如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">macs2 callpeak -t H1hesc.final.bam -n sample --<span class="built_in">shift</span> -100 --extsize 200 --nomodel -B --SPMR -g hs --outdir Macs2_out 2&gt; sample.macs2.log</span><br></pre></td></tr></table></figure></p><h3 id="MACS2输出文件解读"><a href="#MACS2输出文件解读" class="headerlink" title="MACS2输出文件解读"></a>MACS2输出文件解读</h3><ul><li><strong>NAME_peaks.xls</strong><br>包含peak信息的tab分割的文件，前几行会显示callpeak时的命令。输出信息包含：<ul><li>染色体号</li><li>peak起始位点</li><li>peak结束位点</li><li>peak区域长度</li><li>peak的峰值位点（summit position）</li><li>peak 峰值的高度（pileup height at peak summit, -log10(pvalue) for the peak summit）</li><li>peak的富集倍数（相对于random Poisson distribution with local lambda）<br><img src="https://upload-images.jianshu.io/upload_images/8242255-6f70944596087547.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt><br><strong>Coordinates in XLS is 1-based which is different with BED format</strong><br>XLS里的坐标和bed格式的坐标还不一样，起始坐标需要减1才与narrowPeak的起始坐标一样。</li></ul></li><li><strong>NAME_peaks.narrowPeak</strong><br>*narrowPeak文件是BED6+4格式，可以上传到UCSC浏览。输出文件每列信息分别包含：<ul><li>1；染色体号</li><li>2：peak起始位点</li><li>3：结束位点</li><li>4：peak name</li><li>5：int(-10*log10qvalue)</li><li>6 ：正负链</li><li>7：fold change</li><li>8：-log10pvalue</li><li>9：-log10qvalue</li><li>10：relative summit position to peak start（？）<br><img src="https://upload-images.jianshu.io/upload_images/8242255-836a2990e5c80537.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ul></li><li><strong>NAME_summits.bed</strong><br>BED格式的文件，包含peak的summits位置，第5列是-log10pvalue。<strong>如果想找motif，推荐使用此文件。</strong><blockquote><p>Remove the beginning track line if you want to analyze it by other tools.???</p><ul><li><strong>.bdg</strong><br>bedGraph格式，可以导入UCSC或者转换为bigwig格式。两种bfg文件：treat_pileup, and control_lambda.</li></ul></blockquote></li><li><strong>NAME_peaks.broadPeak</strong><br>BED6+3格式与narrowPeak类似，只是没有第10列。</li></ul><hr><h3 id="summits-bed，narrowPeak，bdg-xls四种类型输出文件的比较："><a href="#summits-bed，narrowPeak，bdg-xls四种类型输出文件的比较：" class="headerlink" title="summits.bed，narrowPeak，bdg, xls四种类型输出文件的比较："></a>summits.bed，narrowPeak，bdg, xls四种类型输出文件的比较：</h3><p><img src="https://upload-images.jianshu.io/upload_images/8242255-539bc6f3090fc55f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><ul><li>xls文件<br>文件包含信息还是比较多的，和narrowPeak唯一不同的是peak的起始位置需要减1才是bed格式的文件，另外还包含fold_enrichment 和narrowPeak的fold change 对应，-log10pvalue,-log10qvalue,peak长度，peak 峰值位置等。</li><li>narrowPeak文件<br>和xls文件信息类似</li><li>summits.bed文件<br>包含峰的位置信息和-log10pvalue</li><li>bdg文件<br>bdg文件适合导入UCSC或IGV进行谱图可视化，或者转换为bigwig格式再进行可视化。<br><strong>为什么染色体号后面会出现其他的字符串？？？？</strong></li></ul><hr><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/03_peak_calling_macs.md" target="_blank" rel="noopener">HBC的深度NGS数据分析课程</a><br><a href="https://github.com/taoliu/MACS/" target="_blank" rel="noopener">MCAS2文档</a></p>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> ChIPseq </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第2篇：原始数据的质控、比对和过滤</title>
      <link href="/2019/08/23/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E8%B4%A8%E6%8E%A7%E3%80%81%E6%AF%94%E5%AF%B9%E5%92%8C%E8%BF%87%E6%BB%A4/"/>
      <url>/2019/08/23/%E7%AC%AC2%E7%AF%87%EF%BC%9A%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E8%B4%A8%E6%8E%A7%E3%80%81%E6%AF%94%E5%AF%B9%E5%92%8C%E8%BF%87%E6%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>这部分内容包括对原始测序数据质控，然后比对过滤，这是所有NGS数据处理的上游分析。</p><ul><li><strong>ATAC-Seq与其他方法不同的一点是需要过滤去除线粒体（如果是植物，还需要过滤叶绿体），因为线粒体DNA是裸露的，也可以被Tn5酶识别切割。</strong></li><li><strong>另外一点需要注意的是课程中给出的是单端比对的示例代码，如果是双端测序做相应更改即可。</strong></li></ul><h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><ul><li>用FastQC进行质控检测</li><li>用Trimmomatic进行质量过滤</li><li>用Bowtie2比对，并理解相关参数含义</li></ul><a id="more"></a><h3 id="测序reads-的质控流程示意图"><a href="#测序reads-的质控流程示意图" class="headerlink" title="测序reads 的质控流程示意图"></a>测序reads 的质控流程示意图</h3><p><img src="https://upload-images.jianshu.io/upload_images/8242255-36f81589bdad9c92.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="FASTQC"><a href="#FASTQC" class="headerlink" title="FASTQC"></a>FASTQC</h3><p>首先对拿到的原始测序数据（fastq或fastq.gz格式）进行质控检测，直接用<code>fastqc</code>软件，再加上<code>multiqc</code>将多个检测结果一起展示。<br>如:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fastqc -o out_dir raw_data/*gz</span><br><span class="line">multiqc *fastqc.zip --ignore *.html</span><br></pre></td></tr></table></figure></p><h3 id="Trimmomatic"><a href="#Trimmomatic" class="headerlink" title="Trimmomatic"></a>Trimmomatic</h3><p>Trimmomatic 可以用于去除接头，过滤低质量数据。相同功能的软件还有很多，如<code>trim_galore</code>、<code>cutadapt</code>等，个人比较喜欢trim_galore可以自动识别接头类型。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 课程中给出的Trimmomatic 的用法（单端测序）</span></span><br><span class="line">$ java -jar /opt/Trimmomatic-0.33/trimmomatic-0.33.jar SE \</span><br><span class="line">-threads 2 \</span><br><span class="line">-phred33 \</span><br><span class="line">H1hesc_Input_Rep1_chr12.fastq \</span><br><span class="line">../results/trimmed/H1hesc_Input_Rep1_chr12.qualtrim20.minlen36.fq \</span><br><span class="line">LEADING:20 \</span><br><span class="line">TRAILING:20 \</span><br><span class="line">MINLEN:36</span><br></pre></td></tr></table></figure></p><p><strong>Trimmomatic参数含义：</strong>可以参考<a href="https://www.jianshu.com/p/a8935adebaae" target="_blank" rel="noopener">NGS 数据过滤之 Trimmomatic 详细说明</a><br><strong>trim_galore使用示例</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">trim_galore -q 20 --phred33 --stringency 3 --length 20 -e 0.1 --paired fq1 fq2  --gzip -o input_data_dir</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重新用fastqc检测进行过滤后的reads质量</span></span><br><span class="line">fastqc -o out_dir *fq.gz</span><br><span class="line">multiqc *fastqc.zip --ignore *.html</span><br></pre></td></tr></table></figure><h3 id="比对"><a href="#比对" class="headerlink" title="比对"></a>比对</h3><p>Bowtie2是一个快速精确的比对工具，基于Burrows-Wheeler Transform 构建基因组的FM 索引，比对过程所耗内存少。Bowtie2支持局部、双端、缺口比对模式，对大于50bp的reads比对效果更好（小于50bp的reads用Bowtie1）。</p><h4 id="创建Bowtie2索引"><a href="#创建Bowtie2索引" class="headerlink" title="创建Bowtie2索引"></a>创建Bowtie2索引</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bowtie2-build &lt;path_to_reference_genome.fa&gt; &lt;prefix_to_name_indexes&gt;</span><br><span class="line"><span class="comment"># Can find indexes for the entire genome on Orchestra using following path: /groups/shared_databases/igenome/Homo_sapiens/UCSC/hg19/Sequence/Bowtie2Index/</span></span><br></pre></td></tr></table></figure><h4 id="Bowtie2-比对"><a href="#Bowtie2-比对" class="headerlink" title="Bowtie2 比对"></a>Bowtie2 比对</h4><ul><li>p: 线程数</li><li>q: reads是fastq格式</li><li>x: index路径</li><li>U: fastq路径</li><li>S: 输出Sam格式文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 课程中给出的代码是单端比对</span></span><br><span class="line">bowtie2 -p 2 -q \</span><br><span class="line">-x ~/ngs_course/chipseq/reference_data/chr12\</span><br><span class="line">-U ~/ngs_course/chipseq/results/trimmed/H1hesc_Input_Rep1_chr12.qualtrim20.minlen36.fq \</span><br><span class="line">-S ~/ngs_course/chipseq/results/bowtie2/H1hesc_Input_Rep1_chr12_aln_unsorted.sam</span><br></pre></td></tr></table></figure></li></ul><p><strong>NOTE:</strong> 如果fastq文件是没有经过trim的，可以用局部比对执行soft-clipping，加上参数<code>--local</code></p><h3 id="过滤reads"><a href="#过滤reads" class="headerlink" title="过滤reads"></a>过滤reads</h3><p>首先将sam文件转为bam格式，再对bam文件进行排序，接着过滤唯一比对的reads，去除线粒体reads。<br><strong>转化为bam格式</strong><br>使用samtools转换格式<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">samtools view -h -S -b \</span><br><span class="line">-o H1hesc_Input_Rep1_chr12_aln_unsorted.bam \</span><br><span class="line">H1hesc_Input_Rep1_chr12_aln_unsorted.sam</span><br></pre></td></tr></table></figure></p><p><strong>对bam文件排序</strong><br>对bam文件按照基因组坐标排序，可以直接使用<code>samtools</code>，也可以使用<code>Sambamba</code>。<a href="http://lomereiter.github.io/sambamba/index.html" target="_blank" rel="noopener"><code>sambamba</code></a>快速处理bam和sam文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sambamba sort -t 2 \</span><br><span class="line">-o H1hesc_Input_Rep1_chr12_aln_sorted.bam \</span><br><span class="line">H1hesc_Input_Rep1_chr12_aln_unsorted.bam</span><br></pre></td></tr></table></figure><p><strong>过滤唯一比对的reads</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sambamba view -h -t 2 -f bam \</span><br><span class="line">-F <span class="string">"[XS] == null and not unmapped "</span> \</span><br><span class="line">H1hesc_Input_Rep1_chr12_aln_sorted.bam &gt; H1hesc_Input_Rep1_chr12_aln.bam</span><br></pre></td></tr></table></figure><p><strong>去除PCR重复</strong><br>PCR扩增和一些重复序列（如微卫星、着丝粒）会产生重复，干扰真实的富集信号，所以在call peaks前需要先去除重复，这里先用picard去除PCR重复。picard去除PCR重复时要加上参数<code>REMOVE_DUPLICATES=true</code>,否则只是标记了duplicates，并没有去除。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar picard-tools-1.119/MarkDuplicates.jar REMOVE_DUPLICATES=<span class="literal">true</span> I=H1hesc_Input_Rep1_chr12_aln.bam O=H1hesc_Input_Rep1_chr12_aln.dedup.bam M=H1hesc.duplicates.log</span><br></pre></td></tr></table></figure><p><strong>过滤线粒体reads</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">samtools index H1hesc_Input_Rep1_chr12_aln.dedup.bam</span><br><span class="line">samtools idxstats H1hesc_Input_Rep1_chr12_aln.dedup.bam &gt; H1hesc_Input_Rep1_chr12_aln.dedup.mitochondrial.stats</span><br><span class="line">samtools view -h H1hesc_Input_Rep1_chr12_aln.dedup.bam | grep -v <span class="string">'chrM'</span> | samtools view -bS -o H1hesc.final.bam</span><br></pre></td></tr></table></figure><p>上面给出的仅是示例代码，和参考课程不一样，实际运行需要修改相应文件。<br>此时就得到了唯一比对且已经去除过线粒体的比对文件，可以用于接下来的peaks calling。</p><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p>HBC的深度NGS数据分析课程：<a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/02_QC_and_alignment.md" target="_blank" rel="noopener">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/02_QC_and_alignment.md</a></p>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
            <tag> QC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第1篇：ATAC-seq的背景介绍以及与ChIP-Seq的异同</title>
      <link href="/2019/08/23/%E7%AC%AC1%E7%AF%87%EF%BC%9AATAC-seq%E7%9A%84%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E4%B8%8EChIP-Seq%E7%9A%84%E5%BC%82%E5%90%8C/"/>
      <url>/2019/08/23/%E7%AC%AC1%E7%AF%87%EF%BC%9AATAC-seq%E7%9A%84%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D%E4%BB%A5%E5%8F%8A%E4%B8%8EChIP-Seq%E7%9A%84%E5%BC%82%E5%90%8C/</url>
      
        <content type="html"><![CDATA[<h3 id="ATAC-Seq简介"><a href="#ATAC-Seq简介" class="headerlink" title="ATAC-Seq简介"></a>ATAC-Seq简介</h3><p><strong>ATAC-seq（Assay for Transposase-Accessible Chromatin with high throughput sequencing）</strong> 是2013年由斯坦福大学<a href="http://greenleaf.stanford.edu/index.html" target="_blank" rel="noopener">William J. Greenleaf</a>和<a href="http://changlab.stanford.edu/index.html" target="_blank" rel="noopener">Howard Y. Chang</a>实验室开发的用于研究染色质可及性（通常也理解为染色质的开放性）的方法， 原理是通过转座酶Tn5容易结合在开放染色质的特性，然后对Tn5酶捕获到的DNA序列进行测序。</p><p>真核生物的核DNA并不是裸露的，而是与组蛋白结合形成染色体的基本结构单位核小体，核小体再经逐步的压缩折叠最终形成染色体高级结构（如人的DNA链完整展开约2m长，经过这样的折叠就变成了纳米级至微米级的染色质结构而可以储存在小小的细胞核）。而DNA的复制转录是需要将DNA的紧密结构打开，从而允许一些调控因子结合（转录因子或其他调控因子）。这部分打开的染色质，就叫开放染色质，打开的染色质允许其他调控因子结合的特性称为染色质的可及性（chromatin accessibility）。因此，认为染色质的可及性与转录调控密切相关。<br>开放染色质的研究方法有ATAC-seq以及传统的DNase-Seq及FAIRE-seq等，ATAC-Seq由于所需细胞量少，实验简单，可以在全基因组范围内检测染色质的开放状态，目前已经成为研究染色质开放性的首选技术方法。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-a18ab4a1ad419cdf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="fig"></p><p><a href="https://www.ncbi.nlm.nih.gov/pubmed/24097267#" title="Nature methods." target="_blank" rel="noopener">Nat Methods, 2013</a>. <strong>doi: 10.1038/nmeth.2688. Epub 2013 Oct.</strong></p><a id="more"></a><h3 id="ATAC-Seq与ChIP-Seq的异同"><a href="#ATAC-Seq与ChIP-Seq的异同" class="headerlink" title="ATAC-Seq与ChIP-Seq的异同"></a>ATAC-Seq与ChIP-Seq的异同</h3><p>ATAC-Seq与ChIP-Seq的不同的是ATAC-Seq是全基因组范围内检测染色质的开放程度，可以得到全基因组范围内的蛋白质可能结合的位点信息，一般用于不知道特定的转录因子，用此方法与其他方法结合筛查感兴趣的特定调控因子；但是ChIP-Seq是明确知道感兴趣的转录因子是什么，根据感兴趣的转录因子设计抗体去做ChIP实验拉DNA，验证感兴趣的转录因子是否与DNA存在相互作用。ATAC-Seq、ChIP-Seq、Dnase-Seq、MNase-Seq、FAIRE-Seq整体的分析思路一致，找到富集区域，对富集区域进行功能分析。</p><ul><li><p><strong>ChIP-Seq</strong>是揭示特定转录因子或蛋白复合物的结合区域，实际是研究DNA和蛋白质的相互作用，利用抗体将蛋白质和DNA一起富集，并对富集到的DNA进行测序。</p></li><li><p><strong>DNase-Seq、ATAC-Seq、FAIRE-Seq</strong>都是用来研究开放染色质区域。DNase-Seq是用的DNase I内切酶识别开放染色质区域，而ATAC-seq是用的Tn5转座酶，随后进行富集和扩增；FAIRE-Seq是先进行超声裂解，然后用酚-氯仿富集。</p></li><li><p><strong>MNase-Seq</strong>是用来鉴定核小体区域。</p></li></ul><ul><li><img src="https://upload-images.jianshu.io/upload_images/8242255-333e68ef5995083f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></li></ul><p><strong>翻译部分</strong><br>下面这一部分是对HBC课程中ChIP-Seq Introduction这一节的介绍，主要包括的ChIP-Seq的实验设计和分析方法总体思路。原文链接：<a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/01_Intro_chipseq_and_setup.md。" target="_blank" rel="noopener">https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/01_Intro_chipseq_and_setup.md。</a></p><h2 id="ChIP-Seq-Introduction"><a href="#ChIP-Seq-Introduction" class="headerlink" title="ChIP-Seq Introduction"></a>ChIP-Seq Introduction</h2><h3 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h3><ul><li><strong>理解ChIP-Seq的实验设计</strong><h3 id="ChIP-Seq简介"><a href="#ChIP-Seq简介" class="headerlink" title="ChIP-Seq简介"></a>ChIP-Seq简介</h3>ChIP实验（Chromatin immunoprecipitation）即染色质免疫沉淀，根据DNA与蛋白质相互作用的原理，分离富集与感兴趣的蛋白相互作用的DNA。ChIP-Seq即对分离得到的DNA扩增测序，然后通过分析得到DNA的富集区域也称为peaks，同时可以鉴定过表达的序列motif以及进行功能注释分析。</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/8242255-6c4c141da0780fd4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ChIP-Seq Overall"></p><p>下面这一部分将会介绍ChIP-Seq数据分析的整个流程，从实验设计到产生原始的测序reads，以及到最后的功能富集分析和motif查找。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-5a3c0ba8ea4c59ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="实验设计和文库构建"><a href="#实验设计和文库构建" class="headerlink" title="实验设计和文库构建"></a>实验设计和文库构建</h3><p>文库构建包括以下5步骤：</p><ul><li>蛋白质与DNA的交联</li><li>超声打断DNA链</li><li>加附有抗体的磁珠用于免疫沉淀</li><li>解交联，纯化DNA</li><li>DNA片段大小选择和PCR扩增</li></ul><p>富集到的DNA片段只有一部分是真实的信号（感兴趣的蛋白结合的DNA区域），这个比例取决于<strong>number of active binding sites, the number of starting genomes, and the efficiency of the IP.</strong></p><p>ChIP-Seq富集序列存在以下特点：</p><ul><li>开放染色质区域比紧密区域更易打断；</li><li>重复序列会出现似乎被富集的现象</li><li>序列在整个基因组上不均匀分布</li></ul><p>因此，ChIP-Seq需要有合适的对照组，对照样本需要满足以下其中一个条件：</p><ul><li>没有IP（input DAN）</li><li>没有抗体 (“mock IP”)</li><li>没有特定的抗体 (IgG “mock IP”)</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/8242255-3258f63385c35669.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-57ffd903f1fc2766.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="示例数据介绍"><a href="#示例数据介绍" class="headerlink" title="示例数据介绍"></a>示例数据介绍</h3><p>所用到的示例数据是来自于人类胚胎干细胞系（h1-ESC）中<strong>Nanog和Pou5f1（Oct4）</strong>两个转录因子的结合图谱。这两个转录因子的功能涉及干细胞的多能性，该研究的目标之一是探究这两个转录因子在转录调控中单独和相互的调控作用。<br>两组重复，每组重复包括3个实验样本信息，共6个样本，数据分析中只用到了12号染色体的信息。<br>Nanog IP<br>Pou5f1 IP<br>Control input DNA</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-2a3a493c405b2b06.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p><h3 id="分析流程"><a href="#分析流程" class="headerlink" title="分析流程"></a>分析流程</h3><p>下面这幅图给出了整个分析流程，和每一步需要的数据格式，后面会展开介绍。</p><h3 id="分析环境配置"><a href="#分析环境配置" class="headerlink" title="分析环境配置"></a>分析环境配置</h3><p>这个课程提供了示例数据和分析代码，可以参考<a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/orchestra_mounting.md" target="_blank" rel="noopener">这里</a>连接他们的服务器，我没有连接成功，不知道是不是打开方式不对，大家可以尝试下，如果连接成功，这一部分就是配置服务器的环境，准备数据；如果也连接不上可以用自己的数据或者下载公共数据。</p><p><img src="https://upload-images.jianshu.io/upload_images/8242255-42c0586d8549bb34.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="zoom:50%"></p><h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="https://zhuanlan.zhihu.com/p/31924355" target="_blank" rel="noopener">ATAC-seq：染色质开放性测序技术</a><br><a href="https://www.nature.com/articles/nrg3788#f1" target="_blank" rel="noopener">Clifford A. et al. Nature review, 2014</a><br>HBC课程V : <a href="https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/01_Intro_chipseq_and_setup.md" target="_blank" rel="noopener">01-Introduction to ChIP-Seq</a></p>]]></content>
      
      
      <categories>
          
          <category> epigenetics </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ATACseq </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
