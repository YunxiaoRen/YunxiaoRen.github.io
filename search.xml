<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[细菌生物信息资源数据库——PATRIC]]></title>
    <url>%2F2020%2F02%2F08%2FSat%20Feb%2008%202020%2019%3A22%3A12%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[PATRIC https://www.patricbrc.org/ ：即病理系统资源整合中心，提供了集成的数据资源和分析工具，以支持有关细菌感染性疾病的生物医学研究。 PATRIC, the Pathosystems Resource Integration Center, provides integrated data and analysis tools to support biomedical research on bacterial infectious diseases. 下面是该网站主页，主要包含3个模块： 第一个是搜索模块，可以对细菌、古细菌、噬菌体以及真核宿主进行搜索，数据包括基因组、基因、转录组实验、分类学等信息； 第二个是数据分析模块，可以进行基因组组装、注释、RNA-seq、代谢组的分析等 第三个是多组学数据资源，如AMR数据，基因组数据，蛋白质家族，特殊基因等数据资源]]></content>
      <tags>
        <tag>database</tag>
        <tag>AMR</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[类器官和ATAC-seq技术结合研究人前脑发育图谱]]></title>
    <url>%2F2020%2F02%2F08%2FSat%20Feb%2008%202020%2019%3A12%3A18%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 人类前脑发育的染色质可及性动态图谱 文章信息 题目：Chromatin accessibility dynamics in a model of human forebrain development 杂志：Science 时间：24 January 2020 链接: http://dx.doi. org/10.1126/ science.aay1645 figure 文章介绍： 人类前脑发育在很大程度上是细胞水平研究、直接功能研究或操纵所无法达到的。缺乏初级脑组织样本，特别是在后期，以及传统的体外细胞模型的局限性，阻碍了对健康和疾病状态下皮质激素生成的详细机制性理解。而文中利用干细胞3D定向分化技术形成背侧和腹侧的前脑干细胞作为原始研究组织，更加接近体内真实的发育情况，然后利用ATAC-seq和RNA测序技术绘制了体外20多个月的神经元和胶质细胞系的发育图谱。并对增强子和基因的相互作用，以及每个发育时期特异的转录调控因子进行了探究。然后他们利用这个资源绘制了与精神分裂症和自闭症谱系失调相关的基因和遗传变异图，以区分染色质可及性模式，从而揭示细胞类型和易感期。最后，他们鉴定到在皮质神经发生过程中染色质重构的现象，在此期间四分之一的调节区域是活跃的，并推测这些转录因子可能驱动这些发育变化。 关于脑神经发育过程中染色质可及性图谱的文章已有人发表过，这篇文章仍然能发到Science上，借助了一项重要的实验技术——对干细胞进行重编程然后进行3D培养形成人脑的类器官。]]></content>
      <tags>
        <tag>ATACseq</tag>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[构建基因调控网络的新算法]]></title>
    <url>%2F2020%2F01%2F04%2FSat%20Jan%2004%202020%2016%3A25%3A08%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[基因表达数据被广泛用于推测基因调控网络（Gene regulatory networks, GRNs）。单细胞RNAseq数据包含单个细胞的表达信息，非常有利于调控机制的研究。但是，目前从大量的表达数据中明确转录调控机制仍然面临挑战，而且，重构后的调控网络可能无法捕获主要的调控规则。 这篇文章提出了一个新的方法——TENET：从scRNAseq数据中通过传递熵（transfer entropy, TE) 计算基因间的因果关系，从而构建GRNs。他们的结果发现已知的靶基因具有显著高的TE值，且TE值越高的基因受各种干扰的影响越大。与其他方法相比，他们的结果表明TENET优于其他GRN预测算法。还有一个重要的性能是该方法可以鉴定关键的调控因子。将TENET应用于胚胎干细胞向神经细胞分化过程中的scRNAseq数据，他们发现Nme2是2i条件下特异性干细胞自我更新的关键因子。 一句话评价 构建基因调控网络的新算法 文章信息 题目：Gene network reconstruction using single cell transcriptomic data reveals key factors for embryonic stem cell differentiation 杂志：bioRxiv 时间：Dec. 21, 2019 链接: https://www.biorxiv.org/content/10.1101/2019.12.20.884163v1 有点遗憾，如果半年前自己上点心的话，可能就能深入这个方向的研究了]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
        <tag>scRNA-seq</tag>
        <tag>regulation network</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[利用多组学数据预测药物组合的驱动网络标记物]]></title>
    <url>%2F2019%2F12%2F29%2FSun%20Dec%2029%202019%2010%3A47%3A14%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[文章介绍： 药物组合不仅可能同时抑制多种肿瘤的驱动信号通路，而且有可能减少药物抵抗性。这篇文章介绍了一个利用多组学数据开发的工具——DrugComboExplorer，鉴定药物组合的驱动信号通路，并预测药物组合的协同作用。 该工具通过处理来自单个癌症患者的DNA测序、基因拷贝数、DNA甲基化和RNA序列数据，使用整合的算法（包括bootstrap aggregating-based Markov random field，WGCNA,监督调控网络学习）流程产生驱动信号网络。 DrugComboExplorer is available at https://github.com/Roosevelt- PKU/drugcombinationprediction. figure 文章信息 题目：Driver network as a biomarker: systematic integration and network modeling of multi-omics data to derive driver signaling pathways for drug combination prediction 杂志：Bioinformatics, 时间：15 February 2019 链接: doi: 10.1093/bioinformatics/btz109 每日文献摘要：第27篇 2019年12月29日 周日]]></content>
      <tags>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[利用全基因组组织表达谱预测疾病相关lncRNA]]></title>
    <url>%2F2019%2F12%2F29%2FSun%20Dec%2029%202019%2010%3A43%3A16%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[文章介绍： 基于机器学习的方法——DislncRF，根据组织表达谱从全基因组范围预测疾病相关的lncRNA。DislncRF是基于随机森林模型训练已知的与疾病相关的蛋白编码基因（protein-coding genes ，PCGs），从而提取疾病与表达谱的一般模式，然后应用到lncRNA与疾病的关联中， 代码：https://github.com/xypan1232/DislncRF figure 文章信息 题目：Inferring disease-associated long non-coding RNAs using genome-wide tissue expression profiles 杂志：Bioinformatics 时间：2018 链接: doi.10.1093/bioinformatics/xxxxxx 碎碎念 利用蛋白编码基因与疾病的模式训练模型，然后预测lncRNA与疾病的关联，这样选训练集可靠吗？ 每日文献摘要：第28篇 2019年12月29日 周日]]></content>
      <tags>
        <tag>文献摘要</tag>
        <tag>lncRNA</tag>
        <tag>machine learning</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[利用多组学数据重构调控网络]]></title>
    <url>%2F2019%2F12%2F29%2FSun%20Dec%2029%202019%2010%3A36%3A25%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[文章介绍： 随着测序技术的发展，生命组学数据和医学数据爆炸式增长，单一组学指标并不能够充分反映疾病或正常的生命发育机制，结合多组学从不同层面揭示调控机制将有助于我们更精确的认识生命过程和疾病病因。这篇综述使用state-of-the-art techniques方法概括了调控网络重构的方法，为挖掘多组学数据（基因组、转录组、蛋白质组等）和其他生物数据背后的意义提供了参考。 figure 数据整合策略： 数据整合方法： 文章信息 题目：Integrative approaches to reconstruct regulatory networks from multi-omics T data: A review of state-of-the-art methods 杂志：Computational Biology and Chemistry 时间：August, 2019 链接: https://doi.org/10.1016/j.compbiolchem.2019.107120 每日文献摘要：第29篇 2019年12月29日 周日]]></content>
      <tags>
        <tag>multi-omics</tag>
        <tag>regulation network</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[深度学习在遗传变异和表观调控中的应用]]></title>
    <url>%2F2019%2F12%2F29%2FSun%20Dec%2029%202019%2010%3A34%3A47%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[文章介绍： 利用深度学习卷积神经网络的方法，以表观数据和基因组遗产数据作为参考，训练模型，预测遗传变异的影响。 figure 文章信息 题目：Functional interpretation of genetic variants using deep learning predicts impact on chromatin accessibility and histone modification 杂志：Nucleic Acids Research 时间：2019 链接: doi: 10.1093/nar/gkz808 每日文献摘要：第30篇 2019年12月30日 周日]]></content>
      <tags>
        <tag>deep learning</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[非编码RNA数据库]]></title>
    <url>%2F2019%2F12%2F29%2FSun%20Dec%2029%202019%2010%3A32%3A10%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[文章介绍： RNAcentral是一个综合的非编码RNA数据库，包括大量物种所有类型的非编码RNA序列信息，同时整合了28个数据库，可以搜索比较不同数据库ncRNA序列信息，也可以与数据库比对检索序列与ncRNA序列的相似性，也可以通过Genome browser可视化ncRNA在基因组区域的注释信息，所有数据可以下载。 数据库网址：https://rnacentral.org figure 文章信息 题目：RNAcentral: a hub of information for non-coding RNA sequences 杂志：Nucleic Acids Research, 时间：November, 2019 链接: doi: 10.1093/nar/gky1034 每日文献摘要：第31篇 2019年12月29日 周日]]></content>
      <tags>
        <tag>lncRNA</tag>
        <tag>database</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[单细胞分析相关R包汇总]]></title>
    <url>%2F2019%2F12%2F29%2FSun%20Dec%2029%202019%2010%3A31%3A22%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[文章介绍： Bioconductor是一个针对生物数据分析的以R语言开发的开源软件库，从2001年项目开始至今，提供了很多优秀的分析流程，如bulk-RNA-seq的分析流程，文档非常详细。如今出手整理了单细胞分析的流程，包括软件安装、数据导入、单细胞数据储存、格式转换为下游分析的数据、下游分析、可视化等，非常详细，另外他们提供了在线book：https://osca.bioconductor .，想上手学习单细胞分析的以本书作为一个入门是一个不错的选择。 figure 文章信息 题目：Orchestrating single-cell analysis with Bioconductor 杂志：Nature Methods 时间：02, December, 2019 链接: https://www.nature.com/articles/s41592-019-0654-x 每日文献摘要：第32篇 2019年12月29日 周日]]></content>
      <tags>
        <tag>software</tag>
        <tag>single cell</tag>
        <tag>R</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[深度学习在药物基因组学中的学习和数据资源]]></title>
    <url>%2F2019%2F12%2F29%2FSun%20Dec%2029%202019%2010%3A28%3A18%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[文章介绍： 这篇综述介绍了深度学习的基本模型和典型模型架构，同时总结了深度学习（DL）在肿瘤和肿瘤亚型鉴定的应用（即病人的诊断和分诊治疗），在药物对个体的效应和协同作用的预测，以及在机制、治疗研究中药物的发现和定位的应用。他们整合了基因组学数据和药物基因组数据资源，如 TCGA, ICGC等药物数据库，以及P a DEL药物数据库等。系统地描绘了深度学习在肿瘤药物基因组学中应用。 figure 文章信息 题目：Deep learning of pharmacogenomics resources: moving towards precision oncology 杂志：Briefings in Bioinformatics 时间：2019 链接: doi: 10.1093/bib/bbz144 每日文献摘要：第33篇 2019年12月29日 周日]]></content>
      <tags>
        <tag>deep learning</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[新的降维可视化方法]]></title>
    <url>%2F2019%2F12%2F29%2FSun%20Dec%2029%202019%2010%3A04%3A27%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 新的高维数据结构和模式的可视化方法——PHATE 文章信息 题目：Visualizing structure and transitions in high-dimensional biological data 杂志：Nature biotechnology 时间：3 December,2019 链接: https://www.nature.com/articles/s41587-019-0336-3 figure 文章介绍： 这篇文章提出常见的降维方法如PCA, t-SNE等方法存在对噪音敏感（PCA, Isomap)、扰乱数据结构(t-SNE)、没有为二维可视化优化（PCA &amp; diffusion maps)，计算资源消耗大、依赖于先验知识等不足，他们提出了一种利用数据点之间的信息几何距离(information-geometric distance)同时捕捉局部和全局的非线性结构的可视化方法——PHATE(potential of heat diffusion for affinity-based transition embedding)。与其他常见的降维方法相比，该方法能够更好的保持数据中的一系列结构模式，包括连续的发展进程、分支结构、簇的结构（clusters）。此外，他们定义了一个叫DEMaP的度量，可以更好的去噪。他们在实际数据中验证了该方法的有效性，并且可用于质谱数据、单细胞数据、Hi-C数据、肠道微生物等多种数据类型。 每日文献摘要：第26篇 2019年12月29日 周日]]></content>
      <tags>
        <tag>software</tag>
        <tag>文献摘要</tag>
        <tag>降维</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[单细胞RNA-seq分析流程的系统评估]]></title>
    <url>%2F2019%2F12%2F28%2FSat%20Dec%2028%202019%2019%3A46%3A35%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 scRNA-seq分析流程大比拼 文章信息 题目：A systematic evaluation of single cell RNA-seq analysis pipelines 杂志：Nature Communication 时间：11, October, 2019 链接: https://doi.org/10.1038/s41467-019-12266-7 figure 文章介绍： 单细胞RNA-seq是单细胞领域较为成熟的技术，相关的实验方法和计算方法也不断被开发，面临着越来越多的方法和工具，如何选择合适的最佳流程呢？这篇文章从单细胞建库方法，比对、imputation、标准化和差异方法共评估约3000个组合流程。评价结果可以作为选择最佳分析流程的一个参考，不过所谓的最佳流程并不是以一概全指某个特定流程，而是要根据实际研究目的，选择合适的实验方法和分析方法。 另外还可以参考前不久发表的单细胞RNA-seq最佳分析流程：Current best practices in single‐cell RNA‐seq analysis: a tutorial (https://doi.org/10.15252/msb.20188746) 每日文献摘要：第25篇 2019年12月29日 周日]]></content>
      <tags>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[基于R语言绘制坐标轴截断图]]></title>
    <url>%2F2019%2F12%2F16%2FMon%20Dec%2016%202019%2020%3A18%3A11%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[画图时经常遇到不同组的数据大小相差很大，大数据就会掩盖小数据的变化规律，这时候可以对Y轴进行截断，从而可以在不同层面（大数据和小数据层面）全面反映数据变化情况，如下图所示。 搜索截断图绘制的方法，有根据Excel绘制的，但是感觉操作繁琐；这里根据网上资料总结基于R的3种方法： 分割+组合法，如基于ggplot2, 利用coord_cartesian()将整个图形分割成多个图片,再用grid 包组合分割结果 plotrix R包 基本绘图函数+plotrix R包 示例数据12345678910111213df &lt;- data.frame(name=c("AY","BY","CY","DY","EY","FY","GY"),Money=c(1510,1230,995,48,35,28,10))df#加载 R 包library(ggplot2)# ggplot画图p0 &lt;- ggplot(df, aes(name,Money,fill = name)) + geom_col(position = position_dodge(width = 0.8),color="black") + labs(x = NULL, y = NULL) + scale_fill_brewer(palette="Accent")+ #scale_x_discrete(expand = c(0, 0)) + scale_y_continuous(breaks = seq(0, 1600, 400), limits = c(0, 1600), expand = c(0,0)) + theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.title = element_blank()) 方法一：分割+组合法这种方法的思路是分别绘制不同层级大小的图形，然后组合图形。如可一用ggplot2中的coord_cartesian()函数分割，ylim指定y轴的区间范围。 参考：http://blog.sciencenet.cn/blog-3406804-1156908.html 123456789101112### 小数据层级p1 &lt;- p0 + coord_cartesian(ylim = c(0, 50)) + theme_classic()+ theme(legend.position="none") ### 大数据层级# 不显示X轴坐标和文本标记p2 &lt;-p0 + coord_cartesian(ylim = c(700, 1600)) + theme_classic() + theme(axis.line.x = element_line(colour="white"), axis.text.x = element_blank(), axis.ticks.x = element_blank(), legend.position = c(0.85, 0.6)) P1 p2 grid组合图形, grid.newpage()新建画布, viewport()命令将画板分割为不同的区域。 x和y分别用于指定所放置子图在画板中的坐标，坐标取值范围为0~1，并使用just给定坐标起始位置；width和height用于指定所放置子图在画板中的高度和宽度。 12345678library(grid)grid.newpage() #新建画布plot_site1 &lt;- viewport(x = 0.008, y = 0, width = 0.994, height = 0.4, just = c('left', 'bottom'))plot_site2 &lt;- viewport(x = 0.008, y = 0.4, width = 1, height = 0.5, just = c('left', 'bottom'))#plot_site3 &lt;- viewport(x = 0, y = 0.7, width = 1, height = 0.3, just = c('left', 'bottom'))print(p1, vp = plot_site1)print(p2, vp = plot_site2) 这种方法可以得到一个草图，图片对齐等细节调节需要多次尝试，或者可以导出在AI中修改。 方法二：plotrix R包plotrix R中包含gap.plot()，gap.barplot() 和 gapboxplot()函数, 可以分别画出坐标轴截断的散点图、柱状图和箱线图。主要参数包括y ：要截断的数值向量; gap：截断的区间. 1234567891011121314151617### 用法如下 gap.barplot(y,gap,xaxlab,xtics,yaxlab,ytics,xlim=NA,ylim=NA,xlab=NULL, ylab=NULL,horiz=FALSE,col,...)### Argumentsy ：要截断的数值向量gap ：截断的区间xaxlab ：labels for the x axis ticksxtics ：position of the x axis ticksyaxlab ：labels for the y axis ticksytics ：position of the y axis ticksxlim ：Optional x limits for the plotylim ：optional y limits for the plotxlab ：label for the x axisylab ：label for the y axishoriz ：whether to have vertical or horizontal barscol ：color(s) in which to plot the values 参考：http://www.bioon.com.cn/protocol/showarticle.asp?newsid=66061 相同的数据，画图如下 12345#install.packages ("plotrix")library (plotrix)gap.barplot(df$Money,gap=c(50,740),xaxlab=df$name,ytics=c(50,700,800,900,1000,1100,1200,1300,1400,1500,1600), col=rainbow(7),xlim = c(0,8),width=0.06) 接着使用axis breaks()函数去除中间的两道横线，并添加截断的标记，如//或z。 Axis:1,2,3,4分别代表下、左、上、右方位的坐标轴，即打算截取的坐标轴 breakppos：截断的位置，即截断符号添加的位置 style: gap,slash和z字形 123axis.break(2,50,breakcol="snow",style="gap") ##去掉中间的那两道横线；axis.break(2,50*(1+0.02),breakcol="black",style="slash")##在左侧Y轴把gap位置换成slash；#axis.break(4,50*(1+0.02),breakcol="black",style="slash")##在右侧Y轴把gap位置换成slash； 这种方法是基于base plot绘图的，但是base plot的许多绘图参数与gap.barplot（）并不兼容，如space和width参数设置离坐标轴距离和bar的宽度。 方法三：基本绘图函数+plotrix R包 参考：https://blog.csdn.net/u014801157/article/details/24372371 作者ZGUANG@LZU自己编写的函数，可以手动设置断点，也可以由函数自动计算。断点位置的符号表示提供了平行线和zigzag两种，并且可设置背景颜色、大小、线型、平行线旋转角度等。 函数123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202#' 使用R基本绘图函数绘制y轴不连续的柱形图#'#' 绘制y轴不连续的柱形图，具有误差线添加功能。断点位置通过btm和top参数设置，如果不设置，函数可自动计算合适的断点位置。#' @title gap.barplot function#' @param df 长格式的data.frame，即数据框中每一列为一组绘图数据。#' @param y.cols 用做柱形图y值的数据列（序号或名称），一列为一组。#' @param sd.cols 与y值列顺序对应的误差值的数据列（序号或名称）。#' @param btm 低位断点。如果btm和top均不设置，程序将自动计算和设置断点位置。#' @param top 高位断点。#' @param min.range 自动计算断点的阈值：最大值与最小值的最小比值#' @param max.fold 自动计算断点时最大值与下方数据最大值的最大倍数比#' @param ratio 断裂后上部与下部y轴长度的比例。#' @param gap.width y轴断裂位置的相对物理宽度（非坐标轴实际刻度）#' @param brk.type 断点类型，可设为normal或zigzag#' @param brk.bg 断点处的背景颜色#' @param brk.srt 断点标记线旋转角度#' @param brk.size 断点标记线的大小（长度）#' @param brk.col 断点标记线的颜色#' @param brk.lwd 断点标记线的线宽#' @param cex.error 误差线相对长度，默认为1#' @param ... 其他传递给R基本绘图函数barplot的参数#' @return 返回barplot的原始返回值，即柱形图的x坐标#' @examples#' datax &lt;- na.omit(airquality)[,1:4]#' cols &lt;- cm.colors(ncol(datax))#' layout(matrix(1:6, ncol=2))#' set.seed(0)#' for (ndx in 1:6)&#123;#' dt &lt;- datax[sample(rownames(datax), 10), ]#' par(mar=c(0.5,2,0.5,0.5))#' brkt &lt;- sample(c('normal', 'zigzag'), 1)#' gap.barplot(dt, col=cols, brk.type=brkt, max.fold=5, ratio=2)#' &#125;#' @author ZG Zhao#' @exportgap.barplot &lt;- function(df, y.cols = 1:ncol(df), sd.cols = NULL, btm = NULL, top = NULL, min.range = 10, max.fold = 5, ratio = 1, gap.width = 1, brk.type = "normal", brk.bg = "white", brk.srt = 135, brk.size = 1, brk.col = "black", brk.lwd = 1, cex.error = 1, ...) &#123; if (missing(df)) stop("No data provided.") if (is.numeric(y.cols)) ycol &lt;- y.cols else ycol &lt;- colnames(df) == y.cols if (!is.null(sd.cols)) if (is.numeric(sd.cols)) scol &lt;- sd.cols else scol &lt;- colnames(df) == sd.cols ## Arrange data opts &lt;- options() options(warn = -1) y &lt;- t(df[, ycol]) colnames(y) &lt;- NULL if (missing(sd.cols)) sdx &lt;- 0 else sdx &lt;- t(df[, scol]) sdu &lt;- y + sdx sdd &lt;- y - sdx ylim &lt;- c(0, max(sdu) * 1.05) ## 如果没有设置btm或top，自动计算 if (is.null(btm) | is.null(top)) &#123; autox &lt;- .auto.breaks(dt = sdu, min.range = min.range, max.fold = max.fold) if (autox$flag) &#123; btm &lt;- autox$btm top &lt;- autox$top &#125; else &#123; xx &lt;- barplot(y, beside = TRUE, ylim = ylim, ...) if (!missing(sd.cols)) errorbar(xx, y, sdu - y, horiz = FALSE, cex = cex.error) box() return(invisible(xx)) &#125; &#125; ## Set up virtual y limits halflen &lt;- btm - ylim[1] xlen &lt;- halflen * 0.1 * gap.width v_tps1 &lt;- btm + xlen # virtual top positions v_tps2 &lt;- v_tps1 + halflen * ratio v_ylim &lt;- c(ylim[1], v_tps2) r_tps1 &lt;- top # real top positions r_tps2 &lt;- ylim[2] ## Rescale data lmx &lt;- summary(lm(c(v_tps1, v_tps2) ~ c(r_tps1, r_tps2))) lmx &lt;- lmx$coefficients sel1 &lt;- y &gt; top sel2 &lt;- y &gt;= btm &amp; y &lt;= top y[sel1] &lt;- y[sel1] * lmx[2] + lmx[1] y[sel2] &lt;- btm + xlen/2 sel1 &lt;- sdd &gt; top sel2 &lt;- sdd &gt;= btm &amp; sdd &lt;= top sdd[sel1] &lt;- sdd[sel1] * lmx[2] + lmx[1] sdd[sel2] &lt;- btm + xlen/2 sel1 &lt;- sdu &gt; top sel2 &lt;- sdu &gt;= btm &amp; sdu &lt;= top sdu[sel1] &lt;- sdu[sel1] * lmx[2] + lmx[1] sdu[sel2] &lt;- btm + xlen/2 ## bar plot xx &lt;- barplot(y, beside = TRUE, ylim = v_ylim, axes = FALSE, names.arg = NULL, ...) ## error bars if (!missing(sd.cols)) errorbar(xx, y, sdu - y, horiz = FALSE, cex = cex.error) ## Real ticks and labels brks1 &lt;- pretty(seq(0, btm, length = 10), n = 4) brks1 &lt;- brks1[brks1 &gt;= 0 &amp; brks1 &lt; btm] brks2 &lt;- pretty(seq(top, r_tps2, length = 10), n = 4) brks2 &lt;- brks2[brks2 &gt; top &amp; brks2 &lt;= r_tps2] labx &lt;- c(brks1, brks2) ## Virtual ticks brks &lt;- c(brks1, brks2 * lmx[2] + lmx[1]) axis(2, at = brks, labels = labx) box() ## break marks pos &lt;- par("usr") xyratio &lt;- (pos[2] - pos[1])/(pos[4] - pos[3]) xlen &lt;- (pos[2] - pos[1])/50 * brk.size px1 &lt;- pos[1] - xlen px2 &lt;- pos[1] + xlen px3 &lt;- pos[2] - xlen px4 &lt;- pos[2] + xlen py1 &lt;- btm py2 &lt;- v_tps1 rect(px1, py1, px4, py2, col = brk.bg, xpd = TRUE, border = brk.bg) x1 &lt;- c(px1, px1, px3, px3) x2 &lt;- c(px2, px2, px4, px4) y1 &lt;- c(py1, py2, py1, py2) y2 &lt;- c(py1, py2, py1, py2) px &lt;- .xy.adjust(x1, x2, y1, y2, xlen, xyratio, angle = brk.srt * pi/90) if (brk.type == "zigzag") &#123; x1 &lt;- c(x1, px1, px3) x2 &lt;- c(x2, px2, px4) if (brk.srt &gt; 90) &#123; y1 &lt;- c(y1, py2, py2) y2 &lt;- c(y2, py1, py1) &#125; else &#123; y1 &lt;- c(y1, py1, py1) y2 &lt;- c(y2, py2, py2) &#125; &#125; if (brk.type == "zigzag") &#123; px$x1 &lt;- c(pos[1], px2, px1, pos[2], px4, px3) px$x2 &lt;- c(px2, px1, pos[1], px4, px3, pos[2]) mm &lt;- (v_tps1 - btm)/3 px$y1 &lt;- rep(c(v_tps1, v_tps1 - mm, v_tps1 - 2 * mm), 2) px$y2 &lt;- rep(c(v_tps1 - mm, v_tps1 - 2 * mm, btm), 2) &#125; par(xpd = TRUE) segments(px$x1, px$y1, px$x2, px$y2, lty = 1, col = brk.col, lwd = brk.lwd) options(opts) par(xpd = FALSE) invisible(xx)&#125;## 绘制误差线的函数errorbar &lt;- function(x, y, sd.lwr, sd.upr, horiz = FALSE, cex = 1, ...) &#123; if (missing(sd.lwr) &amp; missing(sd.upr)) return(NULL) if (missing(sd.upr)) sd.upr &lt;- sd.lwr if (missing(sd.lwr)) sd.lwr &lt;- sd.upr if (!horiz) &#123; arrows(x, y, y1 = y - sd.lwr, length = 0.1 * cex, angle = 90, ...) arrows(x, y, y1 = y + sd.upr, length = 0.1 * cex, angle = 90, ...) &#125; else &#123; arrows(y, x, x1 = y - sd.lwr, length = 0.1 * cex, angle = 90, ...) arrows(y, x, x1 = y + sd.upr, length = 0.1 * cex, angle = 90, ...) &#125;&#125;.xy.adjust &lt;- function(x1, x2, y1, y2, xlen, xyratio, angle) &#123; xx1 &lt;- x1 - xlen * cos(angle) yy1 &lt;- y1 + xlen * sin(angle)/xyratio xx2 &lt;- x2 + xlen * cos(angle) yy2 &lt;- y2 - xlen * sin(angle)/xyratio return(list(x1 = xx1, x2 = xx2, y1 = yy1, y2 = yy2))&#125;## 自动计算断点位置的函数.auto.breaks &lt;- function(dt, min.range, max.fold) &#123; datax &lt;- sort(as.vector(dt)) flags &lt;- FALSE btm &lt;- top &lt;- NULL if (max(datax)/min(datax) &lt; min.range) return(list(flag = flags, btm = btm, top = top)) m &lt;- max(datax) btm &lt;- datax[2] i &lt;- 3 while (m/datax[i] &gt; max.fold) &#123; btm &lt;- datax[i] flags &lt;- TRUE i &lt;- i + 1 &#125; if (flags) &#123; btm &lt;- btm + 0.05 * btm x &lt;- 2 top &lt;- datax[i] * (x - 1)/x while (top &lt; btm) &#123; x &lt;- x + 1 top &lt;- datax[i] * (x - 1)/x if (x &gt; 100) &#123; flags &lt;- FALSE break &#125; &#125; &#125; return(list(flag = flags, btm = btm, top = top))&#125; 示例数据123456789101112datax &lt;- na.omit(airquality)[, 1:4]cols &lt;- terrain.colors(ncol(datax) - 1)layout(matrix(1:4, ncol = 2))set.seed(0)for (ndx in 1:4) &#123; dt &lt;- datax[sample(rownames(datax), 10), ] dt &lt;- cbind(dt, dt[, -1] * 0.1) par(mar = c(1, 3, 0.5, 0.5)) brkt &lt;- sample(c("normal", "zigzag"), 1) gap.barplot(dt, y.cols = 2:4, sd.cols = 5:7, col = cols, brk.type = brkt, brk.size = 0.6, brk.lwd = 2, max.fold = 5, ratio = 2, cex.error = 0.3)&#125; 实际数据12gap.barplot(df, y.cols = 2, brk.type = "normal",col = rainbow(7), brk.size = 0.6, brk.lwd = 2, max.fold = 5, ratio = 2, cex.error = 0.3) 第3种方法可以直接计算截断值，另外可以添加error bar, 可以修改的细节处更多，而且包装成函数，整个分析时间也加快。]]></content>
      <tags>
        <tag>R</tag>
        <tag>visualization</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[深度学习揭示体内肿瘤的转移和抗体靶向治疗效率]]></title>
    <url>%2F2019%2F12%2F14%2FSat%20Dec%2014%202019%2016%3A29%3A29%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 基于透明化的成像技术和深度学习算法快速、准确检测微量肿瘤细胞的转移 文章信息 题目：Deep Learning Reveals Cancer Metastasis and Therapeutic Antibody Targeting in the Entire Body 杂志：Cell 时间：December 12, 2019 链接: https://doi.org/10.1016/j.cell.2019.11.013 文章介绍： 肿瘤转移是癌症病人产生治疗抵抗和死亡率升高的一个原因，高效、准确的检测肿瘤的转移具有重要的意义。但是目前技术上有两方面的限制：一是成像技术，可以在体内准确检测所有肿瘤细胞转移的成像技术，二是缺乏对大规模图像数据进行快速、准确定量的算法。这项研究针对这两个瓶颈问题，开发了解决方案。 成像的原理主要是基于对荧光蛋白的标记，但是由于鼠体内很多组织有高度的自发荧光会干扰对单个肿瘤细胞或者少量细胞群的荧光信号检测。因此，他们采用使小鼠变得透明的vDISCO技术，使肿瘤细胞的荧光信号在透明的组织中增强超过100倍，从而既可以检测大规模的转移，也可以准确检测微量的转移。 vDISCO技术：一种压力驱动、基于纳米体的全身免疫标记技术，可将荧光蛋白的信号增强两个数量级。 https://www.nature.com/articles/s41593-018-0301-3 针对算法问题，他们基于卷积神经网络开发了DeepMACT(deep learning-enabled metastasis analysis in cleared tissue)的算法，可以自动化、快速的注释癌症转移的情况，以及抗体药物靶向的效率。 想进一步了解这个算法的可参考：DeepMACT handbook：http://discotechnologies.org/DeepMACT/ figure 碎碎念 透明化这种技术可以用于体内追踪药物、细胞转移等轨迹，用途太多了，再加上深度学习算法的加持，这篇文章不愧是cell封面文章。 每日文献摘要：第24篇 2019年12月14日 周六]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
        <tag>deep learning</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[单细胞多组学联合分析scRNAseq+scATACseq]]></title>
    <url>%2F2019%2F12%2F12%2FThu%20Dec%2012%202019%2021%3A14%3A48%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[单细胞发展至今，多组学整合是其发展的一个方向，关于scRNAseq与scATACseq整合的方法也有很多文章报道，这篇文章是由表观学大牛任兵实验室开发的，主要优点体现在通量上，可用于并行分析数百万个单细胞转录组和可访问染色质。 一句话评价 单细胞ATAC-seq和RNA-seq联合分析方法 文章信息 题目：An ultra high-throughput method for single-cell joint analysis of open chromatin and transcriptome 杂志：NAtuRe StRuCtuRAL &amp; MoLeCuLAR BIoLogY 时间：2019，NOVEMBER 链接: www.nature.com/nsmb]]></content>
      <tags>
        <tag>ATACseq</tag>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[玉米赤霉烯酮对猪小肠上皮细胞转录组和染色质可及性的影响]]></title>
    <url>%2F2019%2F12%2F12%2FThu%20Dec%2012%202019%2020%3A50%3A50%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[这篇文章主要想研究非编码RNA与染色质可及性对玉米赤霉烯酮对猪小肠上皮细胞的影响，思路较简单，分析也过于简单，文章也没有得到特定的结论。思路如下图b所示，分析ATAC-seq得到peaks,然后注释peaks的基因，分析RNA-seq得到miRNA,lncRNA，然后预测这些非编码RNA的靶基因，并将非编码RNA的靶基因与peak注释到的基因整合，进行功能注释。 题目：transcriptome and chromatin accessibility in porcine intestinal epithelial cells upon Zearalenone exposure 杂志：Scientific DATA 时间：Dec 3, 2019 链接: https://doi.org/10.1038/s41597-019-0313-1]]></content>
      <tags>
        <tag>ATACseq</tag>
        <tag>文献摘要</tag>
        <tag>lncRNA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[利用深度学习进行宏基因组物种分类]]></title>
    <url>%2F2019%2F11%2F25%2FMon%20Nov%2025%202019%2023%3A53%3A29%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 深度学习在宏基因组分析的物种鉴定中的应用 文章信息 题目：DeepMicrobes: taxonomic classification for metagenomics with deep learning 杂志：BioRxiv 时间：Jul,8, 2019 链接: http://dx.doi.org/10.1101/694851 文章介绍： 物种分类是宏基因组分析中重要的一个环节，虽然有很多相关的工具。但是利用深度学习的框架进行物种鉴定分类的报道还相对较少，作者这里基于recurrent neural network的架构开发了DeepMicrobes用于物种分类研究，与其他工具相比发现DeepMicrobes的假阳性率相对较低。 软件地址：https://github.com/MicrobeLab/DeepMicrobes figure 每日文献摘要：第21篇 2019年11月25日 周一]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
        <tag>deep learning</tag>
        <tag>metagenomics</tag>
        <tag>16s rRNA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lncRNA-chromatin相互作用的全面分析揭示了lncRNA通过结合不同的调控元件发挥功能]]></title>
    <url>%2F2019%2F11%2F24%2FSun%20Nov%2024%202019%2016%3A55%3A43%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[之前分享过哈尔滨医科大学李霞老师实验室开发的lncRNA-chromatin相互作用数据库——LnChrom (http://biocc.hrbmu.edu.cn/LnChrom/index.jsp) 。这次详细解读数据库背后所做的分析，同时总结文章的思路、结论和成果以及对其他研究的启发。 文章信息题目：Comprehensive analysis of lncRNA-chromatin interactions reveals lncRNA functions dependent on binding diverse regulatory elements 杂志：Journal of Biological Chemistry 时间：Sept.4, 2019 链接：http://www.jbc.org/content/294/43/15613 主要内容lncRNA在人类正常生命活动和疾病中扮演者重要的角色，其可以与染色质相互作用，然后招募蛋白质复合物改变染色质状态，进而调控基因表达。然而，lncRNA与染色质相互作用是如何影响并调节生物功能还并不清晰。基于此作者从人类和小鼠数据集中收集了188,647个lncRNA-chromatin相互作用对。他们的结果发现lncRNA在其结合位点展现了不同的表观修饰方式，尤其是在有增强子活动标记的区域。进而对lncRNA的靶基因的功能分析发现lncRNA即可以通过结合启动子调控元件发挥功能，也可以通过结合增强子发挥功能，尤其是在远端调控区域的调控元件。 文章思路数据资源 物种 数据类型 数据量 人 ChIRP-,CHOP-CHART-seq 27 lncRNA-chromatin interaction for 12 lncRNAs ChIP-seq (H3K4me1, H3K4me3, H3K27ac, H3K27me3 and H3K36me3) 52 DNase-Seq 8 鼠 ChIRP-,CHOP-CHART-seq 25 lncRNA-chromatin interaction for 10 lncRNAs ChIP-seq (H3K4me1, H3K4me3, H3K27ac, H3K27me3 and H3K36me3) 42 数据来源： 文献收集（ChIRP-,CHOP-，RAP-, CHART-seq） Chu, C., et al., Genomic maps of long noncoding RNA occupancy reveal principles of RNA-chromatin interactions. Mol Cell, 2011. 44(4): p. 667-78. Simon, M.D., et al., The genomic binding sites of a noncoding RNA. Proc Natl Acad Sci U S A, 2011. 108(51): p. 20497-502. Engreitz, J.M., et al., The Xist lncRNA exploits three-dimensional genome architecture to spread across the X chromosome. Science, 2013.341(6147): p. 1237973. Mondal, T., et al., MEG3 long noncoding RNA regulates the TGF-beta pathway genes through formation of RNA-DNA triplex structures. Nat Commun, 2015. 6: p. 7743. 数据库 补充知识 ChIRP-seq 与CHART-seq技术类似，都是研究nc-RNA结合的基因组位点，以及作用的蛋白质。 参考：https://www.illumina.com/science/sequencing-method-explorer/kits-and-arrays/chirp-seq.html ChIRP, also commonly referred to as ChIRP-seq, is a protocol to detect the locations on the genome where ncRNAs, such as lncRNAs, and their proteins are bound. In this method, samples are first crosslinked and sonicated. Biotinylated tiling oligos are hybridized to the RNAs of interest, and the complexes are captured with streptavidin magnetic beads. After treatment with RNase H, the DNA is extracted and sequenced. Deep sequencing can determine the lncRNA/protein interaction site at single-base resolution. Pros: Identifies binding sites anywhere on the genome Enables discovery of new binding sites Allows selection of specific RNAs of interest Cons: Nonspecific oligonucleotide interactions can lead to misinterpretation of binding sites Chromatin can be disrupted during the preparation stage The sequence of the RNA of interest must be known CHART-seq CHART-seq用于鉴定nc-RNA结合的基因组位点，同时可以鉴定与其作用的蛋白质。 参考Illumina官网：https://www.illumina.com/science/sequencing-method-explorer/kits-and-arrays/chart.html CHART maps genomic binding sites of ncRNAs by isolating and sequencing the DNA regions where the crosslinked RNA-DNA-protein complexes are bound. CHART differs from other crosslinked-complex purification techniques, such as ChIRP, due to the use of biotinylated 24 nt oligonucleotides (C-oligos) that are highly sensitive and unique to the ncRNA of interest. An RNase H mapping assay is used to design the 24 nt sequence of the C-oligos. First, nuclei samples are crosslinked and fragmented. Next, C-oligos are hybridized to the complex and bound to streptavidin beads. The mixture is washed and the complex eluted. The DNA is isolated and sequenced, and the proteins involved in the complex are isolated and analyzed by Western blots. Pros: Maps genomic binding sites of lncRNAs Simultaneously identify proteins associated with the lncRNA complex Cons: Needs large amount of nuclei (1x109 cells) RAP-seq RAP isolates lncRNAs and maps the sequence of their target DNA through a probe-capture mechanism. First, the cells are crosslinked and lysed before DNase I chromatin digestion to 100–300 bp DNA fragments. Biotinylated RNA probes, antisense to the lncRNA, are hybridized and captured with streptavidin. The biotin-RNA probes are 120 nt and are tiled every 15 nt over the span of the lncRNA. The captured complexes are eluted and prepared for sequencing. RNA library preparation is done through RAP-RNA, and DNA library preparation by standard chromatin immuniprecipitation (ChIP). Pros: Genomic mapping of lncRNA targets Possible to sequence RNA and DNA from the purification products Long RNA probe length provides high binding affinity to the target lncRNA1 Minimal amplification steps during RNA sequencing after purification of the lncRNA complex Cons: Requires RNA sequence to be known ChOP-seq Detection of RNA–DNA binding sites in long noncoding RNAs https://doi.org/10.1093/nar/gkz037 鉴定lncRNA结合位点 方法 方法参考文献：West, J.A., et al., The long noncoding RNAs NEAT1 and MALAT1 bind active chromatin sites. Mol Cell, 2014. 55(5): p. 791-802. 文章中认为lncRNA的结合位点即lncRNA-chromatin interaction对个数，方法是参考以上文献，该文献利用CHART-seq技术鉴定lncRNA结合位点以及相互作用的蛋白质。 结果 去除掉缺少“even”和“odd”样本的lncRNA、低富集度和在GENCODE v27中缺乏注释的lncRNA，最终在人类和鼠中分别鉴定到77,031和111,616个lncRNA-chromatin interaction（lncRNA-chromatin interaction可以理解为lncRNA结合位点）。 每个结合位点的大小平均小于1kb,除了SRA (在2kb左右) （图B）。 下图A展示的是人中的lncRNA-chromatin interaction, 横坐标包含l ncRNA和细胞系，图中展示的是11个lncRNA，其中一个lncRNA应该是由于缺少“even”和“odd”样本被过滤了 结合位点的基因组分布特征 方法 基因组分布特征即在启动子、远端等区域的结合，Homer软件注释可以得到该结果，ChIPseeker也可以做类似的分析。 结果 大多lncRNA的结合位点位于其最邻近基因的转录起始位点（TSS）的远端（Distal）区域。该结论在多个研究中都有提及，lncRNA大部分是位于其转录位点的远端区域，与蛋白质相互作用的方式通常是反式作用。 lnCRANs结合位点的保守性 方法 保守性评估采用的是2005年发表的方法——phastCons,这篇文章至今已有3000+的引用，该模型是基于一个二态系统发育隐马尔可夫模型（phylo HMM），phastCons通过最大似然法拟合一个phylo HMM的数值，跨物种校准模型，然后基于该模型预测保守元件 文献：doi: 10.1101/gr.3715005 ； PMID: 16024819 Evolutionarily conserved elements in vertebrate, insect, worm, and yeast genomes. 结果 他们发现人类的lncRNAs结合位点与DHSs（DNase I hypersensitive sites）相比有更高的保守性。 lnCRANs结合位点的motif分析 方法 HOMER 结果 de novo DNA-binding motifs的结果与之前的发现一致，如HOTAIR 和 MEG3结合位点富集在GA嘌呤处。而且发现有些motif可以与lncRNA的序列匹配，表明这些lncRNA可能形成DNA:RNA三螺旋结构。 lncRNA结合位点与表观修饰的关联 方法 genome association tool (GAT) : 该方法是评估两个基因组片段的相关性，如ChIP-seq和RNA-seq的重合的区域是否显著相关。 Motivation: A common question in genomic analysis is whether two sets of genomic intervals overlap significantly. This question arises, for example, when interpreting ChIP-Seq or RNA-Seq data in functional terms. Because genome organization is complex, answering this question is non-trivial. Summary: We present Genomic Association Test (GAT), a tool for estimating the significance of overlap between multiple sets of genomic intervals. GAT implements a null model that the two sets of intervals are placed independently of one another, but allows each set’s density to depend on external variables, for example, isochore structure or chromosome identity. GAT estimates statistical significance based on simulation and controls for multiple tests using the false discovery rate. Availability: GAT’s source code, documentation and tutorials are available at http://code.google.com/p/genomic-association-tester. 选择了5种组蛋白修饰数据类型:H3K4me3, H3K4me1,H3K27me3, H3K36me3, H3K27ac promotor: high H3K4me3 enchancer: high H3K4me1and low H3K4me3 repressed: H3K27me3 transcription elongation : high H3K36me3 quiescent: low H3K36me3 结果 只有lncRNA的数据同时包含相对应的细胞系至少两个表观修饰数据的lncRNA最后被保留用于这部分的分析。人类和鼠分别是9个和8个lncRNA。lncRNA结合位点与染色质修饰的关联多种多样，所有的lncRNA在H3K4me1 和 H3K27ac mark区域显著富集。 为了进一步探究lncRNA结合位点的表观修饰模式，作者观察了lncRNA结合位点2kb以内的染色质可及性。发现lncRNA在其结合位点展现不同的表观修饰模式，如可以结合在启动子、增强子、抑制子等。 lncRNA结合区域与其潜在的靶基因 方法 如果一个基因的TSS上下游1kb与lncRNA结合位点区域重合，就定义为该基因为此lncRNA的promoter 靶基因； 当lncRNA结合位点与远端（distal）调控元件作用（&gt;2kb to nearest TSSs）时，同时结合 来自4D genome database 的long-range 染色质相互作用数据，鉴定到lncRNA的distal 靶基因 结果 不同的lncRNA靶基因数目差异很大，平均每个lncRNA的蛋白编码靶基因为3100个。其中LncRNA 7SK有8051个蛋白编码靶基因（最多）。同时，他们观察到一些lncRNA的promoter和distal 靶基因有显著的重合，表明lncRNA与启动子和远端调控元件结合靶向于相同的基因。 lncRNA结合区域与其潜在的靶基因的功能 方法 对每个lncRNA的靶基因进行GO/KEGG功能注释 clusterProfiler 结果 功能注释结果发现这些lncRNA都能富集到其已知的功能，如cancer-related lncRNA NEAT1 富集到细胞分化、细胞周期和细胞死亡。 为了进一步确定lncRNA是如何参与通路的调控，他们将lncRNA的靶基因与富集通路匹配对应。发现lncRNA既可以结合启动子调控元件发挥功能，也可以结合远端调控元件发挥功能。 lncRNA-target genes在人类肿瘤预后诊断中的应用 方法 生存分析: Kaplan-Meier method 结果 从TCGA中收集了3肿瘤类型1330个癌症病人的基因表达数据（包括蛋白编码和lncRNA)，根据lncRNA表达的中位数，将病人分为high-risk group和low-risk group.]]></content>
      <tags>
        <tag>lncRNA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[多组学数据联合展示、且可以交互的基因组浏览器——trackViewer]]></title>
    <url>%2F2019%2F11%2F23%2FSat%20Nov%2023%202019%2017%3A53%3A15%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[常见的可视化基因组track的Bioconductor package有rtracklayer 和 Gviz。rtracklayer提供了交互的基因组浏览器和相关tracks的注释；Gviz可以用于tracks覆盖度和注释的可视化。trackViewer是一个更轻量级的工具，且可以产生交互的可视化结果。可用于RNA-seq,ChIP-seq/ATAC-seq,miRNA-seq,DNA-seq,methylation等各种NGS组学数据的覆盖度和注释tracks的可视化展示，而且可以绘制发表级的棒棒糖图和蒲公英图。 先展示下极好看可视化效果 使用方法可以参考文档： 详细文档：http://127.0.0.1:31580/library/trackViewer/doc/trackViewer.html Web app: https://github.com/jianhong/trackViewer.documentation/tree/master/trackViewerShinyApp]]></content>
      <tags>
        <tag>ATACseq</tag>
        <tag>R</tag>
        <tag>visualization</tag>
        <tag>ChIPseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[深度卷积神经网络分析低质量的ATAC-seq数据]]></title>
    <url>%2F2019%2F11%2F23%2FSat%20Nov%2023%202019%2016%3A41%3A46%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 一个基于深度卷积神经网络分析低覆盖度和低质量ATAC-seq的工具 文章信息 题目：AtacWorks: A deep convolutional neural network toolkit for epigenomics 杂志：bioRxiv 时间：Nov. 4, 2019 链接: doi: http://dx.doi.org/10.1101/829481. 文章介绍： 这篇文章介绍了一个基于深度卷积神经网络的方法解析低覆盖度或低质量ATAC-seq数据的工具包——AtacWorks 。使用的架构是Resnet (residual neural network) 。训练模型的数据来自4个血细胞类型，之后利用得到的模型分析HSC，鉴定了差异调控元件、转录因子印迹。 工具介绍：https://github.com/clara-genomics/AtacWorks 安装方法： 流程： figure 碎碎念 还看不懂深度学习的算法，一些基本概念都不理解 每日文献摘要：第20篇 2019年11月23日 周六]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>software</tag>
        <tag>deep learning</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scATAC-seq与scRNA-seq的整合分析系统——MAESTRO]]></title>
    <url>%2F2019%2F11%2F23%2FSat%20Nov%2023%202019%2013%3A25%3A44%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[单细胞技术是目前比较火热的一个领域，从单细胞转录组、基因组扩展到单细胞表观组，如scATAC-seq, scHiC, scmethylation等，促使着相关的分析工具也不断涌出。单细胞领域相关工具的开发大致有两个方向：一是从本质上如算法、统计学方法入手开发新的分析工具；一种是整合多种基础工具，开发出具有功能全面，易用等特征的工具。 MAESTRO(Model-based AnalysEs of Single-cell Transcriptome and RegulOme)是刘小乐实验室基于snakemake新开发的用于分析scRNA-seq和scATAC-seq的工具。MAESTRO主要是打包了一些工具和软件包，目前可以实现的功能包括：对scRNA-seq和scATAC-seq数据的比对、质量控制、细胞过滤、标准化、非监督聚类、差异分析、peak calling、细胞类型注释和转录调控分析。支持 Smart-seq2, 10x-genomics, Drop-seq, SPLiT-seq for scRNA-seq protocols; microfudics-based, 10x-genomics and sci-ATAC-seq for scATAC-seq protocols. 提供的有docker镜像，安装可以参考软件介绍：https://github.com/liulab-dfci/MAESTRO/ 1234567wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.shbash Miniconda3-latest-Linux-x86_64.shconda config --add channels defaultsconda config --add channels biocondaconda config --add channels conda-forgeconda create -n MAESTRO maestro -c liulab-dfci Installing the MAESTRO R package 123R&gt; library(devtools)&gt; install_github("liulab-dfci/MAESTRO") 另外依赖的cell ranger, RABIT/LISA等软件需要自行单独安装。 每种类型的数据的详细分析教程可以在原工具介绍网页点击下面每幅图查看 PS: 目前还没有看到相关文章发表]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>software</tag>
        <tag>single cell</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[叶酸与高血压、脑卒中精准防治的研究]]></title>
    <url>%2F2019%2F11%2F22%2FFri%20Nov%2022%202019%2012%3A37%3A23%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[昨天组会，同学分享了北京大学第一人民医院霍勇老师关于脑卒中精准防治的研究。 脑卒中想必大家都不陌生，周围有的时候会听到某人因为脑卒中突然离世。给我的感觉就是发病急，没有特别明显的发病前症状，但是一旦发病了，往往就是不可救治。 有研究也报道脑卒中是中国人的第一位死因，发病率居世界首位。脑卒中的危险因素中高血压、膳食和年龄占权重较大。霍老师的研究发现中国高血压患者75%为H型高血压（即伴有HCY升高的高血压），而低等叶酸摄入显著增加高血压患者脑卒中的风险。进而发现叶酸缺乏与MTHFR C677T位点的多态性有关，MTHFR基因是叶酸代谢中的一个关键酶，C677T位点的多态性存在3种基因型：CC型（野生型）、CT型（杂合突变型）和TT型（纯合突变型）。 叶酸人体是无法自己合成的，主要从食物中获取。叶酸缺乏有两种类型，一种是膳食中摄入量不足，通过补充可以轻易恢复正常水平；另一种是MTHFR基因的突变，导致叶酸利用率低，即使摄入得很多，但是利用的却很少。而叶酸代谢异常既而可引起高同型半胱氨酸血症，血液异常凝固等，从而引起脑卒中、冠心病、血栓。而且易造成新生儿缺陷等疾病。 根据这一发现，他们提出了高血压患者叶酸治疗的研究（CSPPT），对20,702例45-75岁无心脑血管疾病的高血压患者随访4.5年，MTHFR的3种基因型每都类分为两组，分别用依那普利和依那普利叶酸治疗，他们最后的发现是与单纯使用依那普利降压比较，依那普利叶酸片（依叶）显著降低21%脑卒中风险 这个治疗措施在山东荣成地区已经成为转化应用示范基地，据国家卫计委估计如果CSPPT（即高血压患者叶酸治疗的研究）研究成果广泛应用，每年可预防111万（30%）脑卒中发生。 总结一下就是叶酸缺乏可能会引起脑卒中、高血压、新生儿缺陷等风险的增加 听完之后，想起了自己的基因检测报告好像有叶酸营养需求的报告，打开一看 中招了，而且基因型还是AA 看来以后要多补充叶酸了 文献： 2015，JAMA, Efficacy of folic acid therapy in primary prevention of stroke among adults with hypertension in China: the CSPPT randomized clinical trial.]]></content>
      <tags>
        <tag>chronic disease</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[宏基因组物种鉴定工具]]></title>
    <url>%2F2019%2F11%2F22%2FFri%20Nov%2022%202019%2010%3A13%3A43%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 宏基因组物种鉴定工具集锦 文章信息 题目：Benchmarking Metagenomics Tools for Taxonomic Classification 杂志：Cell 时间：August 8,2019 链接: https://doi.org/10.1016/j.cell.2019.07.010 文章介绍： 鉴定物种分类是宏基因组分析的一个必要和基础步骤，相关工具也是层出不穷，如何评价物种分类工具的性能，主要从鉴定的准确性、速度和所需要的计算资源这几方面考虑。 这篇文章针对20种常见的物种鉴定工具进行评估，并描述了如何评价工具性能。 下图展示了宏基因组的复杂的样本到物种鉴定和丰度计算的过程 figure 参考数据库宏基因组的物种鉴定依赖于数据库，常见的数据库有RefSeq, blast nt和nr，以及16S rRNA特有的数据库SILVA。 评价物种分类工具性能的方法召回率（Recall）和准精确度（Precision）是宏基因组物种鉴定中重要的两个度量概念，这两个概念也是统计学中经常见到的。 其中精度是检索出相关文档数与检索出的文档总数的比率，衡量的是检索系统的查准率；召回率是指检索出的相关文档数和文档库中所有的相关文档数的比率，衡量的是检索系统的查全率。 召回率 = 提取出的正确信息条数 / 样本中的信息条数 精确度= 提取出的正确信息条数 / 提取出的信息条数 两者取值在0和1之间，数值越接近1，查准率或查全率就越高。 F值 = 正确率 召回率 2 / (正确率 + 召回率) （F 值即为正确率和召回率的调和平均值） F值是Precision和Recall加权调和平均 AUPR:是指precision和recal曲线下面的面积，也是一个综合考虑P-R两者来评估结果准确性的一个度量值。 L2 distance:是为了评估丰度准确性的参数值，通过计算在给定的分类水平上，每个已识别分类单元的ground-truth丰度和标准丰度计数之间的成对距离。 ###物种分类工具和其性能 这里他们比较了20种宏基因组物种鉴定工具，利用相同的数据库 分别比较了他们的precision, recall, F1, 速度和其他值。包括DAN-DNA鉴定，DNA-protein鉴定，和基于marker的鉴定方法。 AUPR值如下：值越接近1越好 L2 distance: 值越小越好 运行时间 碎碎念 没有做过宏基因组分析实际项目，看着这些软件名字完全没有感觉，也记不住，后续研究若用到的话可以参考这里做选择。 每日文献摘要：第19篇 2019年11月22日 周五]]></content>
      <tags>
        <tag>software</tag>
        <tag>metagenomics</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[非编码RNA在肿瘤中扮演的角色]]></title>
    <url>%2F2019%2F11%2F17%2FSun%20Nov%2017%202019%2001%3A03%3A18%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 关于非编码RNA在肿瘤中作用的综述 文章信息 题目：The Role of Non-coding RNAs in Oncology 杂志：Cell 时间：November 14, 2019 链接: https://doi.org/10.1016/j.cell.2019.10.017 文章介绍： 非编码RNA作为致癌因子或抑癌因子的总结 （且有体内实验验证） 不同类型的致癌ncRNAs和癌症发生的机制 不同类型的抑癌ncRNAs和阻碍癌症发展的通路 非编码RNA作为肿瘤标志物 每日文献摘要：第18篇 2019年11月17日 周日]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
        <tag>lncRNA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[准确聆听、有效沟通]]></title>
    <url>%2F2019%2F11%2F16%2FSat%20Nov%2016%202019%2023%3A59%3A41%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[有效沟通始于准确聆听 以前觉得自己还是个好的聆听者，当与别人交流时会很认真的听，然后作出回应，但今天发现我并没有做到一个好的聆听者，也没有达到有效的沟通。往往没有了解清晰的状况、只是为了回应而回应，随便地给出评价或建议；或者无论对方说什么，都会联想到自己，开始说自己的事说个没完，陷入了典型的自传式回应沟通。 A: “我这个周末要加班……” B: “辞了辞了！对自己这么苛刻干嘛？” A: “我妈妈不同意我去其他城市发展…..” B:”我爸妈对我没有要求，无论我做什么都特别支持，而且我爸妈…..(ba la ba la说自己的事情没有完)” 自传式回应常见的现象有这样几种： 价值判断–表示肯定或否定 如，你这样做是不对的哦；你肯定小时候怎么样； 追根究底–依据自己的立场，探究别人的隐私 这个貌似也经常触碰，问的有点多，忽略了别人的隐私 好为人师–以个人生活经验指导他人 经常会和别人说，我曾经怎么怎么的，你应该怎样做等 自以为是–根据自己的行为动机判断别人的 如何做到准确聆听，一种做法是移情式聆听，即代入倾诉者的角色，感同深受地了解对方此番谈话的真正目的，并掌握准确清晰的事实，再通过对对方情感的客观反馈，来实现有效的沟通。 记住，说出对方的感受，而不要判断。 更要切记，让别人说出感受，而不是陷入自传式的回应]]></content>
      <categories>
        <category>杂想</category>
      </categories>
      <tags>
        <tag>胡思</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[lncRNA-染色质相互作用数据库]]></title>
    <url>%2F2019%2F11%2F16%2FSat%20Nov%2016%202019%2017%3A07%3A49%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 lncRNA和染色质相互作用数据库 文章信息 题目：LnChrom: a resource of experimentally validated lncRNA–chromatin interactions in human and mouse 杂志：Database 时间：23 March 2018 链接: doi: 10.1093/database/bay039 figure 文章介绍： lncRNA作用机制多样，可以与DNA、RNA和蛋白质相互作用，也是参与染色质调控的重要组成部分。许多lncRNA通过招募染色质修饰因子调控染色质状态，进而影响基因表达过程。作者对已经过实验验证的lncRNA-chromatin相互作用的数据资源进行整理，开发了lnChrom数据库。该数据库目前包括人类和鼠共382743个lncRNA-chromatin相互作用对，另外还收集了每个作用对的染色质修饰因子、表观标记特征、靶基因以及与疾病的关联信息。 LnChrom提供了友好的交互界面，可以通过输入lncRNA ID或靶基因快速检索， 也可以通过选择物种、染色质修饰类型、染色质相关因子，以及基因名字进行高级检索 ，同时可以通过输入感兴趣的染色质区域进行region检索。搜索结果以一个概览的表格和相互作用网络图展示。用户点击某一感兴趣的相互作用对，可以了解到更多细节结果，包括详细的注释信息、Genome Browser，TF Co-occupancy和Cancer Exploration。 网站：http://biocc.hrbmu.edu.cn/LnChrom/ 每日文献摘要：第17篇 2019年11月16日 周六]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
        <tag>lncRNA</tag>
        <tag>database</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[微生物组学研究的相关概念]]></title>
    <url>%2F2019%2F11%2F10%2FSun%20Nov%2010%202019%2023%3A17%3A58%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[这篇文章主要对微生物组学研究中常出现的概念进行整理， 资料摘抄原文如下： 细菌16s rDNA微生物多样性研究中可变区的选择 16S 基础知识、分析工具和分析流程详解 16S/18S/ITS 扩增子测序 微生物组学数据分析工具综述 | 16S+宏基因组＋宏病毒组＋宏转录组–转载 微生物组学的常见分类建立在高通量测序基础上的微生物群落研究，当前主要有三大类： 基于16S/18S/ITS等扩增子做物种分类的Metataxanomics、 鸟枪法打断全基因组DNA序列的Metagenomics 和基于mRNA信息的宏转录组方法Meta-transcriptomics。 ###16S/18S/ITS扩增子测序 16S rDNA是细菌分类学研究中最常用的“分子钟”，其序列包含9个可变区（Variable region）和10个保守区（constant region）。可变区因细菌而异，且变异程度与细菌的系统发育密切相关。通过检测16S rDNA的序列变异和丰度，可以了解环境样品中群落多样性信息。基于16S rDNA的分析在微生物分类鉴定、微生态研究等方面起到重要作用。 16S rDNA结构：16s rRNA基因的序列（约1500bp）有10个保守区和9个高变区（v1-v9：长度分布范围约30~100bp）之分；保守区为所有细菌共有，细菌间无差别，能反映生物物种的亲缘关系，可变区具有属或种的特异性，序列则随菌间的亲缘关系不同而有一定的差异，所以能揭示生物物种的特征核酸序列，被认为是最适于细菌系统发育和分类鉴定的指标。根据保守区设计引物位点，扩增可变区获得的序列可以用于菌种鉴定。一种快速、廉价的菌种鉴定方法。 16s rRNA基因可变区考虑因素： 16s rRNA基因数据库 SILVA; GreenGenes, RDP, EzTaxon-e 几个概念： 核糖体：Ribosome，由 RNA(rRNA）和蛋白质 组成，配合 tRNA 来翻译 mRNA。核糖体按沉降系数来分类，S就是沉降系数，原核70S，真核80S。我们一般研究微生物，70S，由50S和30S两个亚基组成。再细分为 5S、16S、23S，我们的 16S 就是指核糖体的亚基的一个组分，16S rRNA。（记住，这是原核生物核糖体的一个组分） 16S rRNA：这并不是我们的研究对象，因为我们测序的不是它，而是它对应在DNA双链上的基因序列， 16S rDNA。可以这样理解，我们所说的16S 就是指 16S rDNA。 分子钟：即氨基酸在单位时间以同样的速度进行置换。16S 的进化具有良好的时钟性质，在结构与功能上具有高度的保守性，在大多数原核生物中rDNA都具有多个拷贝，5S、16S、23S rDNA的拷贝数相同。16S rDNA由于大小适中，约1.5Kb左右，既能体现不同菌属之间的差异，又能利用测序技术较容易地得到其序列，故被细菌学家和分类学家接受。（来源百度） OTU：即Operational Taxonomic Units的缩写（千万表手滑写成OUT，否则就OUT了），在系统发生学或群体遗传学研究中，为了便于进行分析，人为给某一个分类单元（品系，属，种、分组等）设置的同一标志。理论上一个OTU代表一个微生物物种。 通过测序获得的大量reads，如何才能转变为我们需要的物种信息呢？首先需要对这些reads进行归类（cluster），通常在97%的相似水平划分为不同的OTU，将OTU代表序列与相应的微生物数据库比对（Silva、RDP、Greengene等），得到每个样本所含的物种信息，进而进行后续生物信息统计分析。 Alpha多样性：用于度量群落生态单样本的物种多样性，是反映丰富度和均匀度的综合指标。 菌群丰富度（Community richness）指数有：Chao、Ace，Chao或Ace指数越大，说明菌群丰富度越高。 菌群多样性（Community diversity）指数有：Shannon、Simpson，Shannon值越大，说明群落多样性越高；Simpson指数值越大，说明菌群多样性越低。 根据各样本生成的OTU，对样本序列进行随机取样，以取出的序列数及这些序列所能代表的OTU数构建曲线，计算样本的Alpha多样性。 Beta-diversity： Beta多样性用于不同生态系统之间多样性的比较，利用各样本序列间的进化关系及丰度信息来计算样本间距离，反映样本（组）间是否具有显著的微生物群落差异。目前应用比较多的是PCA、PCoA、NMDS分析等。由于微生物多样性研究通常会涉及到大样本数量的样本，因此通过Beta-diversity分析可以直观地反映样本组间的差异情况。距离越远，微生物群落差异越大，即相似性越高。 LEfSeLEfSe分析即LDA Effect Size分析，多用于多个分组（≧2）之间的比较，或者进行亚组比较分析，进而找到组间在丰度上有显著差异的物种（biomaker）。 基本过程是首先在多组样本中采用非参数因子Kruskal-Wallis秩和检验检测不同分组间丰度差异显著的物种；然后基于获得的显著差异物种，利用成组的Wilcoxon秩和检验进行组间差异分析；最后采用线性判别分析（LDA）对数据进行降维并评估差异显著的物种的影响力大小（即LDA score）。 18S rDNA或ITS（Internal Transcribed Spacer）被广泛应用在真菌分类鉴定中。18S rDNA在系统发育研究中较适用于种级以上阶元的分类；ITS属于中度保守区域，利用它可研究种及种以下的分类阶元。 局限性 16S虽然是一种相对快速和经济适用的方法，但是PCR导致了偏好的产生，这就降低了注释准确度。此外，由于原核、真核生物的“分类标签”完全不同，即使细菌和古菌的16S也相去甚远，以进化快著称的病毒更难以捕获。 常规分析流程 下机数据经过数据过滤，滤除低质量的reads，剩余高质量的Clean data方可用于后期分析；通过reads之间的Overlap关系将reads拼接成Tags；在给定的相似度下将Tags聚成OTU，然后通过OTU与数据库比对，对OTU进行物种注释；基于OTU和物种注释结果进行样品物种复杂度分析以及组间物种差异分析。 宏基因组宏基因组有效避免了扩增偏差，由于是直接打断，理论上不限制物种（细菌、真菌、古菌、真核生物等，事实上当前宏基因组测序多还是以细菌为主），可能组装获得新基因乃至新物种信息，但根据取样情况可能存在少量或大量的宿主污染，因需组装，数据量要求大，成本贵、周期长。 宏基因组经典流程：环境微生物样本–Total DNA提取–文库构建–上机测序（经典短读长: illumina系列；长读长选择: PB, ONT）–数据质控（去除低质量和接头等，去除宿主基因组等干扰信息）–宏基因组组装–Contig Binning–基因组重建–分类注释（可基于reads、contig、bins、还原出来的基因组做物种注释）–其他下游分析。 宏转录组宏转录组的好处是，跳出了DNA层面的束缚，可以获得实时活跃的、真正对群落有贡献的基因和通路，然而mRNA不如DNA稳定,此外多纯化和扩增的步骤也可能引入错误。 宏转录组也迎来了自己的专属软件–IMSA+A ( https://github.com/JeremyCoxBMI/IMSA-A )。IMSA+A在17年1月发表于Microbiome，是一种可应用于任意读长宏转录组学数据、可高效在同一份样品中鉴定出细菌、真菌、病毒的准确的分类分析的方法。]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>metagenomics</tag>
        <tag>16s rRNA</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[三岔路口]]></title>
    <url>%2F2019%2F11%2F06%2FWed%20Nov%2006%202019%2023%3A51%3A17%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[7月初毕业，到现在4个月过去了，终于在昨天正式入职，开始进入工作实习期。昨天配置了电脑，今天总管开始分配任务，虽然是新的领域，新的方法，之前了解的并不多，但是很多知识和方法论都是相通的，估计很快就能完全入手。 之前在即将毕业的一年时间里我一直在纠结是读博、工作还是创业，纠结的原因很多，最根本的原因是对自己不了解，不知道自己适合什么，也没有特别明确工作倾向，只是希望工作中可以经常接触新的东西，可以不断学习。纠结的再多，不如先去尝试。毕业先去了广州，朋友想让我过去做些创业的东西，结果毕业过去的时候，离项目资金申请剩余的时间很少，由于准备不足，申请直接在第一轮被刷下，项目也因此被搁置。这段其实称不上创业的经历，给我印象比较深的是创业最重要的是想法和团队。创业不是一个人的事，一定要有一个敢想敢做的团队。 目前选择了工作，虽然工作的方向和我最初想的领域不一样（最初想工作的领域是目前比较热的技术领域），但是觉得也挺有意思，是有战略发展潜力的一个方向。 不论选择哪条路，都认真、负责的对待。路上的风景也是靠自己创造的。 这里很感谢当初迷茫的时候，师兄师姐给的建议，无论哪条路，选择适合自己的路才是最好的方向。 师姐，你觉得在公司和在科研单位有什么不同吗？读博能学到的东西更多，还是工作呢？我现在很矛盾，不确定自己适合什么方向，你能有空的时候大概说说你的感受吗 一师姐的回答 我认为在公司和科研单位有很多不一样的地方。从工作内容上说，在科研单位主要是围绕课题，而且是开放性课题，包括申请课题、做课题、写总结性的报告公文之类的，所有的事情都是由计划的、相对弹性的；在公司，所有的事情要围绕公司的产品，无论是软件还是科研服务，都是以销售为导向的，所以开放性的研究不会有很多，即使是研发部门，也都是以应用为前提，所以基本上在公司，除了主管级以上会涉及到不同程度的前沿调研探索，如果是新入职的，最看重的还是实操技能，能够准确地完成领导布置的任务（生信相关的有软件开发维护，流程搭建等等）才是最重要的，如果做到高级领导，就需要有前瞻性的想法了，引导队伍向那个方向前进。在公司，一开始从基层做起的话，工作是具体的、指令型的，没有弹性，跟着项目走，项目急就必须很快反馈。 至于你说的哪个能学到更多的东西，我觉得这个没有办法去直接比较。去公司和读博，长远来看，是两条不同的路。如果你准备走科研这条道路，肯定是去读博，之后再出国读博后，是最直接的路径。如果准备进入公司打拼，走生信分析师-生信主管-总监-更高级管理层这条路，从目前的形势看，名校硕士在晋升方面还是没有太大的阻碍的，应该会比较顺利，不会像做科研这条路，硕士有很大的阻碍。读书学到的东西和工作学到的是不一样的，做科研相对单纯些，但是也寂寞些，在公司的话就复杂多了，但是也有更多的发展方向。最终还是看你个人喜欢和选择。至于自己适合哪个方向，你可以问问最了解你的人和自己，通常周围的人会更能看清楚你的能力，自己最清楚自己内心所想。 另一师姐的看法： 我自己接触的也不多，只能说说我目前的比较局限的看法。 先说方向，如果打算转行，比如去做金融，高中教师，或者房地产等等，硕士毕业去应届去找相应工作就行。 如果还是做现在的行业，我觉得公司和科研单位最大的不同，大概是公司更计较短期产粗，而做科研，是看长期产出的。科研单位是长时间比较深入的研究一个课题，发paper，遇到好点的老板可能就插科打诨，工作强度稍小，比较适合顾家，而遇到科研氛围比较浓烈的组，也要熬夜加班，拼一拼看能不能拼个职称，做个副研究员，如果选择科研这条路，博士学位非常重要。而公司，短期项目一个接着一个，一般不会给1年时间做一个项目，可能1,2个月就结束了，讲究项目成果，节奏稍微快，除非大公司，要不绝不可能养老的，加班也是常事，但博士学位相对科研来说，用工作经验也可以弥补。 还有一个比较现实的问题，科研单位的副研老师们，出来应该都比所里挣得多，但研究所里工作和在公司工作，毕竟在其他的待遇上面也有些许差别，类比公务员和公司工作，公积金等等养家糊口的部分也有差别。 所以还是看看你觉得自己更适合哪个更需要哪个 另一师兄的看法 我：师兄，你还想去国外读博吗 师兄：准备着吧,读个博士用处还是很大得 我：为什么呢？是将来想做科研吗？ 师兄：不是, 即使不做科研，这行业对学历也是有要求得, 转行得话就无所谓了 我：你有想着创业吗 师兄：创业也想过啊，不过挺难的, 还是需要先积累一下经验 我：如果有觉得合适的合伙人和团队拉你入伙呢，但是对自己的评价就如你所说，没有一点经验，也不确定自己是否适合，你会考虑吗 师兄：看团队构成吧,不能都没有经验,如果没有什么顾虑的话，创业也是不错的选择，对自己的磨砺很大, 我：顾虑倒是没有，一没有钱，投入的可能是精力和时间，我担心的是怕我做不好，还有就是我可能有一个不错读博的机会，我不知道这次放弃了，之后还有没有 师兄：有读博的机会当然选择读博了,要是感觉科研不是自己喜欢的那就选择创业,还是要看你更想过什么样的生活, 科研算是比较稳定，但就是累 我：我可能不适合科研， 师兄：下定决心的话可以去创业,创业团队里不是只需要研发人员, 职位有很多方向, 找一下自己适合做什么]]></content>
      <categories>
        <category>杂想</category>
      </categories>
      <tags>
        <tag>胡思</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[追踪非小细胞肺癌的进化]]></title>
    <url>%2F2019%2F11%2F05%2FTue%20Nov%2005%202019%2020%3A27%3A02%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[小时候觉得癌症这个词离自己很远很远，知道它很可怕，但实际上并不知道它具体是什么，只天真的觉得它永远也不会出现在我的身边。 高三时大奶从被检出肝癌晚期到去世不到两周，她在去世的前两天都不是特别清楚自己的病情，直到去世的前一天病情的加重，她才明白。 从高三到硕士毕业，7年的时间，大姑和婶婶接连也因为癌症去世。而爷爷今天也被检出贲门癌。爷爷是一个闲不住的人，虽然80多岁了，种地比我们家都多，大概是从4月份的时候开始吃东西容易打嗝，以前他每次从地里干完活回家总要吃两个馒头，现在基本吃不了馒头，只能吃些面条和粥。家里人一直劝他去医院检查，他总是不愿意去，最近才被说服去医院检查，却没想道是癌症。 真的很害怕，以前觉得不会出现在身边的癌症，却不断地夺走亲人的生命。我虽然是研究生命科学的，经常关注癌症相关方面的研究，但是我还是不知道为什么现在的癌症越来越多，我经常怀疑我每天的研究有什么意义，在面对真正的癌症时有什么帮助，似乎大多时候我们依然无能为力！ 但是，没有这些基础研究的推动，临床上治疗又怎么能提升？ 一句话评价 用尽量简短的一句话说清文章亮点或者你的推荐理由。越短越好 文章信息 题目：Tracking the Evolution of Non–Small-Cell Lung Cancer 杂志：The new england journal of medicine 时间：June 1, 2017 链接: https://www.nejm.org/doi/full/10.1056/NEJMoa1616288 figure 文章介绍： BACKGROUND Among patients with non–small-cell lung cancer (NSCLC), data on intratumor heterogeneity and cancer genome evolution have been limited to small retrospective cohorts. We wanted to prospectively investigate intratumor heterogeneity in relation to clinical outcome and to determine the clonal nature of driver events and evolutionary processes in early-stage NSCLC. METHODS In this prospective cohort study, we performed multiregion whole-exome sequencing on 100 early-stage NSCLC tumors that had been resected before systemic therapy. We sequenced and analyzed 327 tumor regions to define evolutionary histories, obtain a census of clonal and subclonal events, and assess the relationship between intratumor heterogeneity and recurrence-free survival. RESULTS We observed widespread intratumor heterogeneity for both somatic copy-number altera- tions and mutations. Driver mutations in EGFR, MET, BRAF, and TP53 were almost always clonal. However, heterogeneous driver alterations that occurred later in evolution were found in more than 75% of the tumors and were common in PIK3CA and NF1 and in genes that are involved in chromatin modification and DNA damage response and repair. Genome doubling and ongoing dynamic chromosomal instability were associated with intratumor heterogeneity and resulted in parallel evolution of driver somatic copy-number alterations, including amplifications in CDK4, FOXA1, and BCL11A. Elevated copy-number heterogeneity was associated with an increased risk of recurrence or death (hazard ratio, 4.9; P=4.4×10−4), which remained significant in multivariate analysis. CONCLUSIONS Intratumor heterogeneity mediated through chromosome instability was associated with an increased risk of recurrence or death, a finding that supports the potential value of chromosome instability as a prognostic predictor. (Funded by Cancer Research UK and others; TRACERx ClinicalTrials.gov number, NCT01888601.) 每日文献摘要：第17篇 2019年11月05日 周二 今天没时间看了，改天再仔细看]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
        <tag>tumor evolution</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[抗微生物耐药性(Anti-microbial Resistance,AMR)]]></title>
    <url>%2F2019%2F11%2F05%2FTue%20Nov%2005%202019%2012%3A55%3A19%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 一篇研究抗微生物药物耐药性的测序方法和资源的超全综述 文章信息 题目：Sequencing-based methods and resources to study antimicrobial resistance 杂志：Nature Review Genetics 时间：18 March 2019 链接: https://doi.org/10.1038/s41576-019-0108-4 figure 文章介绍： 抗微生物药物耐药性(antimicrobial resistance)指微生物（如细菌、病毒和某些寄生虫）阻止抗微生物药物（如抗生素、抗病毒药物和抗疟药物）对其产生作用的能力，致使标准治疗方法失去效力，感染持续存在并可能传播给他人。 参考：https://www.who.int/antimicrobial-resistance/zh/ 日常生活中我们可能大多听说过抗生素耐药性，由于抗生素的过度使用或其他原因，导致细菌对用以治疗细菌感染（如尿道感染、肺炎、血流感染）的抗生素发生反应并改变，使治疗失去效果。 抗微生物药物耐药性是一个含义更为广泛的术语，包括对治疗由寄生虫（如疟疾或蠕虫）、病毒（如艾滋病毒）及真菌（如念珠菌）等其它微生物引起的感染的药物耐药。 抗微生物耐药性已经成为影响各个国家生命健康的重要隐患之一。2019年4月29日，联合国、国际机构和有关专家发布了联合行动，防止可能出现的灾难性耐药危机。其中报告中警告说，如果不采取行动，到2050年，耐药性疾病每年可能导致1000万人死亡，对经济造成的灾难性损失将堪比2008-2009年全球金融危机。到2030年，抗微生物药物耐药性问题可能会使多达2400万人陷入极端贫困。 这篇综述发表于2019年3月的Nature Review Genetics，文中对抗微生物耐药性的监测和鉴定方法做了详尽的概括，包括传统的基于培养的易感性监测、基于测序的监测、以及目前具有前景的深度学习的方法。对基于测序的方法还对相关的工具和数据库也做了详尽的总结。最后对每种方法的优缺点做了讨论，并对未来发展方向做了展望。 碎碎念 做相关研究的，这篇综述绝对值得细读！不做相关研究的也可以根据这篇综述简单了解该领域。 每日文献摘要：第16篇 2019年11月04日 周日]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
        <tag>AMR</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[利用深度学习从宏基因组数据中预测抗生素抗性基因——DeepARG]]></title>
    <url>%2F2019%2F11%2F03%2FSun%20Nov%2003%202019%2017%3A37%3A46%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 利用深度学习从宏基因组数据中预测抗生素抗性基因 文章信息 题目：DeepARG: a deep learning approach for predicting antibiotic resistance genes from metagenomic data 杂志：Microbiome 时间：2018 链接: DOI： 10.1186/s40168-018-0401-z figure 文章介绍： 随着抗生素耐药率的不断上升，人类面临着需要扩大和全面的全球监测，尤其需要的是改进监测环境介质（如废水、农业废弃物、食品和水）的方法，以确定新的抗生素抗性基因（antibiotic resistance genes (ARGs）的潜在来源、基因交换的热点以及ARGs的传播和人类接触的途径。二代测序现在能够直接访问和剖析总宏基因组DNA，其中ARGs通常基于对现有数据库的序列搜索的“best hits”来识别或预测。但是，这种方法产生了很高的假阴性率。为了解决这些限制，作者在这里提出一种深度学习方法，使用所有已知的ARGs类别创建的不同矩阵。分别针对短读长序列和全基因长度序列构建了两种深度学习模型：DeepARG-SS 和DeepARG-LS。 对30个抗生素耐药类别的深度学习模型的评价表明，DeepARG模型可以同时预测高精度的ARGs（&gt;0.97）和召回率（&gt;0.90）。与典型的best hits方法相比，该模型显示出一个优势，产生的假阴性率始终较低，因此整体召回率较高（&gt;0.9）。随着越来越多的数据可用于表示ARGs类别，由于底层神经网络的性质，DeepARG模型的性能有望进一步提高。他们最新开发的ARG数据库DeepARG-DB包含了高度可信的预测的ARGs和广泛的手动检查，极大地扩展了当前的ARG存储库。 DeepARG的模型和数据库网址： http://bench.cs.vt.edu/deeparg. 碎碎念 各个领域都开始探索使用深度学习的方法解决问题了。深度学习、抗生素抗性、宏基因组三个热点方向，但是相关文章好像并不多。 每日文献摘要：第15篇 2019年11月03日 周日]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
        <tag>deep learning</tag>
        <tag>AMR</tag>
        <tag>metagenomics</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scATACseq分析方法评估]]></title>
    <url>%2F2019%2F11%2F02%2FSat%20Nov%2002%202019%2021%3A38%3A50%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 scATAC-seq分析方法评估 文章信息 题目：Assessment of computational methods for the analysis of single-cell ATAC-seq data 杂志：bioRxiv 时间：Aug.18,2019 链接: DOI: http://dx.doi.org/10.1101/739011. 文章介绍： scATAC-seq技术目前广泛应用于不同领域转录调控的研究，伴随着很多计算方法相继被开发，用于分析、解释scATAC-seq数据背后的生物学意义。这篇文章对scATAC-seq分析的10个工具在13个数据集中(包括3个真实数据集和10个合成数据集)进行了测评。 10个工具分别是： BROCKMAN de Boer, C.G. and A. Regev, BROCKMAN: deciphering variance in epigenomic regulators by k-mer factorization. BMC Bioinformatics, 2018. 19(1): p. 253. chromVAR Schep, A.N., et al., chromVAR: inferring transcription-factor-associated accessibility from single-cell epigenomic data. Nat Methods, 2017. 14(10): p. 975-978. Cicero Pliner, H.A., et al., Cicero Predicts cis-Regulatory DNA Interactions from Single-Cell Chromatin Accessibility Data. Mol Cell, 2018. 71(5): p. 858-871 e8. cisTopic Bravo González-Blas, C., et al., cisTopic: cis-regulatory topic modeling on single-cell ATAC-seq data. Nature Methods, 2019. Cusanovich2018 Cusanovich, D.A., et al., A Single-Cell Atlas of In Vivo Mammalian Chromatin Accessibility. Cell, 2018. 174(5): p. 1309-1324 e18. Cusanovich, D.A., et al., The cis-regulatory dynamics of embryonic development at single-cell resolution. Nature, 2018. 555(7697): p. 538-542. Cusanovich, D.A., et al., Multiplex single cell profiling of chromatin accessibility by combinatorial cellular indexing. Science, 2015. 348(6237): p. 910-4. Gene Scoring Lareau, C.A., et al., Droplet-based combinatorial indexing for massive scale single-cell epigenomics. bioRxiv, 2019: p. 612713. scABC Zamanighomi, M., et al., Unsupervised clustering and epigenetic classification of single cells. Nat Commun, 2018. 9(1): p. 2410. Scasat Baker, S.M., et al., Classifying cells with Scasat, a single-cell ATAC-seq analysis tool.Nucleic Acids Res, 2019. 47(2): p. e10. SCRAT Ji, Z., W. Zhou, and H. Ji, Single-cell regulome data analysis by SCRAT. Bioinformatics, 2017. 33(18): p. 2930-2932. SnapATAC Fang, R., et al., Fast and Accurate Clustering of Single Cell Epigenomes Reveals Cis- Regulatory Elements in Rare Cell Types. BioRxiv, 2019. 测评方法： 利用收集到的3个公共数据集和10个合成模仿的不同覆盖度和噪音水平的数据集，从bam格式的比对文件开始，1）根据10种scATAC-seq工具原文提供的方法构建下游分析所需的特征矩阵；2）然后用3种常见的聚类方法K-means、Louvain、Hierarchical clustering和UMAP找出潜在的亚群，并可视化每种方法的细胞间相似性；3）对聚类结果进行评估，有FACS分选标记和有金标准的组织采用ARI(adjusted random)、AMI(adjusted mutual information)和H(homogeneity)的方法评估聚类结果，当只知道已知的marker 基因，采用RAGI (Gini-index-based metric called Residual Average Gini Index)的方法评估。4）最后对基于第3步得到的值，对每种方法的聚类效果进行打分排序。流程如下图所示： 测评结果： 他们的测评结果显示SnapATAC、cisTopic和Cusanovich2018是性能最好的对scATAC-seq数据聚类分析方法。另外基于peak-level（cisTopic, Cusanovich2018, Scasat）和bin-level（SnapATAC）保存信息的方法优于motif/k-mer level (chromVAR,BROCKMAN, SCRAT)或gene-body (Cicero, Gene Scoring) 。实现降维步骤的方法（BROCKMAN、cisTopic、Cusanovich2018、Scasat、SnapATAC）通常比没有这个重要步骤的其他方法显示出优势。此外，SnapATAC是最具伸缩性的方法,它是唯一能够处理超过80000个细胞的方法。CusanovicH2018是平衡分析性能和运行时间的最佳方法。下图展示了每种方法的聚类效果评估等级和时间需求。 参考价值： 概述了scATAC-seq常见的分析流程 如，建库方法常用的两种策略：Droplet-based(10X genomics, BioRad), split-pool(sciATA-seq)。下游常见分析：可视化、聚类、轨迹分析、差异可及性分析、顺式调控网络。 比较了10种scATAC-seq分析方法，为选择合适的方法提供了重要的参考依据 github提供了作者的100多个测试流程Jupyter笔记本，不仅可以复现作者的测评结果，还可以学习每种scATAC-seq的分析方法 github: https://github.com/pinellolab/scATAC-benchmarking/ 不足： 本文的测评主要基于不同方法对scATAC-seq数据的聚类效果，但是，实际项目中可能不仅关注聚类分群，还关注谱系发育轨迹、转录因子结合位点、重要的marker基因以及他们的调控方式。 作者在讨论中也对测评的局限性做了讨论，如，chromVAR更适合于轨迹预测，chromVAR，Cicero, Gene Scoring的设计主要是为了确定关键marker基因以及他们的调控方式等。所以具体选择哪种方法，还要结合实际的研究目的决定。 碎碎念 找时间实践下github上给出的几种scATAC-seq方法 每日文献摘要：第15篇 2019年11月02日 周六]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>software</tag>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[英语学习的网站资源]]></title>
    <url>%2F2019%2F11%2F02%2FSat%20Nov%2002%202019%2020%3A04%3A50%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[The only safe thing is to take a chance. 唯一稳妥的事是去冒险试一试。 1. TED https://www.ted.com/ 关于不同话题的talks，一方面可以了解相关话题的观点，另一方面锻炼听力，学习其演讲式的表达。 2. 雅思口语预测 慎小嶷口语预测博客：blog.sina.com.cn/ieltsguru 实时更新口语题库，及时了解，可以准备相关的topics 3. 英语线上交流学习网站 http://www.topics-mag.com 4. podcast在google上 搜索 podcast English ,会有有很多的英语听力资源，如https://www.podcastsinenglish.com/ 5. 全面的常考口语话题 idebate.org/debatabase 这是一个相当酷的辩论网站，覆盖了几乎所有的常用口语讨论话题。在页面中选择Education,Culture,Enviroment &amp; Animals,Welfare等主题后，就可以在This house believes that的后面看到各种各样的辩论话题。 6. 练习发音的网站 www.bbc.co.uk/worldservice/learningenglish/grammar/pron www.howjsay.com www.inogolo.com]]></content>
      <categories>
        <category>English</category>
      </categories>
      <tags>
        <tag>每日英语</tag>
        <tag>学习资源</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RNA速度-RNA velocity是什么]]></title>
    <url>%2F2019%2F11%2F01%2FFri%20Nov%2001%202019%2022%3A59%3A23%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[一句话评价 通过动态模型评估细胞瞬间状态的RNA速度 文章信息 题目：Generalizing RNA velocity to transient cell states through dynamical modeling 杂志：bioRxiv 时间：Oct. 29,2019 链接: http://dx.doi.org/10.1101/820936. figure 下图是作者利用该方法对胰腺内分泌发育构建的动态图谱 文章介绍： 这篇文章介绍了利用一个新的模型—动态模型对细胞瞬间态的RNA速度（RNA velocity）进行评估计算。关键词动态模型和RNA速度，这里对动态模型的算法和实现过程暂不详细解释，主要了解RNA速度的概念和应用以及这篇文章中开发的方法的优点。 RNA velocity的概念 RNA velocity, 我直译为RNA速度，这一概念是18年由瑞典卡罗林斯卡医学院的Sten Linnarsson和 Peter V. Kharchenko两个实验室提出的，相关研究成果发表Nature(2018, August, Nature)。RNA丰度是单个细胞状态的一个有力指标。单细胞测序技术可以灵敏、准确地揭示RNA的丰度。然而，这种方法仅能捕获在某个时间点的静态快照，使得分析随着时间动态变化的现象面临挑战（如胚胎发生或组织再生）。这里他们提出的RNA速度（RNA velocity）—可以理解为通过对unspliced(nascent) 和spliced(mature) mRNA丰度的评估在时间维度上揭示转录本动态变化的一个指标。 RNA velocity应用 RNA velocity是一个转录本动态变化的指标，能预测细胞未来的状态变化。可以用于细胞分化、谱系发育、肿瘤微环境中细胞成分的动态变化等研究。张泽民老师实验室刚发表的肝癌免疫图谱的文章中就有通过RNA velocity的分析揭示肿瘤微环境中巨噬细胞的迁移(2019,October,Cell) （张老师实验室用的是Scanpy方法分析的RNA velocity）。 scVelo—以动态模型对细胞瞬间态的RNA velocity进行评估计算的方法 回到这篇文章，作者认为现有的计算RNA velocity的模型在一些情况下存在不足，他称这种模型为稳态模型(steady-state model), 这种模型有个两个基本的假设：即（i）在基因水平上，所有具有转录诱导、抑制和稳态mRNA水平的完整剪接动力学被捕捉到；（ii）在细胞水平上，所有基因具有共同的剪接率。但是，当一个种群包含多个具有不同动力学的异质亚种群时，这些假设常常被违背。 所以，他们开发的seVelo，一个基于似然的动力学模型(likelihood-based dynamical model)，它解决了以上提出的全基因转录动力学的问题，从而将RNA速度估计推广到瞬态系统和具有非均匀亚种群动力学的系统。scVelo提供了两种扩展：一种是包含二阶矩的随机模型，另一种是捕获全剪接动力学的动力学模型。与scanpy也兼容。 网址：scVelo: https://scvelo.org 碎碎念 评估科学研究的重要性通常有3方面：新的概念、新的方法、新的发现。18年Nature的那篇文章是提出了新的概念，这篇文章是开发了新的方法，我们还可以应用新的概念和新的方法，为自己关注的领域带来新的发现。 相关文献： 2018, August, Nature, RNA velocity of single cells：DOI: 10.1038/s41586-018-0414-6 2019, October,Cell,Landscape and Dynamics of Single Immune Cells in Hepatocellular Carcinoma. https://doi.org/10.1016/j.cell.2019.10.003. 每日文献摘要：第14篇 2019年11月01日 周五]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[人类红细胞生成过程中的转录组和表观图谱]]></title>
    <url>%2F2019%2F10%2F28%2FMon%20Oct%2028%202019%2020%3A42%3A41%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[十月最后的一天，这一年还有两个月就又结束了。 对于小孩来说两三个月可能如两三年一样长，对于长大的人来说两三年就如两三天一样快。 一句话评价 ATAC-seq和RNA-seq联合分析策略 文章信息 题目：Transcriptional States and Chromatin Accessibility Underlying Human Erythropoiesis 杂志：Cell Report 时间：2019 June 11 链接: DOI: 10.1016/j.celrep.2019.05.046 figure 文章介绍： 碎碎念 虽然idea相似，但是这篇文章总体的逻辑更强，或者说写作的连贯性更强与自己。还有就是图做的也漂亮。 每日文献摘要：第13篇 2019年10月31日 周四]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Smart-seq3问世]]></title>
    <url>%2F2019%2F10%2F27%2FSun%20Oct%2027%202019%2012%3A58%3A20%20GMT%2B0100%2F</url>
    <content type="text"><![CDATA[单细胞技术发展的如火如荼，实验方法、算法、分析工具不断迭代更新和完善。瑞典Karolinska Institute 的Rickard Sandberg实验室14年发表了Smart-seq和Smart-seq2，是至今较为流行的单细胞实验方法之一，由于其具有全长转录本覆盖度的优点，由此可以用于研究可变剪接、变异、等位基因、转录本亚型等转录后调控。但是由于其通量低，价格较贵，限制了其广泛的推广应用。而10X Genomics的出现，由于通量高，价格低，迅速占领了单细胞技术的大部分市场。 Smart-seq3相比Smart-seq2具有什么改进呢？ 最显著的改进特点就是整合了5‘-UMI定量计数的策略，使通量大幅提高。同时还保留Smart-seq2的优点，就是全长转录本的覆盖度。因此，依然在等位基因和转录本亚型层次上具有巨大的应用。 一句话评价 Smart-seq3——等位基因和亚型分辨率的单细胞RNA 计数 文章信息 题目：Single-cell RNA counting at allele- and isoform-resolution using Smart-seq3 杂志：bioRxiv 时间：Oct. 25, 2019 链接: https://www.biorxiv.org/content/biorxiv/early/2019/10/25/817924.full.pdf figure 文章介绍： 瑞典Karolinska Institute 的Rickard Sandberg实验室于10月25日在bioRxiv上发表了Smart-seq3，在等位基因和转录本亚型的研究中具有独特的优点。为大家熟知的Smart-seq2也是由Rickard实验室开发，具有全长转录本的覆盖度的优点，可以进行等位基因表达谱分析等问题，但是由于通量低，价格昂贵，应用推广也受到一定的限制。Smart-seq3针对Smart-seq2的限制性特点做了改进，依然保留全长转录本覆盖度的优点，同时结合5‘ UMI（unique molecular identifier）的RNA计数策略，与Smart-seq2相比通量显著提高，可以达到每个细胞比Smart-seq2多检测出上千个基因。 另外与全长转录本测序相比，虽然长read测序技术可以直接定量等位基因和亚型的表达水平，但是测序深度阻碍了其大范围应用。而Smart-seq3不仅克服了Smart-seq2的缺点，也克服了长读长测序的缺点，采用灵敏的短读长测序、整合5‘UMI和全长转录本覆盖度的优点，可以在单细胞层面上检测等位基因和亚型的变化，通量显著提高，且价格合理（一个测序细胞文库成本约为0.5-1欧元），可以在普通的分子实验室实现该protocol (dx.doi.org/10.17504/protocols.io.7dnhi5e), 不需要特殊的设备。 期待其他实验室对该方法的尝试和验证，预测该方法在转录后调控研究中将有巨大潜在的应用。 每日文献摘要：第12篇 2019年10月27日 周日 捧一杯咖啡，听着咖啡屋淡淡的音乐，打开电脑，专注工作～时光静好]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[基因组结构变异]]></title>
    <url>%2F2019%2F10%2F26%2FSat%20Oct%2026%202019%2014%3A35%3A23%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[基因组变异这里重温下基因组变异的知识，尤其是结构变异的知识点： 单碱基变异，即单核苷酸多态性(SNP)，最常见也最简单的一种基因组变异形式； 很短的Insertion 和 Deletion，也常被我们合并起来称为Indel。主要指在基因组某个位置上发生较短长度的线性片段插入或者删除的现象。强调线性的原因是，这里的插入和删除是有前后顺序的与下述的结构性变异不同。Indel长度通常在50bp以下，更多时候甚至是不超过10bp，这个长度范围内的序列变化可以通过Smith-Waterman 的局部比对算法来准确获得，并且也能够在目前短读长的测序数据中较好地检测出来 基因组结构性变异**（Structure Variantions，简称SVs），这篇文章的重点，通常就是指基因组上大长度的序列变化和位置关系变化。类型很多，包括长度在50bp以上的长片段序列插入或者删除（Big Indel）、串联重复（Tandem repeate）、染色体倒位（Inversion）、染色体内部或染色体之间的序列易位（Translocation）、拷贝数变异（CNV）以及形式更为复杂的嵌合性变异。]]></content>
      <tags>
        <tag>SV</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[利用前列腺癌早期的分子进化特征鉴定前列腺癌的风险标志物和临床发展过程]]></title>
    <url>%2F2019%2F10%2F26%2FSat%20Oct%2026%202019%2010%3A28%3A14%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 肿瘤的分子进化特征为肿瘤的早期诊断提供参考 文章信息 题目：Molecular Evolution of Early-Onset Prostate Cancer Identifies Molecular Risk Markers and Clinical Trajectories 杂志：Cancer Cell 时间：December 10, 2018 链接: https://doi.org/10.1016/j.ccell.2018.10.016 figure 文章介绍： 这篇文章发表于2018年12月，由丹麦哥本哈根大学和德国海德堡大学主导完成，文章利用前列腺癌早期的分子进化特征鉴定前列腺癌不同等级风险的标志物和临床发展轨迹，主要结果包括4个方面： APOBEC3的类时钟（clock-like）突变过程介导了前列腺癌（Prostate Cancer，PC）的早期突变 鉴定出能够区分中等危险疾病（intermediate-risk）的四个分子亚群 ESRP1位点的重排与癌症的侵袭性和增殖性相关 开发了利用DNA测序数据预测PC临床轨迹的方法 文中用到的数据包括WGS，450K 甲基化以及RNA-seq共292个前列腺癌样本，当然不同数据类型的样本并不是一一对应的，另外还用到了公共的Hi-C数据（具体数据来源在文中还没有找到）。 注：EOPC(early-onset PC): 早期前列腺癌； LOPC(late-onset PC): 晚期前列腺癌 数据类型 EOPC 样本数 LOPC样本数 WGS 184 85 Methylomes(450K) 203 45 mRNA-seq 96 Hi-C data 作者利用这些数据进行了什么分析呢首先鉴定EOPC的体细胞突变模式通过somatic和germline的call变异流程，分析SNVs、InDels和SVs。 从SNVs的结果来看，与以前研究的结果一致，前列腺癌的SNVs非常低；EOPC与LOPC相比，EOPC的SNVs数量低于LOPC(平均每M b的SNVs数量，EOPC=0.47,LOPC=0.53)，其中EOPC中TP53的变异率最高。SVs是前列腺癌出现频率较高的变异，SVs常与PC中肿瘤抑制基因的反复融合的形成或丢失有关。基于此作者鉴定了复发性基因组变异位点（recurrent genomic altered loci ，RGA)，结果揭示70%的EOPC携带的SV与ETS融合基因的形成有关，EOPC中第二、三易变异的位点分别是8号染色体的NKX3-1和3号染色体的FOXP1基因附近。为了鉴定RGAs与年龄的关系（即RGAs与前列腺癌发展的早期阶段和晚期阶段的关联），作者继续对LOPC做了对应的基因组变异分析，结果显示LOPC中RGAs的整体比例高于EOPC，另外EOPC中展现出较高的单克隆结构，表明EOPC可能主要与克隆起源有关。 肿瘤发展的过程常伴随这表观结构的变异，如DNA双链的开放和紧密压缩状态的改变。实验室之前的研究发现EOPC基因组中断裂点(breakpoits)常出现在雄性激素受体结合位点(AR-binding sites)附近，这增加了年龄相关的染色质状态改变影响断点发生的可能性。因此，他们整合公共的Hi-C数据检测与特定染色质区域相关的EOPC基因组断裂点，发现断裂点与染色质loop和H3K27ac peaks的数量显著相关。表明EOPC的断裂点主要出现在染色质开放区域，与活性元件相关；LOPC断裂点主要出现在异染色质区域。 小结：这一部分主要利用基因组数据分析前列腺癌早期和晚期的变异特征（SNVs,InDels和SVs）。展示了EOPC和LOPC中断裂点的不同的分布特征，以及与染色质状态的变化。 疑问：有两个概念不怎么理解，一个是RGA，一个是breakpoints，而这两个概念又是这篇文中分析的重点内容。 RGAs(recurrent genomic altered loci ): 字面意思反复出现的基因组变异位点，文中说SVs常与PC中肿瘤抑制基因的反复融合的形成或丢失有关，基于此作者鉴定了RGAs。RGAs是否是染色质结构变异中的DNA重排呢？与SV以及融合基因有什么关联？如何鉴定RGAs呢？ Genome Breakpoints：基因组断裂点。B图（瀑布图）中对变异类型的描述中有个break，可能和Genome Breakpoints有关，是一个变异类型？那么和loss, gain，mutation有什么区别呢？查阅资料发现breakpoints结各种结构变异类型分析中的一个概念 另外文中说做了germline和somatic的call变异，但只提供了WGS数据，为什么没有WES数据？只用WGS进行的somatic variants的分析吗？ DNA重排分析DNA重排是结构变异的一个形式。作者鉴定到EOPC中有两个RGAs位于13q22和8q22。 13q22的最小重叠峰区域以KLF5为中心，以往的研究表明KLF5编码一个参与抑制细胞增殖的转录激活因子, 13q22的丢失与KLF5 mRNA水平的降低以及SV和SNV负荷的整体增加有关。该研究发现KLF5与SPOP（有一个鼠的胚胎干细胞研究中发现SPOP是KLF5的一个靶基因，是一个泛素连接酶基因） mRNA表达水平呈正相关关系，但是与SPOP的突变无关。 8q22处的一个区域显示以ESRP1为中心的反复基因组复制，最小重叠峰区域在MYC附近。这些重复与ESRP1和MYC都有重叠，但只有ESRP1在PC样本中显示出显著的mRNA水平增加。此外，ESRP1重排与格里森评分（GS，前列腺癌评估的一个重要指标）升高显著相关。ESRP1蛋白水平的升高与增殖率升高相关。另外发现其可以作为一个独立的预后标志物。 小结： 根据DNA重排分析，发现ESRP1重排与ESRP1蛋白表达增加、细胞增殖水平升高、GS和肿瘤分期升高有关，并证明ESRP1表达是PC中一个独立的预后生物标记物。 基因组变异的背景知识 单碱基变异，即单核苷酸多态性(SNP)，最常见也最简单的一种基因组变异形式； 很短的Insertion 和 Deletion，也常被我们合并起来称为Indel。主要指在基因组某个位置上发生较短长度的线性片段插入或者删除的现象。强调线性的原因是，这里的插入和删除是有前后顺序的与下述的结构性变异不同。Indel长度通常在50bp以下，更多时候甚至是不超过10bp，这个长度范围内的序列变化可以通过Smith-Waterman 的局部比对算法来准确获得，并且也能够在目前短读长的测序数据中较好地检测出来 基因组结构性变异（Structure Variantions，简称SVs），这篇文章的重点，通常就是指基因组上大长度的序列变化和位置关系变化。类型很多，包括长度在50bp以上的长片段序列插入或者删除（Big Indel）、串联重复（Tandem repeate）、染色体倒位（Inversion）、染色体内部或染色体之间的序列易位（Translocation）、拷贝数变异（CNV）以及形式更为复杂的嵌合性变异。 参考来源：碱基矿工黄树嘉老师的文章—https://zhuanlan.zhihu.com/p/40290546 经典的SVs综述： Alkan, C., Coe, B. P. &amp; Eichler, E. E. Genome structural variation discovery and genotyping. Nature reviews. Genetics**12**, 363–76. 突变特征（mutational signature)分析突变信号(mutational signature)可以用来描述作用于肿瘤细胞的内源性和外源性介导的突变过程。通过突变特征的分析发现APOBEC3的类时钟（clock-like）突变过程介导了PC的早期突变，APOBEC3蛋白是一种胞苷脱氨酶，在单链DNA复制周期中起到限制反转录因子的作用，但也可以诱导癌症基因组的突变。 背景知识 mutaional signature: 下文内容来自：作者-ksxg ，公众号BioKSXG，文章题目：看文献，详解Mutational signatures（突变指标/签名/特征） 不同的体细胞突变过程会产生各种结果，不同的突变过程产生突变类型的独特组合,称为“Mutational Signatures”。截止到2018年已经有30种定义的Mutational Signatures： Signature 涉及的癌症种类 病因学 额外的突变特征 Comments 1 所有癌症，大部分样品 5-甲基胞嘧啶脱氨基作用自发的内源性突变过程导致 小数量的小插入和在大多数组织类型的删除 与诊断年龄相关 2 主要在子宫癌和膀胱癌 AID/APOBEC家族的胞嘧啶核苷脱氨酶的活动 观察到外显子中转录链偏差的突变,但是在内含子中不存在或者较弱 2和13常在同一样本中被鉴定出，常伴随kataegis突变机制 3 乳腺癌、卵巢癌、胰腺癌 通过同源重组的DNA双链断裂修复 断点连接中活跃的大片段（大于3bp）插入和删除，伴随着重叠的微同源序列 乳腺癌、胰腺癌和卵巢癌中生殖系和体细胞的BRCA1和BRCA2突变，特别是胰腺癌中铂疗法 4 头颈癌、肝癌、肺腺癌、肺鳞癌、小细胞肺癌、食道癌 吸烟相关，烟草诱变剂 偏向C &gt;A突变,也与CC &gt; AA二核苷酸替换相关 29也与烟草咀嚼相关癌症有关，但是与4不同 5 所有癌症，大部分样品 未知 T &gt; C替换（ApTpN） 无 6 17种癌症，但主要在结直肠和子宫癌症 DNA错配修复缺陷和微卫星不稳定的肿瘤 单核/多核苷酸重复中活跃的小片段（小于3bp）的插入和删除 4和15、20、26属于DNA错配修复缺陷相关的四大mutational signature 7 皮肤癌,头部和口腔鳞状上皮癌 紫外线暴露 大量的CC &gt; TT二核苷酸突变，被转录的核苷酸切除修复嘧啶突变 无 8 乳腺癌和成神经管细胞瘤 微弱的C &gt;A替换,与双核苷酸替换,尤其是CC &gt; AA相关 未知 无 9 慢性淋巴细胞白血病和恶性B细胞淋巴瘤 聚合酶η引起的突变模式，涉及体细胞超突变的活动 未知 9中，与那些没有超突变的免疫球蛋白基因相比，具有免疫球蛋白基因超突变(IGHV-mutated)的慢性淋巴细胞白血病有大量突变 10 六种癌症,尤其是肠癌和子宫癌,通常会在一小部分样品中产生大量的突变 容易出错的聚合酶极的活动，10中有大量的复发性杆体细胞突变,即Pro286Arg Val411Leu C &gt;A突变(TpCpT)和T &gt; G突变(TpTpT) 与大部分突变的癌症样本相关，这个mutational signature定义为ultra-hypermutators（超-超突变子？不懂） 11 黑色素瘤和胶质母细胞瘤 类似于烷化剂的突变模式 强烈的C &gt; T替换，能被转录的核苷酸切除有效修复 无 12 肝癌 未知 强烈的T &gt; C替换 12在肝癌样本中突变率较小（&lt;20%） 13 22种癌症中，常见于宫颈和膀胱癌 AID/ APOBEC家族的胞嘧啶核苷脱氨酶将胞嘧啶转化为尿嘧啶活动引起的，尤其是APOBEC1, APOBEC3A 和/或者 APOBEC3B，13导致显著的C &gt; G突变 观察到外显子中转录链偏差的突变,但是在内含子中不存在或者较弱 经常和2在同一样品中被鉴定出，病毒感染、逆转录转座子跳跃或组织炎症引起的AID/ APOBEC胞嘧啶核苷脱氨酶激活，常伴随kataegis突变机制 14 四种子宫癌症和一种成人轻度神经胶质瘤样本 未知 未知 在所有样本中都有较高的体细胞突变数（每MB大于200个突变） 15 几种胃癌症和一种小细胞肺癌 DNA错配修复缺陷相关 单核/多核苷酸重复中活跃的小片段（小于3bp）的插入和删除 15和6、20、26属于DNA错配修复缺陷相关的四大mutational signature 16 肝癌 未知 强烈的T &gt; C替换 无 17 食管肿瘤、乳腺癌、肝癌、肺腺癌,B细胞淋巴瘤、胃癌和黑色素瘤 未知 未知 无 18 神经母细胞瘤。此外还在乳腺癌和胃癌癌被观察到 未知 未知 无 19 只在纤维状细胞的星形细胞瘤 未知 未知 无 20 胃和乳腺癌 DNA错配修复缺陷相关 单核/多核苷酸重复中活跃的小片段（小于3bp）的插入和删除 20和6、15、26属于DNA错配修复缺陷相关的四大mutational signature 21 只在胃癌 未知 未知 只在来自同一测序中心的四个样本中被发现，与26有一些类似，只在有15和20的样本中被发现，可能与微卫星不稳定的肿瘤相关 22 肾盂移行细胞癌 发现于马兜铃酸癌症样本 活跃的T&gt;A突变，表明腺嘌呤损伤被转录的核苷酸切除修复 移行细胞癌中突变很高，但在肝癌很低 23 仅在一例肝癌样品中 未知 强烈的C &gt; T替换 无 24 肝癌的子集 黄曲霉毒素暴露 活跃的C &gt;A突变，表明鸟嘌呤损伤被转录的核苷酸切除修复 无 25 霍奇金淋巴瘤 未知 活跃的T&gt;A突变 仅在何杰金氏细胞系中被鉴定出，没有原发霍奇金淋巴瘤的数据 26 乳腺癌、宫颈癌、胃癌、子宫癌 DNA错配修复缺陷相关 单核/多核苷酸重复中活跃的小片段（小于3bp）的插入和删除 26和6、15、20属于DNA错配修复缺陷相关的四大mutational signature 27 肾透明细胞癌的子集 未知 活跃的T&gt;A突变，断点连接中活跃的大片段（大于3bp）插入和删除，伴随着重叠的微同源序列 无 28 胃癌的子集 未知 未知 无 29 仅在齿龈颊口腔鳞状细胞癌 烟草咀嚼习惯相关的样本 偏向C &gt;A突变,也与CC &gt; AA二核苷酸替换相关 4也与烟草咀嚼相关癌症有关，但是与29不同 30 乳腺癌一小部分子集 未知 未知 无 肿瘤纯度与甲基化联合分析正常人前列腺组织由基底细胞、管腔细胞和基质细胞组成，而PC则失去基底细胞，获得肿瘤特异性管腔（T-管腔）细胞和浸润性免疫细胞。考虑到DNA甲基化图谱是细胞类型（cell type,ct）特异性的，作者试图通过使用可用的参考甲基化图谱来解释甲基化分析中ct组成的差异。为此，他们从良性前列腺增生患者和前列腺癌患者中获取了额外的切除样本，并进行荧光激活细胞分类，以识别前列腺癌中存在的主要ct，这使他们能够识别前列腺癌基因组中每个甲基化位点的ct特征。 他们发现在高GS肿瘤中，基底细胞和管腔细胞向T管腔细胞和浸润性免疫细胞的反复转移。鉴于T-管腔和免疫细胞含量在鉴别高级别肿瘤中的相关性，他们将此信息合并为前列腺癌肿瘤侵袭性的经纯度调整的表观遗传指数（PEPCI）。他们发现高PEPCI与高pt、高GS和BCR风险增高密切相关。此外，PEPCI能够对中等风险病例进行分层，并且他们在主要LOPC样本的TCGA队列中验证了这一点。最后，我们的PEPCI评分也能够独立预测GS和BCR。 小结：将肿瘤纯度分析与甲基化分析结合分析，提出经纯度调整的表观遗传指数值（PEPCI），证明了PEPCI可以区别不同等级风险PC。 需补充的知识： 肿瘤纯度的分析 这篇文章提出的PEPCI 整合分析鉴定肿瘤发展的分子亚型他们利用CLICK算法对96个病人的mRNA-seq数据进行分析，将共表达基因共分成7个不同的CLICK clusters(CC)。然后整合CC表达谱与ct比例以及PEPCI的信息的综合分析将患者分为四个与预后相关的亚组，其在生物学通路的表达上有明显差异。 需补充的知识： CLICK的聚类方法 预测肿瘤演化顺序的计算方法他们开发了一种基于条件概率的网络模型PRESCIENT (prediction of sequential changes in the evolution of nascent tumors——预测新生肿瘤演化的顺序变化），用于预测PC和相关临床outcom中体细胞事件的时间序列。 需补充的知识：理解PRESCIENT模型 碎碎念 最后再对这篇文章做一个总结： 这篇文章通过292个前列腺癌样本的WGS，450K 甲基化以及RNA-seq数据以及公共的Hi-C数据，发现早期前列腺癌的分子进化特征可以鉴定前列腺癌不同等级风险的标志物和临床发展轨迹。1）文中首先利用基因组数据分析前列腺癌早期和晚期的变异特征（包括SNVs,InDels和SVs），展示了EOPC和LOPC中断裂点的不同分布特征，以及与染色质状态的变化。2）由于SVs是前列腺癌出现频率较高的变异，所以文中主要做的是SVs相关的分析。基因组重排的分析主要结果是发现了ESRP1位点的重排与癌症的侵袭性和增殖性相关。3）mutational signature的分析发现APOBEC3的类时钟（clock-like）突变过程介导了前列腺癌（Prostate Cancer，PC）的早期突变。4）将肿瘤纯度分析与甲基化分析结合，提出经纯度调整的表观遗传指数值的方法（PEPCI），证明了PEPCI可以区别不同等级风险PC。5）利用CLICK算法对96个病人的mRNA-seq数据进行共表达基因聚类分析，然后整合细胞纯度分析以及PEPCI的信息，将患者分为四个与预后相关的亚组，其在生物学通路的表达上有明显差异。6）开发了一种基于条件概率的网络模型PRESCIENT (prediction of sequential changes in the evolution of nascent tumors——预测新生肿瘤演化的顺序变化），用于预测PC和相关临床outcom中体细胞事件的时间序列。 开发的预测新生肿瘤演化顺序的方法——PRESCIENT ： PRESCIENT：https://bitbucket.org/weischenfeldt/prescient/src/master/ 总之，这篇文章可以作为对肿瘤分子进化特征与肿瘤早期诊断研究感兴趣的参考，文中涉及的方法和开发的新方法也值得学习。 断断续续花了两天时间才看懂了这篇文章的思路框架，方法部分还没有认真细看。粗略估计看懂这篇cancer cell的文章，包括文章思路和结果以及方法，可能需要一个星期的时间。另外一个对我来说这篇文章难于理解的原因是背景知识的缺乏，如结构变异（SVs）的理解，分析原理和方法，以及肿瘤相关方面的背景知识缺乏，我之前是不知道mutaion signature的，也不知道肿瘤中常见的肿瘤纯度，肿瘤进化等是如何分析的，虽然听说过这几个概念，也常见这样的帖子，但是都没有细看。不过认真看一篇文章，学到的知识点真多，以后再看相关的其他文章就有了背景知识。 方法学下次更新 > 每日文献摘要：第11篇 2019年10月26日 周六]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>tumor evolution</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[基础常见的条形图]]></title>
    <url>%2F2019%2F10%2F24%2FThu%20Oct%2024%202019%2013%3A04%3A36%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[今天已进入24节气中的霜降，《二十四节气解》中说：“气肃而霜降，阴始凝也。”可见“霜降”表示天气逐渐变冷，开始降霜。北京的天气也格外应景，从早上就开始淅淅沥沥下雨，呆在屋里，甚至窝在被窝里，都感觉凉凉的。时间过得真快，刚毕业的时候还是三伏天的夏季，转眼又在北京迎来了冬季～ 条形图是常见的一种数据可视化方式，常用于表示类变量（x)对应的数值（y）。这里以ggplot2示例展示如何设置绘制简单的bar plot，如何设置其他图形参数，以及进阶的bar plot示例展示。 ggplot2中绘制条形图的函数有geom_col()和geom_bar()。 条形图的填充色，边框色，背景色和背景框线的设置1234567891011## 简单的条形图 (左图)ggplot(pg_mean, aes(x = group, y = weight)) + geom_col()## 条形的填充色，边框，背景色和框线的设置 （右图）ggplot(pg_mean, aes(x = group, y = weight)) + geom_col(fill="lightblue", colour = "black") + #设置条形的填充颜色fill, 边框颜色colour theme_bw() + # 去掉背景颜色 theme( panel.grid.major.x = element_blank(), # 去掉背景框线 panel.grid.major.y = element_blank() ) 填充色设置和变量排序非默认的填充色设置可以借助scale_fill_brewer() 或 scale_fill_manual()， 对变量的排序:reorder()函数，这里是基于Change的变化对Abb排序。 123456789101112131415## 输入数据处理library(gcookbook) # Load gcookbook for the uspopchange data setlibrary(dplyr)upc &lt;- uspopchange %&gt;% arrange(desc(Change)) %&gt;% slice(1:10)## fill()函数以Region 因子变量填充bar的颜色ggplot(upc, aes(x = Abb, y = Change, fill = Region)) + geom_col()## scale_fill_brewer() or scale_fill_manual()选择其他颜色，reorder对Abbggplot(upc, aes(x = reorder(Abb, Change), y = Change, fill = Region)) + geom_col(colour = "black") + scale_fill_manual(values = c("#669933", "#FFCC66")) + xlab("State") 不同颜色表示正负数值的变化123ggplot(climate_sub, aes(x = Year, y = Anomaly10y, fill = pos)) + geom_col(position = "identity", colour = "black", size = 0.25) + # 边框线的颜色colour和宽度size scale_fill_manual(values = c("#CCEEFF", "#FFDDDD"), guide = FALSE) # scale_fill_manual() 设置颜色， guide = FALSE 去除legend 一对变量，调整bar的宽度和空间123456789## 一对变量水平同时展示 dodgeggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) + geom_col(position = "dodge", colour = "black") + # dodge 映射要填充的变量 scale_fill_brewer(palette = "Pastel1")## 调整bar width 和 dodge位置，默认是0.9ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) + geom_col(width = 0.5, colour = "black",position = position_dodge(0.7)) + scale_fill_brewer(palette = "Pastel1") 堆积图123456789101112131415161718192021## position_stack(reverse = FALSE) 堆积图的顺序调整，guide_legend(reverse = TRUE)：legend顺序调整ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) + geom_col(position = position_stack(reverse = FALSE),colour = "black") + guides(fill = guide_legend(reverse = TRUE))+ scale_fill_brewer(palette = "Pastel1")## geom_col(position = "fill") 以比例展示每个类型的堆积，堆积图总分值是1ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) + geom_col(position = "fill",colour = "black") + guides(fill = guide_legend(reverse = TRUE))+ scale_fill_brewer(palette = "Pastel1")## scale_y_continuous(labels = scales::percent) 以百分制表示比例ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) + geom_col(colour = "black", position = "fill") + scale_y_continuous(labels = scales::percent) + scale_fill_brewer(palette = "Pastel1")## geom_text添加文本ggplot(cabbage_exp, aes(x = Date, y = Weight, fill = Cultivar)) + geom_col() + geom_text(aes(label = Weight), vjust = 2) 圈圈图 Dot plot123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354## 图1；dot plot: geom_point()library(gcookbook) # Load gcookbook for the tophitters2001 data settophit &lt;- tophitters2001[1:25, ] # Take the top 25 from the tophitters data setggplot(tophit, aes(x = avg, y = name)) + geom_point()## 图2 排序:reorderggplot(tophit, aes(x = avg, y = reorder(name, avg))) + geom_point(size = 3) + # Use a larger dot theme_bw() + theme( panel.grid.major.x = element_blank(), panel.grid.minor.x = element_blank(), panel.grid.major.y = element_line(colour = "grey60", linetype = "dashed") )## 图3 置换坐标方向ggplot(tophit, aes(x = reorder(name, avg), y = avg)) + geom_point(size = 3) + # Use a larger dot theme_bw() + theme( panel.grid.major.y = element_blank(), panel.grid.minor.y = element_blank(), panel.grid.major.x = element_line(colour = "grey60", linetype = "dashed"), axis.text.x = element_text(angle = 60, hjust = 1) )## 图4 添加分类颜色# Get the names, sorted first by lg, then by avgnameorder &lt;- tophit$name[order(tophit$lg, tophit$avg)]# Turn name into a factor, with levels in the order of nameordertophit$name &lt;- factor(tophit$name, levels = nameorder)ggplot(tophit, aes(x = avg, y = name)) + geom_segment(aes(yend = name), xend = 0, colour = "grey50") + geom_point(size = 3, aes(colour = lg)) + scale_colour_brewer(palette = "Set1", limits = c("NL", "AL")) + theme_bw() + theme( panel.grid.major.y = element_blank(), # No horizontal grid lines legend.position = c(1, 0.55), # Put legend inside plot area legend.justification = c(1, 0.5) )## 图5 分面 facet_gridggplot(tophit, aes(x = avg, y = name)) + geom_segment(aes(yend = name), xend = 0, colour = "grey50") + geom_point(size = 3, aes(colour = lg)) + scale_colour_brewer(palette = "Set1", limits = c("NL", "AL"), guide = FALSE) + theme_bw() + theme(panel.grid.major.y = element_blank()) + facet_grid(lg ~ ., scales = "free_y", space = "free_y")]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>R</tag>
        <tag>每日一图</tag>
        <tag>visualization</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[base plot与ggplot2语法比较]]></title>
    <url>%2F2019%2F10%2F23%2FWed%20Oct%2023%202019%2018%3A50%3A51%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[通过base plot和ggplot2的简单实例，直接感受下base plot和ggplot2的语法差别。 条形图 基本绘图 barplot()是基本绘图中绘制条形图的函数，需要一个向量参数指定bar的高度（必须），每个bar的label是可选参数。 ggplot2 ggplot2中绘制bar plot使用geom_col或geom_bar, 注意这里使用factor将x变量转换为离散变量。 12345678910library(ggplot2)# Bar graph of values. This uses the BOD data frame, with the# "Time" column for x values and the "demand" column for y values.ggplot(BOD, aes(x = Time, y = demand)) + geom_col()# Convert the x variable to a factor, so that it is treated as discreteggplot(BOD, aes(x = factor(Time), y = demand)) + geom_col() 直方图 基本绘图 hist是基本绘图中直方图的函数。 ggplot2 ggplot2中绘制直方图使用geom_histogram() 12345678library(ggplot2)ggplot(mtcars, aes(x = mpg)) + geom_histogram()#&gt; `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.# With wider binsggplot(mtcars, aes(x = mpg)) + geom_histogram(binwidth = 4) 箱线图 基本绘图 箱线图可以直接用plot()函数（如果x变量是factor，会自动产生bo x plot)， 当然也可以用boxplot()函数。如果想在X轴展示两个变量，也是可以的。 123plot(ToothGrowth$supp, ToothGrowth$len)# Formula syntaxboxplot(len ~ supp, data = ToothGrowth) 12# Put interaction of two variables on x-axisboxplot(len ~ supp + dose, data = ToothGrowth) ggplot2 ggplot2使用geom_boxplot() 函数，x轴展示两个变量时可以用interaction()函数 123library(ggplot2)ggplot(ToothGrowth, aes(x = supp, y = len)) + geom_boxplot() x轴展示两个变量 12ggplot(ToothGrowth, aes(x = interaction(supp, dose), y = len)) + geom_boxplot() 小结 条形图、直方图、箱线图的区别 条形图x和y变量是一对一的关系，绘图时必须传递y变量。直方图是频率分布图，箱线图x变量对应的y变量有多个值。 Base plot和ggpplot2的绘图特征 Base plot直接指定变量参数即可，ggplot2的语法通常包括3个部分，首先是数据框，然后以aes指定参数变量，再加上图形的类型，如geom_boxplot等 箱线图展示一对变量的特征 如果用base plot实现，可以直接在x参数变量后加上另一个参数，如果是ggplot2，借助interaction()将一对变量添加。 个人感觉这里base plot画的图更简单好看。]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>R</tag>
        <tag>每日一图</tag>
        <tag>visualization</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[千里之行始于足下_R Basics]]></title>
    <url>%2F2019%2F10%2F22%2FTue%20Oct%2022%202019%2010%3A44%3A50%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[坚持做一件事很难，总会被最初的意外和后来的惰性扰乱而半路放弃。今天看到几句话，感觉说到心窝里了: 规律地做一些事情，据说可以增加对生活的掌控感，从而缓解焦虑。 对时间最好的利用，就是做自己想做的事情，并且全身心的享受每一刻。 这里就立一个Flag：每日一图，每天至少专注的做一件自己喜欢做的想做的事情。 这里就以推荐三本学习R画图的免费好书推荐的第一本书起航吧：R G raphics Cookbook 这本书主要基于ggplot2的绘图语法，以及tidyverse的数据清理方法。书中使用的数据和例子整合在gcookbook 所以首先安装载入需要的R包123456789install.packages(c("ggplot2", "gcookbook", "MASS", "dplyr","tidyverse"))library(tidyverse)library(gcookbook)library(ggplot2)library(dplyr)# updateupdate.packages() base plot与ggplot2的简单实例对比Scatter plot 使用plot函数，仅需传递给plot两个变量：x, y 1plot(mtcars$wt, mtcars$mpg) 使用ggplot2, 首先创建一个plot 对象，然后加一个点的图层。ggplot2通常以数据框为画图对象（mtcars)，然后指明哪列是x, 哪列是y。 123library(ggplot2)ggplot(mtcars, aes(x = wt, y = mpg)) + geom_point() Line Graph Base plot新增line时，第一次以plot函数，第二次lines函数 123456789# 左图plot(pressure$temperature, pressure$pressure, type = "l")# 右图plot(pressure$temperature, pressure$pressure, type = "l")points(pressure$temperature, pressure$pressure)lines(pressure$temperature, pressure$pressure/2, col = "red")points(pressure$temperature, pressure$pressure/2, col = "red") ggplot2对图像的图形的选择需加上geom_line()，或者geom_point() 12345678# 左图library(ggplot2)ggplot(pressure, aes(x = temperature, y = pressure)) + geom_line()# 右图，加pointsggplot(pressure, aes(x = temperature, y = pressure)) + geom_line() + geom_point()]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>R</tag>
        <tag>每日一图</tag>
        <tag>visualization</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scATAC-seq和深度学习联合揭示2型糖尿病的调控特征]]></title>
    <url>%2F2019%2F09%2F28%2FSat%20Sep%2028%202019%2022%3A34%3A40%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 scATAC-seq和深度学习联合揭示2型糖尿病的调控特征 文章信息 题目：Single cell ATAC-seq in human pancreatic islets and deep learning upscaling of rare cells reveals cell-specific type 2 diabetes regulatory signature 杂志：bioRxiv 时间：Sep. 7, 2019 链接: DOI: http://dx.doi.org/10.1101/749283 figure 文章介绍： II型糖尿病(T2D)是一种以胰岛功能障碍、胰岛素抵抗和血糖紊乱为特征的复杂疾病。全基因组关联研究（GWAS）已经鉴定出超过400个编码遗传倾向的独立信号。超过90%相关的单核苷酸多态性（SNP）定位于非编码区，并富集在染色质定义的胰岛增强子元件中。另外胰岛包含不同的细胞类型，每种细胞类型都有可能参与T2D的转录调控，bulk-seq的方法会掩盖了细胞异质性的特点。所以这里文章采取sci-ATAC-seq (single-cell-combinatorial-indexing ATAC-seq) 的方法，观察到α、β和δ细胞群并识别T2D的细胞特异性的调控信号；另外，他们发现T2D GWAS SNPs显著富集在β细胞，和α或δ细胞与其他细胞类型跨细胞型差异的开放染色质。此外，他们基于U-Net架构还开发了一个深度学习模型用于准确地预测在稀有细胞群体中的开放染色质峰值。 深度学习的代码： https://github.com/ParkerLab/PillowNet. 其他代码在：https://github.com/ParkerLab/islet_sci-ATAC-seq_2019 碎碎念 这篇文章结合scATAC-seq和深度学习的方法探究疾病的转录调控特征的思路和以及文章用到的方法值得学习。 每日文献摘要：第10篇 2019年09月28日 周六 持久确实是一件不易的事！]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
        <tag>deep learning</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scRNA-seq构建表达矩阵]]></title>
    <url>%2F2019%2F09%2F27%2FFri%20Sep%2027%202019%2017%3A19%3A09%20GMT%2B0200%2F</url>
    <content type="text"></content>
      <tags>
        <tag>single cell</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[蛋白质体外液液相分离数据库]]></title>
    <url>%2F2019%2F09%2F26%2FThu%20Sep%2026%202019%2022%3A14%3A22%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 蛋白质体外液液相分离数据库—— LLPSDB 文章信息 题目：LLPSDB: a database of proteins undergoing liquid–liquid phase separation in vitro 杂志：Nucleic Acids Research 时间：August 28, 2019 链接: DOI: 10.1093/nar/gkz778 figure 文章介绍： 之前分享过一篇文章 火起来的相分离是什么, 相分离/相变（Phase separation）描述的是一种细胞里不同成分间相互碰撞、融合形成液滴，从而使一些成分被包裹在液滴内，一些成分被阻隔在液滴外的现象，类似于水油相混，或者可以想象成下雨天伞上的雨滴逐渐滴落的过程。这种现象在液体之间是常见的，但是，2009年，Brangwynne和Hyman关于线虫P颗粒的研究，发现P颗粒（一种蛋白质）并非像我们通常认为的是一种固体，而是像液滴一样，相互碰撞融合，剧烈摇晃后会分散成很小的液滴，而后又很快地融合形成大液滴。之后科学家发现细胞内的许多无膜细胞器——核仁、Cajal bodies、stress granules、miRISC，及突触的细胞骨架——都是特定的蛋白质/RNA的相变。 相分离/相变（Phase separation，Phase Transition）是目前比较火的一个研究领域，已有的研究表明相分离在细胞中普遍存在，与基因组的组装、转录调控可能密切相关，相分离的失调可能是一些疾病（如神经/肌肉退行性疾病）发生的病因，相关领域的科学家也开始通过相分离这个视角重新审视相关疾病，通过干扰异常“相分离”来达到治疗相关疾病的目的。 刚刚明白过相分离是什么，这里已经有人整理出了液液相分离体外蛋白质数据库（(LLPS,Liquid-liquid phase separation)—— LLPSDB 该数据库提供全面、精心收集的与LLPS有关的蛋白质，以及相应的体外实验条件。LLPSDB 目前开放的版本包含1182个条目，273个独立蛋白和2394个特定条件。数据库提供多种数据，包括生物分子信息（蛋白质序列、蛋白质修饰、核酸等）、特定相分离信息（实验条件、相行为描述等）和综合注释。LLPSDB 是第一个专门为LLPS相关蛋白设计的数据库。它为探索蛋白质序列与相变行为之间的关系提供了大量有价值的资源，并将促进相分离预处理方法的发展，为进一步全面了解LLPS在细胞功能中的作用以及相关疾病提供更多的视角。 LLPSDB网址: http://bio-comp.ucas.ac.cn/llpsdb http://bio-comp.org.cn/llpsdb 每日文献摘要：第9篇 2019年09月27日 周五]]></content>
      <tags>
        <tag>database</tag>
        <tag>相分离</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[摘要-单细胞多组学揭示混合表型急性白血病的恶性调控特征]]></title>
    <url>%2F2019%2F09%2F26%2FThu%20Sep%2026%202019%2022%3A12%3A36%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 单细胞多组学联合分析急性白血病的恶性调控特征 文章信息 题目：A single cell framework for multi-omic analysis of disease identifies malignant regulatory signatures in mixed phenotype acute leukemia 杂志：bioRxiv 时间：Jul. 9, 2019 链接: DOI: http://dx.doi.org/10.1101/696328 figure 文章介绍： 单细胞转录组和表观组的整合方法示例，通过比较正常样本和疾病样本转录组和表观组的差异，鉴定调控疾病发生特征。这里以混合表型急性白血病（mixed phenotype acute leukemia，MPAL)为例。首先从健康的外周血和骨髓单个核细胞建立造血发育的免疫表型、转录组和表观遗传学单细胞图。同时在一组混合表型急性白血病（MPAL）临床样本中，从单个细胞中鉴定出癌症特异性转录和染色质特征。测序方法包括droplet-based CITE-seq (single-cell antibody derived tag and RNA sequencing) 和 scATAC-seq (single-cell chromatin accessibility profiling),以及scRNA-seq和scADT-seq（antibody derived tag sequencing） 碎碎念 借助技术和方法的创新，William J. Greenleaf1对造血系统的正常发育和异常疾病的研究可真多。 每日文献摘要：第8篇 2019年09月27日 周五]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[摘要-揭示RNA相关染色质构象的方法——HiChIRP]]></title>
    <url>%2F2019%2F09%2F26%2FThu%20Sep%2026%202019%2022%3A09%3A30%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 研究RNA与染色质构象相互作用的方法 文章信息 题目：HiChIRP reveals RNA-associated chromosome conformation 杂志：Nature Method 时间：2019 June 链接: DOI:10.1038/s41592-019-0407-x figure 文章介绍： lncRNA作用方式多样，其中有许多lncRNA可以利用它们的模块化结构域结合蛋白质、DNA或其他RNA，使它们能够进行长距离的染色质相互作用。尽管在RNA与染色质相互作用的研究中已取得进展，开发了如GRID-seq、ChAR-seq等方法，但是这些方法只适用于大量的RNA。这里提出的HiChIRP方法是利用靶向技术，只关注感兴趣的RNA与染色质的相互作用。 HiChIRP用RNA纯化（ChIRP）富集的染色质分离代替HiChIP方案中的染色质免疫沉淀步骤来识别RNA相关的染色质contracts。由于ChIRP（和类似的方法）需要生物素化探针捕获RNA，因此我们在染色体构象捕获(3C)期间将azido修饰的核苷酸并入染色质contacts中，并且在生物素化探针富集RNA之后，含叠氮的染色质contacts受到无铜二苯并环辛(DIBO)“点击”化学作用从而共价结合生物素进行后续的contracts富集。 每日文献摘要：第7篇 2019年09月27日 周五]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scRNA-seq最佳实践分析教程]]></title>
    <url>%2F2019%2F09%2F20%2FFri%20Sep%2020%202019%2021%3A04%3A29%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 scRNA-seq目前最佳实践分析教程 文章信息 题目：Current best practices in single-cell RNA-seq analysis: a tutorial 杂志：Molecular systems biology 时间：Jul. 13, 2019 链接: doi: http://dx.doi.org/10.1101/701680 figure 文章介绍 这篇文章通过对单细胞方法的总结，提出了一个目前最佳的实践分析流程，代码在https://github.com/theislab/single-cell-tutorial。 单细胞上游分析：raw data 经过处理得到Count 矩阵，然后进行质量控制，标准化，数据矫正，特征选择和可视化 单细胞下游分析：聚类，marker基因的鉴定，注释，轨迹预测，差异基因，基因调控网络，模块组成等 常见平台： 命令行平台： Scater Seurat Scanpy 图形用户交互平台： Granatum ASAP FASTGenmics 常用的方法工具： Scater: https://bioconductor.org/packages/release/bioc/vignettes/scater/inst/doc/vignette-intro.html Seurat:https://satijalab.org/seurat/vignettes.html Scanpy: https://scanpy.readthedocs.io/en/stable/tutorials.html 教程： Analysis of single-cell RNA-seq data with R and Bioconductor https://github.com/drisso/bioc2016singlecell Analysis of single cell RNA-seq data https://scrnaseq-course.cog.sanger.ac.uk/website/index.html Current best-practices in single-cell RNA-seq: a tutorial https://github.com/theislab/single-cell-tutorial 碎碎念 方法更新太快，这里推荐的最佳流程不一定在任何时候都适合，还是要根据目的和具体情况选择 每日文献摘要：第6篇 2019年09月20日 周五]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[摘要-单细胞空间转录组整合分析和可视化流程_Giotto]]></title>
    <url>%2F2019%2F09%2F20%2FFri%20Sep%2020%202019%2014%3A23%3A51%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 单细胞空间转录组分析和可视化流程 文章信息 题目：Giotto, a pipeline for integrative analysis and visualization of single-cell spatial transcriptomic data 杂志：bioRxiv 时间：Jul. 13, 2019 链接: doi: http://dx.doi.org/10.1101/701680 figure 文章介绍： 空间转录组技术有助于研究细胞与其原生的微环境的相互作用，对于理解组织中细胞的身份和功能至关重要。2016年，来自瑞典卡罗琳斯卡研究所和皇家理工学院等机构的研究人员首先开发出空间转录组学（spatial transcriptomics）的高分辨率方法（Visualization and analysis of gene expression in tissue sections by spatial transcriptomics ）。2017年，景乃禾研究员和彭广敦研究员研发的空间转录组学技术——Geo-seq发表在《Nature Protocols》。 Geo-seq技术是通过整合与优化单细胞测序和激光显微切割，构建的一种能够获得少量细胞转录组信息、同时保留细胞原有空间位置信息的测序方法。该技术通过激光显微切割可以直观地在组织上直接捕获细胞，每个获取的样本（此技术可以获取低至5个细胞）都保留了位置信息，然后与单细胞转录组测序技术结合，从而完成了高效率、高分辨率的空间转录组分析。 空间转录组学的技术伴随着单细胞技术不断发展，相关分析工具也被相继开发，这篇文章介绍的是对单细胞空间转录组数据进行整合分析和可视化的流程——Giotto. Giotto包括两个部分，第一部分是分析空间单细胞转录组数据的详细流程，第二部分是空间单细胞转录组数据的可视化浏览。 分析部分需要的输入数据是gene-by-cell count matrix和每个细胞的空间坐标。分析的内容包括单细胞的常规分析，如：数据预处理、特征选择、降维、聚类等。最重要的是整合了基因表达和空间位置信息。 可视化部分提供了交互的工作环境，既可以探索分析结果，也可以可视化其他信息如细胞形态、转录本位置等。 使用教程：http://spatial.rc.fas.harvard.edu/giotto-viewer/tutorial.html 碎碎念 空间转录组结合单细胞技术是一个新的热点研究方向 每日文献摘要：第5篇 2019年08月28日 周三]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>spatial transcriptomics</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[肿瘤基质边界的酸性微环境与肿瘤迁徙]]></title>
    <url>%2F2019%2F08%2F30%2FFri%20Aug%2030%202019%2001%3A04%3A27%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 酸性环境改变转录组的变化影响肿瘤的恶性发展 文章信息 题目：Acidification of Tumor at Stromal Boundaries Drives Transcriptome Alterations Associated with Aggressive Phenotypes 杂志：Cancer research 时间：April 15, 2019 链接: DOI: 10.1158/0008-5472.CAN-18-1604 figure 文章介绍： 肿瘤微环境的3大特征： 异质性 缺氧 酸性 异质性我们听到的报道可能很多，肿瘤微环境不是仅仅有肿瘤细胞组成，还包括免疫细胞、基质细胞等各种成分。 缺氧我们可能也不难理解，肿瘤细胞的快速繁殖使肿瘤微环境中的血管化异常以及血液供应的异常，导致缺氧的环境。 酸性环境如果是做肿瘤代谢的肯定不会陌生，因为著名的瓦博格效应，即大家广泛认同的肿瘤酸性环境产生的原因，认为肿瘤在无氧环境中的糖酵解产生大量乳酸，导致了肿瘤的酸性环境。 酸性环境对肿瘤有什么影响？ 常见的研究有：酸性环境影响肿瘤的恶性发展、基因组和表观组的变化、肿瘤的转移、药物的抵抗性等。 这篇文章介绍的是酸性环境影响基因的表达以及可变剪接，进而影响肿瘤的恶性发展。 每日文献摘要：第4篇 2019年08月27日 周二]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scATAC的一篇经典文献-研究人细胞发育和肿瘤内T细胞耗竭]]></title>
    <url>%2F2019%2F08%2F26%2FMon%20Aug%2026%202019%2011%3A45%3A59%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 学习scATAC-seq的必读文献 文章信息 题目：Massively parallel single-cell chromatin landscapes of human immune cell development and intratumoral T cell exhaustion 杂志：Nature biotechnology 时间：August, 2019 链接: https://www.nature.com/articles/s41587-019-0206-z figure 文章介绍： 利用商业化10X Genomics平台进行scATAC-seq测序，同时研究健康人的血液细胞发育和肿瘤内T细胞的耗竭。共得到200,000个单细胞的染色质可及性图谱。 在血液细胞发育中的应用，得到的结果包括： 鉴定到细胞特异的cis- 和trans调控元件 疾病相关的enhancer活动 细胞分化发育轨迹 在肿瘤基底细胞中的应用，结果包括： 构建了肿瘤微环境中的基底细胞、恶性细胞和免疫细胞的调控网络 发现一些染色质调控因子或许可作为免疫治疗的靶标 碎碎念 William J. Greenleaf 和 Howard Y. Chang合作的又一篇巨作文章，值得细细解读，一是学习scATAC-seq的分析方法，重现文章的部分分析；二是总结文章思路，思考如何利用该数据资源做进一步挖掘，对其他课题的借鉴意义 数据资源：scATAC-seq处理前的数据和处理后的数据都提供在10X平台 https://support.10xgenomics.com/single-cell-atac/datasets. 代码：https://github.com/GreenleafLab/10x-scATAC-2019. 每日文献摘要：第4篇 2019年08月27日 周二]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[awk基本命令使用]]></title>
    <url>%2F2019%2F08%2F25%2FSun%20Aug%2025%202019%2023%3A49%3A13%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[awk是一个处理文本文件的程序，也是一门强大的编程语言。awk是把文件逐行的读入，以空格为默认分隔符将每行分割，切开的部分再进行各种分析处理，非常适用于每行格式相同的文本文件。 示例数据： DEseq2得到的差异表达矩阵(dfdata)作为示例数据： 包括9列数据，分别为id, baseMeanA, baseMeanB,baseMean, log2FoldChange,lfcSE,stat,pvalue,padj 基本用法 输出文件内容 1234# 格式$ awk '&#123;动作&#125;' 文件名# 示例$ head dfdata | awk '&#123;print $0&#125;' 将输出差异基因结构的前5行 提取基因ID，log2FoldChange, pvalue三列信息 awk会根据空格和制表符等分隔符，将每一行分成若干字段，依次用$1、$2、$3代表第一个字段、第二个字段、第三个字段等，$1, $2可以理解为被分隔符分割的第一列，第二列 -F ：输入分隔符，这里是\t 12# 将输出差异基因前10行的第1、5和8列，默认是以空格分割，所以输出结果head dfdata | awk -F '\t' '&#123;print $1,$5,$8&#125;' OFS: 输出分隔符 12# 以tab分割输出head dfdata | awk -F '\t' '&#123;print $1,$5,$8&#125;' OFS='\t' 其他变量 FILENAME：当前文件名 FS：字段分隔符，默认是空格和制表符。 RS：行分隔符，用于分割每一行，默认是换行符。 OFS：输出字段的分隔符，用于打印时分隔字段，默认为空格。 ORS：输出记录的分隔符，用于打印时分隔记录，默认为换行符。 OFMT：数字输出的格式，默认为％.6g 条件1awk '条件 &#123;动作&#125;' 文件名 可以结合正则表达式规则使用 输出特定基因ID的行 12awk -F '\t' '/id/ &#123;print $0&#125;' dfdata# id baseMeanA baseMeanB baseMean log2FoldChange lfcSE stat pvalue padj if语句判断语句和执行语句必须用在{}中，且判断语句用()扩起来 1awk '&#123;if () action; else action&#125;' file 输出 |log2FoldChange | &gt; 1且pvalue &lt; 0.05的所有信息 符合|log2FoldChange | &gt; 1且pvalue &lt; 0.05的基因有多少个 1awk '&#123;if ($5&gt;1 || $5 &lt; -1 &amp;&amp; $8&lt;0.05 ) print $0&#125;' dfdata | wc 且同时输出header 12awk '/id/ &#123;print $0&#125;; &#123;if ($5&gt;1 || $5 &lt; -1 &amp;&amp; $8&lt;0.05 ) print $0&#125;' dfdata | less -S# 两个完整语句间用分号分割 函数 tolower()：字符转为小写。 length()：返回字符串长度。 substr()：返回子字符串。 sin()：正弦。 cos()：余弦。 sqrt()：平方根。 rand()：随机数 1234awk '/id/ &#123;print $0&#125; dfdata# id baseMeanA baseMeanB baseMean log2FoldChange lfcSE stat pvalue padjawk '/id/ &#123;print toupper($0)&#125;' rawcount # ID BASEMEANA BASEMEANB BASEMEAN LOG2FOLDCHANGE LFCSE STAT PVALUE PADJ]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>awk</tag>
        <tag>text processing</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scRNA-seq数据预处理]]></title>
    <url>%2F2019%2F08%2F25%2FSun%20Aug%2025%202019%2020%3A29%3A04%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[scRNA-seq的上游处理与bulk RNA-seq有相似的地方，也有不同的地方。相似的地方如：对原始数据的质控检测、去除低质量的reads、adpter、比对。不同的地方如scRNA-seq数据有的需要考虑Demultiplexing。而且scRNA-seq根据采用的不同的protocols，产生的数据和处理方法也有不同。 这里提供的练习数据是SMART-seq2建库，SMRT-seq2建库的测序数据上游分析与bulk RNA-seq相似，如这节课内容中的分析方法： FastQC 对原始数据进行质控检测 Trim Galore 质控 STAR或Kallisto比对 练习数据mouse ESC的单细胞数据(Kolodziejczyk et al. 2015)，数据下载位置：https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-2600/samples/ 直接点击下载按钮即可下载fastq的数据。 ERR522959_1.fastq ERR522959_2.fastq 质控 FastQC 12mkdir fastqc_resultsfastqc -o fastqc_results Share/ERR522959_1.fastq Share/ERR522959_2.fastq Trim galore 是一个自动识别adpter的质控软件 12mkdir fastqc_trimmed_resultstrim_galore --nextera -o fastqc_trimmed_results Share/ERR522959_1.fastq Share/ERR522959_2.fastq Demultiplexing不同的protocol和pipeline决定了demultiplexing的方法也不同，最灵活的方法是zUMI,可以用于大多的demultiplexing和基于UMI的protocols。SMARTseq2直接提供的是已经demultiplexing的数据。 如何理解demultiplexing？ demultiplexing的过程即识别并移除cell barcode序列。 scRNA-seq质控中需要考虑的另一个因素是不包含细胞或包含两个细胞的droplets。 STAR比对STAR比对的优点有考虑到了剪切体，输出文件内容丰富，（可以进行下游融合基因的分析，bulk seq可以）缺点是耗费计算资源。 比对的步骤首先需要构建参考基因组或转录组的index文件，由于考虑到练习运行时间，这里提供的代码是比对到参考转录本 Make index 123mkdir indicesmkdir indices/STARSTAR --runThreadN 4 --runMode genomeGenerate --genomeDir indices/STAR --genomeFastaFiles Share/2000_reference.transcripts.fa alingment 1234mkdir resultsmkdir results/STARSTAR --runThreadN 4 --genomeDir indices/STAR --readFilesIn Share/ERR522959_1.fastq Share/ERR522959_2.fastq --outFileNamePrefix results/STAR/ Kallisto 比对（Pseudo-Alignment）Kallisto比对也称为pseudo-alignment（假比对）,即它的比对方法和STAR不同，不是将完整reads比对到参考转录本上，而是将kmer(特定长度的序列)比对到参考转录本上。 k-mers和reads相比的特点是： 快 处理测序error的能力强于传统的比对工具 与STAR不同的另一点Kallisto是比对到转录本的 Kallisto’s pseudo mode 专门为scRNA-seq设计的， index 12mkdir indices/Kallistokallisto index -i indices/Kallisto/transcripts.idx Share/2000_reference.transcripts.fa Kallisto Pseudo-Alignment 12mkdir results/Kallistokallisto pseudo -i indices/Kallisto/transcripts.idx -o results/Kallisto -b batch.txt]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[摘要-scRNAseq探究健康人胰岛和T2D的转录组图谱]]></title>
    <url>%2F2019%2F08%2F25%2FSun%20Aug%2025%202019%2009%3A15%3A35%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 健康人胰岛和T2D的单细胞转录组图谱 文章信息 题目：Single-Cell Transcriptome Profiling of Human Pancreatic Islets in Health and Type 2 Diabetes 杂志：Cell Metabolism 时间：October 11, 2016 链接: http://dx.doi.org/10.1016/j.cmet.2016.08.020 figure 文章介绍： 利用单细胞RNA技术探究健康人胰岛和T2D的转录组图谱。数据来源于6个健康人和4个T2D病人，利用SMRT2-seq的方法得到2,209个单细胞。主要分析包括对1）细胞分群；2）鉴定alpha 和beta细胞亚群 ；3）肥胖或T2D相关基因与BMI的关联；4）T2D的基因变异 碎碎念 与16年发表在Cell systerm上的文章相比，这篇文章的分析相对丰富些，一是数据即包括健康人胰腺又包括糖尿病，二是不仅对细胞进行了分群和标记物的鉴定，还将T2D基因和肥胖基因与BMI关联，以及通过与正常组比较发现了T2D的基因变异。将健康和疾病的对照研究，凸显了鉴定的靶标具有重要的临床意义。 Rickard Sandberg实验室发表的文章，SMRT-seq2的开发者，分析方法可以学习 数据资源：E-MTAB-5061， E-MTAB-5060 每日文献摘要：第3篇 2019年08月26日 周一]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[摘要-scRNA-seq探究人胰腺转录组图谱]]></title>
    <url>%2F2019%2F08%2F25%2FSun%20Aug%2025%202019%2008%3A46%3A46%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 人胰腺单细胞转录组图谱 文章信息 题目：A Single-Cell Transcriptome Atlas of the Human Pancreas 杂志：Cell Systems 时间：October 26, 2016 链接: http://dx.doi.org/10.1016/j.cels.2016.09.002 figure 文章介绍： 利用scRNA-seq对人胰腺的组成进行分群以及鉴定特定细胞群的标记基因。样本来自4个过亡的捐赠者，scRNA-seq采用CEL-Seq2 protocol结合FACS分选和机器学技术。所做的分析包括两个方面，首先利用StemID算法对细胞分群，然后鉴定特定细胞亚群的标记基因和转录因子。主要结果有：鉴定到CD24和TM4SF4可以作为alpha 和beta 细胞的标记基因。 碎碎念 只进行了分群和细胞标记基因的鉴定，所做的分析很少，可以利用该数据进行进一步的挖掘 数据资源：GSE85241提供了表达矩阵 每日文献摘要：第2篇 2019年08月25日 周日]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[摘要-scRNA-seq揭示胰腺导管癌的肿瘤内部抑制性和恶性发展过程]]></title>
    <url>%2F2019%2F08%2F24%2FSat%20Aug%2024%202019%2023%3A26%3A26%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[一句话评价 胰腺导管癌(PDAC)异质性和恶性发展的单细胞研究 文章信息 题目：Single-cell RNA-seq highlights intra-tumoral heterogeneity and malignant progression in pancreatic ductal adenocarcinoma 杂志：Cell Research 时间：04 July 2019 链接: https://www.nature.com/articles/s41422-019-0195-y figure 文章介绍： 利用单细胞RNA-seq技术对胰腺导管癌的肿瘤内部异质性和恶性发展进行探究。样本量包括24个肿瘤样本和11个对照样本，利用droplet建库的方法，得到57,530个细胞。主要分析包括：首先对细胞进行1）分群，鉴定到10个群，其中有2个导管细胞型群分别具有异常和恶性基因表达特征，然后又对两个导管细胞群进行亚群分析。2）细胞轨迹分析（拟时间分析）揭示了PDAC恶性发展过程中的相关的通路和转录因子。3）免疫浸润分析：结合TCGA胰腺癌相关的公共数据发现了肿瘤浸润T细胞失活状态相关的基因，为肿瘤免疫治疗提供了参考靶点。 碎碎念 细胞分群是单细胞数据分析的常规步骤 拟时间分析这里用于探究肿瘤恶性程度的发展值得借鉴 另外如何从拟时间分析得到了相关的转录因子呢？（细看原文） 最后与肿瘤免疫扯上关系，升华了研究的价值和意义 每日文献摘要：第1篇 2019年08月24日 周六]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scRNA-seq基础知识扫盲篇]]></title>
    <url>%2F2019%2F08%2F24%2FSat%20Aug%2024%202019%2000%3A29%3A27%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[Bulk RNA-seq与scRNA-seq的优势和局限性Bulk RNA-seq 20世纪末即芯片技术后的又一个突破性技术，之后被广泛应用，逐渐替代芯片 评估测量一个大群体内所有细胞的平均表达量水平 适用于比较转录组学，如不同物种相同组织的不同样本间的转录表达差异比较；或者用于评估疾病等表达量特征 不适用于研究系统的异质性，如早期胚胎发育、复杂组织（脑） 不能提供基因表达量的随机特征 scRNA-seq 2009年出现 (Tang et al. 2009) 伴随着新的protocols和测序成本的降低，2014年左右被广泛推广 适用于检测一群细胞的表达量分布水平；细胞特异性变化等（如鉴定细胞类型、细胞应激的异质性，基因表达的随机性、推测细胞间的基因调控网络 数据集从102～ 10 8细胞，且逐年增长 目前的使用的protocols：SMART-seq2 (Picelli et al. 2013), CELL-seq (Hashimshony et al. 2012) and Drop-seq (Macosko et al. 2015) 商业平台：Fluidigm C1, Wafergen ICELL8 and the 10X Genomics Chromium Bulk RNA-seq的一些方法也适合于scRNA-seq，大多情况需要新的方法 单细胞RNA测序流程 分析方法scRNA-seq上游分析方法与bulk 相同，对测序数据进行质控、比对、比对结果的质控（黄色部分），接着是细胞质控、标准化，这一部分与bulk有相同的也有不同的地方，下游分析就是解释实际生物学问题，包括差异分析、聚类、网络分析等，所用的方法一般都是scRNA特有的算法。 scRNA-seq 分析的综述：(Stegle, Teichmann, and Marioni 2015) Falco ：云端处理scRNA-seq分析. SCONE (Single-Cell Overview of Normalized Expression), scRNA-seq质控和标准化的R包 Seurat ：scRNA-seq分析的常用的四大R包之一，包括对数据的质控、分析等 ASAP (Automated Single-cell Analysis Pipeline) ：scRNA-seq交互分析的网络平台 挑战bulk RNA-seq与scRNA-seq最主要的不同是scRNA-seq的每个测序文库代表一个细胞而不是一群细胞。文库的不同来源于： 扩增 (达到1 million倍) Gene ‘dropouts’：指一个细胞在一个细胞中是中等表达水平，但是在另一个细胞中没有被检测到 上面的差异主要来自于RNA的起始量很低，因此提高转录本的捕获率、降低扩增偏差是一个热门的研究方向。 实验方法发展新的scRNA-seq protocol也是一个热门领域，目前已有的方法包括： CEL-seq (Hashimshony et al. 2012) CEL-seq2 (Hashimshony et al. 2016) Drop-seq (Macosko et al. 2015) InDrop-seq (Klein et al. 2015) MARS-seq (Jaitin et al. 2014) SCRB-seq (Soumillon et al. 2014) Seq-well (Gierahn et al. 2017) Smart-seq (Picelli et al. 2014) Smart-seq2 (Picelli et al. 2014) SMARTer STRT-seq (Islam et al. 2013) 不同的方法实现方式不同，其中定量和捕获是最重要的两个方面 定量有两种类型： 全长（full length): 致力于实现每个转录本一致的read coverage 理论上的一致的coverage很难实现，经常会存在偏差 基于标签(tag-based): 只捕获RNA的5‘ 端或3’端， 可以和UMI(unique molecular identifiers )结合提高定量准确性 由于只捕获单端RNA可能会降低比对率 很难鉴定isoforms 捕获： 捕获策略决定了测序通量，以及得到细胞的方式和其他信息。常用的捕获策略有： microwell-based 使用吸液管或激光捕获等方法分离细胞，并将其放置在微流体管中。该方法的优缺点是： 优点是：可以与FACS分选结合使用，从而可以根据细胞表面marker筛选感兴趣的特定类型的细胞，同时在分选时可以拍摄细胞。图像可以用于识别受损细胞或dublets。 缺点是：通量低、耗时费工 microfluidic-based 如Fluidigm’s C1，提供了一个更为集成的系统，用于捕捉细胞和进行建库准备所需的反应。 优点是：通量比microwell-based 高 缺点是：捕获效率低，只有10%的细胞可以被捕获，因此不适用于细胞类型罕见或者输入细胞量少的研究；另外芯片价格相对贵 droplet- based 将每一个细胞封装在一个毫微升的液滴中，并加上一个珠子（bead), bead中含有建库所需的酶和唯一的条形码（barcode)，条形码可以将reads来自于哪个细胞关联。因此，所有的液滴都可以汇集起来，排序在一起，然后根据条形码将reads分配给原始细胞。 优点是：通量最高 缺点是：测序成本、低覆盖率 (Ziegenhain et al. 2017) 如何选择合适的平台如何选择合适的protocols，只有根据研究的生物学问题。如果感兴趣一个组织的组成，那么droplet-based的方法可以得到大量的细胞，或许是最适合的；如果研究的是罕见细胞，并且知道细胞marker,那么结合FACS富集，测少量的细胞也可以实现目的。 全长转录本适合于对不同亚型感兴趣的研究，tagged的protocols可以和UMI结合，适用于基因水平的定量。 内容来自Hemberg lab’s 单细胞课程学习笔记 ： Introduction to single-cell RNA-seq： https://scrnaseq-course.cog.sanger.ac.uk/website/introduction-to-single-cell-rna-seq.html]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>single cell</tag>
        <tag>scRNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[使用BETA整合分析ATAC-seq/ChIP-seq和RNA-seq数据]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2013%3A15%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[BETA 网址: http://cistrome.dfci.harvard.edu/BETA/tutorial.html 功能介绍 数据准备： peak bed file 123456# chr str end$head mep_ebDfpeak_deseq2_sig.bedchr8 12050808 12052743chr9 66492999 66494729chr4 125632449 125634758chr4 10182030 10183501 df expression file 12345678# symbol log2FC pvalue$head mep_eb_dfexpreMELK 6.23721078699297 5.47784458574045e-218RAD51AP1 4.17541170218602 2.86774188064759e-217HMGN5 5.98876520905166 7.49359285750074e-216ZWILCH 3.74468061674801 2.42032701371558e-204HNRNPA2B1 2.76252025379004 3.05116228100538e-190HLA-DRA -5.19413815362273 2.27680965999626e-188 软件下载安装1234wget http://cistrome.dfci.harvard.edu/BETA/src/BETA_1.0.7.zipunzip BETA_1.0.7.zipcd BETA_1.0.7/sudo python setup.py install 使用BETA BasicBETA Basic 预测调控因子的功能（激活或抑制）和靶基因1BETA basic –p 3656_peaks.bed –e AR_expr.xls –k LIM –g hg19 --da500 –n basic 参数：-p ： peak bed file (必需参数）-e：df expression file (必需参数）-k：表达量文件格式是limma的标准格式（根据实际情况修改）-g：基因组文件，如hg19,hg38,mm10,mm9-n：输出文件前缀，BETA默认是NA-da：选择显著性变化（上调和下调的）表达数据（根据实际情况修改） 其他格式(不是limma和cuffdif标准格式）的差异表达文件格式： 需设置参数--info, geneID如果是smbol需要设置--gname2 BETA PlusBETA Plus 预测调控因子的功能（激活或抑制）和靶基因，以及靶向区域的motif分析 1BETA plus –p 3656_peaks.bed –e AR_expr.xls –k LIM –g hg19 --gs hg19.fa --bl 参数： --gs : motif分析需要的参数, 基因组fasta格式--bl :可选参数，当考虑boundary（如CTCF）时需要的参数 BETA MinusBETA Minus 只根据peak bed数据基于调控潜能值预测靶基因1BETA minus -p 3656_peaks.bed --bl -g hg19 其他可选参数-n：结果文件的名字-o:输出文件路径--gname2：geneID如果是smbol需要设置--gname2--info：其他格式(不是limma和cuffdif标准格式）的差异表达文件格式：需设置参数--info,--pn:peak 数目，默认是10，000-d DISTANCE,--distance 距离TSS的距离. DEFAULT=100000 (100kb)--df DIFF_FDR : 输入0-1的数值，表示统计的阈值，如FDR等，默认是1.--da DIFF_AMOUNT; 取显著表达的基因，0-1表示比例，大于1表示个数。如2000，表示去top 2000个上调和下调的差异基因；0.5表示取50%上调和下调的基因，默认是0.5。-c CUTOFF, --cutoff： 0~1的一个阈值。默认是1e-3。-r REFERENCE, --reference： 当参考基因组不是hg19,或mm9时使用此参数。--bl BOUNDARY :LIMIT Boolean Value. Whether or not use CTCF boundary to get a peak’s associated gene, DEFAULT=FALSE-bf BOUNDARYFILE : Some BED format boundary file, use this only when You set –bl and the genome is neither hg19 nor mm9 相关资料文章Wang, S., Sun, H., Ma, J., Zang, C., Wang, C., Wang, J., … &amp; Liu, X. S. (2013). Target analysis by integration of transcriptome and ChIP-seq data with BETA. Nature protocols, 8(12), 2502-2515.PMID: 24263090网址： http://cistrome.org/BETA/index.html 使用代码1/software/biosoft/software/python/python2.7/bin/BETA plus -P mep_ebDfpeak_deseq2_sig.bed --info -e mep_eb_dfexpre --gname2 -g hg 19 --gs hg19.fa --bl 几点疑问BETA最初的设计主要是用于ChIP-Seq和RNA-seq的整合分析，最终可以预测特定一个转录因子的靶基因，以及这些基因是激活还是抑制的功能。但是对于ATAC-seq，它得到的信号整个基因组范围转录因子的信号，那么与转录组整合分析得到的结果怎么解释？只能知道一些基因的功能是激活的或抑制的，但是并不能知道这些基因是哪些转录因子的靶基因。所以BETA是否适合ATAC-seq和与RNA-seq的整合分析？如果可以，整合分析的结果能得到哪些有价值的信息？]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[转录因子足迹分析+启动子处染色质可及性与基因表达不一定成正相关]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2013%3A10%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[题目：Identification of transcription factorbinding sites using ATAC-seqDOI: 10.1186/s13059-019-1642-2杂志/日期：Genome Biol. , 26 Feb 2019关键词：ATAC-seq; Computational footprinting 日期：2019年2月17日——2019-Week8 主要内容：这篇文章考虑到ATAC-seq实验的人工误差提出了第一个转录因子足迹的分析方法——HINT-ATAC，使用位置依赖模型探究转座酶的裂解偏好，观察到由局部核小体结构决定的转录因子结合位点周围的特异剪接模式，因此，HINT-ATAC可以更好的预测转录因子的结合位点。 题目：Combined analysis of dissimilar promoter accessibility and gene expression profiles identifies tissue-specific genes and actively repressed networksDOI: https://doi.org/10.1186/s13072-019-0260-2杂志/日期：Epigenetics &amp; Chromatin, 12 Feb 2019关键词：ATAC-seq; promoter 日期：2019年2月17日——2019-Week8 主要内容：许多研究都报道了启动子处的染色质可及性与基因表达成正相关，而这篇文章发现了一个不一样的趋势。他们发现相关性最强（高表达，强的染色质可及性）的可能与管家基因功能相关。组织特异性基因表达量高，但是染色质可及性仅为中低水平的coverage。此外，他们预测到中、低表达的、但是有高启动子覆盖的基因被积极抑制。]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[scATAC-seq分析工具]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2013%3A07%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[题目：Destin: toolkit for single-cell analysis of chromatin accessibility DOI: https://doi.org/10.1093/bioinformatics/btz141杂志/日期： Bioinformatics, 01 March 2019关键词： scATAC-seq，GWAS分类：「工具」日期：2019年2月10日——2019-Week7 主要内容：「Destin」用于scATAC-seq分析的一个R工具包，其中的一个亮点是分析GWAS结果是否与特定细胞类型集群中染色质可及性的增加有关，这里他们采用的是最初用于scRNA -seq表达的两种方法:ECWE和MAGMA。除此之外还包括： 从bam文件获取实验信息 peaks的注释区域 质控 确定分群数量 差异可及性染色质（其中输入文件是peaks，cell的bam文件） 总结「Destin」用于sc-ATAC分析的一个R工具包，包括分群，与gwas关联，差异peaks分析等。 相关资料 github : https://github.com/urrutiag/destin 题目： A rapid and robust method for single cell chromatin accessibility profiling DOI: https://www.nature.com/articles/s41467-018-07771-0杂志/日期： Nature Communications, 17 December 2018关键词： scATAC-seq，分类：「工具」日期：2019年2月10日——2019-Week7 主要内容：plate-based的scATAC-seq方法，结合了前期bulk Tn5单核分选标签。 相关资料：代码：https://github.com/dbrg77/plate_scATAC-seq.数据：bulk ATAC 和scATAC-seq :http://genome-euro.ucsc.edu/cgi-bin/hgTracks?hgS_doOtherUser=submit&amp;hgS_otherUserName=dbrg77&amp;hgS_otherUserSessionName=mSpleen_scATAC_cluster.]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>single cell</tag>
        <tag>文献摘要</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[esATAC_一个ATAC-seq分析的R包]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2013%3A03%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[日期：2019年1月13日——2019-Week2分类：「工具」题目：esATAC: An Easy-to-use Systematic pipeline for ATAC-seq data analysisDOI: 10.1093/bioinformatics/bty141杂志：Bioinformatics，2018 Aug关键词： ATAC; chromatin accessibility; transcription factor; regulatory network 介绍之前介绍过中科大Kun Qu老师实验室开发的用于bulk ATAC-seq分析的工具包 —— 「ATAC-pipe」，虽然个人并不推荐依赖使用这种打包工具包。但是他们的分析方法和原理还是值得了解和学习的。这里再介绍一个ATAC-seq分析的工具包——esATAC，是由清华大学Xiaowo Wang老师实验室开发的一个R/Bioconductor包，它的功能包括如下几方面： 原始数据的质控和比对 peak calling 富集分析 转录因子足迹分析 具体分析方法参考vignettes:https://www.bioconductor.org/packages/release/bioc/vignettes/esATAC/inst/doc/esATAC-Introduction.html 数据分析流程 初始数据：可以直接处理fastq格式的测序数据 质控：多种质控方法，包括测序质量，read length分布等 去接头：AdapterRemoval 比对：Bowtie2 鉴定开放染色质peak：F-seq？？仔细了解(Boyle, et al., 2008,Koohy, et al., 2014) peak的注释：ChIPseeker包 TF分析：结合JASPAR数据库 适用物种：人和鼠 单细胞RNA-seq、ATAC-seq分析教程、工具大集锦: https://github.com/seandavi/awesome-single-cell]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ATAC-pipe_ATAC-seq分析的工具包]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2013%3A01%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[日期：2019年1月6日——2019-Week1分类：「工具」题目：ATAC-pipe: general analysis of genome-wide chromatin accessibilityDOI: 10.1093/bib/bby056杂志：Briefings in Bioinformatics关键词： ATAC; chromatin accessibility; transcription factor; regulatory network 摘要ATAC-pipe是中科大Kun Qu实验室开发的一个打包软件包，用于分析bulk ATAC-Seq。主要功能包括： 鉴定显著差异的开放染色质区域 motif分析及相关的TFs对转录调控的影响 TF和motif的足迹分析以及核小体占位的可视化 基于相关性的细胞聚类分析 构建TF调控网络，评估TFs和基因间的相互作用 详细用法参考： https://github.com/QuKunLab/ATAC-pipe或者 manual for ATAC-pipe:https://github.com/QuKunLab/ATAC-pipe/blob/master/Manual_for_ATAC-pipe.pdf 材料和方法1. 流程和算法ATAC-pipe是基于其他工具和软件包的，需要在Linux/MAC OS平台安装 requires Bowtie2, Picard, MACS2, HOMER, Python和R的环境，以及相关的参考基因组和DESeq R包。 比对: Bowtie2 去重: Picard peak calling: MACS2 count标准化和差异分析：DESeq 聚类和热图：Cluster 3.0 和 Treeview TF motifs分析: Homer and msCentipede 序列迁移，TSS富集值和分布，V-plot, TF调控网络：他们自己实验室写的代码 2. 与其他工具的比较他们的介绍是「ATAC-pipe功能多，其他工具可能只是包含QC，比对，peak calling等基本步骤，但是ATAC-pipe还包含样本聚类，motif 搜索，足迹验证、核小体占位分析和TF调控网络分析，而且更重要的是可以鉴定显著差异开放染色质区域和这些区域的TF motif富集, 另外所需时间与其他工具相比较少」。（他们介绍的优点了解下即可，其实很多工具都可以实现相同的功能,其他工具的功能和原理也要了解一下） 结果看一下这个流程包可以给出哪些结果 结果1：质控 结果2：相关性和差异peaks分析 结果3：TF 富集分析 结果4：TF motif足迹分析和核小体占位分析 结果5：TF驱动调控网络讨论使用他人打包的工具包有人可能觉得省时方便，但是会有很多限制，不够灵活。而且他们这个工具包本身需要安装很多工具，最终是包装成python模块，使用时是需要有linux和python基础的。他们的分析结果有很多工具和方法可以实现，对于这篇文章也就是了解下他们进行ATAC-seq分析时使用的方法，同时了解下文章中做比较时提到其他工具。 如果想实现个性化和弹性化的分析，还是需要自己了解掌握每一步的分析流程，具体方法可以参考之前的帖子: ATAC-Seq入门加高阶传送门，文末点击可进入交流群https://mp.weixin.qq.com/s/iVMY_0Su278OfWc2r2_brQ 第10篇：ATAC-Seq、ChIP-Seq、RNA-Seq整合分析（内附目录）https://mp.weixin.qq.com/s/7k2GEmPmnkVfmzegpxabQA 给学徒的ATAC-seq数据实战（附上收费视频）https://mp.weixin.qq.com/s/XQITfdnS6Zn6iTBtuladPw 另外记得在去年苏州单细胞会议的海报展示，Kun Qu老师实验室展示了一个用于sc-ATAC分析的工具包APEC（不知道发表没）。APEC的文章已在预印版上发出：https://www.biorxiv.org/content/early/2019/05/23/646331.full.pdf]]></content>
      <categories>
        <category>literature</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>software</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第10篇：ATAC-Seq、ChIP-Seq、RNA-Seq整合分析]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2012%3A57%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[由于基因表达调控机制的复杂性，多种组学数据的整合分析，从不同的层面探究生物问题越来越重要。从RNA-Seq层面，我们可以探究哪些基因具有显著差异，上调或下调；从ChIP-Seq层面，我们可以研究某个特定转录因子的调控作用；从ATAC-Seq我们可以了解到染色质可及性的动态变化，由于染色质的可及性与调控元件或转录因子的结合密切相关，在转录调控中发挥着重要的作用。因此，整合分析可以进一步探究调控某一生物学过程的关键因子（包括顺式调控元件和转录因子），以及哪个转录因子调控了感兴趣的基因，以及感兴趣的转录因子的靶基因等。目前，好像并没有标准化的方法用来整合比较这三种数据。不过在文献中可以看到有很多相同的或不同的思路和方法做整合分析，大家可以在学习交流群中推荐文献，一起解读学习。 下面的内容主要介绍这一节课程中RNA-Seq和ChIP-Seq的整合分析中提到的两种方法：一是直接比较，即首先得到差异基因与ChIP-Seq靶基因的overlap，然后选择一些关键基因比较一下谱图。课程中提到的另一种方法是使用BETA工具：BETA (Binding and Expression Target Analysis)是 Shirley Liu实验室开发的工具，通过整合转录因子或染色质调控因子的ChIP-Seq与差异基因的表达直接预测靶基因，而且有可能发现增强子区的蛋白质的靶基因。BETA有三个功能： 预测转录因子的功能是激活还是抑制 预测转录因子的靶基因 鉴定转录因子的motif以及调控转录因子激活或抑制的其他因子 BETA包括三个命令取决于输入数据格式和想要的输出数据（可以参考嘉因的帖子ChIP-seq和RNA-seq整合分析，BETA最擅长 | 自己分析数据的完美解决方案） BETA basic: 预测转录因子的功能是激活还是抑制，直接检测靶标 BETA plus：BETA basic + 靶标区域的motif分析 BETA minus：只基于结合数据的调控潜能的值预测TF靶基因 工作原理 每个基因的调控潜能值是通过计算基因TSS的指定范围内的所有结合位点来计算的 调控潜能是基因受因子调节的可能性，取决于TSS范围的结合位点数以及与结合位点与TSS之间的距离 BETA minus按照调控潜能值对基因排序来鉴定靶标 BETA basic需要特定格式的差异分析结果和显著性的结果。它使用CDF来判断上调基因和下调基因是否与NON-DE不同，这是用来识别激活和抑制功能。使用调控潜能和差异统计量计算每一个基因的得分排序，该得分排序可以用于识别靶标。参考资料： 哈佛深度NGS数据分析课程，10-Integrating RNA-seq and ChIP-seq 大牛新宠，转录调控研究神器！找关键转录因子、推测转录因子-靶基因关系]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>ChIPseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第9篇：差异peaks分析——DiffBind]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2012%3A50%3A56%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[学习目标 学习用DiffBind流程评估两个样本间的差异结合区域 用PCA评估样本间的关系 评估不同工具得到的差异peaks的一致性 评估差异peaks富集的工具ATAC-Seq下游分析的另一个重点是差异peaks分析。如分析不同的实验条件、多个时间节点、不同的发育时期等的差异区域。鉴定这些差异peaks区域在生物医学研究中也具有重要意义，目前也有多种相关的工具被开发：选择合适的工具需考虑以下几个因素： 所用的软件不需要大量的代码移植，该工具是否被维护和频繁更新。 用户需要提供什么样的输入文件，是否与peaks calling所用工具可以衔接。 信号分布的基础统计模型是什么？是基于泊松分布或更灵活的负二项分布。 一些工具是专门针对特定的ATAC-seq或ChIP-seq 数据（信号类型）设计的，如组蛋白修饰或转录因子（TF）结合。 具体选择哪种工具决定于实验设计，下面的决策树可以帮助缩小你的选择范围。 DiffBindDiffBind是鉴定两个样本间差异结合位点的一个R包。主要用于peak数据集，包括对peaks的重叠和合并的处理，计算peaks重复间隔的测序reads数，并基于结合亲和力鉴定具有统计显著性的差异结合位点。适用的统计模型有DESeq、DESeq2、edgeR。详细内容可参考DiffBind的文档：http://bioconductor.org/packages/release/bioc/vignettes/DiffBind/inst/doc/DiffBind.pdf 使用方法：1. 下载安装DiffBind1234source("https://bioconductor.org/biocLite.R")biocLite("DiffBind")# view documentationbrowseVignettes("DiffBind") 2. 准备输入文件需要准备一个SampleSheet文件，与ChIPQC的方法一样。SampleSheet文件是根据实验设计和数据存储地址等信息创建的一个csv格式文件，包含的表头信息有“SampleID”、 “Tissue”、 “Factor”、 “Condition” 、”Treatment”、”Replicate” 、”bamReads” 、”ControlID”、 “bamControl” “Peaks”、 “PeakCaller”（bam,peak文件分别在比对和call peak的步骤产生）。 3. 差异peaks分析读入文件一旦读入了peaksets，合并函数就找到所有重叠的peaks，并导出一致性的peaksets。12library(DiffBind)dbObj &lt;- dba(sampleSheet="SampleSheet.csv") 亲和结合矩阵计算每个peaks/regions的count信息。先对一致性的peaks数据集进行标准化，然后根据他们的峰值（point of greatest read overlap）再次中心化并修剪一些peaks，最终得到更加标准的peak间隔。使用函数dba.count()，参数bUseSummarizeOverlaps可以得到更加标准的计算流程。 123dbObj &lt;- dba.count(dbObj, bUseSummarizeOverlaps=TRUE)dba.plotPCA(dbObj, attributes=DBA_FACTOR, label=DBA_ID)plot(dbObj) 结果中同时计算了FRiP (质量评估的一个标准，可以参考第5篇：对ATAC-Seq/ChIP-seq的质量评估（二）——ChIPQC)。样本间的聚类:Venn图展示样本间peaks的重合差异分析差异分析是DiffBind的核心功能，默认情况是基于DEseq2, 可以设置参数method=DBA_EDGER选择edgeR，或者设置method=DBA_ALL_METHODS。每种方法都会评估差异结果的p-vaue和FDR。 1234567# Establishing a contrast dbObj &lt;- dba.contrast(dbObj, categories=DBA_FACTOR,minMembers = 2)dbObj &lt;- dba.analyze(dbObj, method=DBA_ALL_METHODS)# summary of resultsdba.show(dbObj, bContrasts=T)# overlapping peaks identified by the two different tools (DESeq2 and edgeR)dba.plotVenn(dbObj,contrast=1,method=DBA_ALL_METHODS) 提取结果 12comp1.edgeR &lt;- dba.report(dbObj, method=DBA_EDGER, contrast = 1, th=1)comp1.deseq &lt;- dba.report(dbObj, method=DBA_DESEQ2, contrast = 1, th=1) 结果文件包含所有位点的基因组坐标，以及差异富集的统计数据包括fold change、p值和FDR。其中Conc的表示read的平均浓度，即对peak 的read counts进行log2标准化 The value columns show the mean read concentration over all the samples (the default calculation uses log2 normalized ChIP read counts with control read counts subtracted) and the mean concentration over the first (Resistant) group and second (Responsive) group. 保存文件 123456# EdgeRout &lt;- as.data.frame(comp1.edgeR)write.table(out, file="results/Nanog_vs_Pou5f1_edgeR.txt", sep="\t", quote=F, col.names = NA)# DESeq2out &lt;- as.data.frame(comp1.deseq)write.table(out, file="results/Nanog_vs_Pou5f1_deseq2.txt", sep="\t", quote=F, col.names = NA) 以bed格式保存显著性的差异结果123456789101112# Create bed files for each keeping only significant peaks (p &lt; 0.05)# EdgeRout &lt;- as.data.frame(comp1.edgeR)edge.bed &lt;- out[ which(out$FDR &lt; 0.05), c("seqnames", "start", "end", "strand", "Fold")]write.table(edge.bed, file="results/Nanog_vs_Pou5f1_edgeR_sig.bed", sep="\t", quote=F, row.names=F, col.names=F)# DESeq2out &lt;- as.data.frame(comp1.deseq)deseq.bed &lt;- out[ which(out$FDR &lt; 0.05), c("seqnames", "start", "end", "strand", "Fold")]write.table(deseq.bed, file="results/Nanog_vs_Pou5f1_deseq2_sig.bed", sep="\t", quote=F, row.names=F, col.names=F) 参考资料 DiffBind文档 哈佛深度NGS数据分析课程， 09- Differential Peak calling using DiffBind]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>ChIPseq</tag>
        <tag>差异分析</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第8篇：用网页版工具做功能分析和motif分析]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2012%3A42%3A56%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[上一篇介绍了使用ChIPseeker对peaks的分布和邻近基因的注释。除此之外，下游分析通常还包括鉴定我们感兴趣的蛋白质结合的motif；鉴定这些结合区域的基因以及这些基因的富集通路或网络。 学习目标 功能富集分析: [GREAT](http://bejerano.stanford.edu/great/public/html/index.php) motif分析:MEME套件，如DREME(http://meme-suite.org/tools/dreme), MEME-ChIP (http://meme-suite.org/tools/meme-chip) 准备文件提取IDR结果文件的前3列1cut -f 1,2,3 Nanog-idr-merged.bed &gt; Nanog-idr-merged-great.bed 使用bedtools getfasta提取peaks的序列1234bedtools getfasta -fi \ref_genome.fa \-bed Nanog-idr-merged-great.bed \-fo Nanog-idr-merged-dreme.fasta 富集分析GREAT(http://bejerano.stanford.edu/great/public/html/index.php)对peaks的功能注释是对peaks临近基因的注释。方法： 1.打开GREAT网站：http://bejerano.stanford.edu/great/public/html/index.php 。上传Nanog-idr-merged-great.bed文件，选择参考基因组，选择Whole genome作为背景区域，然后点击Submit。 点开Job Description,选择View all genomic region-gene associations，结果中的两个表给出peaks注释到的基因，一个是基因组区域和基因关联的表，一个是基因和基因组关联的表： Region-Gene Association Graphs这栏内容对结合位点的基因数和转录起始位点相关的基因做了图形展示。 Global Controls选择想注释的信息，如GO注释 探究Nanog结合位点相关的GO BP term 选择某个term,查看具体信息 打开This term&#39;s genomic region-gene association tables (140 regions, 116 genes)，查看注释到的GO term相关的基因，可以下载表格。 在This term&#39;s gene -&gt; genomic region association table中点击基因相关的regions，可以在UCSC浏览器上直接查看结合区域。 找Motifmotif是比较有特征的短序列，会多次出现的，并被假设拥有生物学功能。而且，经常是一些具有序列特异性的蛋白的结合位点（如转录因子）或者是涉及到重要生物过程的（如，RNA 起始，RNA 终止， RNA 剪切等等）。有很多网页版工具提供了找motif的方法，2014年的一篇综述列出了目前常用的网页工具（https://doi.org/10.1186/1745-6150-9-4 ）：最常用的有MEME工具套件，下面主要介绍DREME。DREME适用于大批量的ChIP-Seq数据找真核转录因子短的（4nt或8nt）核心DNA结合基序。 DREME 打开DREME网页 http://meme-suite.org/tools/dreme ，只要输入fasta序列Nanog-idr-merged-dreme.fasta即可，同时可以写上email和每个任务的描述，任务完成时如右图所示，可以打开DREAM_HTML_output查看结果。DREME’s HTML展示的结果包括找到的motif的序列logo和表示显著性的E-value。点击More可以查看更多的信息。Tomtom为了确定鉴定到的motif与已知转录因子的motif是否相似，可以将找到的motif再提交到Tomtom，与已知的转录因子数据库搜索匹配，同时还会给出motif-motif相似性的统计评估。在DREAM’s HTML结果中选择某个预测到的motif，点击Submit / Download,然后选择Tomtom，点击Submit，在新打开的Tomtom界面可以选择转录因子的参考数据库，保持默认参数不变，也可以再添加其他参数，输入邮箱和任务描述就可以开始搜索。MEME-ChIPMEME-ChIP是MEME套件中的另一个工具，可以实现DREAM和Tomtom的分析功能，还可以评估motifs的中心富集性并整合相关的motifs合成相似性簇。MEME-ChIP能够鉴定更长的motifs（&lt;30bp）,但是运行时间比较长。另外可以用Homer找motif，详细用法参考找个motif嘛，简单。参考资料 哈佛深度NGS数据分析课程, 08-Web-based functional analysis and motif discovery 找个motif嘛，简单]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>ChIPseq</tag>
        <tag>motif</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第7篇：用Y叔的ChIPseeker对peaks进行注释和可视化]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2012%3A40%3A56%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[上一步骤（第6篇：重复样本的处理——IDR）用IDR对重复样本peaks的一致性进行了评估，同时得到了merge后的一致性的peaks——sample-idr，接下来就是对peaks的注释。这篇主要介绍用Y叔的R包ChIPseeker对peaks的位置（如peaks位置落在启动子、UTR、内含子等）以及peaks临近基因的注释。 ChIPseekerChIPseeker虽然最初是为了ChIP-seq注释而写的一个R包，但它不只局限于ChIP-seq，也可用于ATAC-Seq等其他富集peaks注释，也可用于lincRNA注释、DNA breakpoints的断点位置注释等所有genomic coordination的注释，另外提供了丰富的可视化功能。ChIPseeker的强大功能请参考Y叔的ChIP-Seq系列文章)，如：CS3: peak注释CS4：关于ChIPseq注释的几个问题CS6: ChIPseeker的可视化方法（中秋节的视觉饕餮） 使用方法使用ChIPseeker需要准备两个文件：一个就是要注释的peaks的文件，需满足BED格式。另一个就是注释参考文件，即需要一个包含注释信息的TxDb对象。Bioconductor提供了30个TxDb包，如果其中有研究的物种就可以直接下载安装此物种的TxDb信息。如果研究的物种没有已知的TxDb，可以使用GenomicFeatures包的函数（makeTxDbFromUCSC，makeTxDbFromBiomart）制作TxDb对象： makeTxDbFromUCSC： 通过UCSC在线制作TxDbmakeTxDbFromBiomart: 通过ensembl在线制作TxDbmakeTxDbFromGRanges：通过GRanges对象制作TxDbmakeTxDbFromGFF：通过解析GFF文件制作TxDb 制作TxDb方法示例（CS4：关于ChIPseq注释的几个问题）： 如用人的参考基因信息来做注释，从UCSC生成TxDb: 12library(GenomicFeatures)hg19.refseq.db &lt;- makeTxDbFromUCSC(genome="hg19", table="refGene") 用GFF文件做裂殖酵母的注释 12download.file("ftp://ftp.ebi.ac.uk/pub/databases/pombase/pombe/Chromosome_Dumps/gff3/schizosaccharomyces_pombe.chr.gff3", "schizosaccharomyces_pombe.chr.gff3")require(GenomicFeatures)spombe &lt;- makeTxDbFromGFF("schizosaccharomyces_pombe.chr.gff3") 具体步骤如下： 第1步：下载安装ChIPseeker注释相关的包从Bioconductor直接下载，或从github安装最新版本123456789101112131415source ("https://bioconductor.org/biocLite.R")biocLite("ChIPseeker")# 下载人的基因和lincRNA的TxDb对象biocLite("org.Hs.eg.db")biocLite("TxDb.Hsapiens.UCSC.hg19.knownGene")biocLite("TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts")biocLite("clusterProfiler")#载入各种包library("ChIPseeker")library(clusterProfiler)library("org.Hs.eg.db")library(TxDb.Hsapiens.UCSC.hg19.knownGene)txdb &lt;- TxDb.Hsapiens.UCSC.hg19.knownGenelibrary("TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts")lincRNA_txdb=TxDb.Hsapiens.UCSC.hg19.lincRNAsTranscripts 第2步：读入peaks文件函数readPeakFile读入peaks文件12nanog &lt;- readPeakFile("./idr_out.bed/nanog_idr-bed")pou5f1 &lt;- readPeakFile("./idr_out.bed/pou5f1_idr-bed") 第3步：注释peakspeaks的注释是用的annotatePeak函数，可以单独对每个peaks文件进行注释，也可以将多个peaks制作成一个list，进行比较分析和可视化。1234567# 制作多个样本比较的listpeaks &lt;- list(Nanog=nanog,Pou5f1=pou5f1)# promotor区间范围可以自己设定promoter &lt;- getPromoters(TxDb=txdb, upstream=3000, downstream=3000)tagMatrixList &lt;- lapply(peaks, getTagMatrix, windows=promoter)#annotatePeak传入annoDb参数,可进行基因ID转换（Entrez，ENSEMBL，SYMBOL，GENENAME）peakAnnoList &lt;- lapply(peaks, annotatePeak, TxDb=txdb,tssRegion=c(-3000, 3000), verbose=FALSE,addFlankGeneInfo=TRUE, flankDistance=5000,annoDb="org.Hs.eg.db") annotatePeak传入annoDb参数,即可进行基因ID转换，将Entrez ID转化为ENSEMBL，SYMBOL，GENENAME，peakAnnoList的结果如下： 12seqnames start end width strand annotation geneChr geneStart geneEnd geneLength geneStrand geneId transcriptId distanceToTSS ENSEMBL SYMBOL GENENAME flank_txIds flank_geneIds flank_gene_distances5 chr3 196625522 196625873 352 * Intron (uc003fwz.4/205564, intron 2 of 9) 3 196594727 196661584 66858 1 205564 uc011bty.2 30795 ENSG00000119231 SENP5 SUMO specific peptidase 5 uc003fwz.4;uc011bty.2 205564;205564 0;0 第4步：可视化提供了多种可视化方法，如plotAnnoBar(),vennpie(),plotAnnoPie(),plotDistToTSS()等，下面展示了两个样本在基因组特征区域的分布以及转录因子在TSS区域的结合。12plotAnnoBar(peakAnnoList)plotDistToTSS(peakAnnoList,title="Distribution of transcription factor-binding loci \n relative to TSS") 第5步：功能富集分析提取peakAnnolist中的基因，结合clusterProfiler包对peaks内的邻近基因进行富集注释。12345678910111213141516171819# Create a list with genes from each samplegene = lapply(peakAnnoList, function(i) as.data.frame(i)$geneId)# Run GO enrichment analysis ego &lt;- enrichGO(gene = entrez, keytype = "ENTREZID", OrgDb = org.Hs.eg.db, ont = "BP", pAdjustMethod = "BH", qvalueCutoff = 0.05, readable = TRUE)# Dotplot visualizationdotplot(ego, showCategory=50)# Multiple samples KEGG analysiscompKEGG &lt;- compareCluster(geneCluster = gene, fun = "enrichKEGG", organism = "human", pvalueCutoff = 0.05, pAdjustMethod = "BH")dotplot(compKEGG, showCategory = 20, title = "KEGG Pathway Enrichment Analysis") 第6步：保存文件123456# Output peakAnnolist filesave(peakAnnoList,file="peakAnnolist.rda")write.table(as.data.frame(peakAnnoList$Nanog),file="Nanog.PeakAnno",sep='\t',quote = F)# Output results from GO analysis to a tablecluster_summary &lt;- data.frame(ego)write.csv(cluster_summary, "results/clusterProfiler_Nanog.csv") 参考资料：ChIPseeker详细内容请参考: ChIPseeker文档 Y叔的ChIP-Seq系列：CS3: peak注释CS4：关于ChIPseq注释的几个问题CS6: ChIPseeker的可视化方法（中秋节的视觉饕餮） 哈佛深度NGS数据分析课程 07-ChIPseeker for ChIP peak Annotation, Comparison, and Visualization]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>software</tag>
        <tag>ChIPseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第6篇：重复样本的处理——IDR]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2012%3A38%3A56%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[前言ATAC-seq/ChIP-Seq中重复样本的处理 ATAC-Seq要求必须有2次或更多次生物学重复（十分珍贵或者稀有样本除外，但必须做至少2次技术重复）。理论上重复样本的peaks应该有高度的一致性，实际情况并不完全与预期一致。如何评价重复样本的重复性的好坏？如何得到一致性的peaks? 这一节将介绍两种方法：1. 用Bedtools进行简单的overlap合并重复样本2. 用IDR（Irreproducibility Discovery Rate）的方法获得高重复性的peaks 1. Overlapping peaks using bedtools如何得到两个重复样本间一致性的peaks? 一种简单粗暴的方法就是用bedtools计算peaks的overlaps。用法：bedtools intersect [OPTIONS] -a &lt;bed/gff/vcf/bam&gt; -b &lt;bed/gff/vcf/bam&gt; -a: 参数后加重复样本1（A） -b：参数后加重复样本2（B），也可以加多个样本 其他常用参数解释和图解如下： -wo：Write the original A and B entries plus the number of base pairs of overlap between the two features. -wa：Write the original entry in A for each overlap. -v：Only report those entries in A that have no overlaps with B如果只有-a和-b参数，返回的是相对于A的overlaps。加上参数-wo返回A和B原始的记录加上overlap的记录。参数-wa返回每个overlap中A的原始记录。使用代码示例：1234bedtools intersect \-a macs2/Nanog-rep1_peaks.narrowPeak \-b macs2/Nanog-rep2_peaks.narrowPeak \-wo &gt; bedtools/Nanog-overlaps.bed 2. Irreproducibility Discovery Rate (IDR)评估重复样本间peaks一致性的另一种方法是IDR。IDR是通过比较一对经过排序的regions/peaks 的列表，然后计算反映其重复性的值。IDR在ENCODE和modENCODE项目中被广泛使用，也是ChIP-seq指南和标准中的一部分。 IDR的 优点： 避免了初始阈值的选择，解决了不同callers的不可比较性 IDR不依赖于阈值的选择，所有regions/peaks都被考虑在内。 它是依赖regions/peaks的排序，不要求对输入信号进行校准或标准化IDR的详细说明参考: https://github.com/nboley/idr https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/06_handling-replicates.md#irreproducibility-discovery-rate-idr 使用IDR的注意事项： 建议使用IDR时，MACS2 call peaks的步骤参数设置不要过于严格，以便鉴定出更多的peaks。 使用IDR需要先对MACS2的结果文件narrowPeak根据-log10(p-value)进行排序。 1234# Call peaksmacs2 callpeak -t sample.final.bam -n sample --shift -100 --extsize 200 --nomodel -B --SPMR -g hs --outdir Macs2_out 2&gt; sample.macs2.log#Sort peak by -log10(p-value)sort -k8,8nr NAME_OF_INPUT_peaks.narrowPeak &gt; macs/NAME_FOR_OUPUT_peaks.narrowPeak 使用IDR示例 123456idr --samples sample_Rep1_sorted_peaks.narrowPeak sample_Rep2_sorted_peaks.narrowPeak \--input-file-type narrowPeak \--rank p.value \--output-file sample-idr \--plot \--log-output-file sample.idr.log --samples:narrowPeak的输入文件（重复样本）--input-file-type：输入文件格式包括narrowPeak,broadPeak,bed--rank p.value：以p-value排序--output-file: 输出文件路径--plot：输出IDR度量值的结果 输出文件解读：详细内容可参考：https://github.com/nboley/idr#output-file-format 输出文件包括： sample-idr sample-idr.log sample-idr.png （1）sample-idrsample-idr是common peaks的结果输出文件，格式与输入文件格式类似，只是多了几列信息。前10列是标准的narrowPeak格式文件，包含重复样本整合后的peaks信息。 第5列：包含缩放的 IDR 值 score int如min(int(log2(-125IDR), 1000)，那么IDR=0，缩放的IDR就是1000；IDR=0.05, int(-125log2(0.05)) = 540；IDR=1.0, int(-125log2(1.0) = 0。 第11列和第12列：分别是local和global IDR值 col11: localIDR float -log10(Local IDR value) col12: globalIDR float -log10(Global IDR value)global IDR值是第5列中用于计算缩放的IDR值，类似于对p值进行多个假设校正以计算FDR；local IDR类似于属于不可重复噪声部分的峰值的后验概率。详细内容可阅读Measuring reproducibility of high-throughput experiments。 第13、14、15、16列：是重复样本1相关的信息。 col13: rep1_chromStart int col14: rep1_chromEnd int col15: rep1_signalValue float col16: rep1_summit int 第17-20列：是重复样本2相关的信息，和13-16四列信息类似。 其他列信息如下： col1: chrom string col2: chromStart int col3: chromEnd int col4: name string col6: strand [+-.] Use ‘.’ if no strand is assigned. col7: signalValue float col8: p-value float col9: q-value float col10: summit int wc -l *-idr 计算下common peaks的个数，接着可再计算下与总peaks的比率。如果想看IDR&lt;0.05的，可以通过第5列信息过滤：awk &#39;{if($5 &gt;= 540) print $0}&#39; sample-idr | wc -l（2）sample-idr.loglog文件会给出peaks通过IDR &lt; 0.05的比率，如下图所示（3）sample-idr.pngpng文件包括4个图 左上： Rep1 peak ranks vs Rep2 peak ranks, 没有通过特定IDR阈值的peaks显示为红色。右上：Rep1 log10 peak scores vs Rep2 log10 peak scores，没有通过特定IDR阈值的peaks显示为红色。下面两个图： Peak rank vs IDR scores，箱线图展示了IDR值的分布，默认情况下，IDR值的阈值为-1E-6。 参考资料：哈佛深度NGS数据分析课程06-Handling replicates in ChIP-Seq]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>ChIPseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第5篇：对ATAC-Seq/ChIP-seq的质量评估（二）——ChIPQC]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2011%3A36%3A56%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[1. 学习目标 讨论ChIP-seq数据质量评估的其他方法 用ChIPQC产生质量统计报告 鉴定低质量数据的来源 概览图 ENCODE评估数据质量采用多种指标，如前面已经讨论过的链相关的指标NSC和RSC。这一节将会讨论评估信号分布的其他指标。 NOTE：这里给出的评估指标只是反映数据质量的好坏，符合阈值的并不意味着实验是成功的，不符合阈值的也不一定意味着失败。 2.常见质量评估指标的介绍 SSDSSD值是对富集效果的评估。SSD值依赖于全基因组的pile-up信号强度，对真实的ChIP富集和干扰的强信号区域都很敏感。SSD值越大表明富集越好。 “It provides a measure of pileup across the genome and is computed by looking at the standard deviation of signal pile-up along the genome normalised to the total number of reads. ” FRiP:Fraction of reads in peaksFRiP表示的是peaks中的reads与总reads的比例。它是另一个反映样本富集效果或IP好坏的评价指标。可以理解为是“信噪比”即文库中结合位点片段占背景reads的比例。一个典型质量好的TF富集FRiP值约5%或者更高，polII的FRiP值约为30%或者更高，也有一些质量好的数据FRiP值&lt;1%（如RNAPIII） Relative Enrichment of Genomic Intervals (REGI)REGI是对peaks在不同基因组特征位点分布的统计。 RiBL: Reads overlapping in Blacklisted Regions过滤人工造成的高信号区域非常重要，如ENCIDE和modENCODE提供的DAC Blacklisted Regions track。这些区域经常在特定的重复序列处出现，如着丝粒、端粒、卫星重复序列等，通过简单的比对过滤是不能去除的。来自blacklisted regions的信号会造成call peak 和片段长度评估的混淆。RiBL值可以表示背景信号或input的信号水平，与input sample的SSD值以及input和ChIP sample的读长覆盖值相关。这些区域通常是基因组的0.5%，或者更高的比例（10%）。 3. ChIPQC: quality metrics reportChIPQC是一个Bioconductor包，输入文件包括BAM和peak文件，可以自动计算一些质量评估值，并产生质量报告。 准备数据 BAM files首先对比对过滤后的bam数据（chr12_aln.bam）建索引，然后将bam和index文件从~/ngs_course/chipseq/results/bowtie2移动到自己的目录文件夹data/bams peak files将narrowPeak 文件从macs2目录下~/ngs_course/chipseq/results/macs2 移动到自己目录下data/peakcalls sampleSheet filesampleSheet file是唯一需要自己根据实验设计和数据存储地址等信息创建的一个csv格式文件（bam,peak文件分别在比对和call peak的步骤产生）。sampleSheet具体需要包含的信息如下： SampleID: 样本ID Tissue, Factor, Condition: 不同的实验设计对照信息，三列信息必须包含在sampleSheet里，如果没有某一列的信息设为NA。 Replicate : 重复样本的编号 bamReads : 实验组BAM 文件的路径（data/bams） ControlID : 对照组样本ID bamControl :对照组样本的bam文件路径 Peaks :样本peaks文件的路径 PeakCaller ：peak类型的字符串，可以是raw,bed,narrow,macs等。下载安装ChIPQC12source("http://bioconductor.org/biocLite.R")biocLite("ChIPQC") Running ChIPQCChIPQC只需要三步就可以完成质量评估和报告生成。 首先载入包和sampleSheet信息 12345## Load librarieslibrary(ChIPQC)## Load sample datasamples &lt;- read.csv('meta/samplesheet_chr12.csv')View(samples) 创建ChIPQC对象利用sampleSheet的信息读取每个样本的bam和narrowpeak文件，并计算质量评估值，结果存在一个对象里。 12## Create ChIPQC objectchipObj &lt;- ChIPQC(samples, annotation="hg19") 生成ChIPQC报告 12## Create ChIPQC reportChIPQCreport(chipObj, reportName="ChIP QC report: Nanog and Pou5f1", reportFolder="ChIPQCreport") ChIPQC报告解读ChIPQC生成的结果包含一个网页报告和报告中含有的所有图片。网页报告有三部分：QC Summary ；QC Results；QC files and versions （1）QC Summary - Overview of resultsQC summary包含sampleSheet里填写的样本的基本信息Tissue,Factor,Condition,Replicate。另外还有上面提到的质量评估的常用指标SSD、RiP%和RiBL值。越高的SSD值表明富集效果越好，Pou5f1样本（2.6,3）有较高的SSD值，RiBL值不是很高，FRiP的比例在5%附近或者更高，除了Pou5f1-rep2。 SSD - SSD score (htSeqTools) RIP% - Percentage of reads wthin peaks RIBL% - Percentage of reads wthin Blacklist regions同时表格中还给出了其他统计信息： Reads - Number of sample reads within analysed chromosomes. Dup% - Percentage of MapQ filter passing reads marked as duplicates FragLen - Estimated fragment length by cross-coverage method FragLenCC - Cross-Coverage score at the fragment length RelativeCC - Cross-coverage score at the fragment length over Cross-coverage at the read length （2）QC Results - Full QC results and figures Mapping, Filtering and Duplication rate第一部分是比对、过滤和重复率质检结果，包括Table2 、Figure1和Figure2。Table 2主要给出了比对质量和重复率，因为BAM文件是过滤后的，所以这里Dup%都是0. Total Dup%-Percentage of all mapped reads which are marked as duplicates. Pass MapQ Filter%-Percentage of all mapped reads whichpass MapQ quality filter Pass MapQ Filter and Dup%-Percentage of all reads which pass MapQ filter and are marked asduplicates. Figure 1展现了reads在blacklists中的比例， Figure 2是用基因组注释呈现了reads在基因组特征位置如启动子的分布。这幅图里显示在启动子区域富集最明显。 ChIP signal Distribution and Structure第二部分是ChIP信号分布和结构组成，包括Figure3和4。Figure 3是一个coverage plot， x轴代表在某bp位置read pileup的高度，y轴代表有多少位置有相同的pileup 高度(取log)。**有好的富集的ChIP样本会有一个tail，即更多的位置（y值大）有较高的测序深度。在我们的数据集中Nanog样本与Pou5f1 相比有较高的tails,尤其是重复样本2。但是Pou5f1有较高的SSD值。当SSD高但是coverage看起来低时，可能是存在大片段深度高的区域出现在blacklist 基因组区域。 Peak Profile and ChIP Enrichment第3部分是peak的谱图和ChIP的富集，每个peak都集中在summit位置（summit 理解为peak的最高峰值点处） peak的性状取决于研究对象的类型，如转录因子、组蛋白标记、或其他DNA结合蛋白如聚合酶等，相同类型的对象通常有独特特征的谱图。Figure6和7都是对比对到peak中的reads统计。富集效果好的ChIP样本的reads与peaks会有高比例的重合。尽管Nanog有较高的RiP,但是两个重复样本间的差异大于Pou5f1。 Figure8和9**表示样本的聚类效果，分别是相关性聚类热图和PCA。 4. 实验偏差：ChIP-seq数据质量低的来源 免疫沉淀的特异性和有效性影响因素如抗体的特异性，结和沉淀的强度 片段化超声裂解产生不同大小的片段可能引入偏差 文库构建时的偏差如PCR扩增参考资料：哈佛深度NGS数据分析课程05-ChIP-Seq Quality Assessment]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>ChIPseq</tag>
        <tag>QC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第4篇：对ATAC-Seq/ChIP-seq的质量评估（一）——phantompeakqualtools]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2011%3A25%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[学习目标： 探讨ChIP-seq数据质量低的来源 理解链交叉相关性（ strand cross-correlation） 使用phantompeakqualtools计算交叉相关性和其他相关的质控度量值 评估交叉相关图 ChIP-Seq质量评估在下游分析前，最好是先对peak calling 后的ChIP-Seq数据进行质量评估。 链交叉相关（Strand cross-correlation）链交叉相关是一个有效的评估ChIP-Seq质量的方法，它不依赖于peak calling，而是基于ChIP-Seq实验。如果ChIP-Seq实验成功，DNA富集序列标签（蛋白质相互作用的序列）会在reads的双峰富集中产生显著的聚集。产生reads的双峰富集的原因如下：在ChIP-Seq实验中，DNA被片段化，蛋白质结合的片段会被免疫沉淀，所以产生了有蛋白质结合的DNA片段（fragments ）。DNA的正链从5’端开始被测序（如下图红色reads），DNA负链也从5’末端被测序产生如下图所示的蓝色reads。由于从DNA片段的5′末端测序，使+链reads的富集（下图中的蓝色部分）与负链reads的富集（下图红色部分）有少量的相互抵消区域。我们需要确定峰位移多少碱基数目可以在两个峰间产生最大的相关性。我们可以用交叉相关的度量值（cross-correlation metric）计算产生最大相关的位移。 交叉相关性度量值交叉相关度量是在Watson移动k个碱基后，计算Crick链与Watson链之间的Pearson线性相关。如下面的示意图：首先在链位移为0时，两个向量之间的Pearson相关值为0.539。 在链位移5bp，两个向量之间的Pearson相关值为0.931。 继续移动这些向量，对于每个链位移计算一个相关值。 最后，我们将有一个每个碱基对移位与皮尔森相关值的对应表。这是针对每个染色体的每一个峰计算的，然后该值乘以一个缩放因子，再对所有染色体的值相加，就可以绘交叉相关值（y轴）相对于移位值（x轴）生成的交叉相关图。典型的交叉相关图会产生两个峰：一个富集峰与主要的片段长度（predominant fragment length）相关（高相关性），另一个与read 长度（read length）相关，这个峰也被称为虚幻峰（“phantom” peak）。 质量好的ChIP-Seq数据集倾向产生一个大的片段长度峰（fragment-length peak），下图展示了一个来自于人细胞CTCF（zinc-finger transcription factor）的强信号。如果有好的抗体，转录因子通常产生45,000~60,000个peaks。下图红色的垂直线表示主峰的真实位移，蓝色的垂直线处有一个小的起伏表示read lenngth。 下图是weaker signal的一个示例。这里Pol2的抗体不是很有效，有分散的峰。交叉相关图中有两个峰，一个是真实的峰位移（185-200bp），另外一个在read length。信号弱的数据集中read length的峰会成为主峰。 一个失败的实验产生的交叉相关图类似于input，在fragment length处很少或没有峰，在read length处有信号非常强的。这种现象的原因可能是在结合位点附近fragments没有显著聚集。 交叉相关性质量评估度量值交叉相关谱图可以计算评估ChIP_Seq实验信噪比的度量值，并且实验设计确保fragment length准确。低信噪比和不准确的fragment length 表明ChIP-Seq实验可能有问题。Normalized strand cross-correlation coefficent (NSC)：NSC是最大交叉相关值除以背景交叉相关的比率(所有可能的链转移的最小交叉相关值)。NSC值越大表明富集效果越好，NSC值低于1.1表明较弱的富集，小于1表示无富集。NSC值稍微低于1.05，有较低的信噪比或很少的峰，这肯能是生物学真实现象，比如有的因子在特定组织类型中只有很少的结合位点；也可能确实是数据质量差。Relative strand cross-correlation coefficient (RSC):RSC是片段长度相关值减去背景相关值除以phantom-peak相关值减去背景相关值。RSC的最小值可能是0，表示无信号；富集好的实验RSC值大于1；低于1表示质量低。 phantompeakqualtoolsphantompeakqualtools 是一个用于计算ChIP-Seq数据富集和质量度量值的一个工具包。我们将使用该包来计算基于链交叉相关峰的主要插入大小(fragment length)和基于相对phantom peak的数据质量度量值。phantompeakqualtools是一个R包，依赖samtools。下载phantompeakqualtools12345wget https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/phantompeakqualtools/ccQualityControl.v.1.1.tar.gztar -xzf ccQualityControl.v.1.1.tar.gzcd phantompeakqualtools# 查看READMEless README.txt Linux下安装12R install.packages("caTools", lib="~/R/library") 运行phantompeakqualtools 1234567mkdir -p logs qualfor bam in bam_dir/sample1.final.bam bam_dir/sample2.final.bamdo bam2=`basename $bam .final.bam`Rscript run_spp_nodups.R -c=$bam -savp -out=qual/$&#123;bam2&#125;.qual &gt; logs/$&#123;bam2&#125;.Routdone 参数含义： -c: 比对过滤后的bam文件的全路径和名字 -savp:保存交叉相关图 -out：会产生数据集重要特征值的输出文件 输出文件解读输出文件会产生一个tab分割的名为qual的文件,包含的信息如下： COL1：Filename：比对过滤的bam文件名 COL2：numReads ：有效的测序深度 COL3：estFragLen：逗号分隔的交叉相关峰以相关性递减顺序排列的值 COL4: corr_estFragLen: 逗号分隔的以递减顺序排列交叉相关值 COL5: phantomPeak: Read length/phantom peak链位移 COL6: corr_phantomPeak: phantom peak相关值 COL7: argmin_corr:交叉相关最小的链位移 COL8: min_corr:交叉相关最小值 COL9: Normalized strand cross-correlation coefficient (NSC) = COL4 / COL8 COL10: Relative strand cross-correlation coefficient (RSC) = (COL4 - COL8) / (COL6 - COL8) COL11: QualityTag: Quality tag based on thresholded RSC (codes: -2:veryLow,-1:Low,0:Medium,1:High,2:veryHigh)我们最关注的值是第9列和第11列。Cross-correlation plots课程中的示例数据Nanog_rep1的交叉相关图 参考资料哈佛深度NGS数据分析课程04_ChIP-Seq Quality Assessment: Cross-correlation]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>ChIPseq</tag>
        <tag>QC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第3篇：用MACS2软件call peaks]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2010%3A21%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[学习目标： 学会用MACS2 call peaks 理解MACS2 call peaks的结果 Peak CallingPeak calling即利用计算的方法找出ChIP-seq或ATAC-seq中reads富集的基因组区域。 如下图所示，比对结果的文件中reads在正负链不均匀分布，但在结合位点聚集。正负链5‘末端的reads各形成一组合，通过统计学的方法评估这些组合的分布并和对照组比较，确定这些结合位点是否是显著的。 NOTE：ChIP-seq的分析方法可以鉴定两种类型的富集模式：broad domains和narrow peaks。broad domains，如组蛋白修饰在整个基因body区域的分布；narrow peak，如转录因子的结合。narrow peak相对于broad 或者分散的marks更易被检测到。也有一些混合的结合图谱，如PolII包括narrow和broad信号。 MACS2peaks calling 有不同的方法，MACS2是最常用的call peaks工具。 MACS全称Model-based Analysis of ChIP-Seq，最初的设计是用来鉴定转录因子的结合位点，但是它也可以用于其他类型的富集方式测序。MACS通过整合序列标签位置信息和方向信息提高结合位点的空间分辨率。MACS的工作流如下所示： MACS2的使用方法MACS2的用法，call peaks的参数及输出文件的解读可以参考MACS2文档学习。 了解相关参数：输入文件参数： -t:实验组，IP的数据文件 c: 对照组 f：指定输入文件的格式，默认是自动检测输入数据是什么格式，支持bam,sam,bed等 g:有效基因组大小，由于基因组序列的重复性，基因组实际可以mapping的大小小于原始的基因组。这个参数要根据实际物种计算基因组的有效大小。软件里也给出了几个默认的-g 值：hs – 2.7e9表示人类的基因组有效大小(UCSC human hg18 assembly). hs: 2.7e9 mm: 1.87e9 ce: 9e7 dm: 1.2e8 输出文件参数： --outdir:输出结果的存储路径 -n:输出文件名的前缀 -B/--bdg:输出bedgraph格式的文件，输出文件以NAME+’_treat_pileup.bdg’ for treatment data, NAME+’_control_lambda.bdg’ for local lambda values from control显示。 peak calling 参数 -q/--qvalue 和 -p/--pvalueq value默认值是0.05，与pvalue不能同时使用。 --broadpeak有narrow peak和broad peak, 设置时可以call broad peak 的结果文件。 --broad-cutoff和pvalue、以及qvalue相似 --nolambda: 不要考虑在峰值候选区域的局部偏差/λ q值与峰宽有一定的联系。理想情况下，如果放宽阈值，您将简单地获得更多的peaks，但是使用MACS2放松阈值也会导致更宽的peaks。 Shift 模型参数： --nomodel这个参数和extsize、shift是配套使用的，有这个参数才可以设置extsize和shift。 --extsize当设置了nomodel时，MACS会用--extsize这个参数从5’-&gt;3’方向扩展reads修复fragments。比如说你的转录因子结合范围200bp，就设置这个参数是200。 --shift当设置了–nomodel，MACS用这个参数从5’ 端移动剪切，然后用–extsize延伸，如果–shift是负值表示从3’端方向移动。建议ChIP-seq数据集这个值保持默认值为0，对于检测富集剪切位点如DNAsel数据集设置为EXTSIZE的一半。示例： 想找富集剪切位点，如DNAse-seq，所有5’端的序列reads应该从两个方向延伸，如果想设置移动的窗口是200bp，参数设置如下：--nomodel --shift -100 --extsize 200 对nucleosome-seq数据，用核小体大小的一半进行extsize,所以参数设置如下：--nomodel --shift 37 --extsize 73 --call-summitsMACS利用此参数重新分析信号谱，解析每个peak中包含的subpeak。对相似的结合图谱，推荐使用此参数，当使用此参数时，输出的subpeak会有相同的peak边界，不同的绩点和peak summit poisitions. ATAC-Seq call peaks示例ATAC-seq关心的是在哪切断，断点才是peak的中心，所以使用shift模型，–shift -75或-100对人细胞系ATAC-seq 数据call peak的参数设置如下：1macs2 callpeak -t H1hesc.final.bam -n sample --shift -100 --extsize 200 --nomodel -B --SPMR -g hs --outdir Macs2_out 2&gt; sample.macs2.log MACS2输出文件解读 NAME_peaks.xls包含peak信息的tab分割的文件，前几行会显示callpeak时的命令。输出信息包含： 染色体号 peak起始位点 peak结束位点 peak区域长度 peak的峰值位点（summit position） peak 峰值的高度（pileup height at peak summit, -log10(pvalue) for the peak summit） peak的富集倍数（相对于random Poisson distribution with local lambda）Coordinates in XLS is 1-based which is different with BED formatXLS里的坐标和bed格式的坐标还不一样，起始坐标需要减1才与narrowPeak的起始坐标一样。 NAME_peaks.narrowPeak*narrowPeak文件是BED6+4格式，可以上传到UCSC浏览。输出文件每列信息分别包含： 1；染色体号 2：peak起始位点 3：结束位点 4：peak name 5：int(-10*log10qvalue) 6 ：正负链 7：fold change 8：-log10pvalue 9：-log10qvalue 10：relative summit position to peak start（？） NAME_summits.bedBED格式的文件，包含peak的summits位置，第5列是-log10pvalue。如果想找motif，推荐使用此文件。 Remove the beginning track line if you want to analyze it by other tools.??? .bdgbedGraph格式，可以导入UCSC或者转换为bigwig格式。两种bfg文件：treat_pileup, and control_lambda. NAME_peaks.broadPeakBED6+3格式与narrowPeak类似，只是没有第10列。 summits.bed，narrowPeak，bdg, xls四种类型输出文件的比较： xls文件文件包含信息还是比较多的，和narrowPeak唯一不同的是peak的起始位置需要减1才是bed格式的文件，另外还包含fold_enrichment 和narrowPeak的fold change 对应，-log10pvalue,-log10qvalue,peak长度，peak 峰值位置等。 narrowPeak文件和xls文件信息类似 summits.bed文件包含峰的位置信息和-log10pvalue bdg文件bdg文件适合导入UCSC或IGV进行谱图可视化，或者转换为bigwig格式再进行可视化。为什么染色体号后面会出现其他的字符串？？？？ 参考资料：HBC的深度NGS数据分析课程MCAS2文档]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>ChIPseq</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第2篇：原始数据的质控、比对和过滤]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2009%3A17%3A08%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[这部分内容包括对原始测序数据质控，然后比对过滤，这是所有NGS数据处理的上游分析。 ATAC-Seq与其他方法不同的一点是需要过滤去除线粒体（如果是植物，还需要过滤叶绿体），因为线粒体DNA是裸露的，也可以被Tn5酶识别切割。 另外一点需要注意的是课程中给出的是单端比对的示例代码，如果是双端测序做相应更改即可。 学习目标 用FastQC进行质控检测 用Trimmomatic进行质量过滤 用Bowtie2比对，并理解相关参数含义 测序reads 的质控流程示意图 FASTQC首先对拿到的原始测序数据（fastq或fastq.gz格式）进行质控检测，直接用fastqc软件，再加上multiqc将多个检测结果一起展示。如:12fastqc -o out_dir raw_data/*gzmultiqc *fastqc.zip --ignore *.html TrimmomaticTrimmomatic 可以用于去除接头，过滤低质量数据。相同功能的软件还有很多，如trim_galore、cutadapt等，个人比较喜欢trim_galore可以自动识别接头类型。123456789# 课程中给出的Trimmomatic 的用法（单端测序）$ java -jar /opt/Trimmomatic-0.33/trimmomatic-0.33.jar SE \-threads 2 \-phred33 \H1hesc_Input_Rep1_chr12.fastq \../results/trimmed/H1hesc_Input_Rep1_chr12.qualtrim20.minlen36.fq \LEADING:20 \TRAILING:20 \MINLEN:36 Trimmomatic参数含义：可以参考NGS 数据过滤之 Trimmomatic 详细说明trim_galore使用示例 1trim_galore -q 20 --phred33 --stringency 3 --length 20 -e 0.1 --paired fq1 fq2 --gzip -o input_data_dir 123# 重新用fastqc检测进行过滤后的reads质量fastqc -o out_dir *fq.gzmultiqc *fastqc.zip --ignore *.html 比对Bowtie2是一个快速精确的比对工具，基于Burrows-Wheeler Transform 构建基因组的FM 索引，比对过程所耗内存少。Bowtie2支持局部、双端、缺口比对模式，对大于50bp的reads比对效果更好（小于50bp的reads用Bowtie1）。 创建Bowtie2索引12bowtie2-build &lt;path_to_reference_genome.fa&gt; &lt;prefix_to_name_indexes&gt;# Can find indexes for the entire genome on Orchestra using following path: /groups/shared_databases/igenome/Homo_sapiens/UCSC/hg19/Sequence/Bowtie2Index/ Bowtie2 比对 p: 线程数 q: reads是fastq格式 x: index路径 U: fastq路径 S: 输出Sam格式文件12345## 课程中给出的代码是单端比对bowtie2 -p 2 -q \-x ~/ngs_course/chipseq/reference_data/chr12\-U ~/ngs_course/chipseq/results/trimmed/H1hesc_Input_Rep1_chr12.qualtrim20.minlen36.fq \-S ~/ngs_course/chipseq/results/bowtie2/H1hesc_Input_Rep1_chr12_aln_unsorted.sam NOTE: 如果fastq文件是没有经过trim的，可以用局部比对执行soft-clipping，加上参数--local 过滤reads首先将sam文件转为bam格式，再对bam文件进行排序，接着过滤唯一比对的reads，去除线粒体reads。转化为bam格式使用samtools转换格式123samtools view -h -S -b \-o H1hesc_Input_Rep1_chr12_aln_unsorted.bam \H1hesc_Input_Rep1_chr12_aln_unsorted.sam 对bam文件排序对bam文件按照基因组坐标排序，可以直接使用samtools，也可以使用Sambamba。sambamba快速处理bam和sam文件。 123sambamba sort -t 2 \-o H1hesc_Input_Rep1_chr12_aln_sorted.bam \H1hesc_Input_Rep1_chr12_aln_unsorted.bam 过滤唯一比对的reads 123sambamba view -h -t 2 -f bam \-F "[XS] == null and not unmapped " \H1hesc_Input_Rep1_chr12_aln_sorted.bam &gt; H1hesc_Input_Rep1_chr12_aln.bam 去除PCR重复PCR扩增和一些重复序列（如微卫星、着丝粒）会产生重复，干扰真实的富集信号，所以在call peaks前需要先去除重复，这里先用picard去除PCR重复。picard去除PCR重复时要加上参数REMOVE_DUPLICATES=true,否则只是标记了duplicates，并没有去除。 1java -jar picard-tools-1.119/MarkDuplicates.jar REMOVE_DUPLICATES=true I=H1hesc_Input_Rep1_chr12_aln.bam O=H1hesc_Input_Rep1_chr12_aln.dedup.bam M=H1hesc.duplicates.log 过滤线粒体reads 123samtools index H1hesc_Input_Rep1_chr12_aln.dedup.bamsamtools idxstats H1hesc_Input_Rep1_chr12_aln.dedup.bam &gt; H1hesc_Input_Rep1_chr12_aln.dedup.mitochondrial.statssamtools view -h H1hesc_Input_Rep1_chr12_aln.dedup.bam | grep -v 'chrM' | samtools view -bS -o H1hesc.final.bam 上面给出的仅是示例代码，和参考课程不一样，实际运行需要修改相应文件。此时就得到了唯一比对且已经去除过线粒体的比对文件，可以用于接下来的peaks calling。 参考资料：HBC的深度NGS数据分析课程：https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/02_QC_and_alignment.md]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
        <tag>QC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[第1篇：ATAC-seq的背景介绍以及与ChIP-Seq的异同]]></title>
    <url>%2F2019%2F08%2F23%2FFri%20Aug%2023%202019%2008%3A26%3A56%20GMT%2B0200%2F</url>
    <content type="text"><![CDATA[ATAC-Seq简介ATAC-seq（Assay for Transposase-Accessible Chromatin with high throughput sequencing） 是2013年由斯坦福大学William J. Greenleaf和Howard Y. Chang实验室开发的用于研究染色质可及性（通常也理解为染色质的开放性）的方法， 原理是通过转座酶Tn5容易结合在开放染色质的特性，然后对Tn5酶捕获到的DNA序列进行测序。 真核生物的核DNA并不是裸露的，而是与组蛋白结合形成染色体的基本结构单位核小体，核小体再经逐步的压缩折叠最终形成染色体高级结构（如人的DNA链完整展开约2m长，经过这样的折叠就变成了纳米级至微米级的染色质结构而可以储存在小小的细胞核）。而DNA的复制转录是需要将DNA的紧密结构打开，从而允许一些调控因子结合（转录因子或其他调控因子）。这部分打开的染色质，就叫开放染色质，打开的染色质允许其他调控因子结合的特性称为染色质的可及性（chromatin accessibility）。因此，认为染色质的可及性与转录调控密切相关。开放染色质的研究方法有ATAC-seq以及传统的DNase-Seq及FAIRE-seq等，ATAC-Seq由于所需细胞量少，实验简单，可以在全基因组范围内检测染色质的开放状态，目前已经成为研究染色质开放性的首选技术方法。 Nat Methods, 2013. doi: 10.1038/nmeth.2688. Epub 2013 Oct. ATAC-Seq与ChIP-Seq的异同ATAC-Seq与ChIP-Seq的不同的是ATAC-Seq是全基因组范围内检测染色质的开放程度，可以得到全基因组范围内的蛋白质可能结合的位点信息，一般用于不知道特定的转录因子，用此方法与其他方法结合筛查感兴趣的特定调控因子；但是ChIP-Seq是明确知道感兴趣的转录因子是什么，根据感兴趣的转录因子设计抗体去做ChIP实验拉DNA，验证感兴趣的转录因子是否与DNA存在相互作用。ATAC-Seq、ChIP-Seq、Dnase-Seq、MNase-Seq、FAIRE-Seq整体的分析思路一致，找到富集区域，对富集区域进行功能分析。 ChIP-Seq是揭示特定转录因子或蛋白复合物的结合区域，实际是研究DNA和蛋白质的相互作用，利用抗体将蛋白质和DNA一起富集，并对富集到的DNA进行测序。 DNase-Seq、ATAC-Seq、FAIRE-Seq都是用来研究开放染色质区域。DNase-Seq是用的DNase I内切酶识别开放染色质区域，而ATAC-seq是用的Tn5转座酶，随后进行富集和扩增；FAIRE-Seq是先进行超声裂解，然后用酚-氯仿富集。 MNase-Seq是用来鉴定核小体区域。 翻译部分下面这一部分是对HBC课程中ChIP-Seq Introduction这一节的介绍，主要包括的ChIP-Seq的实验设计和分析方法总体思路。原文链接：https://github.com/hbctraining/In-depth-NGS-Data-Analysis-Course/blob/master/sessionV/lessons/01_Intro_chipseq_and_setup.md。 ChIP-Seq Introduction学习目标 理解ChIP-Seq的实验设计ChIP-Seq简介ChIP实验（Chromatin immunoprecipitation）即染色质免疫沉淀，根据DNA与蛋白质相互作用的原理，分离富集与感兴趣的蛋白相互作用的DNA。ChIP-Seq即对分离得到的DNA扩增测序，然后通过分析得到DNA的富集区域也称为peaks，同时可以鉴定过表达的序列motif以及进行功能注释分析。 下面这一部分将会介绍ChIP-Seq数据分析的整个流程，从实验设计到产生原始的测序reads，以及到最后的功能富集分析和motif查找。 实验设计和文库构建文库构建包括以下5步骤： 蛋白质与DNA的交联 超声打断DNA链 加附有抗体的磁珠用于免疫沉淀 解交联，纯化DNA DNA片段大小选择和PCR扩增 富集到的DNA片段只有一部分是真实的信号（感兴趣的蛋白结合的DNA区域），这个比例取决于number of active binding sites, the number of starting genomes, and the efficiency of the IP. ChIP-Seq富集序列存在以下特点： 开放染色质区域比紧密区域更易打断； 重复序列会出现似乎被富集的现象 序列在整个基因组上不均匀分布 因此，ChIP-Seq需要有合适的对照组，对照样本需要满足以下其中一个条件： 没有IP（input DAN） 没有抗体 (“mock IP”) 没有特定的抗体 (IgG “mock IP”) 示例数据介绍所用到的示例数据是来自于人类胚胎干细胞系（h1-ESC）中Nanog和Pou5f1（Oct4）两个转录因子的结合图谱。这两个转录因子的功能涉及干细胞的多能性，该研究的目标之一是探究这两个转录因子在转录调控中单独和相互的调控作用。两组重复，每组重复包括3个实验样本信息，共6个样本，数据分析中只用到了12号染色体的信息。Nanog IPPou5f1 IPControl input DNA 分析流程下面这幅图给出了整个分析流程，和每一步需要的数据格式，后面会展开介绍。 分析环境配置这个课程提供了示例数据和分析代码，可以参考这里连接他们的服务器，我没有连接成功，不知道是不是打开方式不对，大家可以尝试下，如果连接成功，这一部分就是配置服务器的环境，准备数据；如果也连接不上可以用自己的数据或者下载公共数据。 参考资料：ATAC-seq：染色质开放性测序技术Clifford A. et al. Nature review, 2014HBC课程V : 01-Introduction to ChIP-Seq]]></content>
      <categories>
        <category>Data Sciences</category>
      </categories>
      <tags>
        <tag>ATACseq</tag>
      </tags>
  </entry>
</search>
